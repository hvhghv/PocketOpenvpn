<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mbed TLS v3.5.1: chachapoly.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mbed TLS v3.5.1
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_b4d146e9a6d8dd56ed4afb2480a97fd3.html">mbedtls</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">chachapoly.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains the AEAD-ChaCha20-Poly1305 definitions and functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="private__access_8h_source.html">mbedtls/private_access.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mbedtls_2build__info_8h_source.html">mbedtls/build_info.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="poly1305_8h_source.html">mbedtls/poly1305.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="chacha20_8h_source.html">mbedtls/chacha20.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for chachapoly.h:</div>
<div class="dyncontent">
<div class="center"><img src="chachapoly_8h__incl.png" border="0" usemap="#chachapoly_8h" alt=""/></div>
<map name="chachapoly_8h" id="chachapoly_8h">
<area shape="rect" title="This file contains the AEAD&#45;ChaCha20&#45;Poly1305 definitions and functions." alt="" coords="240,5,339,32"/>
<area shape="rect" href="private__access_8h.html" title="Macro wrapper for struct&#39;s members." alt="" coords="5,155,176,181"/>
<area shape="rect" href="mbedtls_2build__info_8h.html" title="Build&#45;time configuration info." alt="" coords="619,155,757,181"/>
<area shape="rect" href="poly1305_8h.html" title="This file contains Poly1305 definitions and functions." alt="" coords="303,80,438,107"/>
<area shape="rect" href="chacha20_8h.html" title="This file contains ChaCha20 definitions and functions." alt="" coords="140,80,279,107"/>
<area shape="rect" href="mbedtls__config_8h.html" title="Configuration options (set of defines)" alt="" coords="695,237,865,263"/>
<area shape="rect" href="crypto__config_8h.html" title="PSA crypto configuration options (set of defines)" alt="" coords="889,237,1025,263"/>
<area shape="rect" href="config__psa_8h.html" title="PSA crypto configuration options (set of defines)" alt="" coords="1233,237,1380,263"/>
<area shape="rect" href="config__adjust__legacy__crypto_8h.html" title="Adjust legacy configuration configuration." alt="" coords="1404,229,1553,271"/>
<area shape="rect" href="config__adjust__x509_8h.html" title="Adjust X.509 configuration." alt="" coords="348,229,497,271"/>
<area shape="rect" href="config__adjust__ssl_8h.html" title="Adjust TLS configuration." alt="" coords="521,229,671,271"/>
<area shape="rect" href="check__config_8h.html" title="Consistency checks for configuration options." alt="" coords="1049,237,1209,263"/>
<area shape="rect" href="crypto__legacy_8h.html" title="Add temporary suppport for deprecated symbols before they are removed from the library." alt="" coords="1321,326,1460,353"/>
<area shape="rect" href="crypto__adjust__config__synonyms_8h.html" title="Adjust PSA configuration: enable quasi&#45;synonyms." alt="" coords="1485,319,1651,360"/>
<area shape="rect" href="config__adjust__psa__superset__legacy_8h.html" title="Adjust PSA configuration: automatic enablement from legacy." alt="" coords="1676,319,1839,360"/>
<area shape="rect" href="crypto__adjust__config__key__pair__types_8h.html" title="Adjust PSA configuration for key pair types." alt="" coords="1863,319,2030,360"/>
<area shape="rect" href="config__adjust__legacy__from__psa_8h.html" title="Adjust PSA configuration: activate legacy implementations." alt="" coords="793,319,943,360"/>
<area shape="rect" href="crypto__adjust__auto__enabled_8h.html" title="Adjust PSA configuration: enable always&#45;on features." alt="" coords="967,319,1124,360"/>
<area shape="rect" href="config__adjust__psa__from__legacy_8h.html" title="Adjust PSA configuration: construct PSA configuration from legacy." alt="" coords="1148,319,1297,360"/>
<area shape="rect" title=" " alt="" coords="705,326,769,353"/>
<area shape="rect" title=" " alt="" coords="278,326,343,353"/>
<area shape="rect" title=" " alt="" coords="251,155,320,181"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="chachapoly_8h__dep__incl.png" border="0" usemap="#chachapoly_8hdep" alt=""/></div>
<map name="chachapoly_8hdep" id="chachapoly_8hdep">
<area shape="rect" title="This file contains the AEAD&#45;ChaCha20&#45;Poly1305 definitions and functions." alt="" coords="405,5,504,32"/>
<area shape="rect" href="crypto__builtin__composites_8h.html" title=" " alt="" coords="363,80,547,107"/>
<area shape="rect" href="crypto__driver__contexts__composites_8h.html" title=" " alt="" coords="377,155,532,196"/>
<area shape="rect" href="crypto__struct_8h.html" title="PSA cryptography module: Mbed TLS structured type implementations." alt="" coords="400,244,509,271"/>
<area shape="rect" href="crypto_8h.html" title="Platform Security Architecture cryptography module." alt="" coords="420,319,489,345"/>
<area shape="rect" href="pk_8h.html" title="Public Key abstraction layer." alt="" coords="281,393,327,420"/>
<area shape="rect" href="ssl_8h.html" title="SSL/TLS functions." alt="" coords="272,692,323,719"/>
<area shape="rect" href="ssl__ticket_8h.html" title="TLS server ticket callbacks implementation." alt="" coords="461,767,550,793"/>
<area shape="rect" href="ssl__ciphersuites_8h.html" title="SSL Ciphersuites for Mbed TLS." alt="" coords="290,617,417,644"/>
<area shape="rect" href="x509_8h.html" title="X.509 generic defines and structures." alt="" coords="189,468,251,495"/>
<area shape="rect" href="oid_8h.html" title="Object Identifier (OID) database." alt="" coords="115,468,165,495"/>
<area shape="rect" href="debug_8h.html" title="Functions for controlling and providing debug output from the library." alt="" coords="369,767,437,793"/>
<area shape="rect" href="net__sockets_8h.html" title="Network sockets abstraction layer to integrate Mbed TLS into a BSD&#45;style sockets API." alt="" coords="5,767,109,793"/>
<area shape="rect" href="ssl__cache_8h.html" title="SSL session cache implementation." alt="" coords="134,767,226,793"/>
<area shape="rect" href="ssl__cookie_8h.html" title="DTLS cookie callbacks implementation." alt="" coords="250,767,345,793"/>
<area shape="rect" href="x509__crt_8h.html" title="X.509 certificate parsing and writing." alt="" coords="132,617,215,644"/>
<area shape="rect" href="pkcs7_8h.html" title="PKCS #7 generic defines and structures https://tools.ietf.org/html/rfc2315." alt="" coords="65,692,133,719"/>
<area shape="rect" href="x509__crl_8h.html" title="X.509 certificate revocation list parsing." alt="" coords="217,543,300,569"/>
<area shape="rect" href="x509__csr_8h.html" title="X.509 certificate signing request parsing and writing." alt="" coords="55,543,142,569"/>
</map>
</div>
</div>
<p><a href="chachapoly_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa10c236ef79947e0503321c6b91adf6a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#aa10c236ef79947e0503321c6b91adf6a">MBEDTLS_ERR_CHACHAPOLY_BAD_STATE</a>&#160;&#160;&#160;-0x0054</td></tr>
<tr class="separator:aa10c236ef79947e0503321c6b91adf6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfcc39d21b02c91dc0429e094e891858"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#adfcc39d21b02c91dc0429e094e891858">MBEDTLS_ERR_CHACHAPOLY_AUTH_FAILED</a>&#160;&#160;&#160;-0x0056</td></tr>
<tr class="separator:adfcc39d21b02c91dc0429e094e891858"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a23d48de13968c738dfe86f7a167a4d7d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#a23d48de13968c738dfe86f7a167a4d7d">mbedtls_chachapoly_context</a></td></tr>
<tr class="separator:a23d48de13968c738dfe86f7a167a4d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aed9737497f9096f67edc8eab036fb341"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341">mbedtls_chachapoly_mode_t</a> { <a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341a6897b8bea1e6a49332c85de45070bb6b">MBEDTLS_CHACHAPOLY_ENCRYPT</a>, 
<a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341ace5d538bce78fdbc0b835578b752d01e">MBEDTLS_CHACHAPOLY_DECRYPT</a>
 }</td></tr>
<tr class="separator:aed9737497f9096f67edc8eab036fb341"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a59a82c2427261ad0f163689f9ea327a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#a59a82c2427261ad0f163689f9ea327a3">mbedtls_chachapoly_init</a> (<a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *ctx)</td></tr>
<tr class="memdesc:a59a82c2427261ad0f163689f9ea327a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes the specified ChaCha20-Poly1305 context.  <a href="chachapoly_8h.html#a59a82c2427261ad0f163689f9ea327a3">More...</a><br /></td></tr>
<tr class="separator:a59a82c2427261ad0f163689f9ea327a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab52c8fd7aff8b52d6c6be92c19b28e65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#ab52c8fd7aff8b52d6c6be92c19b28e65">mbedtls_chachapoly_free</a> (<a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *ctx)</td></tr>
<tr class="memdesc:ab52c8fd7aff8b52d6c6be92c19b28e65"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function releases and clears the specified ChaCha20-Poly1305 context.  <a href="chachapoly_8h.html#ab52c8fd7aff8b52d6c6be92c19b28e65">More...</a><br /></td></tr>
<tr class="separator:ab52c8fd7aff8b52d6c6be92c19b28e65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a943948ae0a8020d327ee3cba84a26b0f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#a943948ae0a8020d327ee3cba84a26b0f">mbedtls_chachapoly_setkey</a> (<a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *ctx, const unsigned char key[32])</td></tr>
<tr class="memdesc:a943948ae0a8020d327ee3cba84a26b0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the ChaCha20-Poly1305 symmetric encryption key.  <a href="chachapoly_8h.html#a943948ae0a8020d327ee3cba84a26b0f">More...</a><br /></td></tr>
<tr class="separator:a943948ae0a8020d327ee3cba84a26b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c1132fa9aa7f156134f7e9c98710444"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#a7c1132fa9aa7f156134f7e9c98710444">mbedtls_chachapoly_starts</a> (<a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *ctx, const unsigned char nonce[12], <a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341">mbedtls_chachapoly_mode_t</a> mode)</td></tr>
<tr class="memdesc:a7c1132fa9aa7f156134f7e9c98710444"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function starts a ChaCha20-Poly1305 encryption or decryption operation.  <a href="chachapoly_8h.html#a7c1132fa9aa7f156134f7e9c98710444">More...</a><br /></td></tr>
<tr class="separator:a7c1132fa9aa7f156134f7e9c98710444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8250d5f2592c57df2e421880dee91e4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#af8250d5f2592c57df2e421880dee91e4">mbedtls_chachapoly_update_aad</a> (<a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *ctx, const unsigned char *aad, size_t aad_len)</td></tr>
<tr class="memdesc:af8250d5f2592c57df2e421880dee91e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function feeds additional data to be authenticated into an ongoing ChaCha20-Poly1305 operation.  <a href="chachapoly_8h.html#af8250d5f2592c57df2e421880dee91e4">More...</a><br /></td></tr>
<tr class="separator:af8250d5f2592c57df2e421880dee91e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99f1dbde96f78dd333a3bbfbf75a21be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be">mbedtls_chachapoly_update</a> (<a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *ctx, size_t len, const unsigned char *input, unsigned char *output)</td></tr>
<tr class="memdesc:a99f1dbde96f78dd333a3bbfbf75a21be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation.  <a href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be">More...</a><br /></td></tr>
<tr class="separator:a99f1dbde96f78dd333a3bbfbf75a21be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b336e7a9d677f93318851c8da5b6b4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#a18b336e7a9d677f93318851c8da5b6b4">mbedtls_chachapoly_finish</a> (<a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *ctx, unsigned char mac[16])</td></tr>
<tr class="memdesc:a18b336e7a9d677f93318851c8da5b6b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finished the ChaCha20-Poly1305 operation and generates the MAC (authentication tag).  <a href="chachapoly_8h.html#a18b336e7a9d677f93318851c8da5b6b4">More...</a><br /></td></tr>
<tr class="separator:a18b336e7a9d677f93318851c8da5b6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac03b8f4820e55094fb046610a5acbf7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#ac03b8f4820e55094fb046610a5acbf7b">mbedtls_chachapoly_encrypt_and_tag</a> (<a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *ctx, size_t length, const unsigned char nonce[12], const unsigned char *aad, size_t aad_len, const unsigned char *input, unsigned char *output, unsigned char tag[16])</td></tr>
<tr class="memdesc:ac03b8f4820e55094fb046610a5acbf7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs a complete ChaCha20-Poly1305 authenticated encryption with the previously-set key.  <a href="chachapoly_8h.html#ac03b8f4820e55094fb046610a5acbf7b">More...</a><br /></td></tr>
<tr class="separator:ac03b8f4820e55094fb046610a5acbf7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af11a55f37385ab4a4e4582eff8a2058d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#af11a55f37385ab4a4e4582eff8a2058d">mbedtls_chachapoly_auth_decrypt</a> (<a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *ctx, size_t length, const unsigned char nonce[12], const unsigned char *aad, size_t aad_len, const unsigned char tag[16], const unsigned char *input, unsigned char *output)</td></tr>
<tr class="memdesc:af11a55f37385ab4a4e4582eff8a2058d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs a complete ChaCha20-Poly1305 authenticated decryption with the previously-set key.  <a href="chachapoly_8h.html#af11a55f37385ab4a4e4582eff8a2058d">More...</a><br /></td></tr>
<tr class="separator:af11a55f37385ab4a4e4582eff8a2058d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbb54e7c0006e91a3d37758ba1671fe8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#acbb54e7c0006e91a3d37758ba1671fe8">mbedtls_chachapoly_self_test</a> (int verbose)</td></tr>
<tr class="memdesc:acbb54e7c0006e91a3d37758ba1671fe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ChaCha20-Poly1305 checkup routine.  <a href="chachapoly_8h.html#acbb54e7c0006e91a3d37758ba1671fe8">More...</a><br /></td></tr>
<tr class="separator:acbb54e7c0006e91a3d37758ba1671fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains the AEAD-ChaCha20-Poly1305 definitions and functions. </p>
<p>ChaCha20-Poly1305 is an algorithm for Authenticated Encryption with Associated Data (AEAD) that can be used to encrypt and authenticate data. It is based on ChaCha20 and Poly1305 by Daniel Bernstein and was standardized in RFC 7539.</p>
<dl class="section author"><dt>Author</dt><dd>Daniel King <a href="#" onclick="location.href='mai'+'lto:'+'dam'+'ak'+'i.g'+'h@'+'gma'+'il'+'.co'+'m'; return false;">damak<span style="display: none;">.nosp@m.</span>i.gh<span style="display: none;">.nosp@m.</span>@gmai<span style="display: none;">.nosp@m.</span>l.co<span style="display: none;">.nosp@m.</span>m</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="chachapoly_8h_source.html">chachapoly.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="adfcc39d21b02c91dc0429e094e891858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfcc39d21b02c91dc0429e094e891858">&#9670;&nbsp;</a></span>MBEDTLS_ERR_CHACHAPOLY_AUTH_FAILED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_CHACHAPOLY_AUTH_FAILED&#160;&#160;&#160;-0x0056</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Authenticated decryption failed: data was not authentic. </p>

<p class="definition">Definition at line <a class="el" href="chachapoly_8h_source.html#l00032">32</a> of file <a class="el" href="chachapoly_8h_source.html">chachapoly.h</a>.</p>

</div>
</div>
<a id="aa10c236ef79947e0503321c6b91adf6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa10c236ef79947e0503321c6b91adf6a">&#9670;&nbsp;</a></span>MBEDTLS_ERR_CHACHAPOLY_BAD_STATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_CHACHAPOLY_BAD_STATE&#160;&#160;&#160;-0x0054</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The requested operation is not permitted in the current state. </p>

<p class="definition">Definition at line <a class="el" href="chachapoly_8h_source.html#l00030">30</a> of file <a class="el" href="chachapoly_8h_source.html">chachapoly.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a23d48de13968c738dfe86f7a167a4d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23d48de13968c738dfe86f7a167a4d7d">&#9670;&nbsp;</a></span>mbedtls_chachapoly_context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> <a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aed9737497f9096f67edc8eab036fb341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed9737497f9096f67edc8eab036fb341">&#9670;&nbsp;</a></span>mbedtls_chachapoly_mode_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341">mbedtls_chachapoly_mode_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aed9737497f9096f67edc8eab036fb341a6897b8bea1e6a49332c85de45070bb6b"></a>MBEDTLS_CHACHAPOLY_ENCRYPT&#160;</td><td class="fielddoc"><p>The mode value for performing encryption. </p>
</td></tr>
<tr><td class="fieldname"><a id="aed9737497f9096f67edc8eab036fb341ace5d538bce78fdbc0b835578b752d01e"></a>MBEDTLS_CHACHAPOLY_DECRYPT&#160;</td><td class="fielddoc"><p>The mode value for performing decryption. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="chachapoly_8h_source.html#l00038">38</a> of file <a class="el" href="chachapoly_8h_source.html">chachapoly.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="af11a55f37385ab4a4e4582eff8a2058d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af11a55f37385ab4a4e4582eff8a2058d">&#9670;&nbsp;</a></span>mbedtls_chachapoly_auth_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_auth_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>nonce</em>[12], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>aad_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>tag</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs a complete ChaCha20-Poly1305 authenticated decryption with the previously-set key. </p>
<dl class="section note"><dt>Note</dt><dd>Before using this function, you must set the key with <code><a class="el" href="chachapoly_8h.html#a943948ae0a8020d327ee3cba84a26b0f" title="This function sets the ChaCha20-Poly1305 symmetric encryption key.">mbedtls_chachapoly_setkey()</a></code>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context to use (holds the key). </td></tr>
    <tr><td class="paramname">length</td><td>The length (in Bytes) of the data to decrypt. </td></tr>
    <tr><td class="paramname">nonce</td><td>The <code>96</code> Bit (<code>12</code> bytes) nonce/IV to use. </td></tr>
    <tr><td class="paramname">aad</td><td>The buffer containing the additional authenticated data (AAD). This pointer can be <code>NULL</code> if <code>aad_len == 0</code>. </td></tr>
    <tr><td class="paramname">aad_len</td><td>The length (in bytes) of the AAD data to process. </td></tr>
    <tr><td class="paramname">tag</td><td>The buffer holding the authentication tag. This must be a readable buffer of length <code>16</code> Bytes. </td></tr>
    <tr><td class="paramname">input</td><td>The buffer containing the data to decrypt. This pointer can be <code>NULL</code> if <code>ilen == 0</code>. </td></tr>
    <tr><td class="paramname">output</td><td>The buffer to where the decrypted data is written. This pointer can be <code>NULL</code> if <code>ilen == 0</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="chachapoly_8h.html#adfcc39d21b02c91dc0429e094e891858">MBEDTLS_ERR_CHACHAPOLY_AUTH_FAILED</a> if the data was not authentic. </dd>
<dd>
Another negative error code on other kinds of failure. </dd></dl>

</div>
</div>
<a id="ac03b8f4820e55094fb046610a5acbf7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac03b8f4820e55094fb046610a5acbf7b">&#9670;&nbsp;</a></span>mbedtls_chachapoly_encrypt_and_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_encrypt_and_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>nonce</em>[12], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>aad_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>tag</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs a complete ChaCha20-Poly1305 authenticated encryption with the previously-set key. </p>
<dl class="section note"><dt>Note</dt><dd>Before using this function, you must set the key with <code><a class="el" href="chachapoly_8h.html#a943948ae0a8020d327ee3cba84a26b0f" title="This function sets the ChaCha20-Poly1305 symmetric encryption key.">mbedtls_chachapoly_setkey()</a></code>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>You must never use the same nonce twice with the same key. This would void any confidentiality and authenticity guarantees for the messages encrypted with the same nonce and key.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context to use (holds the key). This must be initialized. </td></tr>
    <tr><td class="paramname">length</td><td>The length (in bytes) of the data to encrypt or decrypt. </td></tr>
    <tr><td class="paramname">nonce</td><td>The 96-bit (12 bytes) nonce/IV to use. </td></tr>
    <tr><td class="paramname">aad</td><td>The buffer containing the additional authenticated data (AAD). This pointer can be <code>NULL</code> if <code>aad_len == 0</code>. </td></tr>
    <tr><td class="paramname">aad_len</td><td>The length (in bytes) of the AAD data to process. </td></tr>
    <tr><td class="paramname">input</td><td>The buffer containing the data to encrypt or decrypt. This pointer can be <code>NULL</code> if <code>ilen == 0</code>. </td></tr>
    <tr><td class="paramname">output</td><td>The buffer to where the encrypted or decrypted data is written. This pointer can be <code>NULL</code> if <code>ilen == 0</code>. </td></tr>
    <tr><td class="paramname">tag</td><td>The buffer to where the computed 128-bit (16 bytes) MAC is written. This must not be <code>NULL</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
A negative error code on failure. </dd></dl>

</div>
</div>
<a id="a18b336e7a9d677f93318851c8da5b6b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18b336e7a9d677f93318851c8da5b6b4">&#9670;&nbsp;</a></span>mbedtls_chachapoly_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>mac</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finished the ChaCha20-Poly1305 operation and generates the MAC (authentication tag). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context to use. This must be initialized. </td></tr>
    <tr><td class="paramname">mac</td><td>The buffer to where the 128-bit (16 bytes) MAC is written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Decryption with the piecewise API is discouraged, see the warning on <code><a class="el" href="chachapoly_8h.html#a59a82c2427261ad0f163689f9ea327a3" title="This function initializes the specified ChaCha20-Poly1305 context.">mbedtls_chachapoly_init()</a></code>.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="chachapoly_8h.html#aa10c236ef79947e0503321c6b91adf6a">MBEDTLS_ERR_CHACHAPOLY_BAD_STATE</a> if the operation has not been started or has been finished. </dd>
<dd>
Another negative error code on other kinds of failure. </dd></dl>

</div>
</div>
<a id="ab52c8fd7aff8b52d6c6be92c19b28e65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab52c8fd7aff8b52d6c6be92c19b28e65">&#9670;&nbsp;</a></span>mbedtls_chachapoly_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_chachapoly_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function releases and clears the specified ChaCha20-Poly1305 context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChachaPoly context to clear. This may be <code>NULL</code>, in which case this function is a no-op. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a59a82c2427261ad0f163689f9ea327a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59a82c2427261ad0f163689f9ea327a3">&#9670;&nbsp;</a></span>mbedtls_chachapoly_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_chachapoly_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes the specified ChaCha20-Poly1305 context. </p>
<pre class="fragment">             It must be the first API called before using
             the context. It must be followed by a call to
             \c mbedtls_chachapoly_setkey() before any operation can be
             done, and to \c mbedtls_chachapoly_free() once all
             operations with that context have been finished.

             In order to encrypt or decrypt full messages at once, for
             each message you should make a single call to
             \c mbedtls_chachapoly_crypt_and_tag() or
             \c mbedtls_chachapoly_auth_decrypt().

             In order to encrypt messages piecewise, for each
             message you should make a call to
             \c mbedtls_chachapoly_starts(), then 0 or more calls to
             \c mbedtls_chachapoly_update_aad(), then 0 or more calls to
             \c mbedtls_chachapoly_update(), then one call to
             \c mbedtls_chachapoly_finish().
</pre><dl class="section warning"><dt>Warning</dt><dd>Decryption with the piecewise API is discouraged! Always use <code><a class="el" href="chachapoly_8h.html#af11a55f37385ab4a4e4582eff8a2058d" title="This function performs a complete ChaCha20-Poly1305 authenticated decryption with the previously-set ...">mbedtls_chachapoly_auth_decrypt()</a></code> when possible!</dd></dl>
<p>If however this is not possible because the data is too large to fit in memory, you need to:</p>
<ul>
<li>call <code><a class="el" href="chachapoly_8h.html#a7c1132fa9aa7f156134f7e9c98710444" title="This function starts a ChaCha20-Poly1305 encryption or decryption operation.">mbedtls_chachapoly_starts()</a></code> and (if needed) <code><a class="el" href="chachapoly_8h.html#af8250d5f2592c57df2e421880dee91e4" title="This function feeds additional data to be authenticated into an ongoing ChaCha20-Poly1305 operation.">mbedtls_chachapoly_update_aad()</a></code> as above,</li>
<li>call <code><a class="el" href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be" title="Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation.">mbedtls_chachapoly_update()</a></code> multiple times and ensure its output (the plaintext) is NOT used in any other way than placing it in temporary storage at this point,</li>
<li>call <code><a class="el" href="chachapoly_8h.html#a18b336e7a9d677f93318851c8da5b6b4" title="This function finished the ChaCha20-Poly1305 operation and generates the MAC (authentication tag).">mbedtls_chachapoly_finish()</a></code> to compute the authentication tag and compared it in constant time to the tag received with the ciphertext.</li>
</ul>
<p>If the tags are not equal, you must immediately discard all previous outputs of <code><a class="el" href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be" title="Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation.">mbedtls_chachapoly_update()</a></code>, otherwise you can now safely use the plaintext.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChachaPoly context to initialize. Must not be <code>NULL</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acbb54e7c0006e91a3d37758ba1671fe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbb54e7c0006e91a3d37758ba1671fe8">&#9670;&nbsp;</a></span>mbedtls_chachapoly_self_test()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_self_test </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The ChaCha20-Poly1305 checkup routine. </p>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<code>1</code> on failure. </dd></dl>

</div>
</div>
<a id="a943948ae0a8020d327ee3cba84a26b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a943948ae0a8020d327ee3cba84a26b0f">&#9670;&nbsp;</a></span>mbedtls_chachapoly_setkey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_setkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>key</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the ChaCha20-Poly1305 symmetric encryption key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context to which the key should be bound. This must be initialized. </td></tr>
    <tr><td class="paramname">key</td><td>The <code>256</code> Bit (<code>32</code> Bytes) key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
A negative error code on failure. </dd></dl>

</div>
</div>
<a id="a7c1132fa9aa7f156134f7e9c98710444"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c1132fa9aa7f156134f7e9c98710444">&#9670;&nbsp;</a></span>mbedtls_chachapoly_starts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_starts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>nonce</em>[12], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341">mbedtls_chachapoly_mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function starts a ChaCha20-Poly1305 encryption or decryption operation. </p>
<dl class="section warning"><dt>Warning</dt><dd>You must never use the same nonce twice with the same key. This would void any confidentiality and authenticity guarantees for the messages encrypted with the same nonce and key.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If the context is being used for AAD only (no data to encrypt or decrypt) then <code>mode</code> can be set to any value.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Decryption with the piecewise API is discouraged, see the warning on <code><a class="el" href="chachapoly_8h.html#a59a82c2427261ad0f163689f9ea327a3" title="This function initializes the specified ChaCha20-Poly1305 context.">mbedtls_chachapoly_init()</a></code>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context. This must be initialized and bound to a key. </td></tr>
    <tr><td class="paramname">nonce</td><td>The nonce/IV to use for the message. This must be a readable buffer of length <code>12</code> Bytes. </td></tr>
    <tr><td class="paramname">mode</td><td>The operation to perform: <a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341a6897b8bea1e6a49332c85de45070bb6b">MBEDTLS_CHACHAPOLY_ENCRYPT</a> or <a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341ace5d538bce78fdbc0b835578b752d01e">MBEDTLS_CHACHAPOLY_DECRYPT</a> (discouraged, see warning).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
A negative error code on failure. </dd></dl>

</div>
</div>
<a id="a99f1dbde96f78dd333a3bbfbf75a21be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99f1dbde96f78dd333a3bbfbf75a21be">&#9670;&nbsp;</a></span>mbedtls_chachapoly_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation. </p>
<p>The direction (encryption or decryption) depends on the mode that was given when calling <code><a class="el" href="chachapoly_8h.html#a7c1132fa9aa7f156134f7e9c98710444" title="This function starts a ChaCha20-Poly1305 encryption or decryption operation.">mbedtls_chachapoly_starts()</a></code>.</p>
<p>You may call this function multiple times to process an arbitrary amount of data. It is permitted to call this function 0 times, if no data is to be encrypted or decrypted.</p>
<dl class="section warning"><dt>Warning</dt><dd>Decryption with the piecewise API is discouraged, see the warning on <code><a class="el" href="chachapoly_8h.html#a59a82c2427261ad0f163689f9ea327a3" title="This function initializes the specified ChaCha20-Poly1305 context.">mbedtls_chachapoly_init()</a></code>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context to use. This must be initialized. </td></tr>
    <tr><td class="paramname">len</td><td>The length (in bytes) of the data to encrypt or decrypt. </td></tr>
    <tr><td class="paramname">input</td><td>The buffer containing the data to encrypt or decrypt. This pointer can be <code>NULL</code> if <code>len == 0</code>. </td></tr>
    <tr><td class="paramname">output</td><td>The buffer to where the encrypted or decrypted data is written. This must be able to hold <code>len</code> bytes. This pointer can be <code>NULL</code> if <code>len == 0</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="chachapoly_8h.html#aa10c236ef79947e0503321c6b91adf6a">MBEDTLS_ERR_CHACHAPOLY_BAD_STATE</a> if the operation has not been started or has been finished. </dd>
<dd>
Another negative error code on other kinds of failure. </dd></dl>

</div>
</div>
<a id="af8250d5f2592c57df2e421880dee91e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8250d5f2592c57df2e421880dee91e4">&#9670;&nbsp;</a></span>mbedtls_chachapoly_update_aad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_update_aad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__chachapoly__context.html">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>aad_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function feeds additional data to be authenticated into an ongoing ChaCha20-Poly1305 operation. </p>
<p>The Additional Authenticated Data (AAD), also called Associated Data (AD) is only authenticated but not encrypted nor included in the encrypted output. It is usually transmitted separately from the ciphertext or computed locally by each party.</p>
<dl class="section note"><dt>Note</dt><dd>This function is called before data is encrypted/decrypted. I.e. call this function to process the AAD before calling <code><a class="el" href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be" title="Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation.">mbedtls_chachapoly_update()</a></code>.</dd></dl>
<p>You may call this function multiple times to process an arbitrary amount of AAD. It is permitted to call this function 0 times, if no AAD is used.</p>
<p>This function cannot be called any more if data has been processed by <code><a class="el" href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be" title="Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation.">mbedtls_chachapoly_update()</a></code>, or if the context has been finished.</p>
<dl class="section warning"><dt>Warning</dt><dd>Decryption with the piecewise API is discouraged, see the warning on <code><a class="el" href="chachapoly_8h.html#a59a82c2427261ad0f163689f9ea327a3" title="This function initializes the specified ChaCha20-Poly1305 context.">mbedtls_chachapoly_init()</a></code>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context. This must be initialized and bound to a key. </td></tr>
    <tr><td class="paramname">aad_len</td><td>The length in Bytes of the AAD. The length has no restrictions. </td></tr>
    <tr><td class="paramname">aad</td><td>Buffer containing the AAD. This pointer can be <code>NULL</code> if <code>aad_len == 0</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="poly1305_8h.html#a2d22050169c640e1622e46202e70ab1d">MBEDTLS_ERR_POLY1305_BAD_INPUT_DATA</a> if <code>ctx</code> or <code>aad</code> are NULL. </dd>
<dd>
<a class="el" href="chachapoly_8h.html#aa10c236ef79947e0503321c6b91adf6a">MBEDTLS_ERR_CHACHAPOLY_BAD_STATE</a> if the operations has not been started or has been finished, or if the AAD has been finished. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Sep 6 2024 20:24:40 for Mbed TLS v3.5.1 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
