<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mbed TLS v3.5.1: pkcs12.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mbed TLS v3.5.1
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_b4d146e9a6d8dd56ed4afb2480a97fd3.html">mbedtls</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pkcs12.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>PKCS#12 Personal Information Exchange Syntax.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="mbedtls_2build__info_8h_source.html">mbedtls/build_info.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="md_8h_source.html">mbedtls/md.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cipher_8h_source.html">mbedtls/cipher.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="asn1_8h_source.html">mbedtls/asn1.h</a>&quot;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pkcs12.h:</div>
<div class="dyncontent">
<div class="center"><img src="pkcs12_8h__incl.png" border="0" usemap="#pkcs12_8h" alt=""/></div>
<map name="pkcs12_8h" id="pkcs12_8h">
<area shape="rect" title="PKCS#12 Personal Information Exchange Syntax." alt="" coords="429,5,503,32"/>
<area shape="rect" href="mbedtls_2build__info_8h.html" title="Build&#45;time configuration info." alt="" coords="681,304,819,331"/>
<area shape="rect" href="md_8h.html" title="This file contains the generic functions for message&#45;digest (hashing) and HMAC." alt="" coords="626,80,727,107"/>
<area shape="rect" title=" " alt="" coords="529,229,598,256"/>
<area shape="rect" href="cipher_8h.html" title="This file contains an abstraction interface for use with the cipher primitives provided by the librar..." alt="" coords="268,80,387,107"/>
<area shape="rect" href="asn1_8h.html" title="Generic ASN.1 parsing." alt="" coords="411,80,521,107"/>
<area shape="rect" href="mbedtls__config_8h.html" title="Configuration options (set of defines)" alt="" coords="665,386,835,413"/>
<area shape="rect" href="crypto__config_8h.html" title="PSA crypto configuration options (set of defines)" alt="" coords="859,386,995,413"/>
<area shape="rect" href="config__psa_8h.html" title="PSA crypto configuration options (set of defines)" alt="" coords="1417,386,1563,413"/>
<area shape="rect" href="config__adjust__legacy__crypto_8h.html" title="Adjust legacy configuration configuration." alt="" coords="1019,379,1169,420"/>
<area shape="rect" href="config__adjust__x509_8h.html" title="Adjust X.509 configuration." alt="" coords="1193,379,1342,420"/>
<area shape="rect" href="config__adjust__ssl_8h.html" title="Adjust TLS configuration." alt="" coords="491,379,641,420"/>
<area shape="rect" href="check__config_8h.html" title="Consistency checks for configuration options." alt="" coords="307,386,467,413"/>
<area shape="rect" href="crypto__legacy_8h.html" title="Add temporary suppport for deprecated symbols before they are removed from the library." alt="" coords="1243,475,1382,502"/>
<area shape="rect" href="crypto__adjust__config__synonyms_8h.html" title="Adjust PSA configuration: enable quasi&#45;synonyms." alt="" coords="1407,468,1573,509"/>
<area shape="rect" href="config__adjust__psa__superset__legacy_8h.html" title="Adjust PSA configuration: automatic enablement from legacy." alt="" coords="1598,468,1761,509"/>
<area shape="rect" href="crypto__adjust__config__key__pair__types_8h.html" title="Adjust PSA configuration for key pair types." alt="" coords="1785,468,1952,509"/>
<area shape="rect" href="config__adjust__legacy__from__psa_8h.html" title="Adjust PSA configuration: activate legacy implementations." alt="" coords="1977,468,2126,509"/>
<area shape="rect" href="crypto__adjust__auto__enabled_8h.html" title="Adjust PSA configuration: enable always&#45;on features." alt="" coords="889,468,1046,509"/>
<area shape="rect" href="config__adjust__psa__from__legacy_8h.html" title="Adjust PSA configuration: construct PSA configuration from legacy." alt="" coords="1070,468,1219,509"/>
<area shape="rect" title=" " alt="" coords="399,475,463,502"/>
<area shape="rect" title=" " alt="" coords="309,475,375,502"/>
<area shape="rect" href="private__access_8h.html" title="Macro wrapper for struct&#39;s members." alt="" coords="62,229,233,256"/>
<area shape="rect" href="platform__util_8h.html" title="Common and shared functions used by multiple modules in the Mbed TLS library." alt="" coords="677,155,831,181"/>
<area shape="rect" href="platform__time_8h.html" title="Mbed TLS Platform time abstraction." alt="" coords="957,229,1119,256"/>
<area shape="rect" title=" " alt="" coords="949,304,1007,331"/>
<area shape="rect" title=" " alt="" coords="1417,304,1496,331"/>
<area shape="rect" href="bignum_8h.html" title="Multi&#45;precision integer library." alt="" coords="274,155,399,181"/>
<area shape="rect" title=" " alt="" coords="307,229,369,256"/>
</map>
</div>
</div>
<p><a href="pkcs12_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ac856f81d3cbc3baeaa848b33d991209b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#ac856f81d3cbc3baeaa848b33d991209b">MBEDTLS_ERR_PKCS12_BAD_INPUT_DATA</a>&#160;&#160;&#160;-0x1F80</td></tr>
<tr class="separator:ac856f81d3cbc3baeaa848b33d991209b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae887e38a4caab392fc5086bcceed7af9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#ae887e38a4caab392fc5086bcceed7af9">MBEDTLS_ERR_PKCS12_FEATURE_UNAVAILABLE</a>&#160;&#160;&#160;-0x1F00</td></tr>
<tr class="separator:ae887e38a4caab392fc5086bcceed7af9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e9101410d452e508c88a7231e23996"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#a92e9101410d452e508c88a7231e23996">MBEDTLS_ERR_PKCS12_PBE_INVALID_FORMAT</a>&#160;&#160;&#160;-0x1E80</td></tr>
<tr class="separator:a92e9101410d452e508c88a7231e23996"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3313f9e7321d23b3af93e97a544ffdb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#ab3313f9e7321d23b3af93e97a544ffdb">MBEDTLS_ERR_PKCS12_PASSWORD_MISMATCH</a>&#160;&#160;&#160;-0x1E00</td></tr>
<tr class="separator:ab3313f9e7321d23b3af93e97a544ffdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b0f41c74cd6a8e072c84b5d310b331"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#ad9b0f41c74cd6a8e072c84b5d310b331">MBEDTLS_PKCS12_DERIVE_KEY</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ad9b0f41c74cd6a8e072c84b5d310b331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8ac9a220c8d237a9a5bc972daed1c13"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#ad8ac9a220c8d237a9a5bc972daed1c13">MBEDTLS_PKCS12_DERIVE_IV</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ad8ac9a220c8d237a9a5bc972daed1c13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91d3d19fb1a5cd18648f363eff8617ec"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#a91d3d19fb1a5cd18648f363eff8617ec">MBEDTLS_PKCS12_DERIVE_MAC_KEY</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a91d3d19fb1a5cd18648f363eff8617ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41364d57177059b3ffb3167139e741b4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#a41364d57177059b3ffb3167139e741b4">MBEDTLS_PKCS12_PBE_DECRYPT</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a41364d57177059b3ffb3167139e741b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae833899c432600a15030b761d1e34d44"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#ae833899c432600a15030b761d1e34d44">MBEDTLS_PKCS12_PBE_ENCRYPT</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ae833899c432600a15030b761d1e34d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a860c32e28331903d3e822293aec8e3f7"><td class="memItemLeft" align="right" valign="top">int <a class="el" href="platform__util_8h.html#aa9f53b232ef244efb301233d111930dc">MBEDTLS_DEPRECATED</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#a860c32e28331903d3e822293aec8e3f7">mbedtls_pkcs12_pbe</a> (<a class="el" href="structmbedtls__asn1__buf.html">mbedtls_asn1_buf</a> *pbe_params, int mode, <a class="el" href="cipher_8h.html#a00c5885f1ea7279c5a7d8e12e596569d">mbedtls_cipher_type_t</a> cipher_type, <a class="el" href="md_8h.html#a219313cb40503ec3e34a857ab98b2296">mbedtls_md_type_t</a> md_type, const unsigned char *pwd, size_t pwdlen, const unsigned char *data, size_t len, unsigned char *output)</td></tr>
<tr class="memdesc:a860c32e28331903d3e822293aec8e3f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">PKCS12 Password Based function (encryption / decryption) for cipher-based and mbedtls_md-based PBE's.  <a href="pkcs12_8h.html#a860c32e28331903d3e822293aec8e3f7">More...</a><br /></td></tr>
<tr class="separator:a860c32e28331903d3e822293aec8e3f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf510355b5435be62494364754ca85ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#adf510355b5435be62494364754ca85ed">mbedtls_pkcs12_pbe_ext</a> (<a class="el" href="structmbedtls__asn1__buf.html">mbedtls_asn1_buf</a> *pbe_params, int mode, <a class="el" href="cipher_8h.html#a00c5885f1ea7279c5a7d8e12e596569d">mbedtls_cipher_type_t</a> cipher_type, <a class="el" href="md_8h.html#a219313cb40503ec3e34a857ab98b2296">mbedtls_md_type_t</a> md_type, const unsigned char *pwd, size_t pwdlen, const unsigned char *data, size_t len, unsigned char *output, size_t output_size, size_t *output_len)</td></tr>
<tr class="memdesc:adf510355b5435be62494364754ca85ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">PKCS12 Password Based function (encryption / decryption) for cipher-based and mbedtls_md-based PBE's.  <a href="pkcs12_8h.html#adf510355b5435be62494364754ca85ed">More...</a><br /></td></tr>
<tr class="separator:adf510355b5435be62494364754ca85ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e58a53e1f2194583f1e48fc2ffef627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pkcs12_8h.html#a5e58a53e1f2194583f1e48fc2ffef627">mbedtls_pkcs12_derivation</a> (unsigned char *data, size_t datalen, const unsigned char *pwd, size_t pwdlen, const unsigned char *salt, size_t saltlen, <a class="el" href="md_8h.html#a219313cb40503ec3e34a857ab98b2296">mbedtls_md_type_t</a> <a class="el" href="md_8h.html#a36c5d8bda1905e0434708f0ef5912dda">mbedtls_md</a>, int id, int iterations)</td></tr>
<tr class="memdesc:a5e58a53e1f2194583f1e48fc2ffef627"><td class="mdescLeft">&#160;</td><td class="mdescRight">The PKCS#12 derivation function uses a password and a salt to produce pseudo-random bits for a particular "purpose".  <a href="pkcs12_8h.html#a5e58a53e1f2194583f1e48fc2ffef627">More...</a><br /></td></tr>
<tr class="separator:a5e58a53e1f2194583f1e48fc2ffef627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>PKCS#12 Personal Information Exchange Syntax. </p>

<p class="definition">Definition in file <a class="el" href="pkcs12_8h_source.html">pkcs12.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ac856f81d3cbc3baeaa848b33d991209b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac856f81d3cbc3baeaa848b33d991209b">&#9670;&nbsp;</a></span>MBEDTLS_ERR_PKCS12_BAD_INPUT_DATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_PKCS12_BAD_INPUT_DATA&#160;&#160;&#160;-0x1F80</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Bad input parameters to function. </p>

<p class="definition">Definition at line <a class="el" href="pkcs12_8h_source.html#l00022">22</a> of file <a class="el" href="pkcs12_8h_source.html">pkcs12.h</a>.</p>

</div>
</div>
<a id="ae887e38a4caab392fc5086bcceed7af9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae887e38a4caab392fc5086bcceed7af9">&#9670;&nbsp;</a></span>MBEDTLS_ERR_PKCS12_FEATURE_UNAVAILABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_PKCS12_FEATURE_UNAVAILABLE&#160;&#160;&#160;-0x1F00</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Feature not available, e.g. unsupported encryption scheme. </p>

<p class="definition">Definition at line <a class="el" href="pkcs12_8h_source.html#l00024">24</a> of file <a class="el" href="pkcs12_8h_source.html">pkcs12.h</a>.</p>

</div>
</div>
<a id="ab3313f9e7321d23b3af93e97a544ffdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3313f9e7321d23b3af93e97a544ffdb">&#9670;&nbsp;</a></span>MBEDTLS_ERR_PKCS12_PASSWORD_MISMATCH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_PKCS12_PASSWORD_MISMATCH&#160;&#160;&#160;-0x1E00</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given private key password does not allow for correct decryption. </p>

<p class="definition">Definition at line <a class="el" href="pkcs12_8h_source.html#l00028">28</a> of file <a class="el" href="pkcs12_8h_source.html">pkcs12.h</a>.</p>

</div>
</div>
<a id="a92e9101410d452e508c88a7231e23996"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92e9101410d452e508c88a7231e23996">&#9670;&nbsp;</a></span>MBEDTLS_ERR_PKCS12_PBE_INVALID_FORMAT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_PKCS12_PBE_INVALID_FORMAT&#160;&#160;&#160;-0x1E80</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>PBE ASN.1 data not as expected. </p>

<p class="definition">Definition at line <a class="el" href="pkcs12_8h_source.html#l00026">26</a> of file <a class="el" href="pkcs12_8h_source.html">pkcs12.h</a>.</p>

</div>
</div>
<a id="ad8ac9a220c8d237a9a5bc972daed1c13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8ac9a220c8d237a9a5bc972daed1c13">&#9670;&nbsp;</a></span>MBEDTLS_PKCS12_DERIVE_IV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_PKCS12_DERIVE_IV&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>initialization vector <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="pkcs12_8h_source.html#l00031">31</a> of file <a class="el" href="pkcs12_8h_source.html">pkcs12.h</a>.</p>

</div>
</div>
<a id="ad9b0f41c74cd6a8e072c84b5d310b331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9b0f41c74cd6a8e072c84b5d310b331">&#9670;&nbsp;</a></span>MBEDTLS_PKCS12_DERIVE_KEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_PKCS12_DERIVE_KEY&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>encryption/decryption key </p>

<p class="definition">Definition at line <a class="el" href="pkcs12_8h_source.html#l00030">30</a> of file <a class="el" href="pkcs12_8h_source.html">pkcs12.h</a>.</p>

</div>
</div>
<a id="a91d3d19fb1a5cd18648f363eff8617ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91d3d19fb1a5cd18648f363eff8617ec">&#9670;&nbsp;</a></span>MBEDTLS_PKCS12_DERIVE_MAC_KEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_PKCS12_DERIVE_MAC_KEY&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>integrity / MAC key <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="pkcs12_8h_source.html#l00032">32</a> of file <a class="el" href="pkcs12_8h_source.html">pkcs12.h</a>.</p>

</div>
</div>
<a id="a41364d57177059b3ffb3167139e741b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41364d57177059b3ffb3167139e741b4">&#9670;&nbsp;</a></span>MBEDTLS_PKCS12_PBE_DECRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_PKCS12_PBE_DECRYPT&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkcs12_8h_source.html#l00034">34</a> of file <a class="el" href="pkcs12_8h_source.html">pkcs12.h</a>.</p>

</div>
</div>
<a id="ae833899c432600a15030b761d1e34d44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae833899c432600a15030b761d1e34d44">&#9670;&nbsp;</a></span>MBEDTLS_PKCS12_PBE_ENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_PKCS12_PBE_ENCRYPT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pkcs12_8h_source.html#l00035">35</a> of file <a class="el" href="pkcs12_8h_source.html">pkcs12.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a5e58a53e1f2194583f1e48fc2ffef627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e58a53e1f2194583f1e48fc2ffef627">&#9670;&nbsp;</a></span>mbedtls_pkcs12_derivation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_pkcs12_derivation </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>datalen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>pwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pwdlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>saltlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="md_8h.html#a219313cb40503ec3e34a857ab98b2296">mbedtls_md_type_t</a>&#160;</td>
          <td class="paramname"><em>mbedtls_md</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iterations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The PKCS#12 derivation function uses a password and a salt to produce pseudo-random bits for a particular "purpose". </p>
<p>Depending on the given id, this function can produce an encryption/decryption key, an initialization vector or an integrity key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>buffer to store the derived data in </td></tr>
    <tr><td class="paramname">datalen</td><td>length of buffer to fill </td></tr>
    <tr><td class="paramname">pwd</td><td>The password to use. For compliance with PKCS#12 §B.1, this should be a BMPString, i.e. a Unicode string where each character is encoded as 2 bytes in big-endian order, with no byte order mark and with a null terminator (i.e. the last two bytes should be 0x00 0x00). </td></tr>
    <tr><td class="paramname">pwdlen</td><td>length of the password (may be 0). </td></tr>
    <tr><td class="paramname">salt</td><td>Salt buffer to use. This may only be <code>NULL</code> when <code>saltlen</code> is 0. </td></tr>
    <tr><td class="paramname">saltlen</td><td>length of the salt (may be zero) </td></tr>
    <tr><td class="paramname">mbedtls_md</td><td>mbedtls_md type to use during the derivation </td></tr>
    <tr><td class="paramname">id</td><td>id that describes the purpose (can be <a class="el" href="pkcs12_8h.html#ad9b0f41c74cd6a8e072c84b5d310b331">MBEDTLS_PKCS12_DERIVE_KEY</a>, <a class="el" href="pkcs12_8h.html#ad8ac9a220c8d237a9a5bc972daed1c13">MBEDTLS_PKCS12_DERIVE_IV</a> or <a class="el" href="pkcs12_8h.html#a91d3d19fb1a5cd18648f363eff8617ec">MBEDTLS_PKCS12_DERIVE_MAC_KEY</a>) </td></tr>
    <tr><td class="paramname">iterations</td><td>number of iterations</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or a MD, BIGNUM type error. </dd></dl>

</div>
</div>
<a id="a860c32e28331903d3e822293aec8e3f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a860c32e28331903d3e822293aec8e3f7">&#9670;&nbsp;</a></span>mbedtls_pkcs12_pbe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="platform__util_8h.html#aa9f53b232ef244efb301233d111930dc">MBEDTLS_DEPRECATED</a> mbedtls_pkcs12_pbe </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__asn1__buf.html">mbedtls_asn1_buf</a> *&#160;</td>
          <td class="paramname"><em>pbe_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cipher_8h.html#a00c5885f1ea7279c5a7d8e12e596569d">mbedtls_cipher_type_t</a>&#160;</td>
          <td class="paramname"><em>cipher_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="md_8h.html#a219313cb40503ec3e34a857ab98b2296">mbedtls_md_type_t</a>&#160;</td>
          <td class="paramname"><em>md_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>pwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pwdlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PKCS12 Password Based function (encryption / decryption) for cipher-based and mbedtls_md-based PBE's. </p>
<dl class="section note"><dt>Note</dt><dd>When encrypting, <a class="el" href="mbedtls__config_8h.html#a0f53acf64658fe68c1e532a9434c31f0">MBEDTLS_CIPHER_PADDING_PKCS7</a> must be enabled at compile time.</dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000007">Deprecated:</a></b></dt><dd>This function is deprecated and will be removed in a future version of the library. Please use <a class="el" href="pkcs12_8h.html#adf510355b5435be62494364754ca85ed" title="PKCS12 Password Based function (encryption / decryption) for cipher-based and mbedtls_md-based PBE&#39;s.">mbedtls_pkcs12_pbe_ext()</a> instead.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>When decrypting:<ul>
<li>if <a class="el" href="mbedtls__config_8h.html#a0f53acf64658fe68c1e532a9434c31f0">MBEDTLS_CIPHER_PADDING_PKCS7</a> is enabled at compile time, this function validates the CBC padding and returns <a class="el" href="pkcs12_8h.html#ab3313f9e7321d23b3af93e97a544ffdb">MBEDTLS_ERR_PKCS12_PASSWORD_MISMATCH</a> if the padding is invalid. Note that this can help active adversaries attempting to brute-forcing the password. Note also that there is no guarantee that an invalid password will be detected (the chances of a valid padding with a random password are about 1/255).</li>
<li>if <a class="el" href="mbedtls__config_8h.html#a0f53acf64658fe68c1e532a9434c31f0">MBEDTLS_CIPHER_PADDING_PKCS7</a> is disabled at compile time, this function does not validate the CBC padding.</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pbe_params</td><td>an ASN1 buffer containing the pkcs-12 PbeParams structure </td></tr>
    <tr><td class="paramname">mode</td><td>either <a class="el" href="pkcs12_8h.html#ae833899c432600a15030b761d1e34d44">MBEDTLS_PKCS12_PBE_ENCRYPT</a> or <a class="el" href="pkcs12_8h.html#a41364d57177059b3ffb3167139e741b4">MBEDTLS_PKCS12_PBE_DECRYPT</a> </td></tr>
    <tr><td class="paramname">cipher_type</td><td>the cipher used </td></tr>
    <tr><td class="paramname">md_type</td><td>the mbedtls_md used </td></tr>
    <tr><td class="paramname">pwd</td><td>Latin1-encoded password used. This may only be <code>NULL</code> when <code>pwdlen</code> is 0. No null terminator should be used. </td></tr>
    <tr><td class="paramname">pwdlen</td><td>length of the password (may be 0) </td></tr>
    <tr><td class="paramname">data</td><td>the input data </td></tr>
    <tr><td class="paramname">len</td><td>data length </td></tr>
    <tr><td class="paramname">output</td><td>Output buffer. On success, it contains the encrypted or decrypted data, possibly followed by the CBC padding. On failure, the content is indeterminate. For decryption, there must be enough room for <code>len</code> bytes. For encryption, there must be enough room for <code>len</code> + 1 bytes, rounded up to the block size of the block cipher identified by <code>pbe_params</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or a MBEDTLS_ERR_XXX code </dd></dl>

</div>
</div>
<a id="adf510355b5435be62494364754ca85ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf510355b5435be62494364754ca85ed">&#9670;&nbsp;</a></span>mbedtls_pkcs12_pbe_ext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_pkcs12_pbe_ext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmbedtls__asn1__buf.html">mbedtls_asn1_buf</a> *&#160;</td>
          <td class="paramname"><em>pbe_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cipher_8h.html#a00c5885f1ea7279c5a7d8e12e596569d">mbedtls_cipher_type_t</a>&#160;</td>
          <td class="paramname"><em>cipher_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="md_8h.html#a219313cb40503ec3e34a857ab98b2296">mbedtls_md_type_t</a>&#160;</td>
          <td class="paramname"><em>md_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>pwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pwdlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>output_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PKCS12 Password Based function (encryption / decryption) for cipher-based and mbedtls_md-based PBE's. </p>
<dl class="section warning"><dt>Warning</dt><dd>When decrypting:<ul>
<li>This function validates the CBC padding and returns <a class="el" href="pkcs12_8h.html#ab3313f9e7321d23b3af93e97a544ffdb">MBEDTLS_ERR_PKCS12_PASSWORD_MISMATCH</a> if the padding is invalid. Note that this can help active adversaries attempting to brute-forcing the password. Note also that there is no guarantee that an invalid password will be detected (the chances of a valid padding with a random password are about 1/255).</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pbe_params</td><td>an ASN1 buffer containing the pkcs-12 PbeParams structure </td></tr>
    <tr><td class="paramname">mode</td><td>either <a class="el" href="pkcs12_8h.html#ae833899c432600a15030b761d1e34d44">MBEDTLS_PKCS12_PBE_ENCRYPT</a> or <a class="el" href="pkcs12_8h.html#a41364d57177059b3ffb3167139e741b4">MBEDTLS_PKCS12_PBE_DECRYPT</a> </td></tr>
    <tr><td class="paramname">cipher_type</td><td>the cipher used </td></tr>
    <tr><td class="paramname">md_type</td><td>the mbedtls_md used </td></tr>
    <tr><td class="paramname">pwd</td><td>Latin1-encoded password used. This may only be <code>NULL</code> when <code>pwdlen</code> is 0. No null terminator should be used. </td></tr>
    <tr><td class="paramname">pwdlen</td><td>length of the password (may be 0) </td></tr>
    <tr><td class="paramname">data</td><td>the input data </td></tr>
    <tr><td class="paramname">len</td><td>data length </td></tr>
    <tr><td class="paramname">output</td><td>Output buffer. On success, it contains the encrypted or decrypted data, possibly followed by the CBC padding. On failure, the content is indeterminate. For decryption, there must be enough room for <code>len</code> bytes. For encryption, there must be enough room for <code>len</code> + 1 bytes, rounded up to the block size of the block cipher identified by <code>pbe_params</code>. </td></tr>
    <tr><td class="paramname">output_size</td><td>size of output buffer. This must be big enough to accommodate for output plus padding data. </td></tr>
    <tr><td class="paramname">output_len</td><td>On success, length of actual data written to the output buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, or a MBEDTLS_ERR_XXX code </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Sep 6 2024 20:24:41 for Mbed TLS v3.5.1 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
