<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: Control_processor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a>  </div>
  <div class="headertitle">
<div class="title">Control_processor</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey.html">key</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for unidirectional cipher and HMAC key material.  <a href="structkey.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__ctx.html">key_ctx</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for one set of cipher and/or HMAC contexts.  <a href="structkey__ctx.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey2.html">key2</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for bidirectional cipher and HMAC key material.  <a href="structkey2.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__direction__state.html">key_direction_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key ordering of the <code><a class="el" href="structkey2.html#a9698a633f0112a2000a0efdb8d960010" title="Two unidirectional sets of key material.">key2.keys</a></code> array.  <a href="structkey__direction__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for two sets of OpenSSL cipher and/or HMAC contexts for both sending and receiving directions.  <a href="structkey__ctx__bi.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__source.html">key_source</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for one half of random material to be used in key method 2 data channel key generation.  <a href="structkey__source.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__source2.html">key_source2</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for both halves of random material to be used in key method 2 data channel key generation.  <a href="structkey__source2.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html">key_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Security parameter state of one TLS and data channel key session.  <a href="structkey__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtls__session.html">tls_session</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Security parameter state of a single session within a VPN tunnel.  <a href="structtls__session.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtls__multi.html">tls_multi</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Security parameter state for a single VPN tunnel.  <a href="structtls__multi.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Functions for initialization and cleanup of key_state structures</h2></td></tr>
<tr class="memitem:gaf97679512a386e6c21d2d73f4ae662f6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#gaf97679512a386e6c21d2d73f4ae662f6">key_state_init</a> (struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>, struct <a class="el" href="structkey__state.html">key_state</a> *ks)</td></tr>
<tr class="memdesc:gaf97679512a386e6c21d2d73f4ae662f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> structure.  <a href="group__control__processor.html#gaf97679512a386e6c21d2d73f4ae662f6">More...</a><br /></td></tr>
<tr class="separator:gaf97679512a386e6c21d2d73f4ae662f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e479e6a3ddb6991825951db9dff9319"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga1e479e6a3ddb6991825951db9dff9319">key_state_free</a> (struct <a class="el" href="structkey__state.html">key_state</a> *ks, bool clear)</td></tr>
<tr class="memdesc:ga1e479e6a3ddb6991825951db9dff9319"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleanup a <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> structure.  <a href="group__control__processor.html#ga1e479e6a3ddb6991825951db9dff9319">More...</a><br /></td></tr>
<tr class="separator:ga1e479e6a3ddb6991825951db9dff9319"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Functions for initialization and cleanup of tls_session structures</h2></td></tr>
<tr class="memitem:ga93bffc74e6ed2eaeed528f8e981afac8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga93bffc74e6ed2eaeed528f8e981afac8">tls_session_init</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>)</td></tr>
<tr class="memdesc:ga93bffc74e6ed2eaeed528f8e981afac8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> structure.  <a href="group__control__processor.html#ga93bffc74e6ed2eaeed528f8e981afac8">More...</a><br /></td></tr>
<tr class="separator:ga93bffc74e6ed2eaeed528f8e981afac8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga22cb46e1959bff9bb56c726f19e35581"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga22cb46e1959bff9bb56c726f19e35581">tls_session_free</a> (struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>, bool clear)</td></tr>
<tr class="memdesc:ga22cb46e1959bff9bb56c726f19e35581"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up a <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> structure.  <a href="group__control__processor.html#ga22cb46e1959bff9bb56c726f19e35581">More...</a><br /></td></tr>
<tr class="separator:ga22cb46e1959bff9bb56c726f19e35581"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Functions for initialization and cleanup of tls_multi structures</h2></td></tr>
<tr class="memitem:gaf7223d904613a08407ae52dc3831d7a2"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#gaf7223d904613a08407ae52dc3831d7a2">tls_multi_init</a> (struct <a class="el" href="structtls__options.html">tls_options</a> *<a class="el" href="structtls__options.html">tls_options</a>)</td></tr>
<tr class="memdesc:gaf7223d904613a08407ae52dc3831d7a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and initialize a <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure.  <a href="group__control__processor.html#gaf7223d904613a08407ae52dc3831d7a2">More...</a><br /></td></tr>
<tr class="separator:gaf7223d904613a08407ae52dc3831d7a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada87c9f2a7755ab7507dd16fa6e22716"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#gada87c9f2a7755ab7507dd16fa6e22716">tls_multi_init_finalize</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:gada87c9f2a7755ab7507dd16fa6e22716"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalize initialization of a <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure.  <a href="group__control__processor.html#gada87c9f2a7755ab7507dd16fa6e22716">More...</a><br /></td></tr>
<tr class="separator:gada87c9f2a7755ab7507dd16fa6e22716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga03aaa9093737daae72627dc38198dd1d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structtls__auth__standalone.html">tls_auth_standalone</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga03aaa9093737daae72627dc38198dd1d">tls_auth_standalone_init</a> (struct <a class="el" href="structtls__options.html">tls_options</a> *<a class="el" href="structtls__options.html">tls_options</a>, struct <a class="el" href="structgc__arena.html">gc_arena</a> *gc)</td></tr>
<tr class="separator:ga03aaa9093737daae72627dc38198dd1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga85674d980185b3f2923ae9540114289a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga85674d980185b3f2923ae9540114289a">tls_auth_standalone_finalize</a> (struct <a class="el" href="structtls__auth__standalone.html">tls_auth_standalone</a> *tas, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="separator:ga85674d980185b3f2923ae9540114289a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafe3228d8a3cae5eb8f159e8230f4cd27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#gafe3228d8a3cae5eb8f159e8230f4cd27">tls_multi_init_set_options</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, const char *local, const char *remote)</td></tr>
<tr class="separator:gafe3228d8a3cae5eb8f159e8230f4cd27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f6dae3fb4465d1c697a80fdebd50d67"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga3f6dae3fb4465d1c697a80fdebd50d67">tls_multi_free</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, bool clear)</td></tr>
<tr class="memdesc:ga3f6dae3fb4465d1c697a80fdebd50d67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleanup a <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure and free associated memory allocations.  <a href="group__control__processor.html#ga3f6dae3fb4465d1c697a80fdebd50d67">More...</a><br /></td></tr>
<tr class="separator:ga3f6dae3fb4465d1c697a80fdebd50d67"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Control channel negotiation states</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrp074f583fcd32a701d71d3a0081fec6b1"></a>These states represent the different phases of control channel negotiation between OpenVPN peers.</p>
<p>OpenVPN servers and clients progress through the states in a different order, because of their different roles during exchange of random material. The references to the <code><a class="el" href="structkey__source2.html" title="Container for both halves of random material to be used in key method 2 data channel key generation.">key_source2</a></code> structure in the list below is only valid if key method 2 is being used. See the <a class="el" href="">data channel key generation</a> related page for more information.</p>
<p>Clients follow this order:</p><ol type="1">
<li><code>S_INITIAL</code>, ready to begin three-way handshake and control channel negotiation.</li>
<li><code>S_PRE_START</code>, have started three-way handshake, waiting for acknowledgment from remote.</li>
<li><code>S_START</code>, initial three-way handshake complete.</li>
<li><code>S_SENT_KEY</code>, have sent local part of <code><a class="el" href="structkey__source2.html" title="Container for both halves of random material to be used in key method 2 data channel key generation.">key_source2</a></code> random material.</li>
<li><code>S_GOT_KEY</code>, have received remote part of <code><a class="el" href="structkey__source2.html" title="Container for both halves of random material to be used in key method 2 data channel key generation.">key_source2</a></code> random material.</li>
<li><code>S_ACTIVE</code>, normal operation</li>
</ol>
<p>Servers follow the same order, except for <code>S_SENT_KEY</code> and <code>S_GOT_KEY</code> being reversed, because the server first receives the client's <code><a class="el" href="structkey__source2.html" title="Container for both halves of random material to be used in key method 2 data channel key generation.">key_source2</a></code> random material before generating and sending its own. </p>
</td></tr>
<tr class="memitem:gaf6e8cab5d0642b96ef462156816c3a28"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#gaf6e8cab5d0642b96ef462156816c3a28">S_ERROR</a>&#160;&#160;&#160;-1</td></tr>
<tr class="memdesc:gaf6e8cab5d0642b96ef462156816c3a28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error state.  <a href="group__control__processor.html#gaf6e8cab5d0642b96ef462156816c3a28">More...</a><br /></td></tr>
<tr class="separator:gaf6e8cab5d0642b96ef462156816c3a28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5c620f0ab83a389abc17d80bfb1e0665"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga5c620f0ab83a389abc17d80bfb1e0665">S_UNDEF</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ga5c620f0ab83a389abc17d80bfb1e0665"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undefined state, used after a <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> is cleaned up.  <a href="group__control__processor.html#ga5c620f0ab83a389abc17d80bfb1e0665">More...</a><br /></td></tr>
<tr class="separator:ga5c620f0ab83a389abc17d80bfb1e0665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf80d9f1dca21e561e35220bdeee2fc1e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#gaf80d9f1dca21e561e35220bdeee2fc1e">S_INITIAL</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:gaf80d9f1dca21e561e35220bdeee2fc1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> state after initialization by <code><a class="el" href="group__control__processor.html#gaf97679512a386e6c21d2d73f4ae662f6" title="Initialize a key_state structure.">key_state_init()</a></code> before start of three-way handshake.  <a href="group__control__processor.html#gaf80d9f1dca21e561e35220bdeee2fc1e">More...</a><br /></td></tr>
<tr class="separator:gaf80d9f1dca21e561e35220bdeee2fc1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6be8de96f4d931c3be923f74f8511b02"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga6be8de96f4d931c3be923f74f8511b02">S_PRE_START</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga6be8de96f4d931c3be923f74f8511b02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waiting for the remote OpenVPN peer to acknowledge during the initial three-way handshake.  <a href="group__control__processor.html#ga6be8de96f4d931c3be923f74f8511b02">More...</a><br /></td></tr>
<tr class="separator:ga6be8de96f4d931c3be923f74f8511b02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga66275a3888e8a86da79d69078c27c18d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga66275a3888e8a86da79d69078c27c18d">S_START</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:ga66275a3888e8a86da79d69078c27c18d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Three-way handshake is complete, start of key exchange.  <a href="group__control__processor.html#ga66275a3888e8a86da79d69078c27c18d">More...</a><br /></td></tr>
<tr class="separator:ga66275a3888e8a86da79d69078c27c18d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf3421bc4c6c95c3ed9824fe7c2c20d8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#gadf3421bc4c6c95c3ed9824fe7c2c20d8">S_SENT_KEY</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:gadf3421bc4c6c95c3ed9824fe7c2c20d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local OpenVPN process has sent its part of the key material.  <a href="group__control__processor.html#gadf3421bc4c6c95c3ed9824fe7c2c20d8">More...</a><br /></td></tr>
<tr class="separator:gadf3421bc4c6c95c3ed9824fe7c2c20d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga66bd0f7cdbc8450a4690c519de7d75bc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga66bd0f7cdbc8450a4690c519de7d75bc">S_GOT_KEY</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:ga66bd0f7cdbc8450a4690c519de7d75bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local OpenVPN process has received the remote's part of the key material.  <a href="group__control__processor.html#ga66bd0f7cdbc8450a4690c519de7d75bc">More...</a><br /></td></tr>
<tr class="separator:ga66bd0f7cdbc8450a4690c519de7d75bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0b9dd6c70b47159cdbfbeecb4b971197"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga0b9dd6c70b47159cdbfbeecb4b971197">S_ACTIVE</a>&#160;&#160;&#160;6</td></tr>
<tr class="memdesc:ga0b9dd6c70b47159cdbfbeecb4b971197"><td class="mdescLeft">&#160;</td><td class="mdescRight">Operational <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> state immediately after negotiation has completed while still within the handshake window.  <a href="group__control__processor.html#ga0b9dd6c70b47159cdbfbeecb4b971197">More...</a><br /></td></tr>
<tr class="separator:ga0b9dd6c70b47159cdbfbeecb4b971197"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Index of key_state objects within a tls_session structure</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrp348dc162a1f22f9ec4d9fab524f330d1"></a>This is the index of <code><a class="el" href="structtls__session.html#a1de4672c1233dd4887122a909b10c314">tls_session.key</a></code> </p>
</td></tr>
<tr class="memitem:ga53a47713d8d3afdedf8826560da3e8b1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga53a47713d8d3afdedf8826560da3e8b1">KS_PRIMARY</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ga53a47713d8d3afdedf8826560da3e8b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Primary key state index.  <a href="group__control__processor.html#ga53a47713d8d3afdedf8826560da3e8b1">More...</a><br /></td></tr>
<tr class="separator:ga53a47713d8d3afdedf8826560da3e8b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf097bad90fb34433800b15445db8398"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#gadf097bad90fb34433800b15445db8398">KS_LAME_DUCK</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:gadf097bad90fb34433800b15445db8398"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key state index that will retire soon.  <a href="group__control__processor.html#gadf097bad90fb34433800b15445db8398">More...</a><br /></td></tr>
<tr class="separator:gadf097bad90fb34433800b15445db8398"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga136f3095237ae23358c30581753e4178"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga136f3095237ae23358c30581753e4178">KS_SIZE</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga136f3095237ae23358c30581753e4178"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the <code><a class="el" href="structtls__session.html#a1de4672c1233dd4887122a909b10c314">tls_session.key</a></code> array.  <a href="group__control__processor.html#ga136f3095237ae23358c30581753e4178">More...</a><br /></td></tr>
<tr class="separator:ga136f3095237ae23358c30581753e4178"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Index of tls_session objects within a tls_multi structure</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrp12b5b9f5a31276d4e8a8352c56f23541"></a>This is the index of <code><a class="el" href="structtls__multi.html#a74e065e432f819307a830ef38d5be73c" title="Array of tls_session objects representing control channel sessions with the remote peer.">tls_multi.session</a></code> </p>
<p>Normally three <a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a> objects are maintained by an active openvpn session. The first is the current, TLS authenticated session, the second is used to process connection requests from a new client that would usurp the current session if successfully authenticated, and the third is used as a repository for a "lame-duck" key in the event that the primary session resets due to error while the lame-duck key still has time left before its expiration. Lame duck keys are used to maintain the continuity of the data channel connection while a new key is being negotiated. </p>
</td></tr>
<tr class="memitem:gad3c70b02a0ca4537fba1d53802e1e429"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#gad3c70b02a0ca4537fba1d53802e1e429">TM_ACTIVE</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:gad3c70b02a0ca4537fba1d53802e1e429"><td class="mdescLeft">&#160;</td><td class="mdescRight">Active <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code>.  <a href="group__control__processor.html#gad3c70b02a0ca4537fba1d53802e1e429">More...</a><br /></td></tr>
<tr class="separator:gad3c70b02a0ca4537fba1d53802e1e429"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6575a67494af1ca3e9608941e12a5386"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga6575a67494af1ca3e9608941e12a5386">TM_UNTRUSTED</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ga6575a67494af1ca3e9608941e12a5386"><td class="mdescLeft">&#160;</td><td class="mdescRight">As yet un-trusted <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> being negotiated.  <a href="group__control__processor.html#ga6575a67494af1ca3e9608941e12a5386">More...</a><br /></td></tr>
<tr class="separator:ga6575a67494af1ca3e9608941e12a5386"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89d765b434597e7194131ace44c605af"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#ga89d765b434597e7194131ace44c605af">TM_LAME_DUCK</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga89d765b434597e7194131ace44c605af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Old <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code>.  <a href="group__control__processor.html#ga89d765b434597e7194131ace44c605af">More...</a><br /></td></tr>
<tr class="separator:ga89d765b434597e7194131ace44c605af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa195349d22c113d3acc88b6795e491b8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__control__processor.html#gaa195349d22c113d3acc88b6795e491b8">TM_SIZE</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:gaa195349d22c113d3acc88b6795e491b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the <code><a class="el" href="structtls__multi.html#a74e065e432f819307a830ef38d5be73c" title="Array of tls_session objects representing control channel sessions with the remote peer.">tls_multi.session</a></code> array.  <a href="group__control__processor.html#gaa195349d22c113d3acc88b6795e491b8">More...</a><br /></td></tr>
<tr class="separator:gaa195349d22c113d3acc88b6795e491b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gadf097bad90fb34433800b15445db8398"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadf097bad90fb34433800b15445db8398">&#9670;&nbsp;</a></span>KS_LAME_DUCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KS_LAME_DUCK&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key state index that will retire soon. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00382">382</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="ga53a47713d8d3afdedf8826560da3e8b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga53a47713d8d3afdedf8826560da3e8b1">&#9670;&nbsp;</a></span>KS_PRIMARY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KS_PRIMARY&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Primary key state index. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00381">381</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="ga136f3095237ae23358c30581753e4178"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga136f3095237ae23358c30581753e4178">&#9670;&nbsp;</a></span>KS_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KS_SIZE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of the <code><a class="el" href="structtls__session.html#a1de4672c1233dd4887122a909b10c314">tls_session.key</a></code> array. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00384">384</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="ga0b9dd6c70b47159cdbfbeecb4b971197"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0b9dd6c70b47159cdbfbeecb4b971197">&#9670;&nbsp;</a></span>S_ACTIVE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define S_ACTIVE&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Operational <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> state immediately after negotiation has completed while still within the handshake window. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00092">92</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="gaf6e8cab5d0642b96ef462156816c3a28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf6e8cab5d0642b96ef462156816c3a28">&#9670;&nbsp;</a></span>S_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define S_ERROR&#160;&#160;&#160;-1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error state. </p>
<p><br  />
 </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00076">76</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="ga66bd0f7cdbc8450a4690c519de7d75bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga66bd0f7cdbc8450a4690c519de7d75bc">&#9670;&nbsp;</a></span>S_GOT_KEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define S_GOT_KEY&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Local OpenVPN process has received the remote's part of the key material. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00089">89</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="gaf80d9f1dca21e561e35220bdeee2fc1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf80d9f1dca21e561e35220bdeee2fc1e">&#9670;&nbsp;</a></span>S_INITIAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define S_INITIAL&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initial <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> state after initialization by <code><a class="el" href="group__control__processor.html#gaf97679512a386e6c21d2d73f4ae662f6" title="Initialize a key_state structure.">key_state_init()</a></code> before start of three-way handshake. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00079">79</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="ga6be8de96f4d931c3be923f74f8511b02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6be8de96f4d931c3be923f74f8511b02">&#9670;&nbsp;</a></span>S_PRE_START</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define S_PRE_START&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waiting for the remote OpenVPN peer to acknowledge during the initial three-way handshake. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00082">82</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="gadf3421bc4c6c95c3ed9824fe7c2c20d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadf3421bc4c6c95c3ed9824fe7c2c20d8">&#9670;&nbsp;</a></span>S_SENT_KEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define S_SENT_KEY&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Local OpenVPN process has sent its part of the key material. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00087">87</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="ga66275a3888e8a86da79d69078c27c18d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga66275a3888e8a86da79d69078c27c18d">&#9670;&nbsp;</a></span>S_START</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define S_START&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Three-way handshake is complete, start of key exchange. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00085">85</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="ga5c620f0ab83a389abc17d80bfb1e0665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5c620f0ab83a389abc17d80bfb1e0665">&#9670;&nbsp;</a></span>S_UNDEF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define S_UNDEF&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Undefined state, used after a <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> is cleaned up. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00077">77</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="gad3c70b02a0ca4537fba1d53802e1e429"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad3c70b02a0ca4537fba1d53802e1e429">&#9670;&nbsp;</a></span>TM_ACTIVE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TM_ACTIVE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Active <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code>. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00462">462</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="ga89d765b434597e7194131ace44c605af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89d765b434597e7194131ace44c605af">&#9670;&nbsp;</a></span>TM_LAME_DUCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TM_LAME_DUCK&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Old <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code>. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00465">465</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="gaa195349d22c113d3acc88b6795e491b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa195349d22c113d3acc88b6795e491b8">&#9670;&nbsp;</a></span>TM_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TM_SIZE&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of the <code><a class="el" href="structtls__multi.html#a74e065e432f819307a830ef38d5be73c" title="Array of tls_session objects representing control channel sessions with the remote peer.">tls_multi.session</a></code> array. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00466">466</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<a id="ga6575a67494af1ca3e9608941e12a5386"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6575a67494af1ca3e9608941e12a5386">&#9670;&nbsp;</a></span>TM_UNTRUSTED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TM_UNTRUSTED&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>As yet un-trusted <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> being negotiated. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00463">463</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga1e479e6a3ddb6991825951db9dff9319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e479e6a3ddb6991825951db9dff9319">&#9670;&nbsp;</a></span>key_state_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void key_state_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey__state.html">key_state</a> *&#160;</td>
          <td class="paramname"><em>ks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clear</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cleanup a <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> structure. </p>
<p>This function cleans up a <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> structure. It frees the associated SSL-BIO, and the structures allocated for the <a class="el" href="group__reliable.html">Reliability Layer</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ks</td><td>- A pointer to the <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> structure to be cleaned up. </td></tr>
    <tr><td class="paramname">clear</td><td>- Whether the memory allocated for the <em>ks</em> object should be overwritten with 0s. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl_8c_source.html#l00996">996</a> of file <a class="el" href="ssl_8c_source.html">ssl.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00194">key_state::ack_write_buf</a>, <a class="el" href="buffer_8c_source.html#l01204">buffer_list_free()</a>, <a class="el" href="ssl__common_8h_source.html#l00188">key_state::crypto_options</a>, <a class="el" href="buffer_8c_source.html#l00185">free_buf()</a>, <a class="el" href="crypto_8c_source.html#l00908">free_key_ctx_bi()</a>, <a class="el" href="crypto_8h_source.html#l00234">crypto_options::key_ctx_bi</a>, <a class="el" href="ssl__common_8h_source.html#l00190">key_state::key_src</a>, <a class="el" href="ssl__verify_8h.html#a2410fec00466d19501d3ada2a47fcd6a">key_state_rm_auth_control_file()</a>, <a class="el" href="ssl__openssl_8c_source.html#l02026">key_state_ssl_free()</a>, <a class="el" href="ssl__common_8h_source.html#l00178">key_state::ks_ssl</a>, <a class="el" href="crypto_8h_source.html#l00238">crypto_options::packet_id</a>, <a class="el" href="packet__id_8c_source.html#l00101">packet_id_free()</a>, <a class="el" href="ssl__common_8h_source.html#l00200">key_state::paybuf</a>, <a class="el" href="ssl__common_8h_source.html#l00192">key_state::plaintext_read_buf</a>, <a class="el" href="ssl__common_8h_source.html#l00193">key_state::plaintext_write_buf</a>, <a class="el" href="ssl__common_8h_source.html#l00198">key_state::rec_ack</a>, <a class="el" href="ssl__common_8h_source.html#l00197">key_state::rec_reliable</a>, <a class="el" href="reliable_8c_source.html#l00327">reliable_free()</a>, <a class="el" href="ssl__common_8h_source.html#l00077">S_UNDEF</a>, <a class="el" href="buffer_8h_source.html#l00401">secure_memzero()</a>, <a class="el" href="ssl__common_8h_source.html#l00196">key_state::send_reliable</a>, and <a class="el" href="ssl__common_8h_source.html#l00168">key_state::state</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02129">key_state_soft_reset()</a>, <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>, and <a class="el" href="ssl_8c_source.html#l01151">tls_session_free()</a>.</p>

</div>
</div>
<a id="gaf97679512a386e6c21d2d73f4ae662f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf97679512a386e6c21d2d73f4ae662f6">&#9670;&nbsp;</a></span>key_state_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void key_state_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkey__state.html">key_state</a> *&#160;</td>
          <td class="paramname"><em>ks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize a <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> structure. </p>
<p>This function initializes a <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> structure associated with a <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code>. It sets up the structure's SSL-BIO, sets the object's <code><a class="el" href="structkey__state.html#a42be32cf0cb8d287f43befbbb6715472">key_state.state</a></code> to <code>S_INITIAL</code>, and sets the session ID and key ID two appropriate values based on the <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a>'s</code> internal state. It also initializes a new set of structures for the <a class="el" href="group__reliable.html">Reliability Layer</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>- A pointer to the <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> structure associated with the <em>ks</em> argument. </td></tr>
    <tr><td class="paramname">ks</td><td>- A pointer to the <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> structure to be initialized. This structure should already have been allocated before calling this function. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl_8c_source.html#l00916">916</a> of file <a class="el" href="ssl_8c_source.html">ssl.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00194">key_state::ack_write_buf</a>, <a class="el" href="buffer_8c_source.html#l00064">alloc_buf()</a>, <a class="el" href="buffer_8h_source.html#l01059">ALLOC_OBJ_CLEAR</a>, <a class="el" href="mtu_8h_source.html#l00194">BUF_SIZE</a>, <a class="el" href="openvpn_2basic_8h_source.html#l00033">CLEAR</a>, <a class="el" href="ssl__common_8h_source.html#l00188">key_state::crypto_options</a>, <a class="el" href="mtu_8h_source.html#l00187">FRAME_HEADROOM</a>, <a class="el" href="ssl__common_8h_source.html#l00184">key_state::initial_opcode</a>, <a class="el" href="ssl__common_8h_source.html#l00176">key_state::key_id</a>, <a class="el" href="ssl__common_8h_source.html#l00190">key_state::key_src</a>, <a class="el" href="ssl__openssl_8c_source.html#l01986">key_state_ssl_init()</a>, <a class="el" href="ssl__common_8h_source.html#l00178">key_state::ks_ssl</a>, <a class="el" href="ssl_8h_source.html#l00056">P_CONTROL_SOFT_RESET_V1</a>, <a class="el" href="ssl_8h_source.html#l00050">P_KEY_ID_MASK</a>, <a class="el" href="crypto_8h_source.html#l00238">crypto_options::packet_id</a>, <a class="el" href="packet__id_8c_source.html#l00078">packet_id_init()</a>, <a class="el" href="crypto_8h_source.html#l00240">crypto_options::pid_persist</a>, <a class="el" href="ssl__common_8h_source.html#l00192">key_state::plaintext_read_buf</a>, <a class="el" href="ssl__common_8h_source.html#l00193">key_state::plaintext_write_buf</a>, <a class="el" href="ssl__common_8h_source.html#l00198">key_state::rec_ack</a>, <a class="el" href="ssl__common_8h_source.html#l00197">key_state::rec_reliable</a>, <a class="el" href="reliable_8c_source.html#l00309">reliable_init()</a>, <a class="el" href="reliable_8h_source.html#l00460">reliable_set_timeout()</a>, <a class="el" href="ssl__common_8h_source.html#l00079">S_INITIAL</a>, <a class="el" href="ssl__common_8h_source.html#l00196">key_state::send_reliable</a>, <a class="el" href="ssl__common_8h_source.html#l00168">key_state::state</a>, <a class="el" href="common_8h_source.html#l00078">TLS_CHANNEL_BUF_SIZE</a>, <a class="el" href="ssl_8h_source.html#l00085">TLS_RELIABLE_N_REC_BUFFERS</a>, <a class="el" href="ssl_8h_source.html#l00084">TLS_RELIABLE_N_SEND_BUFFERS</a>, and <a class="el" href="otime_8h_source.html#l00094">update_time()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02129">key_state_soft_reset()</a>, and <a class="el" href="ssl_8c_source.html#l01088">tls_session_init()</a>.</p>

</div>
</div>
<a id="ga85674d980185b3f2923ae9540114289a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga85674d980185b3f2923ae9540114289a">&#9670;&nbsp;</a></span>tls_auth_standalone_finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_auth_standalone_finalize </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__auth__standalone.html">tls_auth_standalone</a> *&#160;</td>
          <td class="paramname"><em>tas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structframe.html">frame</a> *&#160;</td>
          <td class="paramname"><em>frame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl_8c_source.html#l01323">1323</a> of file <a class="el" href="ssl_8c_source.html">ssl.c</a>.</p>

<p class="reference">References <a class="el" href="ssl_8h_source.html#l00139">tls_auth_standalone::frame</a>, and <a class="el" href="ssl_8c_source.html#l00315">tls_init_control_channel_frame_parameters()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l03051">do_init_finalize_tls_frame()</a>.</p>

</div>
</div>
<a id="ga03aaa9093737daae72627dc38198dd1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga03aaa9093737daae72627dc38198dd1d">&#9670;&nbsp;</a></span>tls_auth_standalone_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structtls__auth__standalone.html">tls_auth_standalone</a>* tls_auth_standalone_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__options.html">tls_options</a> *&#160;</td>
          <td class="paramname"><em>tls_options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgc__arena.html">gc_arena</a> *&#160;</td>
          <td class="paramname"><em>gc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl_8c_source.html#l01300">1300</a> of file <a class="el" href="ssl_8c_source.html">ssl.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l01096">ALLOC_OBJ_CLEAR_GC</a>, <a class="el" href="crypto_8h_source.html#l00248">CO_IGNORE_PACKET_ID</a>, <a class="el" href="crypto_8h_source.html#l00257">crypto_options::flags</a>, <a class="el" href="ssl__common_8h_source.html#l00312">tls_options::frame</a>, <a class="el" href="ssl_8h_source.html#l00139">tls_auth_standalone::frame</a>, <a class="el" href="ssl__common_8h_source.html#l00230">tls_wrap_ctx::opt</a>, <a class="el" href="ssl__common_8h_source.html#l00310">tls_options::tls_wrap</a>, and <a class="el" href="ssl_8h_source.html#l00138">tls_auth_standalone::tls_wrap</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02814">do_init_crypto_tls()</a>.</p>

</div>
</div>
<a id="ga3f6dae3fb4465d1c697a80fdebd50d67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3f6dae3fb4465d1c697a80fdebd50d67">&#9670;&nbsp;</a></span>tls_multi_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_multi_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clear</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cleanup a <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure and free associated memory allocations. </p>
<p>This function cleans up a <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure. This includes cleaning up all associated <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> structures.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">multi</td><td>- The <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure to clean up in free. </td></tr>
    <tr><td class="paramname">clear</td><td>- Whether the memory allocated for the <em>multi</em> object should be overwritten with 0s. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl_8c_source.html#l01348">1348</a> of file <a class="el" href="ssl_8c_source.html">ssl.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="ssl__verify_8c_source.html#l00817">auth_set_client_reason()</a>, <a class="el" href="ssl__verify_8c_source.html#l00236">cert_hash_free()</a>, <a class="el" href="ssl__common_8h_source.html#l00550">tls_multi::locked_cert_hash_set</a>, <a class="el" href="ssl__common_8h_source.html#l00548">tls_multi::locked_cn</a>, <a class="el" href="ssl__common_8h_source.html#l00549">tls_multi::locked_username</a>, <a class="el" href="ssl__common_8h_source.html#l00566">tls_multi::peer_info</a>, <a class="el" href="ssl__common_8h_source.html#l00592">tls_multi::remote_ciphername</a>, <a class="el" href="buffer_8h_source.html#l00401">secure_memzero()</a>, <a class="el" href="ssl__common_8h_source.html#l00597">tls_multi::session</a>, <a class="el" href="ssl_8c_source.html#l01151">tls_session_free()</a>, <a class="el" href="ssl__common_8h_source.html#l00466">TM_SIZE</a>, and <a class="el" href="auth__token_8c_source.html#l00395">wipe_auth_token()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l03593">do_close_tls()</a>.</p>

</div>
</div>
<a id="gaf7223d904613a08407ae52dc3831d7a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf7223d904613a08407ae52dc3831d7a2">&#9670;&nbsp;</a></span>tls_multi_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structtls__multi.html">tls_multi</a>* tls_multi_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__options.html">tls_options</a> *&#160;</td>
          <td class="paramname"><em>tls_options</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate and initialize a <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure. </p>
<p>This function allocates a new <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure, and performs some amount of initialization. Afterwards, the <code><a class="el" href="group__control__processor.html#gada87c9f2a7755ab7507dd16fa6e22716" title="Finalize initialization of a tls_multi structure.">tls_multi_init_finalize()</a></code> function must be called to finalize the structure's initialization process.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"><a class="el" href="structtls__options.html">tls_options</a></td><td>- The configuration options to be used for this VPN tunnel.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A newly allocated and initialized <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ssl_8c_source.html#l01259">1259</a> of file <a class="el" href="ssl_8c_source.html">ssl.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l01059">ALLOC_OBJ_CLEAR</a>, <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="ssl__common_8h_source.html#l00442">tls_session::key</a>, <a class="el" href="ssl__common_8h_source.html#l00518">tls_multi::key_scan</a>, <a class="el" href="ssl__common_8h_source.html#l00382">KS_LAME_DUCK</a>, <a class="el" href="ssl__common_8h_source.html#l00381">KS_PRIMARY</a>, <a class="el" href="ssl__common_8h_source.html#l00516">tls_multi::opt</a>, <a class="el" href="ssl__common_8h_source.html#l00597">tls_multi::session</a>, <a class="el" href="openvpn_2basic_8h_source.html#l00030">SIZE</a>, <a class="el" href="ssl__common_8h_source.html#l00462">TM_ACTIVE</a>, <a class="el" href="ssl__common_8h_source.html#l00465">TM_LAME_DUCK</a>, and <a class="el" href="ssl__common_8h_source.html#l00590">tls_multi::use_peer_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02814">do_init_crypto_tls()</a>.</p>

</div>
</div>
<a id="gada87c9f2a7755ab7507dd16fa6e22716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada87c9f2a7755ab7507dd16fa6e22716">&#9670;&nbsp;</a></span>tls_multi_init_finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_multi_init_finalize </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structframe.html">frame</a> *&#160;</td>
          <td class="paramname"><em>frame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalize initialization of a <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure. </p>
<p>This function initializes the <code>TM_ACTIVE</code> <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code>, and in server mode also the <code>TM_UNTRUSTED</code> <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code>, associated with this <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure. It also configures the control channel's <code>frame</code> structure based on the data channel's <code>frame</code> given in argument <em>frame</em>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">multi</td><td>- The <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure of which to finalize initialization. </td></tr>
    <tr><td class="paramname">frame</td><td>- The data channel's <code>frame</code> structure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl_8c_source.html#l01281">1281</a> of file <a class="el" href="ssl_8c_source.html">ssl.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00312">tls_options::frame</a>, <a class="el" href="ssl__common_8h_source.html#l00516">tls_multi::opt</a>, <a class="el" href="ssl__common_8h_source.html#l00597">tls_multi::session</a>, <a class="el" href="ssl__common_8h_source.html#l00265">tls_options::single_session</a>, <a class="el" href="ssl_8c_source.html#l00315">tls_init_control_channel_frame_parameters()</a>, <a class="el" href="ssl_8c_source.html#l01088">tls_session_init()</a>, <a class="el" href="ssl__common_8h_source.html#l00462">TM_ACTIVE</a>, and <a class="el" href="ssl__common_8h_source.html#l00463">TM_UNTRUSTED</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l03051">do_init_finalize_tls_frame()</a>.</p>

</div>
</div>
<a id="gafe3228d8a3cae5eb8f159e8230f4cd27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafe3228d8a3cae5eb8f159e8230f4cd27">&#9670;&nbsp;</a></span>tls_multi_init_set_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_multi_init_set_options </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>remote</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl_8c_source.html#l01335">1335</a> of file <a class="el" href="ssl_8c_source.html">ssl.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00260">tls_options::local_options</a>, <a class="el" href="ssl__common_8h_source.html#l00516">tls_multi::opt</a>, and <a class="el" href="ssl__common_8h_source.html#l00261">tls_options::remote_options</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l03499">do_compute_occ_strings()</a>.</p>

</div>
</div>
<a id="ga22cb46e1959bff9bb56c726f19e35581"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga22cb46e1959bff9bb56c726f19e35581">&#9670;&nbsp;</a></span>tls_session_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tls_session_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>clear</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clean up a <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> structure. </p>
<p>This function cleans up a <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> structure. This includes cleaning up all associated <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> structures.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>- A pointer to the <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> structure to be cleaned up. </td></tr>
    <tr><td class="paramname">clear</td><td>- Whether the memory allocated for the <em>session</em> object should be overwritten with 0s. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl_8c_source.html#l01151">1151</a> of file <a class="el" href="ssl_8c_source.html">ssl.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__verify_8c_source.html#l00236">cert_hash_free()</a>, <a class="el" href="keyingmaterialexporter_8c_source.html#l00058">session::key</a>, <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="ssl__common_8h_source.html#l00384">KS_SIZE</a>, <a class="el" href="buffer_8h_source.html#l00401">secure_memzero()</a>, and <a class="el" href="ssl_8h_source.html#l00519">tls_wrap_free()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l01179">move_session()</a>, <a class="el" href="ssl_8c_source.html#l01204">reset_session()</a>, <a class="el" href="ssl_8c_source.html#l01348">tls_multi_free()</a>, and <a class="el" href="ssl_8c_source.html#l03021">tls_multi_process()</a>.</p>

</div>
</div>
<a id="ga93bffc74e6ed2eaeed528f8e981afac8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga93bffc74e6ed2eaeed528f8e981afac8">&#9670;&nbsp;</a></span>tls_session_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tls_session_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize a <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> structure. </p>
<p>This function initializes a <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> structure. This includes generating a random session ID, and initializing the <code>KS_PRIMARY</code> <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> in the <code><a class="el" href="structtls__session.html#a1de4672c1233dd4887122a909b10c314">tls_session.key</a></code> array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">multi</td><td>- A pointer to the <code><a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a></code> structure associated with the <em>session</em> argument. </td></tr>
    <tr><td class="paramname">session</td><td>- A pointer to the <code><a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a></code> structure to be initialized. This structure should already have been allocated before calling this function. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl_8c_source.html#l01088">1088</a> of file <a class="el" href="ssl_8c_source.html">ssl.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00064">alloc_buf()</a>, <a class="el" href="mtu_8h_source.html#l00194">BUF_SIZE</a>, <a class="el" href="openvpn_2basic_8h_source.html#l00033">CLEAR</a>, <a class="el" href="errlevel_8h_source.html#l00163">D_TLS_DEBUG</a>, <a class="el" href="openvpn_2error_8h_source.html#l00171">dmsg</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="keyingmaterialexporter_8c_source.html#l00058">session::key</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, <a class="el" href="ssl__common_8h_source.html#l00381">KS_PRIMARY</a>, <a class="el" href="ssl__common_8h_source.html#l00516">tls_multi::opt</a>, <a class="el" href="ssl_8h_source.html#l00063">P_CONTROL_HARD_RESET_CLIENT_V2</a>, <a class="el" href="ssl_8h_source.html#l00067">P_CONTROL_HARD_RESET_CLIENT_V3</a>, <a class="el" href="ssl_8h_source.html#l00064">P_CONTROL_HARD_RESET_SERVER_V2</a>, <a class="el" href="packet__id_8c_source.html#l00078">packet_id_init()</a>, <a class="el" href="packet__id_8c_source.html#l00524">packet_id_persist_load_obj()</a>, <a class="el" href="session__id_8h_source.html#l00055">session_id_defined()</a>, <a class="el" href="session__id_8c_source.html#l00057">session_id_print()</a>, and <a class="el" href="session__id_8c_source.html#l00051">session_id_random()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l01179">move_session()</a>, <a class="el" href="ssl_8c_source.html#l01204">reset_session()</a>, and <a class="el" href="ssl_8c_source.html#l01281">tls_multi_init_finalize()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
