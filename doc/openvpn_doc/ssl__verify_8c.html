<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: src/openvpn/ssl_verify.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_92f13d409beef24f5ba1b81abfed1f1c.html">openvpn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ssl_verify.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="syshead_8h_source.html">syshead.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="base64_8h_source.html">base64.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="manage_8h_source.html">manage.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="otime_8h_source.html">otime.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="run__command_8h_source.html">run_command.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ssl__verify_8h_source.html">ssl_verify.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ssl__verify__backend_8h_source.html">ssl_verify_backend.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ssl__verify__openssl_8h_source.html">ssl_verify_openssl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="auth__token_8h_source.html">auth_token.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="push_8h_source.html">push.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ssl_verify.c:</div>
<div class="dyncontent">
<div class="center"><img src="ssl__verify_8c__incl.png" border="0" usemap="#src_2openvpn_2ssl__verify_8c" alt=""/></div>
<map name="src_2openvpn_2ssl__verify_8c" id="src_2openvpn_2ssl__verify_8c">
<area shape="rect" title=" " alt="" coords="2143,5,2305,32"/>
<area shape="rect" href="syshead_8h.html" title=" " alt="" coords="580,155,663,181"/>
<area shape="rect" href="base64_8h.html" title=" " alt="" coords="1265,80,1340,107"/>
<area shape="rect" href="manage_8h.html" title=" " alt="" coords="2105,155,2183,181"/>
<area shape="rect" href="otime_8h.html" title=" " alt="" coords="1325,453,1390,480"/>
<area shape="rect" href="run__command_8h.html" title=" " alt="" coords="2500,379,2615,405"/>
<area shape="rect" href="ssl__verify_8h.html" title=" " alt="" coords="2033,80,2121,107"/>
<area shape="rect" href="ssl__verify__openssl_8h.html" title=" " alt="" coords="2208,155,2349,181"/>
<area shape="rect" href="ssl__verify__backend_8h.html" title=" " alt="" coords="2374,155,2519,181"/>
<area shape="rect" href="auth__token_8h.html" title=" " alt="" coords="2595,80,2693,107"/>
<area shape="rect" href="push_8h.html" title=" " alt="" coords="2717,80,2779,107"/>
<area shape="rect" href="compat_8h.html" title=" " alt="" coords="45,229,121,256"/>
<area shape="rect" title=" " alt="" coords="641,752,716,779"/>
<area shape="rect" title=" " alt="" coords="145,229,229,256"/>
<area shape="rect" title=" " alt="" coords="253,229,341,256"/>
<area shape="rect" title=" " alt="" coords="366,229,445,256"/>
<area shape="rect" title=" " alt="" coords="469,229,555,256"/>
<area shape="rect" title=" " alt="" coords="580,229,663,256"/>
<area shape="rect" title=" " alt="" coords="687,229,764,256"/>
<area shape="rect" title=" " alt="" coords="788,229,863,256"/>
<area shape="rect" title=" " alt="" coords="887,229,964,256"/>
<area shape="rect" title=" " alt="" coords="988,229,1073,256"/>
<area shape="rect" href="misc_8h.html" title=" " alt="" coords="2113,379,2175,405"/>
<area shape="rect" href="event_8h.html" title=" " alt="" coords="1946,304,2011,331"/>
<area shape="rect" href="socket_8h.html" title=" " alt="" coords="1708,229,1780,256"/>
<area shape="rect" href="mroute_8h.html" title=" " alt="" coords="2282,229,2355,256"/>
<area shape="rect" href="argv_8h.html" title=" " alt="" coords="1959,528,2017,555"/>
<area shape="rect" href="buffer_8h.html" title=" " alt="" coords="1765,603,1830,629"/>
<area shape="rect" href="openvpn_2basic_8h.html" title=" " alt="" coords="2152,752,2216,779"/>
<area shape="rect" href="common_8h.html" title=" " alt="" coords="1561,528,1644,555"/>
<area shape="rect" href="env__set_8h.html" title=" " alt="" coords="2143,453,2222,480"/>
<area shape="rect" href="integer_8h.html" title=" " alt="" coords="1313,528,1385,555"/>
<area shape="rect" href="platform_8h.html" title=" " alt="" coords="2092,528,2172,555"/>
<area shape="rect" href="openvpn_2error_8h.html" title=" " alt="" coords="1197,677,1256,704"/>
<area shape="rect" href="win32_8h.html" title=" " alt="" coords="1900,453,1967,480"/>
<area shape="rect" href="sig_8h.html" title=" " alt="" coords="1908,379,1959,405"/>
<area shape="rect" href="perf_8h.html" title=" " alt="" coords="1983,379,2038,405"/>
<area shape="rect" href="mtu_8h.html" title=" " alt="" coords="1770,528,1825,555"/>
<area shape="rect" href="proto_8h.html" title=" " alt="" coords="1466,453,1529,480"/>
<area shape="rect" href="proxy_8h.html" title=" " alt="" coords="1857,304,1921,331"/>
<area shape="rect" href="socks_8h.html" title=" " alt="" coords="1605,453,1673,480"/>
<area shape="rect" href="list_8h.html" title=" " alt="" coords="2348,528,2399,555"/>
<area shape="rect" href="route_8h.html" title=" " alt="" coords="2450,304,2513,331"/>
<area shape="rect" title=" " alt="" coords="2255,304,2324,331"/>
<area shape="rect" href="ssl__common_8h.html" title=" " alt="" coords="1232,155,1339,181"/>
<area shape="rect" href="session__id_8h.html" title=" " alt="" coords="1143,528,1238,555"/>
<area shape="rect" href="packet__id_8h.html" title=" " alt="" coords="1199,379,1289,405"/>
<area shape="rect" href="crypto_8h.html" title=" " alt="" coords="1251,304,1320,331"/>
<area shape="rect" title=" " alt="" coords="2379,229,2490,256"/>
<area shape="rect" href="forward_8h.html" title=" " alt="" coords="2710,155,2786,181"/>
</map>
</div>
</div>
<p><a href="ssl__verify_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa3c76f18cb94ad4db806e6590c4a1986"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#aa3c76f18cb94ad4db806e6590c4a1986">TLS_USERNAME_LEN</a>&#160;&#160;&#160;64</td></tr>
<tr class="memdesc:aa3c76f18cb94ad4db806e6590c4a1986"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length of common name.  <a href="ssl__verify_8c.html#aa3c76f18cb94ad4db806e6590c4a1986">More...</a><br /></td></tr>
<tr class="separator:aa3c76f18cb94ad4db806e6590c4a1986"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad5f82b5103ca6b176eef6d78ae1ea3f8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#ad5f82b5103ca6b176eef6d78ae1ea3f8">string_mod_remap_name</a> (char *str)</td></tr>
<tr class="separator:ad5f82b5103ca6b176eef6d78ae1ea3f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba2e5249b11caedf3edbcfc1a70e23b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#adba2e5249b11caedf3edbcfc1a70e23b">setenv_untrusted</a> (struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>)</td></tr>
<tr class="separator:adba2e5249b11caedf3edbcfc1a70e23b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c0047d81eec2d7c39339ccd9d78ca34"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a4c0047d81eec2d7c39339ccd9d78ca34">tls_deauthenticate</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi)</td></tr>
<tr class="separator:a4c0047d81eec2d7c39339ccd9d78ca34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af141763456956a63d18f26c7897d5746"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#af141763456956a63d18f26c7897d5746">set_common_name</a> (struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>, const char *common_name)</td></tr>
<tr class="separator:af141763456956a63d18f26c7897d5746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3b8a3f413dbfc086e05cc5b09efb998"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#af3b8a3f413dbfc086e05cc5b09efb998">tls_common_name</a> (const struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, const bool null)</td></tr>
<tr class="memdesc:af3b8a3f413dbfc086e05cc5b09efb998"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the common name field for the given tunnel.  <a href="ssl__verify_8c.html#af3b8a3f413dbfc086e05cc5b09efb998">More...</a><br /></td></tr>
<tr class="separator:af3b8a3f413dbfc086e05cc5b09efb998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85e2a6ef69ed420aae1fba8369408071"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a85e2a6ef69ed420aae1fba8369408071">tls_lock_common_name</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi)</td></tr>
<tr class="memdesc:a85e2a6ef69ed420aae1fba8369408071"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locks the common name field for the given tunnel.  <a href="ssl__verify_8c.html#a85e2a6ef69ed420aae1fba8369408071">More...</a><br /></td></tr>
<tr class="separator:a85e2a6ef69ed420aae1fba8369408071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a7dd88a71d94eeb9c2fe155ea934245"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a9a7dd88a71d94eeb9c2fe155ea934245">tls_lock_username</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, const char *username)</td></tr>
<tr class="separator:a9a7dd88a71d94eeb9c2fe155ea934245"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add880839dd1306f5e17f2e7baabc92d9"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#add880839dd1306f5e17f2e7baabc92d9">tls_username</a> (const struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, const bool null)</td></tr>
<tr class="memdesc:add880839dd1306f5e17f2e7baabc92d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the username field for the given tunnel.  <a href="ssl__verify_8c.html#add880839dd1306f5e17f2e7baabc92d9">More...</a><br /></td></tr>
<tr class="separator:add880839dd1306f5e17f2e7baabc92d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb1a815a125d75d306ec1a9896e156a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#adb1a815a125d75d306ec1a9896e156a3">cert_hash_remember</a> (struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>, const int error_depth, const struct <a class="el" href="structbuffer.html">buffer</a> *<a class="el" href="structcert__hash.html">cert_hash</a>)</td></tr>
<tr class="separator:adb1a815a125d75d306ec1a9896e156a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af83ef415aa36cda688d9d969f68085fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#af83ef415aa36cda688d9d969f68085fd">cert_hash_free</a> (struct <a class="el" href="structcert__hash__set.html">cert_hash_set</a> *chs)</td></tr>
<tr class="memdesc:af83ef415aa36cda688d9d969f68085fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees the given set of certificate hashes.  <a href="ssl__verify_8c.html#af83ef415aa36cda688d9d969f68085fd">More...</a><br /></td></tr>
<tr class="separator:af83ef415aa36cda688d9d969f68085fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b28e512b6ddffa5538605a3122f521"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a55b28e512b6ddffa5538605a3122f521">cert_hash_compare</a> (const struct <a class="el" href="structcert__hash__set.html">cert_hash_set</a> *chs1, const struct <a class="el" href="structcert__hash__set.html">cert_hash_set</a> *chs2)</td></tr>
<tr class="memdesc:a55b28e512b6ddffa5538605a3122f521"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares certificates hashes, returns true if hashes are equal.  <a href="ssl__verify_8c.html#a55b28e512b6ddffa5538605a3122f521">More...</a><br /></td></tr>
<tr class="separator:a55b28e512b6ddffa5538605a3122f521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a505a56df4a2c66759d42745e4ffbd85f"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structcert__hash__set.html">cert_hash_set</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a505a56df4a2c66759d42745e4ffbd85f">cert_hash_copy</a> (const struct <a class="el" href="structcert__hash__set.html">cert_hash_set</a> *chs)</td></tr>
<tr class="separator:a505a56df4a2c66759d42745e4ffbd85f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fc8473f2a78fad6655bbe55b8f32aa5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a6fc8473f2a78fad6655bbe55b8f32aa5">tls_lock_cert_hash_set</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi)</td></tr>
<tr class="memdesc:a6fc8473f2a78fad6655bbe55b8f32aa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Locks the certificate hash set used in the given tunnel.  <a href="ssl__verify_8c.html#a6fc8473f2a78fad6655bbe55b8f32aa5">More...</a><br /></td></tr>
<tr class="separator:a6fc8473f2a78fad6655bbe55b8f32aa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf3ddf703a0408ef63c324443acff732"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#aaf3ddf703a0408ef63c324443acff732">print_nsCertType</a> (int type)</td></tr>
<tr class="separator:aaf3ddf703a0408ef63c324443acff732"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84f183d3f42b41f6e8691a5d9e18a0f4"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="ssl__verify__backend_8h.html#ad75d91d2a2ad02fb4a39a5fc8c4d4ec3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a84f183d3f42b41f6e8691a5d9e18a0f4">verify_peer_cert</a> (const struct <a class="el" href="structtls__options.html">tls_options</a> *opt, <a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *peer_cert, const char *subject, const char *common_name)</td></tr>
<tr class="separator:a84f183d3f42b41f6e8691a5d9e18a0f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f359d02c2643457c46b0f59763336fe"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a9f359d02c2643457c46b0f59763336fe">verify_cert_set_env</a> (struct <a class="el" href="structenv__set.html">env_set</a> *es, <a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *peer_cert, int cert_depth, const char *subject, const char *common_name, const struct <a class="el" href="structx509__track.html">x509_track</a> *<a class="el" href="structx509__track.html">x509_track</a>)</td></tr>
<tr class="separator:a9f359d02c2643457c46b0f59763336fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa175c3436aa21a0dd2ca6bb530b9cac1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="ssl__verify__backend_8h.html#ad75d91d2a2ad02fb4a39a5fc8c4d4ec3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#aa175c3436aa21a0dd2ca6bb530b9cac1">verify_cert_call_plugin</a> (const struct <a class="el" href="structplugin__list.html">plugin_list</a> *plugins, struct <a class="el" href="structenv__set.html">env_set</a> *es, int cert_depth, <a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *cert, char *subject)</td></tr>
<tr class="separator:aa175c3436aa21a0dd2ca6bb530b9cac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa731ba21c375c741e01cafeca6aa8ed"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#aaa731ba21c375c741e01cafeca6aa8ed">verify_cert_export_cert</a> (<a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *peercert, const char *tmp_dir, struct <a class="el" href="structgc__arena.html">gc_arena</a> *gc)</td></tr>
<tr class="separator:aaa731ba21c375c741e01cafeca6aa8ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b4b170c8a6d323a4189836d67a51075"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="ssl__verify__backend_8h.html#ad75d91d2a2ad02fb4a39a5fc8c4d4ec3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a6b4b170c8a6d323a4189836d67a51075">verify_cert_call_command</a> (const char *verify_command, struct <a class="el" href="structenv__set.html">env_set</a> *es, int cert_depth, <a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *cert, char *subject, const char *verify_export_cert)</td></tr>
<tr class="separator:a6b4b170c8a6d323a4189836d67a51075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31084a9a8352acb7b56989063dff7628"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="ssl__verify__backend_8h.html#ad75d91d2a2ad02fb4a39a5fc8c4d4ec3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a31084a9a8352acb7b56989063dff7628">verify_check_crl_dir</a> (const char *crl_dir, <a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *cert, const char *subject, int cert_depth)</td></tr>
<tr class="separator:a31084a9a8352acb7b56989063dff7628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8574f9402b712d3051d9febde91cf220"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ssl__verify__backend_8h.html#ad75d91d2a2ad02fb4a39a5fc8c4d4ec3">result_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a8574f9402b712d3051d9febde91cf220">verify_cert</a> (struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>, <a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *cert, int cert_depth)</td></tr>
<tr class="separator:a8574f9402b712d3051d9febde91cf220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0381474c42881a8c06fbf172442cad3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#aa0381474c42881a8c06fbf172442cad3">auth_set_client_reason</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, const char *client_reason)</td></tr>
<tr class="memdesc:aa0381474c42881a8c06fbf172442cad3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the reason why authentication of a client failed.  <a href="ssl__verify_8c.html#aa0381474c42881a8c06fbf172442cad3">More...</a><br /></td></tr>
<tr class="separator:aa0381474c42881a8c06fbf172442cad3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7aea148e078833f0cda3c5e7af7a0a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#ae7aea148e078833f0cda3c5e7af7a0a6">ssl_session_fully_authenticated</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>)</td></tr>
<tr class="separator:ae7aea148e078833f0cda3c5e7af7a0a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6de478954452cfd54e8352f57638772"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#ac6de478954452cfd54e8352f57638772">tls_authentication_status</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, const int latency)</td></tr>
<tr class="separator:ac6de478954452cfd54e8352f57638772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af19cd77fa1e9449e092e2be555ceef32"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#af19cd77fa1e9449e092e2be555ceef32">verify_user_pass_script</a> (struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>, struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, const struct <a class="el" href="structuser__pass.html">user_pass</a> *up)</td></tr>
<tr class="separator:af19cd77fa1e9449e092e2be555ceef32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a869c58e582efe53b8ba10a2c9d3021"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a9a869c58e582efe53b8ba10a2c9d3021">verify_user_pass_plugin</a> (struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>, struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, const struct <a class="el" href="structuser__pass.html">user_pass</a> *up)</td></tr>
<tr class="separator:a9a869c58e582efe53b8ba10a2c9d3021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc7cf94216d895753fce8988673be7da"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#afc7cf94216d895753fce8988673be7da">set_verify_user_pass_env</a> (struct <a class="el" href="structuser__pass.html">user_pass</a> *up, struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>)</td></tr>
<tr class="separator:afc7cf94216d895753fce8988673be7da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad04670ce0b3419d381ce4348a68e45d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#aad04670ce0b3419d381ce4348a68e45d">verify_user_pass</a> (struct <a class="el" href="structuser__pass.html">user_pass</a> *up, struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>)</td></tr>
<tr class="memdesc:aad04670ce0b3419d381ce4348a68e45d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify the given username and password, using either an external script, a plugin, or the management interface.  <a href="ssl__verify_8c.html#aad04670ce0b3419d381ce4348a68e45d">More...</a><br /></td></tr>
<tr class="separator:aad04670ce0b3419d381ce4348a68e45d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923edfe06fe9d56f1b92fea3ddfecbcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a923edfe06fe9d56f1b92fea3ddfecbcf">verify_final_auth_checks</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, struct <a class="el" href="structtls__session.html">tls_session</a> *<a class="el" href="structsession.html">session</a>)</td></tr>
<tr class="memdesc:a923edfe06fe9d56f1b92fea3ddfecbcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform final authentication checks, including locking of the cn, the allowed certificate hashes, and whether a client config entry exists in the client config directory.  <a href="ssl__verify_8c.html#a923edfe06fe9d56f1b92fea3ddfecbcf">More...</a><br /></td></tr>
<tr class="separator:a923edfe06fe9d56f1b92fea3ddfecbcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a562d8b5b597a5474e839c3f0e31777cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__verify_8c.html#a562d8b5b597a5474e839c3f0e31777cd">tls_x509_clear_env</a> (struct <a class="el" href="structenv__set.html">env_set</a> *es)</td></tr>
<tr class="memdesc:a562d8b5b597a5474e839c3f0e31777cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove any X509_ env variables from <a class="el" href="structenv__set.html">env_set</a> es.  <a href="ssl__verify_8c.html#a562d8b5b597a5474e839c3f0e31777cd">More...</a><br /></td></tr>
<tr class="separator:a562d8b5b597a5474e839c3f0e31777cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa3c76f18cb94ad4db806e6590c4a1986"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3c76f18cb94ad4db806e6590c4a1986">&#9670;&nbsp;</a></span>TLS_USERNAME_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_USERNAME_LEN&#160;&#160;&#160;64</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum length of common name. </p>

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00051">51</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa0381474c42881a8c06fbf172442cad3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0381474c42881a8c06fbf172442cad3">&#9670;&nbsp;</a></span>auth_set_client_reason()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void auth_set_client_reason </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>client_reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the reason why authentication of a client failed. </p>
<p>This be will send to the client when the AUTH_FAILED message is sent An example would be "SESSION: Token expired" </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">multi</td><td>The multi tls struct </td></tr>
    <tr><td class="paramname">client_reason</td><td>The string to send to the client as part of AUTH_FAILED </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00817">817</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="multi_8c_source.html#l01803">multi_client_set_protocol_options()</a>, <a class="el" href="ssl_8c_source.html#l01348">tls_multi_free()</a>, and <a class="el" href="auth__token_8c_source.html#l00302">verify_auth_token()</a>.</p>

</div>
</div>
<a id="a55b28e512b6ddffa5538605a3122f521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55b28e512b6ddffa5538605a3122f521">&#9670;&nbsp;</a></span>cert_hash_compare()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool cert_hash_compare </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structcert__hash__set.html">cert_hash_set</a> *&#160;</td>
          <td class="paramname"><em>chs1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structcert__hash__set.html">cert_hash_set</a> *&#160;</td>
          <td class="paramname"><em>chs2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compares certificates hashes, returns true if hashes are equal. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chs1</td><td>cert 1 hash set </td></tr>
    <tr><td class="paramname">chs2</td><td>cert 2 hash set </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00250">250</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__verify_8h_source.html#l00060">cert_hash_set::ch</a>, <a class="el" href="ssl__verify_8h_source.html#l00051">MAX_CERT_DEPTH</a>, and <a class="el" href="ssl__verify_8h_source.html#l00055">cert_hash::sha256_hash</a>.</p>

<p class="reference">Referenced by <a class="el" href="multi_8c_source.html#l03046">multi_process_float()</a>, and <a class="el" href="ssl__verify_8c_source.html#l01453">verify_final_auth_checks()</a>.</p>

</div>
</div>
<a id="a505a56df4a2c66759d42745e4ffbd85f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a505a56df4a2c66759d42745e4ffbd85f">&#9670;&nbsp;</a></span>cert_hash_copy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structcert__hash__set.html">cert_hash_set</a>* cert_hash_copy </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structcert__hash__set.html">cert_hash_set</a> *&#160;</td>
          <td class="paramname"><em>chs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00287">287</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l01054">ALLOC_OBJ</a>, <a class="el" href="buffer_8h_source.html#l01059">ALLOC_OBJ_CLEAR</a>, <a class="el" href="ssl__verify_8h_source.html#l00060">cert_hash_set::ch</a>, <a class="el" href="compat-lz4_8h_source.html#l00686">dest</a>, <a class="el" href="ssl__verify_8h_source.html#l00051">MAX_CERT_DEPTH</a>, and <a class="el" href="ssl__verify_8h_source.html#l00055">cert_hash::sha256_hash</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00308">tls_lock_cert_hash_set()</a>.</p>

</div>
</div>
<a id="af83ef415aa36cda688d9d969f68085fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af83ef415aa36cda688d9d969f68085fd">&#9670;&nbsp;</a></span>cert_hash_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cert_hash_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcert__hash__set.html">cert_hash_set</a> *&#160;</td>
          <td class="paramname"><em>chs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees the given set of certificate hashes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chs</td><td>The certificate hash set to free. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00236">236</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__verify_8h_source.html#l00060">cert_hash_set::ch</a>, and <a class="el" href="ssl__verify_8h_source.html#l00051">MAX_CERT_DEPTH</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l01348">tls_multi_free()</a>, and <a class="el" href="ssl_8c_source.html#l01151">tls_session_free()</a>.</p>

</div>
</div>
<a id="adb1a815a125d75d306ec1a9896e156a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb1a815a125d75d306ec1a9896e156a3">&#9670;&nbsp;</a></span>cert_hash_remember()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cert_hash_remember </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>error_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>cert_hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00215">215</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l01054">ALLOC_OBJ</a>, <a class="el" href="buffer_8h_source.html#l01059">ALLOC_OBJ_CLEAR</a>, <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="buffer_8h_source.html#l00127">BLEN</a>, <a class="el" href="buffer_8h_source.html#l00124">BPTR</a>, <a class="el" href="ssl__verify_8h_source.html#l00051">MAX_CERT_DEPTH</a>, and <a class="el" href="ssl__verify_8h_source.html#l00055">cert_hash::sha256_hash</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify__openssl_8c_source.html#l00052">verify_callback()</a>.</p>

</div>
</div>
<a id="aaf3ddf703a0408ef63c324443acff732"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf3ddf703a0408ef63c324443acff732">&#9670;&nbsp;</a></span>print_nsCertType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const char* print_nsCertType </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00321">321</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__verify_8h_source.html#l00216">NS_CERT_CHECK_CLIENT</a>, and <a class="el" href="ssl__verify_8h_source.html#l00214">NS_CERT_CHECK_SERVER</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00345">verify_peer_cert()</a>.</p>

</div>
</div>
<a id="af141763456956a63d18f26c7897d5746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af141763456956a63d18f26c7897d5746">&#9670;&nbsp;</a></span>set_common_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_common_name </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>common_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00091">91</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="list_8c_source.html#l00589">hash_func()</a>, <a class="el" href="env__set_8c_source.html#l00285">setenv_str()</a>, and <a class="el" href="buffer_8c_source.html#l00665">string_alloc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00646">verify_cert()</a>, <a class="el" href="ssl__verify_8c_source.html#l01453">verify_final_auth_checks()</a>, and <a class="el" href="ssl__verify_8c_source.html#l01279">verify_user_pass()</a>.</p>

</div>
</div>
<a id="afc7cf94216d895753fce8988673be7da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc7cf94216d895753fce8988673be7da">&#9670;&nbsp;</a></span>set_verify_user_pass_env()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool set_verify_user_pass_env </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structuser__pass.html">user_pass</a> *&#160;</td>
          <td class="paramname"><em>up</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l01244">1244</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="auth__token_8c_source.html#l00052">add_session_token_env()</a>, <a class="el" href="errlevel_8h_source.html#l00059">D_TLS_ERRORS</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="env__set_8c_source.html#l00285">setenv_str()</a>, <a class="el" href="ssl__verify_8c_source.html#l00063">setenv_untrusted()</a>, <a class="el" href="ssl__common_8h_source.html#l00345">SSLF_AUTH_USER_PASS_OPTIONAL</a>, and <a class="el" href="misc_8h_source.html#l00078">user_pass::username</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l01279">verify_user_pass()</a>.</p>

</div>
</div>
<a id="adba2e5249b11caedf3edbcfc1a70e23b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adba2e5249b11caedf3edbcfc1a70e23b">&#9670;&nbsp;</a></span>setenv_untrusted()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void setenv_untrusted </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00063">63</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="socket_8h_source.html#l00405">SA_IP_PORT</a>, and <a class="el" href="socket_8c_source.html#l03148">setenv_link_socket_actual()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l01244">set_verify_user_pass_env()</a>, and <a class="el" href="ssl__verify_8c_source.html#l00646">verify_cert()</a>.</p>

</div>
</div>
<a id="ae7aea148e078833f0cda3c5e7af7a0a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7aea148e078833f0cda3c5e7af7a0a6">&#9670;&nbsp;</a></span>ssl_session_fully_authenticated()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ssl_session_fully_authenticated </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00912">912</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00571">tls_multi::auth_token_initial</a>, <a class="el" href="keyingmaterialexporter_8c_source.html#l00058">session::key</a>, <a class="el" href="ssl__common_8h_source.html#l00176">key_state::key_id</a>, <a class="el" href="ssl__common_8h_source.html#l00381">KS_PRIMARY</a>, and <a class="el" href="push_8c_source.html#l00526">send_push_reply_auth_token()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00950">tls_authentication_status()</a>, and <a class="el" href="ssl__verify_8c_source.html#l01279">verify_user_pass()</a>.</p>

</div>
</div>
<a id="ad5f82b5103ca6b176eef6d78ae1ea3f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5f82b5103ca6b176eef6d78ae1ea3f8">&#9670;&nbsp;</a></span>string_mod_remap_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void string_mod_remap_name </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00054">54</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l00928">CC_CRLF</a>, <a class="el" href="buffer_8h_source.html#l00899">CC_PRINT</a>, and <a class="el" href="buffer_8c_source.html#l01057">string_mod()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00646">verify_cert()</a>, and <a class="el" href="ssl__verify_8c_source.html#l01279">verify_user_pass()</a>.</p>

</div>
</div>
<a id="ac6de478954452cfd54e8352f57638772"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6de478954452cfd54e8352f57638772">&#9670;&nbsp;</a></span>tls_authentication_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tls_authentication_status </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>latency</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00950">950</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="ssl__common_8h_source.html#l00209">key_state::auth_deferred_expire</a>, <a class="el" href="ssl__common_8h_source.html#l00208">key_state::authenticated</a>, <a class="el" href="errlevel_8h_source.html#l00059">D_TLS_ERRORS</a>, <a class="el" href="ssl__verify_8h_source.html#l00089">DECRYPT_KEY_ENABLED</a>, <a class="el" href="openvpn_2error_8h_source.html#l00171">dmsg</a>, <a class="el" href="ssl__common_8h_source.html#l00518">tls_multi::key_scan</a>, <a class="el" href="ssl__common_8h_source.html#l00482">KEY_SCAN_SIZE</a>, <a class="el" href="ssl__common_8h_source.html#l00139">KS_AUTH_DEFERRED</a>, <a class="el" href="ssl__common_8h_source.html#l00138">KS_AUTH_FALSE</a>, <a class="el" href="ssl__common_8h_source.html#l00141">KS_AUTH_TRUE</a>, <a class="el" href="otime_8c_source.html#l00036">now</a>, <a class="el" href="ssl__common_8h_source.html#l00597">tls_multi::session</a>, <a class="el" href="ssl__verify_8c_source.html#l00912">ssl_session_fully_authenticated()</a>, <a class="el" href="ssl__verify_8h_source.html#l00070">TLS_AUTHENTICATION_DEFERRED</a>, <a class="el" href="ssl__verify_8h_source.html#l00069">TLS_AUTHENTICATION_FAILED</a>, <a class="el" href="ssl__verify_8h_source.html#l00068">TLS_AUTHENTICATION_SUCCEEDED</a>, <a class="el" href="ssl__verify_8h_source.html#l00071">TLS_AUTHENTICATION_UNDEFINED</a>, and <a class="el" href="ssl__common_8h_source.html#l00462">TM_ACTIVE</a>.</p>

<p class="reference">Referenced by <a class="el" href="multi_8c_source.html#l02588">multi_connection_established()</a>, <a class="el" href="push_8c_source.html#l00731">process_incoming_push_request()</a>, and <a class="el" href="ssl_8c_source.html#l03021">tls_multi_process()</a>.</p>

</div>
</div>
<a id="af3b8a3f413dbfc086e05cc5b09efb998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3b8a3f413dbfc086e05cc5b09efb998">&#9670;&nbsp;</a></span>tls_common_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* tls_common_name </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>null</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the common name field for the given tunnel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">multi</td><td>The tunnel to return the common name for </td></tr>
    <tr><td class="paramname">null</td><td>Whether null may be returned. If not, "UNDEF" will be returned. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00129">129</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00429">tls_session::common_name</a>, <a class="el" href="ssl__common_8h_source.html#l00597">tls_multi::session</a>, and <a class="el" href="ssl__common_8h_source.html#l00462">TM_ACTIVE</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l01343">format_common_name()</a>, <a class="el" href="multi_8c_source.html#l00096">learn_address_script()</a>, <a class="el" href="multi_8c_source.html#l03816">management_callback_kill_by_cn()</a>, <a class="el" href="multi_8c_source.html#l01750">multi_client_connect_setenv()</a>, <a class="el" href="multi_8c_source.html#l02497">multi_client_connect_source_ccd()</a>, <a class="el" href="multi_8c_source.html#l01352">multi_delete_dup()</a>, <a class="el" href="multi_8c_source.html#l00468">multi_instance_string()</a>, <a class="el" href="multi_8c_source.html#l00852">multi_print_status()</a>, <a class="el" href="multi_8c_source.html#l03046">multi_process_float()</a>, <a class="el" href="multi_8c_source.html#l01439">multi_select_virtual_addr()</a>, and <a class="el" href="forward_8c_source.html#l00358">send_control_channel_string_dowork()</a>.</p>

</div>
</div>
<a id="a4c0047d81eec2d7c39339ccd9d78ca34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c0047d81eec2d7c39339ccd9d78ca34">&#9670;&nbsp;</a></span>tls_deauthenticate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tls_deauthenticate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00072">72</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00208">key_state::authenticated</a>, <a class="el" href="ssl__common_8h_source.html#l00442">tls_session::key</a>, <a class="el" href="ssl__common_8h_source.html#l00138">KS_AUTH_FALSE</a>, <a class="el" href="ssl__common_8h_source.html#l00384">KS_SIZE</a>, <a class="el" href="ssl__common_8h_source.html#l00597">tls_multi::session</a>, <a class="el" href="ssl__common_8h_source.html#l00466">TM_SIZE</a>, and <a class="el" href="auth__token_8c_source.html#l00395">wipe_auth_token()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00167">tls_lock_username()</a>, and <a class="el" href="ssl__verify_8c_source.html#l01453">verify_final_auth_checks()</a>.</p>

</div>
</div>
<a id="a6fc8473f2a78fad6655bbe55b8f32aa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fc8473f2a78fad6655bbe55b8f32aa5">&#9670;&nbsp;</a></span>tls_lock_cert_hash_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_lock_cert_hash_set </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locks the certificate hash set used in the given tunnel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">multi</td><td>The tunnel to lock </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00308">308</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__verify_8c_source.html#l00287">cert_hash_copy()</a>, <a class="el" href="ssl__common_8h_source.html#l00431">tls_session::cert_hash_set</a>, <a class="el" href="ssl__common_8h_source.html#l00550">tls_multi::locked_cert_hash_set</a>, <a class="el" href="ssl__common_8h_source.html#l00597">tls_multi::session</a>, and <a class="el" href="ssl__common_8h_source.html#l00462">TM_ACTIVE</a>.</p>

<p class="reference">Referenced by <a class="el" href="multi_8c_source.html#l02463">multi_client_connect_early_setup()</a>.</p>

</div>
</div>
<a id="a85e2a6ef69ed420aae1fba8369408071"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85e2a6ef69ed420aae1fba8369408071">&#9670;&nbsp;</a></span>tls_lock_common_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_lock_common_name </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Locks the common name field for the given tunnel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">multi</td><td>The tunnel to lock </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00154">154</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00429">tls_session::common_name</a>, <a class="el" href="ssl__common_8h_source.html#l00548">tls_multi::locked_cn</a>, <a class="el" href="ssl__common_8h_source.html#l00597">tls_multi::session</a>, <a class="el" href="buffer_8c_source.html#l00665">string_alloc()</a>, and <a class="el" href="ssl__common_8h_source.html#l00462">TM_ACTIVE</a>.</p>

<p class="reference">Referenced by <a class="el" href="multi_8c_source.html#l02463">multi_client_connect_early_setup()</a>.</p>

</div>
</div>
<a id="a9a7dd88a71d94eeb9c2fe155ea934245"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a7dd88a71d94eeb9c2fe155ea934245">&#9670;&nbsp;</a></span>tls_lock_username()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool tls_lock_username </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00167">167</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="errlevel_8h_source.html#l00059">D_TLS_ERRORS</a>, <a class="el" href="ssl__common_8h_source.html#l00549">tls_multi::locked_username</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="multi-auth_8c_source.html#l00145">np()</a>, <a class="el" href="buffer_8c_source.html#l00665">string_alloc()</a>, and <a class="el" href="ssl__verify_8c_source.html#l00072">tls_deauthenticate()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l01279">verify_user_pass()</a>.</p>

</div>
</div>
<a id="add880839dd1306f5e17f2e7baabc92d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add880839dd1306f5e17f2e7baabc92d9">&#9670;&nbsp;</a></span>tls_username()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* tls_username </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>null</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the username field for the given tunnel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">multi</td><td>The tunnel to return the username for </td></tr>
    <tr><td class="paramname">null</td><td>Whether null may be returned. If not, "UNDEF" will be returned. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00193">193</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00549">tls_multi::locked_username</a>.</p>

<p class="reference">Referenced by <a class="el" href="multi_8c_source.html#l00852">multi_print_status()</a>.</p>

</div>
</div>
<a id="a562d8b5b597a5474e839c3f0e31777cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a562d8b5b597a5474e839c3f0e31777cd">&#9670;&nbsp;</a></span>tls_x509_clear_env()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_x509_clear_env </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structenv__set.html">env_set</a> *&#160;</td>
          <td class="paramname"><em>es</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove any X509_ env variables from <a class="el" href="structenv__set.html">env_set</a> es. </p>

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l01515">1515</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="env__set_8c_source.html#l00185">env_set_del()</a>, <a class="el" href="env__set_8h_source.html#l00044">env_set::list</a>, <a class="el" href="env__set_8h_source.html#l00039">env_item::next</a>, and <a class="el" href="env__set_8h_source.html#l00038">env_item::string</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>.</p>

</div>
</div>
<a id="a8574f9402b712d3051d9febde91cf220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8574f9402b712d3051d9febde91cf220">&#9670;&nbsp;</a></span>verify_cert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ssl__verify__backend_8h.html#ad75d91d2a2ad02fb4a39a5fc8c4d4ec3">result_t</a> verify_cert </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cert_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00646">646</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="ssl__verify__openssl_8c_source.html#l00261">backend_x509_get_username()</a>, <a class="el" href="buffer_8h_source.html#l00127">BLEN</a>, <a class="el" href="buffer_8h_source.html#l00124">BPTR</a>, <a class="el" href="ssl__common_8h_source.html#l00282">tls_options::crl_file</a>, <a class="el" href="errlevel_8h_source.html#l00072">D_HANDSHAKE</a>, <a class="el" href="errlevel_8h_source.html#l00059">D_TLS_ERRORS</a>, <a class="el" href="ssl__common_8h_source.html#l00332">tls_options::es</a>, <a class="el" href="ssl__verify__backend_8h_source.html#l00035">FAILURE</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00093">M_WARN</a>, <a class="el" href="ssl__verify_8h_source.html#l00051">MAX_CERT_DEPTH</a>, <a class="el" href="integer_8h_source.html#l00044">max_int()</a>, <a class="el" href="crypto__backend_8h_source.html#l00052">MD_SHA1</a>, <a class="el" href="crypto__backend_8h_source.html#l00053">MD_SHA256</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="ssl__common_8h_source.html#l00334">tls_options::plugins</a>, <a class="el" href="ssl__verify_8c_source.html#l00091">set_common_name()</a>, <a class="el" href="ssl__verify_8c_source.html#l00063">setenv_untrusted()</a>, <a class="el" href="ssl__common_8h_source.html#l00353">tls_options::ssl_flags</a>, <a class="el" href="ssl__common_8h_source.html#l00347">SSLF_CRL_VERIFY_DIR</a>, <a class="el" href="ssl__verify_8c_source.html#l00054">string_mod_remap_name()</a>, <a class="el" href="buffer_8c_source.html#l01125">string_replace_leading()</a>, <a class="el" href="ssl__verify__backend_8h_source.html#l00035">SUCCESS</a>, <a class="el" href="ssl__openssl_8c_source.html#l00126">tls_clear_error()</a>, <a class="el" href="ssl__verify_8c_source.html#l00051">TLS_USERNAME_LEN</a>, <a class="el" href="ssl__verify__openssl_8c_source.html#l00768">tls_verify_crl_missing()</a>, <a class="el" href="ssl__verify_8c_source.html#l00549">verify_cert_call_command()</a>, <a class="el" href="ssl__verify_8c_source.html#l00481">verify_cert_call_plugin()</a>, <a class="el" href="ssl__verify_8c_source.html#l00421">verify_cert_set_env()</a>, <a class="el" href="ssl__verify_8c_source.html#l00604">verify_check_crl_dir()</a>, <a class="el" href="ssl__common_8h_source.html#l00278">tls_options::verify_command</a>, <a class="el" href="ssl__common_8h_source.html#l00279">tls_options::verify_export_cert</a>, <a class="el" href="ssl__common_8h_source.html#l00287">tls_options::verify_hash</a>, <a class="el" href="ssl__common_8h_source.html#l00288">tls_options::verify_hash_algo</a>, <a class="el" href="ssl__verify_8c_source.html#l00345">verify_peer_cert()</a>, <a class="el" href="ssl__verify__openssl_8c_source.html#l00311">x509_get_sha1_fingerprint()</a>, <a class="el" href="ssl__verify__openssl_8c_source.html#l00321">x509_get_sha256_fingerprint()</a>, <a class="el" href="ssl__verify__openssl_8c_source.html#l00331">x509_get_subject()</a>, <a class="el" href="ssl__common_8h_source.html#l00359">tls_options::x509_track</a>, and <a class="el" href="ssl__common_8h_source.html#l00289">tls_options::x509_username_field</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify__openssl_8c_source.html#l00052">verify_callback()</a>.</p>

</div>
</div>
<a id="a6b4b170c8a6d323a4189836d67a51075"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b4b170c8a6d323a4189836d67a51075">&#9670;&nbsp;</a></span>verify_cert_call_command()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="ssl__verify__backend_8h.html#ad75d91d2a2ad02fb4a39a5fc8c4d4ec3">result_t</a> verify_cert_call_command </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>verify_command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structenv__set.html">env_set</a> *&#160;</td>
          <td class="paramname"><em>es</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cert_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>subject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>verify_export_cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00549">549</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="argv_8c_source.html#l00104">argv_free()</a>, <a class="el" href="argv_8c_source.html#l00262">argv_msg_prefix()</a>, <a class="el" href="argv_8c_source.html#l00090">argv_new()</a>, <a class="el" href="argv_8c_source.html#l00485">argv_parse_cmd()</a>, <a class="el" href="argv_8c_source.html#l00466">argv_printf_cat()</a>, <a class="el" href="errlevel_8h_source.html#l00072">D_HANDSHAKE</a>, <a class="el" href="errlevel_8h_source.html#l00163">D_TLS_DEBUG</a>, <a class="el" href="ssl__verify__backend_8h_source.html#l00035">FAILURE</a>, <a class="el" href="argv_8h_source.html#l00036">argv::gc</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="run__command_8h_source.html#l00057">openvpn_run_script()</a>, <a class="el" href="platform_8c_source.html#l00287">platform_unlink()</a>, <a class="el" href="env__set_8c_source.html#l00285">setenv_str()</a>, <a class="el" href="ssl__verify__backend_8h_source.html#l00035">SUCCESS</a>, and <a class="el" href="ssl__verify_8c_source.html#l00511">verify_cert_export_cert()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00646">verify_cert()</a>.</p>

</div>
</div>
<a id="aa175c3436aa21a0dd2ca6bb530b9cac1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa175c3436aa21a0dd2ca6bb530b9cac1">&#9670;&nbsp;</a></span>verify_cert_call_plugin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="ssl__verify__backend_8h.html#ad75d91d2a2ad02fb4a39a5fc8c4d4ec3">result_t</a> verify_cert_call_plugin </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structplugin__list.html">plugin_list</a> *&#160;</td>
          <td class="paramname"><em>plugins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structenv__set.html">env_set</a> *&#160;</td>
          <td class="paramname"><em>es</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cert_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>subject</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00481">481</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="argv_8c_source.html#l00104">argv_free()</a>, <a class="el" href="argv_8c_source.html#l00090">argv_new()</a>, <a class="el" href="argv_8c_source.html#l00442">argv_printf()</a>, <a class="el" href="errlevel_8h_source.html#l00072">D_HANDSHAKE</a>, <a class="el" href="ssl__verify__backend_8h_source.html#l00035">FAILURE</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="openvpn-plugin_8h_source.html#l00151">OPENVPN_PLUGIN_FUNC_SUCCESS</a>, <a class="el" href="openvpn-plugin_8h_source.html#l00124">OPENVPN_PLUGIN_TLS_VERIFY</a>, <a class="el" href="plugin_8c_source.html#l00799">plugin_call_ssl()</a>, <a class="el" href="plugin_8c_source.html#l00940">plugin_defined()</a>, and <a class="el" href="ssl__verify__backend_8h_source.html#l00035">SUCCESS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00646">verify_cert()</a>.</p>

</div>
</div>
<a id="aaa731ba21c375c741e01cafeca6aa8ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa731ba21c375c741e01cafeca6aa8ed">&#9670;&nbsp;</a></span>verify_cert_export_cert()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const char* verify_cert_export_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *&#160;</td>
          <td class="paramname"><em>peercert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tmp_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgc__arena.html">gc_arena</a> *&#160;</td>
          <td class="paramname"><em>gc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00511">511</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="argv_8h_source.html#l00036">argv::gc</a>, <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="platform_8c_source.html#l00342">platform_create_temp_file()</a>, <a class="el" href="platform_8c_source.html#l00287">platform_unlink()</a>, <a class="el" href="ssl__verify__backend_8h_source.html#l00035">SUCCESS</a>, and <a class="el" href="ssl__verify__openssl_8c_source.html#l00757">x509_write_pem()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00549">verify_cert_call_command()</a>.</p>

</div>
</div>
<a id="a9f359d02c2643457c46b0f59763336fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f359d02c2643457c46b0f59763336fe">&#9670;&nbsp;</a></span>verify_cert_set_env()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void verify_cert_set_env </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structenv__set.html">env_set</a> *&#160;</td>
          <td class="paramname"><em>es</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *&#160;</td>
          <td class="paramname"><em>peer_cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cert_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>subject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>common_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structx509__track.html">x509_track</a> *&#160;</td>
          <td class="paramname"><em>x509_track</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00421">421</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__verify__openssl_8c_source.html#l00284">backend_x509_get_serial()</a>, <a class="el" href="ssl__verify__openssl_8c_source.html#l00303">backend_x509_get_serial_hex()</a>, <a class="el" href="buffer_8h_source.html#l00127">BLEN</a>, <a class="el" href="buffer_8h_source.html#l00124">BPTR</a>, <a class="el" href="buffer_8c_source.html#l00499">format_hex_ex()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="buffer_8c_source.html#l00299">openvpn_snprintf()</a>, <a class="el" href="env__set_8c_source.html#l00285">setenv_str()</a>, <a class="el" href="ssl__verify__openssl_8c_source.html#l00311">x509_get_sha1_fingerprint()</a>, <a class="el" href="ssl__verify__openssl_8c_source.html#l00321">x509_get_sha256_fingerprint()</a>, <a class="el" href="ssl__verify__openssl_8c_source.html#l00520">x509_setenv()</a>, and <a class="el" href="ssl__verify__openssl_8c_source.html#l00431">x509_setenv_track()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00646">verify_cert()</a>.</p>

</div>
</div>
<a id="a31084a9a8352acb7b56989063dff7628"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31084a9a8352acb7b56989063dff7628">&#9670;&nbsp;</a></span>verify_check_crl_dir()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="ssl__verify__backend_8h.html#ad75d91d2a2ad02fb4a39a5fc8c4d4ec3">result_t</a> verify_check_crl_dir </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>crl_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>subject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cert_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00604">604</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__verify__openssl_8c_source.html#l00284">backend_x509_get_serial()</a>, <a class="el" href="errlevel_8h_source.html#l00072">D_HANDSHAKE</a>, <a class="el" href="ssl__verify__backend_8h_source.html#l00035">FAILURE</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="buffer_8c_source.html#l00299">openvpn_snprintf()</a>, <a class="el" href="syshead_8h_source.html#l00479">OS_SPECIFIC_DIRSEP</a>, <a class="el" href="platform_8c_source.html#l00315">platform_open()</a>, and <a class="el" href="ssl__verify__backend_8h_source.html#l00035">SUCCESS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00646">verify_cert()</a>.</p>

</div>
</div>
<a id="a923edfe06fe9d56f1b92fea3ddfecbcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a923edfe06fe9d56f1b92fea3ddfecbcf">&#9670;&nbsp;</a></span>verify_final_auth_checks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void verify_final_auth_checks </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform final authentication checks, including locking of the cn, the allowed certificate hashes, and whether a client config entry exists in the client config directory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">multi</td><td>The TLS multi structure to verify locked structures. </td></tr>
    <tr><td class="paramname">session</td><td>The current TLS session </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l01453">1453</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00208">key_state::authenticated</a>, <a class="el" href="common_8h_source.html#l00071">CCD_DEFAULT</a>, <a class="el" href="ssl__verify_8c_source.html#l00250">cert_hash_compare()</a>, <a class="el" href="errlevel_8h_source.html#l00059">D_TLS_ERRORS</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="keyingmaterialexporter_8c_source.html#l00058">session::key</a>, <a class="el" href="ssl__common_8h_source.html#l00138">KS_AUTH_FALSE</a>, <a class="el" href="ssl__common_8h_source.html#l00381">KS_PRIMARY</a>, <a class="el" href="ssl__common_8h_source.html#l00550">tls_multi::locked_cert_hash_set</a>, <a class="el" href="ssl__common_8h_source.html#l00548">tls_multi::locked_cn</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="platform_8c_source.html#l00395">platform_gen_path()</a>, <a class="el" href="platform_8c_source.html#l00461">platform_test_file()</a>, <a class="el" href="ssl__verify_8c_source.html#l00091">set_common_name()</a>, <a class="el" href="ssl__verify_8c_source.html#l00072">tls_deauthenticate()</a>, and <a class="el" href="auth__token_8c_source.html#l00395">wipe_auth_token()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02455">key_method_2_read()</a>.</p>

</div>
</div>
<a id="a84f183d3f42b41f6e8691a5d9e18a0f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84f183d3f42b41f6e8691a5d9e18a0f4">&#9670;&nbsp;</a></span>verify_peer_cert()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="ssl__verify__backend_8h.html#ad75d91d2a2ad02fb4a39a5fc8c4d4ec3">result_t</a> verify_peer_cert </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structtls__options.html">tls_options</a> *&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="openvpn-plugin_8h.html#a8e555d49f1b97eabd68c37f22ba78896">openvpn_x509_cert_t</a> *&#160;</td>
          <td class="paramname"><em>peer_cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>subject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>common_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l00345">345</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="errlevel_8h_source.html#l00072">D_HANDSHAKE</a>, <a class="el" href="ssl__verify__backend_8h_source.html#l00035">FAILURE</a>, <a class="el" href="options_8h_source.html#l00051">MAX_PARMS</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="ssl__verify_8h_source.html#l00212">NS_CERT_CHECK_NONE</a>, <a class="el" href="ssl__common_8h_source.html#l00284">tls_options::ns_cert_type</a>, <a class="el" href="ssl__verify_8c_source.html#l00321">print_nsCertType()</a>, <a class="el" href="ssl__common_8h_source.html#l00286">tls_options::remote_cert_eku</a>, <a class="el" href="ssl__common_8h_source.html#l00285">tls_options::remote_cert_ku</a>, <a class="el" href="ssl__verify__backend_8h_source.html#l00035">SUCCESS</a>, <a class="el" href="ssl__common_8h_source.html#l00281">tls_options::verify_x509_name</a>, <a class="el" href="ssl__verify_8h_source.html#l00063">VERIFY_X509_NONE</a>, <a class="el" href="ssl__verify_8h_source.html#l00064">VERIFY_X509_SUBJECT_DN</a>, <a class="el" href="ssl__verify_8h_source.html#l00065">VERIFY_X509_SUBJECT_RDN</a>, <a class="el" href="ssl__verify_8h_source.html#l00066">VERIFY_X509_SUBJECT_RDN_PREFIX</a>, <a class="el" href="ssl__common_8h_source.html#l00280">tls_options::verify_x509_type</a>, <a class="el" href="ssl__verify__openssl_8c_source.html#l00707">x509_verify_cert_eku()</a>, <a class="el" href="ssl__verify__openssl_8c_source.html#l00646">x509_verify_cert_ku()</a>, and <a class="el" href="ssl__verify__openssl_8c_source.html#l00579">x509_verify_ns_cert_type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00646">verify_cert()</a>.</p>

</div>
</div>
<a id="aad04670ce0b3419d381ce4348a68e45d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad04670ce0b3419d381ce4348a68e45d">&#9670;&nbsp;</a></span>verify_user_pass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void verify_user_pass </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structuser__pass.html">user_pass</a> *&#160;</td>
          <td class="paramname"><em>up</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify the given username and password, using either an external script, a plugin, or the management interface. </p>
<p>If authentication succeeds, the appropriate state is filled into the session's primary key state's authenticated field. Authentication may also be deferred, in which case the key state's auth_deferred field is filled in.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">up</td><td>The username and password to verify. </td></tr>
    <tr><td class="paramname">multi</td><td>The TLS multi structure to verify usernames against. </td></tr>
    <tr><td class="paramname">session</td><td>The current TLS session </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l01279">1279</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00567">tls_multi::auth_token</a>, <a class="el" href="ssl__common_8h_source.html#l00577">AUTH_TOKEN_EXPIRED</a>, <a class="el" href="ssl__common_8h_source.html#l00575">AUTH_TOKEN_HMAC_OK</a>, <a class="el" href="ssl__common_8h_source.html#l00170">key_state::auth_token_state_flags</a>, <a class="el" href="ssl__common_8h_source.html#l00208">key_state::authenticated</a>, <a class="el" href="buffer_8h_source.html#l00928">CC_CRLF</a>, <a class="el" href="buffer_8h_source.html#l00899">CC_PRINT</a>, <a class="el" href="errlevel_8h_source.html#l00072">D_HANDSHAKE</a>, <a class="el" href="errlevel_8h_source.html#l00059">D_TLS_ERRORS</a>, <a class="el" href="auth__token_8c_source.html#l00176">generate_auth_token()</a>, <a class="el" href="auth__token_8h_source.html#l00127">is_auth_token()</a>, <a class="el" href="keyingmaterialexporter_8c_source.html#l00058">session::key</a>, <a class="el" href="ssl__common_8h_source.html#l00139">KS_AUTH_DEFERRED</a>, <a class="el" href="ssl__common_8h_source.html#l00138">KS_AUTH_FALSE</a>, <a class="el" href="ssl__common_8h_source.html#l00141">KS_AUTH_TRUE</a>, <a class="el" href="ssl__common_8h_source.html#l00381">KS_PRIMARY</a>, <a class="el" href="openvpn_2error_8h_source.html#l00093">M_WARN</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="openvpn-plugin_8h_source.html#l00125">OPENVPN_PLUGIN_AUTH_USER_PASS_VERIFY</a>, <a class="el" href="openvpn-plugin_8h_source.html#l00153">OPENVPN_PLUGIN_FUNC_DEFERRED</a>, <a class="el" href="openvpn-plugin_8h_source.html#l00152">OPENVPN_PLUGIN_FUNC_ERROR</a>, <a class="el" href="openvpn-plugin_8h_source.html#l00151">OPENVPN_PLUGIN_FUNC_SUCCESS</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="plugin_8c_source.html#l00940">plugin_defined()</a>, <a class="el" href="ssl__verify_8c_source.html#l00091">set_common_name()</a>, <a class="el" href="ssl__verify_8c_source.html#l01244">set_verify_user_pass_env()</a>, <a class="el" href="ssl__verify_8c_source.html#l00912">ssl_session_fully_authenticated()</a>, <a class="el" href="ssl__common_8h_source.html#l00344">SSLF_USERNAME_AS_COMMON_NAME</a>, <a class="el" href="buffer_8c_source.html#l01057">string_mod()</a>, <a class="el" href="ssl__verify_8c_source.html#l00054">string_mod_remap_name()</a>, <a class="el" href="ssl__verify_8c_source.html#l00167">tls_lock_username()</a>, <a class="el" href="ssl__verify_8c_source.html#l00051">TLS_USERNAME_LEN</a>, <a class="el" href="misc_8h_source.html#l00078">user_pass::username</a>, <a class="el" href="auth__token_8c_source.html#l00302">verify_auth_token()</a>, <a class="el" href="ssl__verify_8c_source.html#l01172">verify_user_pass_plugin()</a>, <a class="el" href="ssl__verify_8c_source.html#l01104">verify_user_pass_script()</a>, and <a class="el" href="auth__token_8c_source.html#l00395">wipe_auth_token()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02455">key_method_2_read()</a>.</p>

</div>
</div>
<a id="a9a869c58e582efe53b8ba10a2c9d3021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a869c58e582efe53b8ba10a2c9d3021">&#9670;&nbsp;</a></span>verify_user_pass_plugin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int verify_user_pass_plugin </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structuser__pass.html">user_pass</a> *&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l01172">1172</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="errlevel_8h_source.html#l00059">D_TLS_ERRORS</a>, <a class="el" href="keyingmaterialexporter_8c_source.html#l00058">session::key</a>, <a class="el" href="ssl__verify_8h.html#a2410fec00466d19501d3ada2a47fcd6a">key_state_rm_auth_control_file()</a>, <a class="el" href="ssl__common_8h_source.html#l00381">KS_PRIMARY</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="openvpn-plugin_8h_source.html#l00125">OPENVPN_PLUGIN_AUTH_USER_PASS_VERIFY</a>, <a class="el" href="openvpn-plugin_8h_source.html#l00153">OPENVPN_PLUGIN_FUNC_DEFERRED</a>, <a class="el" href="openvpn-plugin_8h_source.html#l00152">OPENVPN_PLUGIN_FUNC_ERROR</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="plugin_8h_source.html#l00202">plugin_call()</a>, <a class="el" href="env__set_8c_source.html#l00330">setenv_del()</a>, and <a class="el" href="env__set_8c_source.html#l00285">setenv_str()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l01279">verify_user_pass()</a>.</p>

</div>
</div>
<a id="af19cd77fa1e9449e092e2be555ceef32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af19cd77fa1e9449e092e2be555ceef32">&#9670;&nbsp;</a></span>verify_user_pass_script()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool verify_user_pass_script </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__session.html">tls_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structuser__pass.html">user_pass</a> *&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__verify_8c_source.html#l01104">1104</a> of file <a class="el" href="ssl__verify_8c_source.html">ssl_verify.c</a>.</p>

<p class="reference">References <a class="el" href="argv_8c_source.html#l00104">argv_free()</a>, <a class="el" href="argv_8c_source.html#l00090">argv_new()</a>, <a class="el" href="argv_8c_source.html#l00485">argv_parse_cmd()</a>, <a class="el" href="argv_8c_source.html#l00466">argv_printf_cat()</a>, <a class="el" href="errlevel_8h_source.html#l00059">D_TLS_ERRORS</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="run__command_8h_source.html#l00057">openvpn_run_script()</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="platform_8c_source.html#l00342">platform_create_temp_file()</a>, <a class="el" href="platform_8c_source.html#l00287">platform_unlink()</a>, <a class="el" href="env__set_8c_source.html#l00330">setenv_del()</a>, <a class="el" href="env__set_8c_source.html#l00285">setenv_str()</a>, <a class="el" href="status_8c_source.html#l00190">status_close()</a>, <a class="el" href="status_8c_source.html#l00063">status_open()</a>, <a class="el" href="status_8h_source.html#l00051">STATUS_OUTPUT_WRITE</a>, <a class="el" href="status_8c_source.html#l00226">status_printf()</a>, and <a class="el" href="misc_8h_source.html#l00078">user_pass::username</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l01279">verify_user_pass()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
