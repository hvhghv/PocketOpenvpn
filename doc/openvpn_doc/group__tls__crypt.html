<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: Control channel encryption (&ndash;tls-crypt, &ndash;tls-crypt-v2)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Control channel encryption (&ndash;tls-crypt, &ndash;tls-crypt-v2)<div class="ingroups"><a class="el" href="group__control__tls.html">Control_tls</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Control channel encryption (&ndash;tls-crypt, &ndash;tls-crypt-v2):</div>
<div class="dyncontent">
<div class="center"><img src="group__tls__crypt.png" border="0" usemap="#group____tls____crypt" alt=""/></div>
<map name="group____tls____crypt" id="group____tls____crypt">
<area shape="rect" title=" " alt="" coords="139,5,316,60"/>
<area shape="rect" href="group__control__tls.html" title=" " alt="" coords="5,20,91,45"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga65e056054468311502b28a13b7b1a3ef"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga65e056054468311502b28a13b7b1a3ef">TLS_CRYPT_TAG_SIZE</a>&#160;&#160;&#160;(256/8)</td></tr>
<tr class="separator:ga65e056054468311502b28a13b7b1a3ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga55c58e2fa69ea5ffbbb71e25520618e0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga55c58e2fa69ea5ffbbb71e25520618e0">TLS_CRYPT_PID_SIZE</a>&#160;&#160;&#160;(sizeof(<a class="el" href="packet__id_8h.html#a345f753b1c6ea20d24409e769aadb7e6">packet_id_type</a>) + sizeof(<a class="el" href="packet__id_8h.html#a32b361b1d3a0fc2f92ceeff736bba97e">net_time_t</a>))</td></tr>
<tr class="separator:ga55c58e2fa69ea5ffbbb71e25520618e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1acab4b545b3fff369cb0c05b1897c02"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga1acab4b545b3fff369cb0c05b1897c02">TLS_CRYPT_BLOCK_SIZE</a>&#160;&#160;&#160;(128/8)</td></tr>
<tr class="separator:ga1acab4b545b3fff369cb0c05b1897c02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7eb6b7a1658d8cf6f2f2119b5b927d29"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga7eb6b7a1658d8cf6f2f2119b5b927d29">TLS_CRYPT_OFF_PID</a>&#160;&#160;&#160;(1 + <a class="el" href="session__id_8h.html#ad1163f0bf6339f1dd003192df69052df">SID_SIZE</a>)</td></tr>
<tr class="separator:ga7eb6b7a1658d8cf6f2f2119b5b927d29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8fb65027448e8c403fbbce9bc3b0e056"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga8fb65027448e8c403fbbce9bc3b0e056">TLS_CRYPT_OFF_TAG</a>&#160;&#160;&#160;(<a class="el" href="group__tls__crypt.html#ga7eb6b7a1658d8cf6f2f2119b5b927d29">TLS_CRYPT_OFF_PID</a> + <a class="el" href="group__tls__crypt.html#ga55c58e2fa69ea5ffbbb71e25520618e0">TLS_CRYPT_PID_SIZE</a>)</td></tr>
<tr class="separator:ga8fb65027448e8c403fbbce9bc3b0e056"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae4cc51d2d63382d195391a4c50af92b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#gaae4cc51d2d63382d195391a4c50af92b">TLS_CRYPT_OFF_CT</a>&#160;&#160;&#160;(<a class="el" href="group__tls__crypt.html#ga8fb65027448e8c403fbbce9bc3b0e056">TLS_CRYPT_OFF_TAG</a> + <a class="el" href="group__tls__crypt.html#ga65e056054468311502b28a13b7b1a3ef">TLS_CRYPT_TAG_SIZE</a>)</td></tr>
<tr class="separator:gaae4cc51d2d63382d195391a4c50af92b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c94fd45c9f1fdf27e843fde47b5f6eb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga0c94fd45c9f1fdf27e843fde47b5f6eb">TLS_CRYPT_V2_MAX_WKC_LEN</a>&#160;&#160;&#160;(1024)</td></tr>
<tr class="separator:ga0c94fd45c9f1fdf27e843fde47b5f6eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad176f609bffbc5f9a85ba1d1533e5fd2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#gad176f609bffbc5f9a85ba1d1533e5fd2">TLS_CRYPT_V2_CLIENT_KEY_LEN</a>&#160;&#160;&#160;(2048 / 8)</td></tr>
<tr class="separator:gad176f609bffbc5f9a85ba1d1533e5fd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7912dec33dae66135819fefc188d1cb3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga7912dec33dae66135819fefc188d1cb3">TLS_CRYPT_V2_SERVER_KEY_LEN</a>&#160;&#160;&#160;(sizeof(struct <a class="el" href="structkey.html">key</a>))</td></tr>
<tr class="separator:ga7912dec33dae66135819fefc188d1cb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafb0f9976e3233bad47df4efe72c4a0bd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#gafb0f9976e3233bad47df4efe72c4a0bd">TLS_CRYPT_V2_TAG_SIZE</a>&#160;&#160;&#160;(<a class="el" href="group__tls__crypt.html#ga65e056054468311502b28a13b7b1a3ef">TLS_CRYPT_TAG_SIZE</a>)</td></tr>
<tr class="separator:gafb0f9976e3233bad47df4efe72c4a0bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaec2f3a21e8cbef25c45d8f4107a9115e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#gaec2f3a21e8cbef25c45d8f4107a9115e">TLS_CRYPT_V2_MAX_METADATA_LEN</a></td></tr>
<tr class="separator:gaec2f3a21e8cbef25c45d8f4107a9115e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e3ee15558e2e004eb521863530e76cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga0e3ee15558e2e004eb521863530e76cd">TLS_CRYPT_V2_MAX_B64_METADATA_LEN</a>&#160;&#160;&#160;<a class="el" href="base64_8h.html#a6bb9abfbe864e37f2ed40143e1cbcdbe">OPENVPN_BASE64_LENGTH</a>(<a class="el" href="group__tls__crypt.html#gaec2f3a21e8cbef25c45d8f4107a9115e">TLS_CRYPT_V2_MAX_METADATA_LEN</a> - 1)</td></tr>
<tr class="separator:ga0e3ee15558e2e004eb521863530e76cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad1ffd0865c58c744773e5c95e3084cf3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#gad1ffd0865c58c744773e5c95e3084cf3">tls_crypt_init_key</a> (struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *<a class="el" href="structkey.html">key</a>, const char *key_file, bool key_inline, bool tls_server)</td></tr>
<tr class="memdesc:gad1ffd0865c58c744773e5c95e3084cf3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a <a class="el" href="structkey__ctx__bi.html" title="Container for two sets of OpenSSL cipher and/or HMAC contexts for both sending and receiving directio...">key_ctx_bi</a> structure for use with &ndash;tls-crypt.  <a href="group__tls__crypt.html#gad1ffd0865c58c744773e5c95e3084cf3">More...</a><br /></td></tr>
<tr class="separator:gad1ffd0865c58c744773e5c95e3084cf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac9c2ecaaf4e2af189ab15bb47a558bfa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#gac9c2ecaaf4e2af189ab15bb47a558bfa">tls_crypt_buf_overhead</a> (void)</td></tr>
<tr class="memdesc:gac9c2ecaaf4e2af189ab15bb47a558bfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the maximum overhead (in bytes) added to the destination buffer by <a class="el" href="group__tls__crypt.html#gadaca5f414562a243603a60a0e3158e5a" title="Wrap a control channel packet (both authenticates and encrypts the data).">tls_crypt_wrap()</a>.  <a href="group__tls__crypt.html#gac9c2ecaaf4e2af189ab15bb47a558bfa">More...</a><br /></td></tr>
<tr class="separator:gac9c2ecaaf4e2af189ab15bb47a558bfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga24b342111241c5ea9c731de4aa66fcb2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga24b342111241c5ea9c731de4aa66fcb2">tls_crypt_adjust_frame_parameters</a> (struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:ga24b342111241c5ea9c731de4aa66fcb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjust frame parameters for &ndash;tls-crypt overhead.  <a href="group__tls__crypt.html#ga24b342111241c5ea9c731de4aa66fcb2">More...</a><br /></td></tr>
<tr class="separator:ga24b342111241c5ea9c731de4aa66fcb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadaca5f414562a243603a60a0e3158e5a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#gadaca5f414562a243603a60a0e3158e5a">tls_crypt_wrap</a> (const struct <a class="el" href="structbuffer.html">buffer</a> *src, struct <a class="el" href="structbuffer.html">buffer</a> *<a class="el" href="compat-lz4_8h.html#a961c13eb7fcda15b167b953cac1ab3ec">dst</a>, struct <a class="el" href="structcrypto__options.html">crypto_options</a> *opt)</td></tr>
<tr class="memdesc:gadaca5f414562a243603a60a0e3158e5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrap a control channel packet (both authenticates and encrypts the data).  <a href="group__tls__crypt.html#gadaca5f414562a243603a60a0e3158e5a">More...</a><br /></td></tr>
<tr class="separator:gadaca5f414562a243603a60a0e3158e5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81c822ba2e5599865dddb37e01a2c20c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga81c822ba2e5599865dddb37e01a2c20c">tls_crypt_unwrap</a> (const struct <a class="el" href="structbuffer.html">buffer</a> *src, struct <a class="el" href="structbuffer.html">buffer</a> *<a class="el" href="compat-lz4_8h.html#a961c13eb7fcda15b167b953cac1ab3ec">dst</a>, struct <a class="el" href="structcrypto__options.html">crypto_options</a> *opt)</td></tr>
<tr class="memdesc:ga81c822ba2e5599865dddb37e01a2c20c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unwrap a control channel packet (decrypts, authenticates and performs replay checks).  <a href="group__tls__crypt.html#ga81c822ba2e5599865dddb37e01a2c20c">More...</a><br /></td></tr>
<tr class="separator:ga81c822ba2e5599865dddb37e01a2c20c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga793fa02bdff7c0df6d31b493c8df32aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga793fa02bdff7c0df6d31b493c8df32aa">tls_crypt_v2_init_server_key</a> (struct <a class="el" href="structkey__ctx.html">key_ctx</a> *<a class="el" href="structkey__ctx.html">key_ctx</a>, bool encrypt, const char *key_file, bool key_inline)</td></tr>
<tr class="memdesc:ga793fa02bdff7c0df6d31b493c8df32aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a tls-crypt-v2 server key (used to encrypt/decrypt client keys).  <a href="group__tls__crypt.html#ga793fa02bdff7c0df6d31b493c8df32aa">More...</a><br /></td></tr>
<tr class="separator:ga793fa02bdff7c0df6d31b493c8df32aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5cbcf02978d6d2200ec5fbd645d6646c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga5cbcf02978d6d2200ec5fbd645d6646c">tls_crypt_v2_init_client_key</a> (struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *<a class="el" href="structkey.html">key</a>, struct <a class="el" href="structbuffer.html">buffer</a> *wrapped_key_buf, const char *key_file, bool key_inline)</td></tr>
<tr class="memdesc:ga5cbcf02978d6d2200ec5fbd645d6646c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a tls-crypt-v2 client key.  <a href="group__tls__crypt.html#ga5cbcf02978d6d2200ec5fbd645d6646c">More...</a><br /></td></tr>
<tr class="separator:ga5cbcf02978d6d2200ec5fbd645d6646c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2765985ed19e136d6e833a249031b3ba"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga2765985ed19e136d6e833a249031b3ba">tls_crypt_v2_extract_client_key</a> (struct <a class="el" href="structbuffer.html">buffer</a> *buf, struct <a class="el" href="structtls__wrap__ctx.html">tls_wrap_ctx</a> *ctx, const struct <a class="el" href="structtls__options.html">tls_options</a> *opt)</td></tr>
<tr class="memdesc:ga2765985ed19e136d6e833a249031b3ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract a tls-crypt-v2 client key from a P_CONTROL_HARD_RESET_CLIENT_V3 message, and load the key into the supplied tls wrap context.  <a href="group__tls__crypt.html#ga2765985ed19e136d6e833a249031b3ba">More...</a><br /></td></tr>
<tr class="separator:ga2765985ed19e136d6e833a249031b3ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabc1250a0d15da5d5b50f49f1aec7ef19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#gabc1250a0d15da5d5b50f49f1aec7ef19">tls_crypt_v2_write_server_key_file</a> (const char *filename)</td></tr>
<tr class="memdesc:gabc1250a0d15da5d5b50f49f1aec7ef19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a tls-crypt-v2 server key, and write to file.  <a href="group__tls__crypt.html#gabc1250a0d15da5d5b50f49f1aec7ef19">More...</a><br /></td></tr>
<tr class="separator:gabc1250a0d15da5d5b50f49f1aec7ef19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c2e1553c38344d7858a9dcf062f7f54"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__crypt.html#ga7c2e1553c38344d7858a9dcf062f7f54">tls_crypt_v2_write_client_key_file</a> (const char *filename, const char *b64_metadata, const char *key_file, bool key_inline)</td></tr>
<tr class="memdesc:ga7c2e1553c38344d7858a9dcf062f7f54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a tls-crypt-v2 client key, and write to file.  <a href="group__tls__crypt.html#ga7c2e1553c38344d7858a9dcf062f7f54">More...</a><br /></td></tr>
<tr class="separator:ga7c2e1553c38344d7858a9dcf062f7f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Control channel encryption uses a pre-shared static key (like the &ndash;tls-auth key) to encrypt control channel packets.</p>
<p>Encrypting control channel packets has three main advantages:</p><ul>
<li>It provides more privacy by hiding the certificate used for the TLS connection.</li>
<li>It is harder to identify OpenVPN traffic as such.</li>
<li>It provides "poor-man's" post-quantum security, against attackers who will never know the pre-shared key (i.e. no forward secrecy).</li>
</ul>
<p>&ndash;tls-crypt uses a tls-auth-style group key, where all servers and clients share the same group key. &ndash;tls-crypt-v2 adds support for client-specific keys, where all servers share the same client-key encryption key, and each clients receives a unique client key, both in plaintext and in encrypted form. When connecting to a server, the client sends the encrypted key to the server in the first packet (P_CONTROL_HARD_RESET_CLIENT_V3). The server then decrypts that key, and both parties can use the same client-specific key for tls-crypt packets. See doc/tls-crypt-v2.txt for more details.</p>
<dl class="section user"><dt>On-the-wire tls-crypt packet specification</dt><dd><p class="startdd">Control channel encryption is based on the SIV construction [0], to achieve nonce misuse-resistant authenticated encryption:</p>
<div class="fragment"><div class="line">msg      = control channel plaintext</div>
<div class="line">header   = opcode (1 byte) || session_id (8 bytes) || packet_id (8 bytes)</div>
<div class="line">Ka       = authentication key (256 bits)</div>
<div class="line">Ke       = encryption key (256 bits)</div>
<div class="line">(Ka and Ke are pre-shared keys, like with --tls-auth)</div>
<div class="line"> </div>
<div class="line">auth_tag = HMAC-SHA256(Ka, header || msg)</div>
<div class="line">IV       = 128 most-significant bits of auth_tag</div>
<div class="line">ciph     = AES256-CTR(Ke, IV, msg)</div>
<div class="line"> </div>
<div class="line">output   = Header || Tag || Ciph</div>
</div><!-- fragment --><p class="interdd">This boils down to the following on-the-wire packet format:</p>
<div class="fragment"><div class="line">- opcode - || - session_id - || - packet_id - || auth_tag || * payload *</div>
</div><!-- fragment --><p class="interdd">Where <code>- XXX -</code> means authenticated, and <code>* XXX *</code> means authenticated and encrypted.</p>
<p class="enddd"></p>
</dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga1acab4b545b3fff369cb0c05b1897c02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1acab4b545b3fff369cb0c05b1897c02">&#9670;&nbsp;</a></span>TLS_CRYPT_BLOCK_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_BLOCK_SIZE&#160;&#160;&#160;(128/8)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00091">91</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<a id="gaae4cc51d2d63382d195391a4c50af92b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaae4cc51d2d63382d195391a4c50af92b">&#9670;&nbsp;</a></span>TLS_CRYPT_OFF_CT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_OFF_CT&#160;&#160;&#160;(<a class="el" href="group__tls__crypt.html#ga8fb65027448e8c403fbbce9bc3b0e056">TLS_CRYPT_OFF_TAG</a> + <a class="el" href="group__tls__crypt.html#ga65e056054468311502b28a13b7b1a3ef">TLS_CRYPT_TAG_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00095">95</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<a id="ga7eb6b7a1658d8cf6f2f2119b5b927d29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7eb6b7a1658d8cf6f2f2119b5b927d29">&#9670;&nbsp;</a></span>TLS_CRYPT_OFF_PID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_OFF_PID&#160;&#160;&#160;(1 + <a class="el" href="session__id_8h.html#ad1163f0bf6339f1dd003192df69052df">SID_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00093">93</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<a id="ga8fb65027448e8c403fbbce9bc3b0e056"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8fb65027448e8c403fbbce9bc3b0e056">&#9670;&nbsp;</a></span>TLS_CRYPT_OFF_TAG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_OFF_TAG&#160;&#160;&#160;(<a class="el" href="group__tls__crypt.html#ga7eb6b7a1658d8cf6f2f2119b5b927d29">TLS_CRYPT_OFF_PID</a> + <a class="el" href="group__tls__crypt.html#ga55c58e2fa69ea5ffbbb71e25520618e0">TLS_CRYPT_PID_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00094">94</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<a id="ga55c58e2fa69ea5ffbbb71e25520618e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga55c58e2fa69ea5ffbbb71e25520618e0">&#9670;&nbsp;</a></span>TLS_CRYPT_PID_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_PID_SIZE&#160;&#160;&#160;(sizeof(<a class="el" href="packet__id_8h.html#a345f753b1c6ea20d24409e769aadb7e6">packet_id_type</a>) + sizeof(<a class="el" href="packet__id_8h.html#a32b361b1d3a0fc2f92ceeff736bba97e">net_time_t</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00090">90</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<a id="ga65e056054468311502b28a13b7b1a3ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga65e056054468311502b28a13b7b1a3ef">&#9670;&nbsp;</a></span>TLS_CRYPT_TAG_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_TAG_SIZE&#160;&#160;&#160;(256/8)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00089">89</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<a id="gad176f609bffbc5f9a85ba1d1533e5fd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad176f609bffbc5f9a85ba1d1533e5fd2">&#9670;&nbsp;</a></span>TLS_CRYPT_V2_CLIENT_KEY_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_V2_CLIENT_KEY_LEN&#160;&#160;&#160;(2048 / 8)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00098">98</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<a id="ga0e3ee15558e2e004eb521863530e76cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0e3ee15558e2e004eb521863530e76cd">&#9670;&nbsp;</a></span>TLS_CRYPT_V2_MAX_B64_METADATA_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_V2_MAX_B64_METADATA_LEN&#160;&#160;&#160;<a class="el" href="base64_8h.html#a6bb9abfbe864e37f2ed40143e1cbcdbe">OPENVPN_BASE64_LENGTH</a>(<a class="el" href="group__tls__crypt.html#gaec2f3a21e8cbef25c45d8f4107a9115e">TLS_CRYPT_V2_MAX_METADATA_LEN</a> - 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00104">104</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<a id="gaec2f3a21e8cbef25c45d8f4107a9115e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaec2f3a21e8cbef25c45d8f4107a9115e">&#9670;&nbsp;</a></span>TLS_CRYPT_V2_MAX_METADATA_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_V2_MAX_METADATA_LEN</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">                                                 (unsigned)(<a class="code" href="group__tls__crypt.html#ga0c94fd45c9f1fdf27e843fde47b5f6eb">TLS_CRYPT_V2_MAX_WKC_LEN</a> \</div>
<div class="line">                                                 - (<a class="code" href="group__tls__crypt.html#gad176f609bffbc5f9a85ba1d1533e5fd2">TLS_CRYPT_V2_CLIENT_KEY_LEN</a> + <a class="code" href="group__tls__crypt.html#gafb0f9976e3233bad47df4efe72c4a0bd">TLS_CRYPT_V2_TAG_SIZE</a> \</div>
<div class="line">                                                    + <span class="keyword">sizeof</span>(<a class="code" href="config-msvc_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a>)))</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00101">101</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<a id="ga0c94fd45c9f1fdf27e843fde47b5f6eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0c94fd45c9f1fdf27e843fde47b5f6eb">&#9670;&nbsp;</a></span>TLS_CRYPT_V2_MAX_WKC_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_V2_MAX_WKC_LEN&#160;&#160;&#160;(1024)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00097">97</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<a id="ga7912dec33dae66135819fefc188d1cb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7912dec33dae66135819fefc188d1cb3">&#9670;&nbsp;</a></span>TLS_CRYPT_V2_SERVER_KEY_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_V2_SERVER_KEY_LEN&#160;&#160;&#160;(sizeof(struct <a class="el" href="structkey.html">key</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00099">99</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<a id="gafb0f9976e3233bad47df4efe72c4a0bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafb0f9976e3233bad47df4efe72c4a0bd">&#9670;&nbsp;</a></span>TLS_CRYPT_V2_TAG_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_CRYPT_V2_TAG_SIZE&#160;&#160;&#160;(<a class="el" href="group__tls__crypt.html#ga65e056054468311502b28a13b7b1a3ef">TLS_CRYPT_TAG_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="tls__crypt_8h_source.html#l00100">100</a> of file <a class="el" href="tls__crypt_8h_source.html">tls_crypt.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga24b342111241c5ea9c731de4aa66fcb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga24b342111241c5ea9c731de4aa66fcb2">&#9670;&nbsp;</a></span>tls_crypt_adjust_frame_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_crypt_adjust_frame_parameters </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structframe.html">frame</a> *&#160;</td>
          <td class="paramname"><em>frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjust frame parameters for &ndash;tls-crypt overhead. </p>

<p class="definition">Definition at line <a class="el" href="tls__crypt_8c_source.html#l00098">98</a> of file <a class="el" href="tls__crypt_8c_source.html">tls_crypt.c</a>.</p>

<p class="reference">References <a class="el" href="errlevel_8h_source.html#l00124">D_MTU_DEBUG</a>, <a class="el" href="mtu_8h_source.html#l00274">frame_add_to_extra_frame()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="tls__crypt_8c_source.html#l00077">tls_crypt_buf_overhead()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02814">do_init_crypto_tls()</a>.</p>

</div>
</div>
<a id="gac9c2ecaaf4e2af189ab15bb47a558bfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac9c2ecaaf4e2af189ab15bb47a558bfa">&#9670;&nbsp;</a></span>tls_crypt_buf_overhead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int tls_crypt_buf_overhead </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the maximum overhead (in bytes) added to the destination buffer by <a class="el" href="group__tls__crypt.html#gadaca5f414562a243603a60a0e3158e5a" title="Wrap a control channel packet (both authenticates and encrypts the data).">tls_crypt_wrap()</a>. </p>

<p class="definition">Definition at line <a class="el" href="tls__crypt_8c_source.html#l00077">77</a> of file <a class="el" href="tls__crypt_8c_source.html">tls_crypt.c</a>.</p>

<p class="reference">References <a class="el" href="packet__id_8h_source.html#l00305">packet_id_size()</a>, <a class="el" href="tls__crypt_8h_source.html#l00091">TLS_CRYPT_BLOCK_SIZE</a>, and <a class="el" href="tls__crypt_8h_source.html#l00089">TLS_CRYPT_TAG_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="tls__crypt_8c_source.html#l00098">tls_crypt_adjust_frame_parameters()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00268">tls_crypt_fail_msg_too_long()</a>, and <a class="el" href="test__tls__crypt_8c_source.html#l00246">tls_crypt_loopback_max_len()</a>.</p>

</div>
</div>
<a id="gad1ffd0865c58c744773e5c95e3084cf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad1ffd0865c58c744773e5c95e3084cf3">&#9670;&nbsp;</a></span>tls_crypt_init_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_crypt_init_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>key_inline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>tls_server</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a <a class="el" href="structkey__ctx__bi.html" title="Container for two sets of OpenSSL cipher and/or HMAC contexts for both sending and receiving directio...">key_ctx_bi</a> structure for use with &ndash;tls-crypt. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>The key context to initialize </td></tr>
    <tr><td class="paramname">key_file</td><td>The file to read the key from or the key itself if key_inline is true. </td></tr>
    <tr><td class="paramname">key_inline</td><td>True if key_file contains an inline key, False otherwise. </td></tr>
    <tr><td class="paramname">tls_server</td><td>Must be set to true is this is a TLS server instance. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tls__crypt_8c_source.html#l00083">83</a> of file <a class="el" href="tls__crypt_8c_source.html">tls_crypt.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8h_source.html#l00143">key_type::cipher</a>, <a class="el" href="crypto_8c_source.html#l01175">crypto_read_openvpn_key()</a>, <a class="el" href="crypto_8h_source.html#l00144">key_type::digest</a>, <a class="el" href="crypto_8h_source.html#l00175">KEY_DIRECTION_INVERSE</a>, <a class="el" href="crypto_8h_source.html#l00174">KEY_DIRECTION_NORMAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="tls__crypt_8c_source.html#l00053">tls_crypt_kt()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02638">do_init_tls_wrap_key()</a>.</p>

</div>
</div>
<a id="ga81c822ba2e5599865dddb37e01a2c20c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga81c822ba2e5599865dddb37e01a2c20c">&#9670;&nbsp;</a></span>tls_crypt_unwrap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tls_crypt_unwrap </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcrypto__options.html">crypto_options</a> *&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unwrap a control channel packet (decrypts, authenticates and performs replay checks). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Data to decrypt and authenticate. </td></tr>
    <tr><td class="paramname">dst</td><td>Returns the decrypted data, if unwrapping was successful. </td></tr>
    <tr><td class="paramname">opt</td><td>The crypto state for this &ndash;tls-crypt instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true iff unwrapping succeeded (data authenticated correctly and was no replay). </dd></dl>

<p class="definition">Definition at line <a class="el" href="tls__crypt_8c_source.html#l00185">185</a> of file <a class="el" href="tls__crypt_8c_source.html">tls_crypt.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="buffer_8h_source.html#l00127">BLEN</a>, <a class="el" href="buffer_8h_source.html#l00124">BPTR</a>, <a class="el" href="buffer_8h_source.html#l00623">buf_advance()</a>, <a class="el" href="buffer_8h_source.html#l00595">buf_inc_len()</a>, <a class="el" href="buffer_8h_source.html#l00240">buf_len()</a>, <a class="el" href="buffer_8h_source.html#l00525">buf_safe()</a>, <a class="el" href="crypto_8h_source.html#l00166">key_ctx::cipher</a>, <a class="el" href="crypto__backend_8h.html#ae2189e6f338356e3a497a940ac4a0a32">cipher_ctx_final()</a>, <a class="el" href="crypto__backend_8h.html#ad42b9bea282ea0b9489d7d1e427cdb1a">cipher_ctx_reset()</a>, <a class="el" href="crypto__backend_8h.html#a01630447f2e7d79d187a092a2dfda9ab">cipher_ctx_update()</a>, <a class="el" href="crypto_8h_source.html#l00248">CO_IGNORE_PACKET_ID</a>, <a class="el" href="crypto_8h_source.html#l00261">CRYPT_ERROR</a>, <a class="el" href="crypto_8c_source.html#l00319">crypto_check_replay()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00226">crypto_clear_error()</a>, <a class="el" href="errlevel_8h_source.html#l00146">D_CRYPTO_DEBUG</a>, <a class="el" href="errlevel_8h_source.html#l00166">D_PACKET_CONTENT</a>, <a class="el" href="crypto_8h_source.html#l00223">key_ctx_bi::decrypt</a>, <a class="el" href="openvpn_2error_8h_source.html#l00171">dmsg</a>, <a class="el" href="compat-lz4_8h_source.html#l00712">dst</a>, <a class="el" href="crypto_8h_source.html#l00257">crypto_options::flags</a>, <a class="el" href="buffer_8h_source.html#l00510">format_hex()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01011">gc_init()</a>, <a class="el" href="crypto_8h_source.html#l00167">key_ctx::hmac</a>, <a class="el" href="crypto__backend_8h.html#a253c2c692da0d3706ca0f2ac5628a90e">hmac_ctx_final()</a>, <a class="el" href="crypto__backend_8h.html#a11227ed744de3ec49ba41ebe20aecb7b">hmac_ctx_reset()</a>, <a class="el" href="crypto__backend_8h.html#a0a5053c34da29530f5ec4dd8a7ed8009">hmac_ctx_update()</a>, <a class="el" href="crypto_8h_source.html#l00234">crypto_options::key_ctx_bi</a>, <a class="el" href="buffer_8h_source.html#l00066">buffer::len</a>, <a class="el" href="crypto__openssl_8c_source.html#l01167">memcmp_constant_time()</a>, <a class="el" href="crypto_8h_source.html#l00238">crypto_options::packet_id</a>, <a class="el" href="packet__id_8h_source.html#l00274">packet_id_initialized()</a>, <a class="el" href="packet__id_8c_source.html#l00301">packet_id_read()</a>, <a class="el" href="tls__crypt_8h_source.html#l00091">TLS_CRYPT_BLOCK_SIZE</a>, <a class="el" href="tls__crypt_8h_source.html#l00095">TLS_CRYPT_OFF_CT</a>, <a class="el" href="tls__crypt_8h_source.html#l00093">TLS_CRYPT_OFF_PID</a>, <a class="el" href="tls__crypt_8h_source.html#l00094">TLS_CRYPT_OFF_TAG</a>, and <a class="el" href="tls__crypt_8h_source.html#l00089">TLS_CRYPT_TAG_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l01514">read_control_auth()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00285">tls_crypt_fail_invalid_key()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00305">tls_crypt_fail_replay()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00325">tls_crypt_ignore_replay()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00208">tls_crypt_loopback()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00246">tls_crypt_loopback_max_len()</a>, and <a class="el" href="test__tls__crypt_8c_source.html#l00226">tls_crypt_loopback_zero_len()</a>.</p>

</div>
</div>
<a id="ga2765985ed19e136d6e833a249031b3ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2765985ed19e136d6e833a249031b3ba">&#9670;&nbsp;</a></span>tls_crypt_v2_extract_client_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tls_crypt_v2_extract_client_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structtls__wrap__ctx.html">tls_wrap_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structtls__options.html">tls_options</a> *&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract a tls-crypt-v2 client key from a P_CONTROL_HARD_RESET_CLIENT_V3 message, and load the key into the supplied tls wrap context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>Buffer containing a received P_CONTROL_HARD_RESET_CLIENT_V3 message. </td></tr>
    <tr><td class="paramname">ctx</td><td>tls-wrap context to be initialized with the client key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if a key was successfully extracted. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tls__crypt_8c_source.html#l00573">573</a> of file <a class="el" href="tls__crypt_8c_source.html">tls_crypt.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00064">alloc_buf()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="buffer_8h_source.html#l00125">BEND</a>, <a class="el" href="buffer_8h_source.html#l00127">BLEN</a>, <a class="el" href="buffer_8h_source.html#l00623">buf_advance()</a>, <a class="el" href="buffer_8h_source.html#l00595">buf_inc_len()</a>, <a class="el" href="crypto_8h_source.html#l00166">key_ctx::cipher</a>, <a class="el" href="ssl__common_8h_source.html#l00236">tls_wrap_ctx::cleanup_key_ctx</a>, <a class="el" href="crypto_8h_source.html#l00245">CO_PACKET_ID_LONG_FORM</a>, <a class="el" href="errlevel_8h_source.html#l00072">D_HANDSHAKE</a>, <a class="el" href="errlevel_8h_source.html#l00059">D_TLS_ERRORS</a>, <a class="el" href="crypto_8h_source.html#l00257">crypto_options::flags</a>, <a class="el" href="crypto_8h_source.html#l00234">crypto_options::key_ctx_bi</a>, <a class="el" href="structtls__wrap__ctx.html#a26648735a6e3a08455ad8191dad8f119">tls_wrap_ctx::mode</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="ssl__common_8h_source.html#l00230">tls_wrap_ctx::opt</a>, <a class="el" href="buffer_8h_source.html#l00401">secure_memzero()</a>, <a class="el" href="tls__crypt_8c_source.html#l00285">tls_crypt_v2_load_client_key()</a>, <a class="el" href="tls__crypt_8h_source.html#l00101">TLS_CRYPT_V2_MAX_METADATA_LEN</a>, <a class="el" href="ssl__common_8h_source.html#l00235">tls_wrap_ctx::tls_crypt_v2_metadata</a>, <a class="el" href="ssl__common_8h_source.html#l00232">tls_wrap_ctx::tls_crypt_v2_server_key</a>, <a class="el" href="tls__crypt_8c_source.html#l00405">tls_crypt_v2_unwrap_client_key()</a>, <a class="el" href="tls__crypt_8c_source.html#l00514">tls_crypt_v2_verify_metadata()</a>, and <a class="el" href="ssl__common_8h_source.html#l00307">tls_options::tls_crypt_v2_verify_script</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l01514">read_control_auth()</a>, and <a class="el" href="test__tls__crypt_8c_source.html#l00431">tls_crypt_v2_wrap_unwrap_max_metadata()</a>.</p>

</div>
</div>
<a id="ga5cbcf02978d6d2200ec5fbd645d6646c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5cbcf02978d6d2200ec5fbd645d6646c">&#9670;&nbsp;</a></span>tls_crypt_v2_init_client_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_crypt_v2_init_client_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>wrapped_key_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>key_inline</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a tls-crypt-v2 client key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Key structure to be initialized with the client key. </td></tr>
    <tr><td class="paramname">wrapped_key_buf</td><td>Returns buffer containing the wrapped key that will be sent to the server when connecting. Caller must free this buffer when no longer needed. </td></tr>
    <tr><td class="paramname">key_file</td><td>File path of the key file to load or the key itself if key_inline is true. </td></tr>
    <tr><td class="paramname">key_inline</td><td>True if key_file contains an inline key, False otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tls__crypt_8c_source.html#l00300">300</a> of file <a class="el" href="tls__crypt_8c_source.html">tls_crypt.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00064">alloc_buf()</a>, <a class="el" href="buffer_8h_source.html#l00784">buf_read()</a>, <a class="el" href="crypto_8h_source.html#l00185">key2::keys</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="crypto_8c_source.html#l01913">read_pem_key_file()</a>, <a class="el" href="buffer_8h_source.html#l00401">secure_memzero()</a>, <a class="el" href="tls__crypt_8c_source.html#l00044">tls_crypt_v2_cli_pem_name</a>, <a class="el" href="tls__crypt_8h_source.html#l00098">TLS_CRYPT_V2_CLIENT_KEY_LEN</a>, <a class="el" href="tls__crypt_8c_source.html#l00285">tls_crypt_v2_load_client_key()</a>, and <a class="el" href="tls__crypt_8h_source.html#l00097">TLS_CRYPT_V2_MAX_WKC_LEN</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02638">do_init_tls_wrap_key()</a>, and <a class="el" href="tls__crypt_8c_source.html#l00642">tls_crypt_v2_write_client_key_file()</a>.</p>

</div>
</div>
<a id="ga793fa02bdff7c0df6d31b493c8df32aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga793fa02bdff7c0df6d31b493c8df32aa">&#9670;&nbsp;</a></span>tls_crypt_v2_init_server_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_crypt_v2_init_server_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey__ctx.html">key_ctx</a> *&#160;</td>
          <td class="paramname"><em>key_ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>encrypt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>key_inline</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a tls-crypt-v2 server key (used to encrypt/decrypt client keys). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>Key structure to be initialized. Must be non-NULL. @parem encrypt If true, initialize the key structure for encryption, otherwise for decryption. </td></tr>
    <tr><td class="paramname">key_file</td><td>File path of the key file to load or the key itself if key_inline is true. </td></tr>
    <tr><td class="paramname">key_inline</td><td>True if key_file contains an inline key, False otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tls__crypt_8c_source.html#l00325">325</a> of file <a class="el" href="tls__crypt_8c_source.html">tls_crypt.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l00318">buf_set_write()</a>, <a class="el" href="crypto_8h_source.html#l00143">key_type::cipher</a>, <a class="el" href="crypto_8h_source.html#l00144">key_type::digest</a>, <a class="el" href="crypto_8c_source.html#l00823">init_key_ctx()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="crypto_8c_source.html#l01913">read_pem_key_file()</a>, <a class="el" href="buffer_8h_source.html#l00401">secure_memzero()</a>, <a class="el" href="tls__crypt_8c_source.html#l00053">tls_crypt_kt()</a>, and <a class="el" href="tls__crypt_8c_source.html#l00045">tls_crypt_v2_srv_pem_name</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02638">do_init_tls_wrap_key()</a>, and <a class="el" href="tls__crypt_8c_source.html#l00642">tls_crypt_v2_write_client_key_file()</a>.</p>

</div>
</div>
<a id="ga7c2e1553c38344d7858a9dcf062f7f54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7c2e1553c38344d7858a9dcf062f7f54">&#9670;&nbsp;</a></span>tls_crypt_v2_write_client_key_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_crypt_v2_write_client_key_file </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>b64_metadata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>key_inline</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a tls-crypt-v2 client key, and write to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Filename of the client key file to create. </td></tr>
    <tr><td class="paramname">b64_metadata</td><td>Base64 metadata to be included in the client key. </td></tr>
    <tr><td class="paramname">key_file</td><td>File path of the server key to use for wrapping the client key or the key itself if key_inline is true. </td></tr>
    <tr><td class="paramname">key_inline</td><td>True if key_file contains an inline key, False otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tls__crypt_8c_source.html#l00642">642</a> of file <a class="el" href="tls__crypt_8c_source.html">tls_crypt.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00090">alloc_buf_gc()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="buffer_8h_source.html#l00130">BCAP</a>, <a class="el" href="buffer_8h_source.html#l00125">BEND</a>, <a class="el" href="buffer_8h_source.html#l00127">BLEN</a>, <a class="el" href="buffer_8h_source.html#l00124">BPTR</a>, <a class="el" href="buffer_8c_source.html#l00164">buf_clear()</a>, <a class="el" href="buffer_8h_source.html#l00595">buf_inc_len()</a>, <a class="el" href="buffer_8h_source.html#l00673">buf_write()</a>, <a class="el" href="buffer_8c_source.html#l00349">buffer_write_file()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00442">crypto_pem_encode()</a>, <a class="el" href="errlevel_8h_source.html#l00079">D_GENKEY</a>, <a class="el" href="compat-lz4_8h_source.html#l00712">dst</a>, <a class="el" href="buffer_8c_source.html#l00185">free_buf()</a>, <a class="el" href="crypto_8c_source.html#l00891">free_key_ctx()</a>, <a class="el" href="crypto_8c_source.html#l00908">free_key_ctx_bi()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="integer_8h_source.html#l00030">htonll</a>, <a class="el" href="crypto_8h_source.html#l00185">key2::keys</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="otime_8c_source.html#l00036">now</a>, <a class="el" href="src_2openvpn_2base64_8c_source.html#l00160">openvpn_base64_decode()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00532">rand_bytes()</a>, <a class="el" href="buffer_8h_source.html#l00401">secure_memzero()</a>, <a class="el" href="options_8h_source.html#l00669">streq</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00059">test_client_key</a>, <a class="el" href="tls__crypt_8c_source.html#l00050">TLS_CRYPT_METADATA_TYPE_TIMESTAMP</a>, <a class="el" href="tls__crypt_8c_source.html#l00048">TLS_CRYPT_METADATA_TYPE_USER</a>, <a class="el" href="tls__crypt_8c_source.html#l00044">tls_crypt_v2_cli_pem_name</a>, <a class="el" href="tls__crypt_8h_source.html#l00098">TLS_CRYPT_V2_CLIENT_KEY_LEN</a>, <a class="el" href="tls__crypt_8c_source.html#l00300">tls_crypt_v2_init_client_key()</a>, <a class="el" href="tls__crypt_8c_source.html#l00325">tls_crypt_v2_init_server_key()</a>, <a class="el" href="tls__crypt_8h_source.html#l00104">TLS_CRYPT_V2_MAX_B64_METADATA_LEN</a>, <a class="el" href="tls__crypt_8h_source.html#l00101">TLS_CRYPT_V2_MAX_METADATA_LEN</a>, <a class="el" href="tls__crypt_8h_source.html#l00097">TLS_CRYPT_V2_MAX_WKC_LEN</a>, <a class="el" href="tls__crypt_8c_source.html#l00405">tls_crypt_v2_unwrap_client_key()</a>, and <a class="el" href="tls__crypt_8c_source.html#l00348">tls_crypt_v2_wrap_client_key()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l01101">do_genkey()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00559">test_tls_crypt_v2_write_client_key_file()</a>, and <a class="el" href="test__tls__crypt_8c_source.html#l00577">test_tls_crypt_v2_write_client_key_file_metadata()</a>.</p>

</div>
</div>
<a id="gabc1250a0d15da5d5b50f49f1aec7ef19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabc1250a0d15da5d5b50f49f1aec7ef19">&#9670;&nbsp;</a></span>tls_crypt_v2_write_server_key_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tls_crypt_v2_write_server_key_file </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a tls-crypt-v2 server key, and write to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Filename of the server key file to create. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tls__crypt_8c_source.html#l00636">636</a> of file <a class="el" href="tls__crypt_8c_source.html">tls_crypt.c</a>.</p>

<p class="reference">References <a class="el" href="tls__crypt_8c_source.html#l00045">tls_crypt_v2_srv_pem_name</a>, and <a class="el" href="crypto_8c_source.html#l01857">write_pem_key_file()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l01101">do_genkey()</a>, and <a class="el" href="test__tls__crypt_8c_source.html#l00546">test_tls_crypt_v2_write_server_key_file()</a>.</p>

</div>
</div>
<a id="gadaca5f414562a243603a60a0e3158e5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadaca5f414562a243603a60a0e3158e5a">&#9670;&nbsp;</a></span>tls_crypt_wrap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tls_crypt_wrap </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcrypto__options.html">crypto_options</a> *&#160;</td>
          <td class="paramname"><em>opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrap a control channel packet (both authenticates and encrypts the data). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Data to authenticate and encrypt. </td></tr>
    <tr><td class="paramname">dst</td><td>Any data present in this buffer is first authenticated, then the wrapped packet id and data from the src buffer are appended. Must have at least <a class="el" href="group__tls__crypt.html#gac9c2ecaaf4e2af189ab15bb47a558bfa" title="Returns the maximum overhead (in bytes) added to the destination buffer by tls_crypt_wrap().">tls_crypt_buf_overhead()</a>+<a class="el" href="buffer_8h.html#ab7be565801383d9f7371ab9a6aa99077">BLEN(src)</a> headroom. </td></tr>
    <tr><td class="paramname">opt</td><td>The crypto state for this &ndash;tls-crypt instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true iff wrapping succeeded. </dd></dl>

<p class="definition">Definition at line <a class="el" href="tls__crypt_8c_source.html#l00108">108</a> of file <a class="el" href="tls__crypt_8c_source.html">tls_crypt.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="buffer_8h_source.html#l00125">BEND</a>, <a class="el" href="buffer_8h_source.html#l00127">BLEN</a>, <a class="el" href="buffer_8h_source.html#l00124">BPTR</a>, <a class="el" href="buffer_8h_source.html#l00595">buf_inc_len()</a>, <a class="el" href="buffer_8h_source.html#l00525">buf_safe()</a>, <a class="el" href="buffer_8h_source.html#l00640">buf_write_alloc()</a>, <a class="el" href="buffer_8h_source.html#l00062">buffer::capacity</a>, <a class="el" href="crypto_8h_source.html#l00166">key_ctx::cipher</a>, <a class="el" href="crypto__backend_8h.html#ae2189e6f338356e3a497a940ac4a0a32">cipher_ctx_final()</a>, <a class="el" href="crypto__backend_8h.html#ad42b9bea282ea0b9489d7d1e427cdb1a">cipher_ctx_reset()</a>, <a class="el" href="crypto__backend_8h.html#a01630447f2e7d79d187a092a2dfda9ab">cipher_ctx_update()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00226">crypto_clear_error()</a>, <a class="el" href="errlevel_8h_source.html#l00058">D_CRYPT_ERRORS</a>, <a class="el" href="errlevel_8h_source.html#l00166">D_PACKET_CONTENT</a>, <a class="el" href="openvpn_2error_8h_source.html#l00171">dmsg</a>, <a class="el" href="compat-lz4_8h_source.html#l00712">dst</a>, <a class="el" href="crypto_8h_source.html#l00221">key_ctx_bi::encrypt</a>, <a class="el" href="buffer_8h_source.html#l00510">format_hex()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01011">gc_init()</a>, <a class="el" href="crypto_8h_source.html#l00167">key_ctx::hmac</a>, <a class="el" href="crypto__backend_8h.html#a253c2c692da0d3706ca0f2ac5628a90e">hmac_ctx_final()</a>, <a class="el" href="crypto__backend_8h.html#a11227ed744de3ec49ba41ebe20aecb7b">hmac_ctx_reset()</a>, <a class="el" href="crypto__backend_8h.html#a8625131329a13b2097ccacb82c83b3fe">hmac_ctx_size()</a>, <a class="el" href="crypto__backend_8h.html#a0a5053c34da29530f5ec4dd8a7ed8009">hmac_ctx_update()</a>, <a class="el" href="crypto_8h_source.html#l00234">crypto_options::key_ctx_bi</a>, <a class="el" href="buffer_8h_source.html#l00066">buffer::len</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="buffer_8h_source.html#l00064">buffer::offset</a>, <a class="el" href="crypto_8h_source.html#l00238">crypto_options::packet_id</a>, <a class="el" href="packet__id_8h_source.html#l00274">packet_id_initialized()</a>, <a class="el" href="packet__id_8c_source.html#l00349">packet_id_write()</a>, <a class="el" href="packet__id_8h_source.html#l00207">packet_id::send</a>, <a class="el" href="tls__crypt_8h_source.html#l00091">TLS_CRYPT_BLOCK_SIZE</a>, and <a class="el" href="tls__crypt_8h_source.html#l00089">TLS_CRYPT_TAG_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__tls__crypt_8c_source.html#l00285">tls_crypt_fail_invalid_key()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00268">tls_crypt_fail_msg_too_long()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00305">tls_crypt_fail_replay()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00325">tls_crypt_ignore_replay()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00208">tls_crypt_loopback()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00246">tls_crypt_loopback_max_len()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00226">tls_crypt_loopback_zero_len()</a>, and <a class="el" href="ssl_8c_source.html#l01452">write_control_auth()</a>.</p>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="agroup__tls__crypt_html_ga0c94fd45c9f1fdf27e843fde47b5f6eb"><div class="ttname"><a href="group__tls__crypt.html#ga0c94fd45c9f1fdf27e843fde47b5f6eb">TLS_CRYPT_V2_MAX_WKC_LEN</a></div><div class="ttdeci">#define TLS_CRYPT_V2_MAX_WKC_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls__crypt_8h_source.html#l00097">tls_crypt.h:97</a></div></div>
<div class="ttc" id="agroup__tls__crypt_html_gafb0f9976e3233bad47df4efe72c4a0bd"><div class="ttname"><a href="group__tls__crypt.html#gafb0f9976e3233bad47df4efe72c4a0bd">TLS_CRYPT_V2_TAG_SIZE</a></div><div class="ttdeci">#define TLS_CRYPT_V2_TAG_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="tls__crypt_8h_source.html#l00100">tls_crypt.h:100</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a30af71eaf40c925c9832eb289a48da35"><div class="ttname"><a href="config-msvc_8h.html#a30af71eaf40c925c9832eb289a48da35">uint16_t</a></div><div class="ttdeci">unsigned __int16 uint16_t</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00163">config-msvc.h:163</a></div></div>
<div class="ttc" id="agroup__tls__crypt_html_gad176f609bffbc5f9a85ba1d1533e5fd2"><div class="ttname"><a href="group__tls__crypt.html#gad176f609bffbc5f9a85ba1d1533e5fd2">TLS_CRYPT_V2_CLIENT_KEY_LEN</a></div><div class="ttdeci">#define TLS_CRYPT_V2_CLIENT_KEY_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls__crypt_8h_source.html#l00098">tls_crypt.h:98</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
