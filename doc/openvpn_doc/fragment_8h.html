<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: src/openvpn/fragment.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_92f13d409beef24f5ba1b81abfed1f1c.html">openvpn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fragment.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buffer_8h_source.html">buffer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="interval_8h_source.html">interval.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mtu_8h_source.html">mtu.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="shaper_8h_source.html">shaper.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="openvpn_2error_8h_source.html">error.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for fragment.h:</div>
<div class="dyncontent">
<div class="center"><img src="fragment_8h__incl.png" border="0" usemap="#src_2openvpn_2fragment_8h" alt=""/></div>
<map name="src_2openvpn_2fragment_8h" id="src_2openvpn_2fragment_8h">
<area shape="rect" title=" " alt="" coords="263,5,421,32"/>
<area shape="rect" href="common_8h.html" title=" " alt="" coords="399,304,482,331"/>
<area shape="rect" href="buffer_8h.html" title=" " alt="" coords="553,379,619,405"/>
<area shape="rect" href="openvpn_2error_8h.html" title=" " alt="" coords="197,453,255,480"/>
<area shape="rect" href="interval_8h.html" title=" " alt="" coords="255,155,330,181"/>
<area shape="rect" href="mtu_8h.html" title=" " alt="" coords="576,80,631,107"/>
<area shape="rect" href="shaper_8h.html" title=" " alt="" coords="207,80,279,107"/>
<area shape="rect" href="openvpn_2basic_8h.html" title=" " alt="" coords="754,528,818,555"/>
<area shape="rect" title=" " alt="" coords="5,528,68,555"/>
<area shape="rect" title=" " alt="" coords="93,528,167,555"/>
<area shape="rect" title=" " alt="" coords="191,528,261,555"/>
<area shape="rect" href="errlevel_8h.html" title=" " alt="" coords="285,528,359,555"/>
<area shape="rect" href="otime_8h.html" title=" " alt="" coords="264,229,329,256"/>
<area shape="rect" href="integer_8h.html" title=" " alt="" coords="190,304,262,331"/>
<area shape="rect" href="misc_8h.html" title=" " alt="" coords="514,155,575,181"/>
<area shape="rect" href="argv_8h.html" title=" " alt="" coords="557,304,615,331"/>
<area shape="rect" href="env__set_8h.html" title=" " alt="" coords="608,229,687,256"/>
<area shape="rect" href="platform_8h.html" title=" " alt="" coords="791,304,871,331"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="fragment_8h__dep__incl.png" border="0" usemap="#src_2openvpn_2fragment_8hdep" alt=""/></div>
<map name="src_2openvpn_2fragment_8hdep" id="src_2openvpn_2fragment_8hdep">
<area shape="rect" title=" " alt="" coords="1893,5,2052,32"/>
<area shape="rect" href="openvpn_8h.html" title=" " alt="" coords="1803,80,1961,107"/>
<area shape="rect" href="fragment_8c.html" title=" " alt="" coords="1985,80,2144,107"/>
<area shape="rect" href="auth__token_8c.html" title=" " alt="" coords="5,319,177,345"/>
<area shape="rect" href="forward_8h.html" title=" " alt="" coords="1121,155,1272,181"/>
<area shape="rect" href="sig_8c.html" title=" " alt="" coords="2194,319,2319,345"/>
<area shape="rect" href="socket_8c.html" title=" " alt="" coords="1542,237,1689,263"/>
<area shape="rect" href="init_8h.html" title=" " alt="" coords="1819,155,1945,181"/>
<area shape="rect" href="vlan_8h.html" title=" " alt="" coords="1997,155,2129,181"/>
<area shape="rect" href="ssl__ncp_8c.html" title=" " alt="" coords="2391,155,2544,181"/>
<area shape="rect" href="test__auth__token_8c.html" title=" " alt="" coords="9,393,174,435"/>
<area shape="rect" href="push_8h.html" title=" " alt="" coords="715,237,851,263"/>
<area shape="rect" href="forward_8c.html" title=" " alt="" coords="1044,319,1195,345"/>
<area shape="rect" href="helper_8c.html" title=" " alt="" coords="376,319,519,345"/>
<area shape="rect" href="multi_8c.html" title=" " alt="" coords="1526,319,1662,345"/>
<area shape="rect" href="options_8c.html" title=" " alt="" coords="201,319,352,345"/>
<area shape="rect" href="occ_8h.html" title=" " alt="" coords="977,237,1107,263"/>
<area shape="rect" href="init_8c.html" title=" " alt="" coords="1219,319,1345,345"/>
<area shape="rect" href="occ_8c.html" title=" " alt="" coords="891,319,1020,345"/>
<area shape="rect" href="ping_8h.html" title=" " alt="" coords="1183,237,1315,263"/>
<area shape="rect" href="multi_8h.html" title=" " alt="" coords="2025,237,2161,263"/>
<area shape="rect" href="mtcp_8c.html" title=" " alt="" coords="1687,319,1824,345"/>
<area shape="rect" href="mudp_8c.html" title=" " alt="" coords="1848,319,1988,345"/>
<area shape="rect" href="openvpn_8c.html" title=" " alt="" coords="2013,319,2170,345"/>
<area shape="rect" href="proxy_8c.html" title=" " alt="" coords="502,237,641,263"/>
<area shape="rect" href="push_8c.html" title=" " alt="" coords="543,319,679,345"/>
<area shape="rect" href="ssl__verify_8c.html" title=" " alt="" coords="703,319,866,345"/>
<area shape="rect" href="ping_8c.html" title=" " alt="" coords="1369,319,1501,345"/>
<area shape="rect" href="vlan_8c.html" title=" " alt="" coords="2344,319,2476,345"/>
<area shape="rect" href="openvpn_2error_8c.html" title=" " alt="" coords="1815,237,1949,263"/>
<area shape="rect" href="test__ncp_8c.html" title=" " alt="" coords="2387,229,2553,271"/>
</map>
</div>
</div>
<p><a href="fragment_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfragment.html">fragment</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for reassembling one incoming fragmented packet.  <a href="structfragment.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfragment__list.html">fragment_list</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of fragment structures for reassembling multiple incoming packets concurrently.  <a href="structfragment__list.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfragment__master.html">fragment_master</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fragmentation and reassembly state for one VPN tunnel instance.  <a href="structfragment__master.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gac70c6ff35b69110fa3f80d39cb31095a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gac70c6ff35b69110fa3f80d39cb31095a">N_FRAG_BUF</a>&#160;&#160;&#160;25</td></tr>
<tr class="memdesc:gac70c6ff35b69110fa3f80d39cb31095a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of packet buffers for reassembling incoming fragmented packets.  <a href="group__fragmentation.html#gac70c6ff35b69110fa3f80d39cb31095a">More...</a><br /></td></tr>
<tr class="separator:gac70c6ff35b69110fa3f80d39cb31095a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0734e22cc0aead1c3f72118a37fd6954"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga0734e22cc0aead1c3f72118a37fd6954">FRAG_TTL_SEC</a>&#160;&#160;&#160;10</td></tr>
<tr class="memdesc:ga0734e22cc0aead1c3f72118a37fd6954"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time-to-live in seconds for a fragment.  <a href="group__fragmentation.html#ga0734e22cc0aead1c3f72118a37fd6954">More...</a><br /></td></tr>
<tr class="separator:ga0734e22cc0aead1c3f72118a37fd6954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac80975ec6bf6ea0417f924b37fb56fdc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gac80975ec6bf6ea0417f924b37fb56fdc">FRAG_WAKEUP_INTERVAL</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:gac80975ec6bf6ea0417f924b37fb56fdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interval in seconds between calls to wakeup code.  <a href="group__fragmentation.html#gac80975ec6bf6ea0417f924b37fb56fdc">More...</a><br /></td></tr>
<tr class="separator:gac80975ec6bf6ea0417f924b37fb56fdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa887b9882c0901330e5d7ee4132b0fa2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fragment_8h.html#aa887b9882c0901330e5d7ee4132b0fa2">FRAG_MAP_MASK</a>&#160;&#160;&#160;0xFFFFFFFF</td></tr>
<tr class="memdesc:aa887b9882c0901330e5d7ee4132b0fa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mask for reassembly map.  <a href="fragment_8h.html#aa887b9882c0901330e5d7ee4132b0fa2">More...</a><br /></td></tr>
<tr class="separator:aa887b9882c0901330e5d7ee4132b0fa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13f1a5ba4de8983b873747c5f15178b1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fragment_8h.html#a13f1a5ba4de8983b873747c5f15178b1">MAX_FRAGS</a>&#160;&#160;&#160;32</td></tr>
<tr class="memdesc:a13f1a5ba4de8983b873747c5f15178b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of fragments per packet.  <a href="fragment_8h.html#a13f1a5ba4de8983b873747c5f15178b1">More...</a><br /></td></tr>
<tr class="separator:a13f1a5ba4de8983b873747c5f15178b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31648c78b7df7103ccd48279bf57a5d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fragment_8h.html#a31648c78b7df7103ccd48279bf57a5d5">N_SEQ_ID</a>&#160;&#160;&#160;256</td></tr>
<tr class="memdesc:a31648c78b7df7103ccd48279bf57a5d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">One more than the maximum fragment sequence ID, above which the IDs wrap to zero.  <a href="fragment_8h.html#a31648c78b7df7103ccd48279bf57a5d5">More...</a><br /></td></tr>
<tr class="separator:a31648c78b7df7103ccd48279bf57a5d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae01d83e01152b50bd153c9f33b97f0d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fragment_8h.html#ae01d83e01152b50bd153c9f33b97f0d5">MAX_FRAG_PKT_SIZE</a>&#160;&#160;&#160;65536</td></tr>
<tr class="memdesc:ae01d83e01152b50bd153c9f33b97f0d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">(Not used) Maximum packet size before fragmenting.  <a href="fragment_8h.html#ae01d83e01152b50bd153c9f33b97f0d5">More...</a><br /></td></tr>
<tr class="separator:ae01d83e01152b50bd153c9f33b97f0d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gacf00a549c0d55a864584b128cd1d1927"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gacf00a549c0d55a864584b128cd1d1927">fragment_wakeup</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f, struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="separator:gacf00a549c0d55a864584b128cd1d1927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Functions for initialization and cleanup</div></td></tr>
<tr class="memitem:ga0be982cb04c4e5c3344d8f91323f4d8c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structfragment__master.html">fragment_master</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga0be982cb04c4e5c3344d8f91323f4d8c">fragment_init</a> (struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:ga0be982cb04c4e5c3344d8f91323f4d8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and initialize a <code><a class="el" href="structfragment__master.html" title="Fragmentation and reassembly state for one VPN tunnel instance.">fragment_master</a></code> structure.  <a href="group__fragmentation.html#ga0be982cb04c4e5c3344d8f91323f4d8c">More...</a><br /></td></tr>
<tr class="separator:ga0be982cb04c4e5c3344d8f91323f4d8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga78eb641be3402b8db31607baba604e62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga78eb641be3402b8db31607baba604e62">fragment_frame_init</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:ga78eb641be3402b8db31607baba604e62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate internal packet buffers for a <code><a class="el" href="structfragment__master.html" title="Fragmentation and reassembly state for one VPN tunnel instance.">fragment_master</a></code> structure.  <a href="group__fragmentation.html#ga78eb641be3402b8db31607baba604e62">More...</a><br /></td></tr>
<tr class="separator:ga78eb641be3402b8db31607baba604e62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae6f7daf38cb2c0edaa6dbdfeabddb826"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gae6f7daf38cb2c0edaa6dbdfeabddb826">fragment_free</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f)</td></tr>
<tr class="memdesc:gae6f7daf38cb2c0edaa6dbdfeabddb826"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a <code><a class="el" href="structfragment__master.html" title="Fragmentation and reassembly state for one VPN tunnel instance.">fragment_master</a></code> structure and its internal packet buffers.  <a href="group__fragmentation.html#gae6f7daf38cb2c0edaa6dbdfeabddb826">More...</a><br /></td></tr>
<tr class="separator:gae6f7daf38cb2c0edaa6dbdfeabddb826"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Functions for processing packets received from a remote OpenVPN peer</div></td></tr>
<tr class="memitem:gaa1048bcf1d77edd2762193d3c26e5a63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gaa1048bcf1d77edd2762193d3c26e5a63">fragment_incoming</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f, struct <a class="el" href="structbuffer.html">buffer</a> *buf, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:gaa1048bcf1d77edd2762193d3c26e5a63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process an incoming packet, which may or may not be fragmented.  <a href="group__fragmentation.html#gaa1048bcf1d77edd2762193d3c26e5a63">More...</a><br /></td></tr>
<tr class="separator:gaa1048bcf1d77edd2762193d3c26e5a63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Functions for processing packets to be sent to a remote OpenVPN peer</div></td></tr>
<tr class="memitem:ga8d431d13746c625db07ffbef8fdb4b63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga8d431d13746c625db07ffbef8fdb4b63">fragment_outgoing</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f, struct <a class="el" href="structbuffer.html">buffer</a> *buf, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:ga8d431d13746c625db07ffbef8fdb4b63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process an outgoing packet, which may or may not need to be fragmented.  <a href="group__fragmentation.html#ga8d431d13746c625db07ffbef8fdb4b63">More...</a><br /></td></tr>
<tr class="separator:ga8d431d13746c625db07ffbef8fdb4b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafee718405669b72a316b31225da38485"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gafee718405669b72a316b31225da38485">fragment_ready_to_send</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f, struct <a class="el" href="structbuffer.html">buffer</a> *buf, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:gafee718405669b72a316b31225da38485"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether outgoing fragments are ready to be send, and if so make one available.  <a href="group__fragmentation.html#gafee718405669b72a316b31225da38485">More...</a><br /></td></tr>
<tr class="separator:gafee718405669b72a316b31225da38485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7e459710a8c1f5d5f8446d92106119b0"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga7e459710a8c1f5d5f8446d92106119b0">fragment_outgoing_defined</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f)</td></tr>
<tr class="memdesc:ga7e459710a8c1f5d5f8446d92106119b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether a <code><a class="el" href="structfragment__master.html" title="Fragmentation and reassembly state for one VPN tunnel instance.">fragment_master</a></code> structure contains fragments ready to be sent.  <a href="group__fragmentation.html#ga7e459710a8c1f5d5f8446d92106119b0">More...</a><br /></td></tr>
<tr class="separator:ga7e459710a8c1f5d5f8446d92106119b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Functions for regular housekeeping</div></td></tr>
<tr class="memitem:ga6e041de3847f4dceb3d17413d9fb6cd8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga6e041de3847f4dceb3d17413d9fb6cd8">fragment_housekeeping</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f, struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>, struct timeval *tv)</td></tr>
<tr class="memdesc:ga6e041de3847f4dceb3d17413d9fb6cd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform housekeeping of a <code><a class="el" href="structfragment__master.html" title="Fragmentation and reassembly state for one VPN tunnel instance.">fragment_master</a></code> structure.  <a href="group__fragmentation.html#ga6e041de3847f4dceb3d17413d9fb6cd8">More...</a><br /></td></tr>
<tr class="separator:ga6e041de3847f4dceb3d17413d9fb6cd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Fragment header</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrp0de59534d97f2e219f5b65054199c2da"></a> </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Add description of fragment header format.</dd></dl>
</td></tr>
<tr class="memitem:ga01f33477e16b4dc5aaa209e6c19d75fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga01f33477e16b4dc5aaa209e6c19d75fd">hton_fragment_header_type</a>(x)&#160;&#160;&#160;htonl(x)</td></tr>
<tr class="memdesc:ga01f33477e16b4dc5aaa209e6c19d75fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a fragment_header_type from host to network order.  <a href="group__fragmentation.html#ga01f33477e16b4dc5aaa209e6c19d75fd">More...</a><br /></td></tr>
<tr class="separator:ga01f33477e16b4dc5aaa209e6c19d75fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeaaf50d07d04564c86229dd4da126c25"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gaeaaf50d07d04564c86229dd4da126c25">ntoh_fragment_header_type</a>(x)&#160;&#160;&#160;ntohl(x)</td></tr>
<tr class="memdesc:gaeaaf50d07d04564c86229dd4da126c25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a <code>fragment_header_type</code> from network to host order.  <a href="group__fragmentation.html#gaeaaf50d07d04564c86229dd4da126c25">More...</a><br /></td></tr>
<tr class="separator:gaeaaf50d07d04564c86229dd4da126c25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaadb98fb20038d668245f4b5e36f0e1f2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gaadb98fb20038d668245f4b5e36f0e1f2">FRAG_TYPE_MASK</a>&#160;&#160;&#160;0x00000003</td></tr>
<tr class="memdesc:gaadb98fb20038d668245f4b5e36f0e1f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit mask for fragment type info.  <a href="group__fragmentation.html#gaadb98fb20038d668245f4b5e36f0e1f2">More...</a><br /></td></tr>
<tr class="separator:gaadb98fb20038d668245f4b5e36f0e1f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6c21b2617660c826f3d500246d52b7d1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga6c21b2617660c826f3d500246d52b7d1">FRAG_TYPE_SHIFT</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ga6c21b2617660c826f3d500246d52b7d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit shift for fragment type info.  <a href="group__fragmentation.html#ga6c21b2617660c826f3d500246d52b7d1">More...</a><br /></td></tr>
<tr class="separator:ga6c21b2617660c826f3d500246d52b7d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa3660951c032f02c8dcd6ccdab37e5f2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gaa3660951c032f02c8dcd6ccdab37e5f2">FRAG_WHOLE</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:gaa3660951c032f02c8dcd6ccdab37e5f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fragment type indicating packet is whole.  <a href="group__fragmentation.html#gaa3660951c032f02c8dcd6ccdab37e5f2">More...</a><br /></td></tr>
<tr class="separator:gaa3660951c032f02c8dcd6ccdab37e5f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf0eca0df84e5d201ef805f5bf5eb5f6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gadf0eca0df84e5d201ef805f5bf5eb5f6">FRAG_YES_NOTLAST</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:gadf0eca0df84e5d201ef805f5bf5eb5f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fragment type indicating packet is part of a fragmented packet, but not the last part in the sequence.  <a href="group__fragmentation.html#gadf0eca0df84e5d201ef805f5bf5eb5f6">More...</a><br /></td></tr>
<tr class="separator:gadf0eca0df84e5d201ef805f5bf5eb5f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga95d0b14b610983de2c4992b3090e575b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga95d0b14b610983de2c4992b3090e575b">FRAG_YES_LAST</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga95d0b14b610983de2c4992b3090e575b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fragment type indicating packet is the last part in the sequence of parts.  <a href="group__fragmentation.html#ga95d0b14b610983de2c4992b3090e575b">More...</a><br /></td></tr>
<tr class="separator:ga95d0b14b610983de2c4992b3090e575b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga79fcd096ab99879b56b86266b01a7b59"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga79fcd096ab99879b56b86266b01a7b59">FRAG_TEST</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:ga79fcd096ab99879b56b86266b01a7b59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fragment type not implemented yet.  <a href="group__fragmentation.html#ga79fcd096ab99879b56b86266b01a7b59">More...</a><br /></td></tr>
<tr class="separator:ga79fcd096ab99879b56b86266b01a7b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3effaad37521e90e15f872895425a09f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga3effaad37521e90e15f872895425a09f">FRAG_SEQ_ID_MASK</a>&#160;&#160;&#160;0x000000ff</td></tr>
<tr class="memdesc:ga3effaad37521e90e15f872895425a09f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit mask for fragment sequence ID.  <a href="group__fragmentation.html#ga3effaad37521e90e15f872895425a09f">More...</a><br /></td></tr>
<tr class="separator:ga3effaad37521e90e15f872895425a09f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga33fcfec81e6502bd0683d410da2c8a43"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga33fcfec81e6502bd0683d410da2c8a43">FRAG_SEQ_ID_SHIFT</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga33fcfec81e6502bd0683d410da2c8a43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit shift for fragment sequence ID.  <a href="group__fragmentation.html#ga33fcfec81e6502bd0683d410da2c8a43">More...</a><br /></td></tr>
<tr class="separator:ga33fcfec81e6502bd0683d410da2c8a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf3a43cb119381aa8e7747f8be6f6c049"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gaf3a43cb119381aa8e7747f8be6f6c049">FRAG_ID_MASK</a>&#160;&#160;&#160;0x0000001f</td></tr>
<tr class="memdesc:gaf3a43cb119381aa8e7747f8be6f6c049"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit mask for fragment ID.  <a href="group__fragmentation.html#gaf3a43cb119381aa8e7747f8be6f6c049">More...</a><br /></td></tr>
<tr class="separator:gaf3a43cb119381aa8e7747f8be6f6c049"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa6b49757480dca90db5d906d17f746a8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gaa6b49757480dca90db5d906d17f746a8">FRAG_ID_SHIFT</a>&#160;&#160;&#160;10</td></tr>
<tr class="memdesc:gaa6b49757480dca90db5d906d17f746a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit shift for fragment ID.  <a href="group__fragmentation.html#gaa6b49757480dca90db5d906d17f746a8">More...</a><br /></td></tr>
<tr class="separator:gaa6b49757480dca90db5d906d17f746a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga00d4eb7e42c98ad73c5a4fcb9a95234f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga00d4eb7e42c98ad73c5a4fcb9a95234f">FRAG_SIZE_MASK</a>&#160;&#160;&#160;0x00003fff</td></tr>
<tr class="memdesc:ga00d4eb7e42c98ad73c5a4fcb9a95234f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit mask for fragment size.  <a href="group__fragmentation.html#ga00d4eb7e42c98ad73c5a4fcb9a95234f">More...</a><br /></td></tr>
<tr class="separator:ga00d4eb7e42c98ad73c5a4fcb9a95234f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafbb3b9c37eb42de4e896ca0dfaf616bd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gafbb3b9c37eb42de4e896ca0dfaf616bd">FRAG_SIZE_SHIFT</a>&#160;&#160;&#160;15</td></tr>
<tr class="memdesc:gafbb3b9c37eb42de4e896ca0dfaf616bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit shift for fragment size.  <a href="group__fragmentation.html#gafbb3b9c37eb42de4e896ca0dfaf616bd">More...</a><br /></td></tr>
<tr class="separator:gafbb3b9c37eb42de4e896ca0dfaf616bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa814cc3bc6de2eb908bdc3065cfcb474"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gaa814cc3bc6de2eb908bdc3065cfcb474">FRAG_SIZE_ROUND_SHIFT</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:gaa814cc3bc6de2eb908bdc3065cfcb474"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit shift for fragment size rounding.  <a href="group__fragmentation.html#gaa814cc3bc6de2eb908bdc3065cfcb474">More...</a><br /></td></tr>
<tr class="separator:gaa814cc3bc6de2eb908bdc3065cfcb474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga64d4625277bb54cc9e888f4d2b987070"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga64d4625277bb54cc9e888f4d2b987070">FRAG_SIZE_ROUND_MASK</a>&#160;&#160;&#160;((1 &lt;&lt; <a class="el" href="group__fragmentation.html#gaa814cc3bc6de2eb908bdc3065cfcb474">FRAG_SIZE_ROUND_SHIFT</a>) - 1)</td></tr>
<tr class="memdesc:ga64d4625277bb54cc9e888f4d2b987070"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit mask for fragment size rounding.  <a href="group__fragmentation.html#ga64d4625277bb54cc9e888f4d2b987070">More...</a><br /></td></tr>
<tr class="separator:ga64d4625277bb54cc9e888f4d2b987070"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga86ca315ed1280ba7fc2e8e4030e7d194"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga86ca315ed1280ba7fc2e8e4030e7d194">FRAG_EXTRA_MASK</a>&#160;&#160;&#160;0x0000ffff</td></tr>
<tr class="memdesc:ga86ca315ed1280ba7fc2e8e4030e7d194"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit mask for extra bits.  <a href="group__fragmentation.html#ga86ca315ed1280ba7fc2e8e4030e7d194">More...</a><br /></td></tr>
<tr class="separator:ga86ca315ed1280ba7fc2e8e4030e7d194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga93dd54339aed4e498e3c40fc22be90bf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga93dd54339aed4e498e3c40fc22be90bf">FRAG_EXTRA_SHIFT</a>&#160;&#160;&#160;15</td></tr>
<tr class="memdesc:ga93dd54339aed4e498e3c40fc22be90bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit shift for extra bits.  <a href="group__fragmentation.html#ga93dd54339aed4e498e3c40fc22be90bf">More...</a><br /></td></tr>
<tr class="separator:ga93dd54339aed4e498e3c40fc22be90bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga69167a8c3dbf318d7ecfd4abc888044e"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="config-msvc_8h.html#a6eb1e68cc391dd753bc8ce896dbb8315">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga69167a8c3dbf318d7ecfd4abc888044e">fragment_header_type</a></td></tr>
<tr class="memdesc:ga69167a8c3dbf318d7ecfd4abc888044e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fragmentation information is stored in a 32-bit packet header.  <a href="group__fragmentation.html#ga69167a8c3dbf318d7ecfd4abc888044e">More...</a><br /></td></tr>
<tr class="separator:ga69167a8c3dbf318d7ecfd4abc888044e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Data Channel Fragmentation module header file. </p>

<p class="definition">Definition in file <a class="el" href="fragment_8h_source.html">fragment.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa887b9882c0901330e5d7ee4132b0fa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa887b9882c0901330e5d7ee4132b0fa2">&#9670;&nbsp;</a></span>FRAG_MAP_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FRAG_MAP_MASK&#160;&#160;&#160;0xFFFFFFFF</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mask for reassembly map. </p>

<p class="definition">Definition at line <a class="el" href="fragment_8h_source.html#l00071">71</a> of file <a class="el" href="fragment_8h_source.html">fragment.h</a>.</p>

</div>
</div>
<a id="ae01d83e01152b50bd153c9f33b97f0d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae01d83e01152b50bd153c9f33b97f0d5">&#9670;&nbsp;</a></span>MAX_FRAG_PKT_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_FRAG_PKT_SIZE&#160;&#160;&#160;65536</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(Not used) Maximum packet size before fragmenting. </p>

<p class="definition">Definition at line <a class="el" href="fragment_8h_source.html#l00154">154</a> of file <a class="el" href="fragment_8h_source.html">fragment.h</a>.</p>

</div>
</div>
<a id="a13f1a5ba4de8983b873747c5f15178b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13f1a5ba4de8983b873747c5f15178b1">&#9670;&nbsp;</a></span>MAX_FRAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_FRAGS&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of fragments per packet. </p>

<p class="definition">Definition at line <a class="el" href="fragment_8h_source.html#l00073">73</a> of file <a class="el" href="fragment_8h_source.html">fragment.h</a>.</p>

</div>
</div>
<a id="a31648c78b7df7103ccd48279bf57a5d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31648c78b7df7103ccd48279bf57a5d5">&#9670;&nbsp;</a></span>N_SEQ_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define N_SEQ_ID&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>One more than the maximum fragment sequence ID, above which the IDs wrap to zero. </p>
<p>Should be a power of 2. </p>

<p class="definition">Definition at line <a class="el" href="fragment_8h_source.html#l00142">142</a> of file <a class="el" href="fragment_8h_source.html">fragment.h</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
