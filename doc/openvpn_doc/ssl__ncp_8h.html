<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: src/openvpn/ssl_ncp.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_92f13d409beef24f5ba1b81abfed1f1c.html">openvpn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ssl_ncp.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="buffer_8h_source.html">buffer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="options_8h_source.html">options.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ssl_ncp.h:</div>
<div class="dyncontent">
<div class="center"><img src="ssl__ncp_8h__incl.png" border="0" usemap="#src_2openvpn_2ssl__ncp_8h" alt=""/></div>
<map name="src_2openvpn_2ssl__ncp_8h" id="src_2openvpn_2ssl__ncp_8h">
<area shape="rect" title=" " alt="" coords="886,5,1040,32"/>
<area shape="rect" href="buffer_8h.html" title=" " alt="" coords="1528,752,1593,779"/>
<area shape="rect" href="options_8h.html" title=" " alt="" coords="1807,80,1882,107"/>
<area shape="rect" href="openvpn_2basic_8h.html" title=" " alt="" coords="1915,901,1979,928"/>
<area shape="rect" href="openvpn_2error_8h.html" title=" " alt="" coords="671,827,730,853"/>
<area shape="rect" title=" " alt="" coords="530,901,593,928"/>
<area shape="rect" title=" " alt="" coords="106,901,180,928"/>
<area shape="rect" title=" " alt="" coords="618,901,687,928"/>
<area shape="rect" href="errlevel_8h.html" title=" " alt="" coords="711,901,786,928"/>
<area shape="rect" href="common_8h.html" title=" " alt="" coords="1699,677,1782,704"/>
<area shape="rect" href="mtu_8h.html" title=" " alt="" coords="1096,677,1150,704"/>
<area shape="rect" href="route_8h.html" title=" " alt="" coords="892,304,954,331"/>
<area shape="rect" href="tun_8h.html" title=" " alt="" coords="811,379,862,405"/>
<area shape="rect" href="socket_8h.html" title=" " alt="" coords="1347,379,1419,405"/>
<area shape="rect" href="proxy_8h.html" title=" " alt="" coords="1780,453,1844,480"/>
<area shape="rect" href="plugin_8h.html" title=" " alt="" coords="1636,155,1703,181"/>
<area shape="rect" href="manage_8h.html" title=" " alt="" coords="1394,155,1473,181"/>
<area shape="rect" href="comp_8h.html" title=" " alt="" coords="2022,155,2088,181"/>
<area shape="rect" href="pushlist_8h.html" title=" " alt="" coords="2112,155,2190,181"/>
<area shape="rect" href="clinat_8h.html" title=" " alt="" coords="2140,379,2204,405"/>
<area shape="rect" href="crypto__backend_8h.html" title=" " alt="" coords="2207,677,2332,704"/>
<area shape="rect" href="misc_8h.html" title=" " alt="" coords="1555,528,1616,555"/>
<area shape="rect" href="networking_8h.html" title=" " alt="" coords="50,453,146,480"/>
<area shape="rect" title=" " alt="" coords="271,677,348,704"/>
<area shape="rect" title=" " alt="" coords="423,453,530,480"/>
<area shape="rect" title=" " alt="" coords="554,453,636,480"/>
<area shape="rect" title=" " alt="" coords="661,453,748,480"/>
<area shape="rect" href="win32_8h.html" title=" " alt="" coords="875,603,942,629"/>
<area shape="rect" href="event_8h.html" title=" " alt="" coords="874,453,940,480"/>
<area shape="rect" href="proto_8h.html" title=" " alt="" coords="1241,528,1304,555"/>
<area shape="rect" href="ring__buffer_8h.html" title=" " alt="" coords="136,603,230,629"/>
<area shape="rect" href="openvpn-msg_8h.html" title=" " alt="" coords="853,677,964,704"/>
<area shape="rect" href="argv_8h.html" title=" " alt="" coords="1465,677,1522,704"/>
<area shape="rect" href="sig_8h.html" title=" " alt="" coords="883,528,934,555"/>
<area shape="rect" href="perf_8h.html" title=" " alt="" coords="804,528,858,555"/>
<area shape="rect" href="env__set_8h.html" title=" " alt="" coords="1566,603,1645,629"/>
<area shape="rect" href="integer_8h.html" title=" " alt="" coords="702,752,774,779"/>
<area shape="rect" href="platform_8h.html" title=" " alt="" coords="1907,677,1987,704"/>
<area shape="rect" href="syshead_8h.html" title=" " alt="" coords="22,603,104,629"/>
<area shape="rect" title=" " alt="" coords="21,677,105,704"/>
<area shape="rect" title=" " alt="" coords="181,677,246,704"/>
<area shape="rect" href="socks_8h.html" title=" " alt="" coords="1328,528,1396,555"/>
<area shape="rect" href="ssl__verify__openssl_8h.html" title=" " alt="" coords="1522,229,1663,256"/>
<area shape="rect" href="openvpn-plugin_8h.html" title=" " alt="" coords="1687,229,1807,256"/>
<area shape="rect" title=" " alt="" coords="1537,304,1648,331"/>
<area shape="rect" title=" " alt="" coords="1672,304,1742,331"/>
<area shape="rect" title=" " alt="" coords="1766,304,1835,331"/>
<area shape="rect" href="mroute_8h.html" title=" " alt="" coords="1832,229,1905,256"/>
<area shape="rect" href="list_8h.html" title=" " alt="" coords="2062,677,2112,704"/>
<area shape="rect" href="crypto__openssl_8h.html" title=" " alt="" coords="2224,752,2345,779"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="ssl__ncp_8h__dep__incl.png" border="0" usemap="#src_2openvpn_2ssl__ncp_8hdep" alt=""/></div>
<map name="src_2openvpn_2ssl__ncp_8hdep" id="src_2openvpn_2ssl__ncp_8hdep">
<area shape="rect" title=" " alt="" coords="398,5,551,32"/>
<area shape="rect" href="init_8c.html" title=" " alt="" coords="5,80,131,107"/>
<area shape="rect" href="multi_8c.html" title=" " alt="" coords="155,80,291,107"/>
<area shape="rect" href="options_8c.html" title=" " alt="" coords="315,80,466,107"/>
<area shape="rect" href="push_8c.html" title=" " alt="" coords="491,80,627,107"/>
<area shape="rect" href="ssl_8c.html" title=" " alt="" coords="651,80,776,107"/>
<area shape="rect" href="ssl__ncp_8c.html" title=" " alt="" coords="801,80,954,107"/>
<area shape="rect" href="test__ncp_8c.html" title=" " alt="" coords="795,155,960,196"/>
</map>
</div>
</div>
<p><a href="ssl__ncp_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a60162f0bb993e9a5b4ff33a3015136e9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__ncp_8h.html#a60162f0bb993e9a5b4ff33a3015136e9">MAX_NCP_CIPHERS_LENGTH</a>&#160;&#160;&#160;127</td></tr>
<tr class="memdesc:a60162f0bb993e9a5b4ff33a3015136e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum length of a ncp-cipher string that is accepted.  <a href="ssl__ncp_8h.html#a60162f0bb993e9a5b4ff33a3015136e9">More...</a><br /></td></tr>
<tr class="separator:a60162f0bb993e9a5b4ff33a3015136e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac1a6ca132f8c8f36946e7219726f53a0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__ncp_8h.html#ac1a6ca132f8c8f36946e7219726f53a0">tls_peer_supports_ncp</a> (const char *peer_info)</td></tr>
<tr class="memdesc:ac1a6ca132f8c8f36946e7219726f53a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether the client supports NCP either by announcing IV_NCP&gt;=2 or the IV_CIPHERS list.  <a href="ssl__ncp_8h.html#ac1a6ca132f8c8f36946e7219726f53a0">More...</a><br /></td></tr>
<tr class="separator:ac1a6ca132f8c8f36946e7219726f53a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a492a4b3d2f9c0baf24422d85631ac945"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__ncp_8h.html#a492a4b3d2f9c0baf24422d85631ac945">check_pull_client_ncp</a> (struct <a class="el" href="structcontext.html">context</a> *c, int found)</td></tr>
<tr class="memdesc:a492a4b3d2f9c0baf24422d85631ac945"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether the cipher negotiation is in an acceptable state and we continue to connect or should abort.  <a href="ssl__ncp_8h.html#a492a4b3d2f9c0baf24422d85631ac945">More...</a><br /></td></tr>
<tr class="separator:a492a4b3d2f9c0baf24422d85631ac945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a376b44a7af8c2393b6a41449a979326a"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__ncp_8h.html#a376b44a7af8c2393b6a41449a979326a">ncp_get_best_cipher</a> (const char *server_list, const char *peer_info, const char *remote_cipher, struct <a class="el" href="structgc__arena.html">gc_arena</a> *gc)</td></tr>
<tr class="memdesc:a376b44a7af8c2393b6a41449a979326a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iterates through the ciphers in server_list and return the first cipher that is also supported by the peer according to the IV_NCP and IV_CIPHER values in peer_info.  <a href="ssl__ncp_8h.html#a376b44a7af8c2393b6a41449a979326a">More...</a><br /></td></tr>
<tr class="separator:a376b44a7af8c2393b6a41449a979326a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1aa40b305d4b041c70de70204b3c3dc"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__ncp_8h.html#ac1aa40b305d4b041c70de70204b3c3dc">tls_peer_ncp_list</a> (const char *peer_info, struct <a class="el" href="structgc__arena.html">gc_arena</a> *gc)</td></tr>
<tr class="memdesc:ac1aa40b305d4b041c70de70204b3c3dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the support cipher list from the peer according to the IV_NCP and IV_CIPHER values in peer_info.  <a href="ssl__ncp_8h.html#ac1aa40b305d4b041c70de70204b3c3dc">More...</a><br /></td></tr>
<tr class="separator:ac1aa40b305d4b041c70de70204b3c3dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb86af7cb51e95c7822697409f0fa093"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__ncp_8h.html#afb86af7cb51e95c7822697409f0fa093">mutate_ncp_cipher_list</a> (const char *list, struct <a class="el" href="structgc__arena.html">gc_arena</a> *gc)</td></tr>
<tr class="memdesc:afb86af7cb51e95c7822697409f0fa093"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether the ciphers in the supplied list are supported.  <a href="ssl__ncp_8h.html#afb86af7cb51e95c7822697409f0fa093">More...</a><br /></td></tr>
<tr class="separator:afb86af7cb51e95c7822697409f0fa093"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e8061a56d8a114317b5f829b6cbf19b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ssl__ncp_8h.html#a9e8061a56d8a114317b5f829b6cbf19b">tls_item_in_cipher_list</a> (const char *item, const char *list)</td></tr>
<tr class="memdesc:a9e8061a56d8a114317b5f829b6cbf19b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return true iff item is present in the colon-separated zero-terminated cipher list.  <a href="ssl__ncp_8h.html#a9e8061a56d8a114317b5f829b6cbf19b">More...</a><br /></td></tr>
<tr class="separator:a9e8061a56d8a114317b5f829b6cbf19b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a60162f0bb993e9a5b4ff33a3015136e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60162f0bb993e9a5b4ff33a3015136e9">&#9670;&nbsp;</a></span>MAX_NCP_CIPHERS_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_NCP_CIPHERS_LENGTH&#160;&#160;&#160;127</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The maximum length of a ncp-cipher string that is accepted. </p>
<p>Since this list needs to be pushed as IV_CIPHERS, we are conservative about its length. </p>

<p class="definition">Definition at line <a class="el" href="ssl__ncp_8h_source.html#l00116">116</a> of file <a class="el" href="ssl__ncp_8h_source.html">ssl_ncp.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a492a4b3d2f9c0baf24422d85631ac945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a492a4b3d2f9c0baf24422d85631ac945">&#9670;&nbsp;</a></span>check_pull_client_ncp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool check_pull_client_ncp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcontext.html">context</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>found</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether the cipher negotiation is in an acceptable state and we continue to connect or should abort. </p>
<dl class="section return"><dt>Returns</dt><dd>Wether the client NCP process suceeded or failed </dd></dl>

<p class="definition">Definition at line <a class="el" href="ssl__ncp_8c_source.html#l00308">308</a> of file <a class="el" href="ssl__ncp_8c_source.html">ssl_ncp.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_8h_source.html#l00530">context::c2</a>, <a class="el" href="errlevel_8h_source.html#l00083">D_PUSH</a>, <a class="el" href="errlevel_8h_source.html#l00059">D_TLS_ERRORS</a>, <a class="el" href="options_8h_source.html#l00521">options::enable_ncp_fallback</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="options_8h_source.html#l00524">options::ncp_ciphers</a>, <a class="el" href="options_8h_source.html#l00523">options::ncp_enabled</a>, <a class="el" href="options_8h_source.html#l00686">OPT_P_NCP</a>, <a class="el" href="openvpn_8h_source.html#l00491">context::options</a>, <a class="el" href="ssl__common_8h_source.html#l00592">tls_multi::remote_ciphername</a>, <a class="el" href="openvpn_8h_source.html#l00340">context_2::tls_multi</a>, and <a class="el" href="ssl__ncp_8c_source.html#l00295">tls_poor_mans_ncp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02267">do_deferred_options()</a>.</p>

</div>
</div>
<a id="afb86af7cb51e95c7822697409f0fa093"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb86af7cb51e95c7822697409f0fa093">&#9670;&nbsp;</a></span>mutate_ncp_cipher_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* mutate_ncp_cipher_list </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgc__arena.html">gc_arena</a> *&#160;</td>
          <td class="paramname"><em>gc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether the ciphers in the supplied list are supported. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">list</td><td>Colon-separated list of ciphers @parms gc <a class="el" href="structgc__arena.html" title="Garbage collection arena used to keep track of dynamically allocated memory.">gc_arena</a> to allocate the returned string</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>colon separated string of normalised (via translate_cipher_name_from_openvpn) and zero terminated string iff all ciphers in list are supported and the total length is short than MAX_NCP_CIPHERS_LENGTH. NULL otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ssl__ncp_8c_source.html#l00096">96</a> of file <a class="el" href="ssl__ncp_8c_source.html">ssl_ncp.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00064">alloc_buf()</a>, <a class="el" href="buffer_8h_source.html#l00546">buf_forward_capacity()</a>, <a class="el" href="buffer_8h_source.html#l00240">buf_len()</a>, <a class="el" href="buffer_8c_source.html#l00549">buf_null_terminate()</a>, <a class="el" href="buffer_8c_source.html#l00272">buf_puts()</a>, <a class="el" href="buffer_8h_source.html#l00284">buf_str()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00635">cipher_kt_get()</a>, <a class="el" href="crypto__backend_8h.html#aa7653846be359a2fc26cdf1677e668dd">cipher_kt_name()</a>, <a class="el" href="buffer_8c_source.html#l00185">free_buf()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00093">M_WARN</a>, <a class="el" href="ssl__ncp_8h_source.html#l00116">MAX_NCP_CIPHERS_LENGTH</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="buffer_8c_source.html#l00665">string_alloc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="options_8c_source.html#l03142">options_postprocess_mutate()</a>, and <a class="el" href="test__ncp_8c_source.html#l00049">test_check_ncp_ciphers_list()</a>.</p>

</div>
</div>
<a id="a376b44a7af8c2393b6a41449a979326a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a376b44a7af8c2393b6a41449a979326a">&#9670;&nbsp;</a></span>ncp_get_best_cipher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ncp_get_best_cipher </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>server_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>peer_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>remote_cipher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgc__arena.html">gc_arena</a> *&#160;</td>
          <td class="paramname"><em>gc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Iterates through the ciphers in server_list and return the first cipher that is also supported by the peer according to the IV_NCP and IV_CIPHER values in peer_info. </p>
<p>We also accept a cipher that is the remote cipher of the client for "Poor man's NCP": Use peer cipher if it is an allowed (NCP) cipher. Allows non-NCP peers to upgrade their cipher individually.</p>
<p>Make sure to call <a class="el" href="ssl_8c.html#a0abbfa06ce57c32f9f1a46c247de29cf" title="Update TLS session crypto parameters (cipher and auth) and derive data channel keys based on the supp...">tls_session_update_crypto_params()</a> after calling this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gc</td><td>gc arena that is ONLY used to allocate the returned string</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NULL if no common cipher is available, otherwise the best common cipher </dd></dl>

<p class="definition">Definition at line <a class="el" href="ssl__ncp_8c_source.html#l00241">241</a> of file <a class="el" href="ssl__ncp_8c_source.html">ssl_ncp.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="options_8h_source.html#l00669">streq</a>, <a class="el" href="buffer_8c_source.html#l00665">string_alloc()</a>, <a class="el" href="compat-strsep_8c_source.html#l00038">strsep()</a>, <a class="el" href="ssl__ncp_8c_source.html#l00187">tls_item_in_cipher_list()</a>, and <a class="el" href="ssl__ncp_8c_source.html#l00207">tls_peer_ncp_list()</a>.</p>

<p class="reference">Referenced by <a class="el" href="multi_8c_source.html#l01803">multi_client_set_protocol_options()</a>, <a class="el" href="test__ncp_8c_source.html#l00211">test_ncp_best()</a>, and <a class="el" href="test__ncp_8c_source.html#l00162">test_poor_man()</a>.</p>

</div>
</div>
<a id="a9e8061a56d8a114317b5f829b6cbf19b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e8061a56d8a114317b5f829b6cbf19b">&#9670;&nbsp;</a></span>tls_item_in_cipher_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tls_item_in_cipher_list </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>item</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return true iff item is present in the colon-separated zero-terminated cipher list. </p>

<p class="definition">Definition at line <a class="el" href="ssl__ncp_8c_source.html#l00187">187</a> of file <a class="el" href="ssl__ncp_8c_source.html">ssl_ncp.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00665">string_alloc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02718">do_init_crypto_tls_c1()</a>, <a class="el" href="ssl__ncp_8c_source.html#l00241">ncp_get_best_cipher()</a>, <a class="el" href="options_8c_source.html#l03081">options_postprocess_cipher()</a>, <a class="el" href="options_8c_source.html#l03762">options_string()</a>, <a class="el" href="ssl_8c_source.html#l02214">push_peer_info()</a>, <a class="el" href="ssl__ncp_8c_source.html#l00295">tls_poor_mans_ncp()</a>, and <a class="el" href="ssl_8c_source.html#l01946">tls_session_update_crypto_params()</a>.</p>

</div>
</div>
<a id="ac1aa40b305d4b041c70de70204b3c3dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1aa40b305d4b041c70de70204b3c3dc">&#9670;&nbsp;</a></span>tls_peer_ncp_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* tls_peer_ncp_list </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>peer_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgc__arena.html">gc_arena</a> *&#160;</td>
          <td class="paramname"><em>gc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the support cipher list from the peer according to the IV_NCP and IV_CIPHER values in peer_info. </p>
<dl class="section return"><dt>Returns</dt><dd>Either a string containing the ncp list that is either static or allocated via gc. If no information is available an empty string ("") is returned. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ssl__ncp_8c_source.html#l00207">207</a> of file <a class="el" href="ssl__ncp_8c_source.html">ssl_ncp.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00665">string_alloc()</a>, and <a class="el" href="ssl__ncp_8c_source.html#l00058">tls_peer_info_ncp_ver()</a>.</p>

<p class="reference">Referenced by <a class="el" href="multi_8c_source.html#l01803">multi_client_set_protocol_options()</a>, <a class="el" href="ssl__ncp_8c_source.html#l00241">ncp_get_best_cipher()</a>, and <a class="el" href="test__ncp_8c_source.html#l00123">test_extract_client_ciphers()</a>.</p>

</div>
</div>
<a id="ac1a6ca132f8c8f36946e7219726f53a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1a6ca132f8c8f36946e7219726f53a0">&#9670;&nbsp;</a></span>tls_peer_supports_ncp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tls_peer_supports_ncp </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>peer_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns whether the client supports NCP either by announcing IV_NCP&gt;=2 or the IV_CIPHERS list. </p>

<p class="definition">Definition at line <a class="el" href="ssl__ncp_8c_source.html#l00078">78</a> of file <a class="el" href="ssl__ncp_8c_source.html">ssl_ncp.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__ncp_8c_source.html#l00058">tls_peer_info_ncp_ver()</a>.</p>

<p class="reference">Referenced by <a class="el" href="push_8c_source.html#l00427">prepare_push_reply()</a>, and <a class="el" href="test__ncp_8c_source.html#l00123">test_extract_client_ciphers()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
