<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: src/openvpn/crypto.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_92f13d409beef24f5ba1b81abfed1f1c.html">openvpn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">crypto.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="crypto_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  OpenVPN -- An application to securely tunnel IP networks</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *             over a single TCP/UDP port, with support for SSL/TLS-based</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *             session authentication and key exchange,</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *             packet encryption, packet authentication, and</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *             packet compression.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *  Copyright (C) 2002-2022 OpenVPN Inc &lt;sales@openvpn.net&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *  Copyright (C) 2010-2021 Fox Crypto B.V. &lt;openvpn@foxcrypto.com&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *  it under the terms of the GNU General Public License version 2</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *  as published by the Free Software Foundation.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *  GNU General Public License for more details.</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *  You should have received a copy of the GNU General Public License along</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *  with this program; if not, write to the Free Software Foundation, Inc.,</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *  51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#ifndef CRYPTO_H</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#define CRYPTO_H</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="crypto__backend_8h.html">crypto_backend.h</a>&quot;</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="openvpn_2basic_8h.html">basic.h</a>&quot;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="buffer_8h.html">buffer.h</a>&quot;</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="packet__id_8h.html">packet_id.h</a>&quot;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mtu_8h.html">mtu.h</a>&quot;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="structsha256__digest.html">  132</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structsha256__digest.html">sha256_digest</a> {</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="structsha256__digest.html#ab33fddc33bcbd885fc183ce3803a0ba3">  133</a></span>&#160;    <a class="code" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> <a class="code" href="structsha256__digest.html#ab33fddc33bcbd885fc183ce3803a0ba3">digest</a>[<a class="code" href="crypto__mbedtls_8h.html#aa9cf0abf87b30c4c63e9c7e89c590579">SHA256_DIGEST_LENGTH</a>];</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;};</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> * Defines a key type and key length for both cipher and HMAC.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="structkey__type.html">  139</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structkey__type.html">key_type</a></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="structkey__type.html#a24ca445d5f9e33112714deaf58cf3599">  141</a></span>&#160;    <a class="code" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> <a class="code" href="structkey__type.html#a24ca445d5f9e33112714deaf58cf3599">cipher_length</a>;      </div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="structkey__type.html#a0714213fa1e02f00924a2c85deb53caf">  142</a></span>&#160;    <a class="code" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> <a class="code" href="structkey__type.html#a0714213fa1e02f00924a2c85deb53caf">hmac_length</a>;        </div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="structkey__type.html#aba064fbaa853a46ae2d3afbc3ae98aff">  143</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="crypto__mbedtls_8h.html#aa82c97683560a0df89eddd2a3cf6e6d4">cipher_kt_t</a> *<a class="code" href="structkey__type.html#aba064fbaa853a46ae2d3afbc3ae98aff">cipher</a>;  </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="structkey__type.html#a496ad3263017e1eca30ec7f490a8011e">  144</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="crypto__mbedtls_8h.html#acd12a312c79aead7af792554fb5606d5">md_kt_t</a> *<a class="code" href="structkey__type.html#a496ad3263017e1eca30ec7f490a8011e">digest</a>;      </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;};</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="structkey.html">  151</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structkey.html">key</a></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;{</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="structkey.html#a94ff5232b6e56df51d126b8695a9413c">  153</a></span>&#160;    <a class="code" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> <a class="code" href="structkey.html#a94ff5232b6e56df51d126b8695a9413c">cipher</a>[<a class="code" href="crypto__backend_8h.html#a5ecba19b3b19dd1317e0fad83cfcd414">MAX_CIPHER_KEY_LENGTH</a>];</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="structkey.html#a9cdc2579088a9fd78f0484a3e56a5899">  155</a></span>&#160;    <a class="code" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> <a class="code" href="structkey.html#a9cdc2579088a9fd78f0484a3e56a5899">hmac</a>[<a class="code" href="crypto__backend_8h.html#a9ce521546cb78acc7159459c101aa46b">MAX_HMAC_KEY_LENGTH</a>];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;};</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="structkey__ctx.html">  164</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structkey__ctx.html">key_ctx</a></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="structkey__ctx.html#aae41ef2b9e31ab2da86e7926cceed175">  166</a></span>&#160;    <a class="code" href="crypto__mbedtls_8h.html#a5fd03a052e0b72cb24747f7cccfc66dd">cipher_ctx_t</a> *<a class="code" href="structkey__ctx.html#aae41ef2b9e31ab2da86e7926cceed175">cipher</a>;       </div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="structkey__ctx.html#ac82e9ac5970ca208fa7d36c9a49bb4a7">  167</a></span>&#160;    <a class="code" href="crypto__mbedtls_8h.html#a673f50867e637575e463123b9a6b8180">hmac_ctx_t</a> *<a class="code" href="structkey__ctx.html#ac82e9ac5970ca208fa7d36c9a49bb4a7">hmac</a>;           </div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="structkey__ctx.html#a3abf80e0721314aa5ae121fa668620a7">  168</a></span>&#160;    <a class="code" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> <a class="code" href="structkey__ctx.html#a3abf80e0721314aa5ae121fa668620a7">implicit_iv</a>[<a class="code" href="crypto__mbedtls_8h.html#ae9cda5ecb2fa1ec97a413d9ffbb0c87e">OPENVPN_MAX_IV_LENGTH</a>];</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="structkey__ctx.html#a094aa3b3f35e7d15ac58d5e4ef072eaa">  170</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structkey__ctx.html#a094aa3b3f35e7d15ac58d5e4ef072eaa">implicit_iv_len</a>;     </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;};</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="crypto_8h.html#ab8be0ec27dfc6dc8d779afa0c42db52c">  173</a></span>&#160;<span class="preprocessor">#define KEY_DIRECTION_BIDIRECTIONAL 0 </span><span class="comment">/* same keys for both directions */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="crypto_8h.html#a09112b6672bf44b0ecef2eee6348244c">  174</a></span>&#160;<span class="preprocessor">#define KEY_DIRECTION_NORMAL        1 </span><span class="comment">/* encrypt with keys[0], decrypt with keys[1] */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="crypto_8h.html#ad246376c36364cabaacea01498048ec7">  175</a></span>&#160;<span class="preprocessor">#define KEY_DIRECTION_INVERSE       2 </span><span class="comment">/* encrypt with keys[1], decrypt with keys[0] */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="structkey2.html">  181</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structkey2.html">key2</a></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;{</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="structkey2.html#a325d016ea0977d9569d3d75fd4e7fe06">  183</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structkey2.html#a325d016ea0977d9569d3d75fd4e7fe06">n</a>;                      </div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="structkey2.html#a9698a633f0112a2000a0efdb8d960010">  185</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structkey.html">key</a> <a class="code" href="structkey2.html#a9698a633f0112a2000a0efdb8d960010">keys</a>[2];         </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;};</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="structkey__direction__state.html">  198</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structkey__direction__state.html">key_direction_state</a></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="structkey__direction__state.html#acedd040b7d56fae540d55e6a380b42bb">  200</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structkey__direction__state.html#acedd040b7d56fae540d55e6a380b42bb">out_key</a>;                </div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="structkey__direction__state.html#a650262f702aa180805a0101bbcb7646b">  202</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structkey__direction__state.html#a650262f702aa180805a0101bbcb7646b">in_key</a>;                 </div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="structkey__direction__state.html#a235ef043e0135e9626b532d28c6a5ddc">  204</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structkey__direction__state.html#a235ef043e0135e9626b532d28c6a5ddc">need_keys</a>;              </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;};</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="structkey__ctx__bi.html">  219</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structkey__ctx__bi.html">key_ctx_bi</a></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;{</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="structkey__ctx__bi.html#a7ef99b43dc7528037f1c81685d24a4d6">  221</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structkey__ctx.html">key_ctx</a> <a class="code" href="structkey__ctx__bi.html#a7ef99b43dc7528037f1c81685d24a4d6">encrypt</a>;     </div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="structkey__ctx__bi.html#a552f7a501cae9ddf3a107d87a1b039fa">  223</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structkey__ctx.html">key_ctx</a> <a class="code" href="structkey__ctx__bi.html#a552f7a501cae9ddf3a107d87a1b039fa">decrypt</a>;     </div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="structkey__ctx__bi.html#a2d1c4992f06672c3474722a569fb23b8">  225</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structkey__ctx__bi.html#a2d1c4992f06672c3474722a569fb23b8">initialized</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;};</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="structcrypto__options.html">  232</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcrypto__options.html">crypto_options</a></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;{</div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="structcrypto__options.html#a6f5aaea8aa6f397a0684d8b0a2879252">  234</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structkey__ctx__bi.html">key_ctx_bi</a> <a class="code" href="structkey__ctx__bi.html">key_ctx_bi</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="structcrypto__options.html#ab4b7f20d49e1ac2efb9faf4a13d3701d">  238</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structpacket__id.html">packet_id</a> <a class="code" href="structpacket__id.html">packet_id</a>; </div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="structcrypto__options.html#a64268b2eac664d85f5e6133264f937ce">  240</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structpacket__id__persist.html">packet_id_persist</a> *<a class="code" href="structcrypto__options.html#a64268b2eac664d85f5e6133264f937ce">pid_persist</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="crypto_8h.html#a10cf731ef4917a647cdca413d507ff81">  245</a></span>&#160;<span class="preprocessor">#define CO_PACKET_ID_LONG_FORM  (1&lt;&lt;0)</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="crypto_8h.html#a46afc2f632a024378e286f6ada0ade76">  248</a></span>&#160;<span class="preprocessor">#define CO_IGNORE_PACKET_ID     (1&lt;&lt;1)</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="crypto_8h.html#a897fcd411cae93fbed05653515ce480e">  254</a></span>&#160;<span class="preprocessor">#define CO_MUTE_REPLAY_WARNINGS (1&lt;&lt;2)</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="structcrypto__options.html#a4f1cebf03b32cf2f3b44e90630079e88">  257</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structcrypto__options.html#a4f1cebf03b32cf2f3b44e90630079e88">flags</a>;         </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;};</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="crypto_8h.html#a3c30c5ee1d0788ec86d22aec61952199">  261</a></span>&#160;<span class="preprocessor">#define CRYPT_ERROR(format) \</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="preprocessor">    do { msg(D_CRYPT_ERRORS, &quot;%s: &quot; format, error_prefix); goto error_exit; } while (false)</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="crypto_8h.html#a3658531e5110d45db922d6a47fb2454b">  268</a></span>&#160;<span class="preprocessor">#define OPENVPN_AEAD_MIN_IV_LEN (sizeof(packet_id_type) + 8)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="crypto_8h.html#abab39c003d995feddd945d8c680be0bd">  270</a></span>&#160;<span class="preprocessor">#define RKF_MUST_SUCCEED (1&lt;&lt;0)</span></div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="crypto_8h.html#a88d01fb7acc16a3c70e24fbc61b741bc">  271</a></span>&#160;<span class="preprocessor">#define RKF_INLINE       (1&lt;&lt;1)</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#a3482d06fa45961722769bcad30ed3407">read_key_file</a>(<span class="keyword">struct</span> <a class="code" href="structkey2.html">key2</a> *<a class="code" href="structkey2.html">key2</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *file, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordtype">int</span> <a class="code" href="crypto_8h.html#a81c00d1ee124bc52b54b6b3082fba96e">write_key_file</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nkeys, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpacket__id__persist.html#a4d627c299051f13bd6c8ae411ae89341">filename</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#abd4e2239c5b8afe85276885676851bcf">generate_key_random</a>(<span class="keyword">struct</span> <a class="code" href="structkey.html">key</a> *<a class="code" href="structkey.html">key</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#af0c4bb63e6b4aae63502a87217a36c79">check_replay_consistency</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt, <span class="keywordtype">bool</span> <a class="code" href="structpacket__id.html">packet_id</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="crypto_8h.html#a87b883dc7b32de49358a397c4e5a56a6">check_key</a>(<span class="keyword">struct</span> <a class="code" href="structkey.html">key</a> *<a class="code" href="structkey.html">key</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#aba43c7afa9dab7d3d1bb9443a0fba6d8">fixup_key</a>(<span class="keyword">struct</span> <a class="code" href="structkey.html">key</a> *<a class="code" href="structkey.html">key</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="crypto_8h.html#ac5e8c79c3087b70be89679a45aa3a310">write_key</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey.html">key</a> *<a class="code" href="structkey.html">key</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;               <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *buf);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keywordtype">int</span> <a class="code" href="crypto_8h.html#aa5a63a28549eab7b202ca3fa522a22d6">read_key</a>(<span class="keyword">struct</span> <a class="code" href="structkey.html">key</a> *<a class="code" href="structkey.html">key</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt, <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *buf);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#a5657fa40c2ed8eed4ac057b87902100b">init_key_type</a>(<span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt, <span class="keyword">const</span> <span class="keywordtype">char</span> *ciphername,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">char</span> *authname, <span class="keywordtype">int</span> keysize, <span class="keywordtype">bool</span> tls_mode, <span class="keywordtype">bool</span> warn);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"> * Key context functions</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#ae629299ae8c5888623e26033c1784d31">init_key_ctx</a>(<span class="keyword">struct</span> <a class="code" href="structkey__ctx.html">key_ctx</a> *ctx, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey.html">key</a> *<a class="code" href="structkey.html">key</a>,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                  <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt, <span class="keywordtype">int</span> enc,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#af3aee473fd00923f722cc0518add3d7c">free_key_ctx</a>(<span class="keyword">struct</span> <a class="code" href="structkey__ctx.html">key_ctx</a> *ctx);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#ab4bddbfa55994baf73b823dd49eb9320">init_key_ctx_bi</a>(<span class="keyword">struct</span> <a class="code" href="structkey__ctx__bi.html">key_ctx_bi</a> *ctx, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey2.html">key2</a> *<a class="code" href="structkey2.html">key2</a>,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                     <span class="keywordtype">int</span> key_direction, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">char</span> *name);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#a0605d1e78bd3bf4e23d99e039301f934">free_key_ctx_bi</a>(<span class="keyword">struct</span> <a class="code" href="structkey__ctx__bi.html">key_ctx_bi</a> *ctx);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">/**************************************************************************/</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keywordtype">void</span> <a class="code" href="group__data__crypto.html#ga2756bad88224b98719d4e8f08cb11ef9">openvpn_encrypt</a>(<span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *buf, <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> work,</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                     <span class="keyword">struct</span> <a class="code" href="structcrypto__options.html">crypto_options</a> *opt);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="group__data__crypto.html#gae91d99446478fcf3327672eb78ef0bf8">openvpn_decrypt</a>(<span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *buf, <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> work,</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                     <span class="keyword">struct</span> <a class="code" href="structcrypto__options.html">crypto_options</a> *opt, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structframe.html">frame</a> *<a class="code" href="structframe.html">frame</a>,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                     <span class="keyword">const</span> <a class="code" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> *ad_start);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="crypto_8h.html#a1e6bbdde50a9843d441c22ada85e6345">crypto_check_replay</a>(<span class="keyword">struct</span> <a class="code" href="structcrypto__options.html">crypto_options</a> *opt,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                         <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structpacket__id__net.html">packet_id_net</a> *pin, <span class="keyword">const</span> <span class="keywordtype">char</span> *error_prefix,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                         <span class="keyword">struct</span> <a class="code" href="structgc__arena.html">gc_arena</a> *gc);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#af597e0d765df961d66a200fa33ba4faf">crypto_adjust_frame_parameters</a>(<span class="keyword">struct</span> <a class="code" href="structframe.html">frame</a> *<a class="code" href="structframe.html">frame</a>,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                    <span class="keywordtype">bool</span> <a class="code" href="structpacket__id.html">packet_id</a>,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                    <span class="keywordtype">bool</span> packet_id_long_form);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="crypto_8h.html#ac2246d073775a03a612d337782cfa1a5">crypto_max_overhead</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<a class="code" href="crypto_8h.html#a3d1d59d591bbcb56e9b02116f1a66112">write_pem_key_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpacket__id__persist.html#a4d627c299051f13bd6c8ae411ae89341">filename</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *key_name);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<a class="code" href="crypto_8h.html#a41e699455c3550f40ca4cbe7592a439a">generate_ephemeral_key</a>(<span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *<a class="code" href="structkey.html">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *pem_name);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<a class="code" href="crypto_8h.html#a4a653f6e2b03fc30f52845d37b5867a9">read_pem_key_file</a>(<span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *<a class="code" href="structkey.html">key</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *pem_name,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">char</span> *key_file, <span class="keywordtype">bool</span> key_inline);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">/* Minimum length of the nonce used by the PRNG */</span></div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="crypto_8h.html#a89d9152ef191855e0958554eca1e877c">  458</a></span>&#160;<span class="preprocessor">#define NONCE_SECRET_LEN_MIN 16</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">/* Maximum length of the nonce used by the PRNG */</span></div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="crypto_8h.html#a73f126605671fbbab2201edf86635df4">  461</a></span>&#160;<span class="preprocessor">#define NONCE_SECRET_LEN_MAX 64</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="crypto_8h.html#a72d592a2e01dbbf9ac96d01aa811fee7">  464</a></span>&#160;<span class="preprocessor">#define PRNG_NONCE_RESET_BYTES 1024</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#ab99dea190ad93a642a0fc5a429b8f0ed">prng_init</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *md_name, <span class="keyword">const</span> <span class="keywordtype">int</span> nonce_secret_len_parm);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"> * Message digest-based pseudo random number generator.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment"> * If the PRNG was initialised with a certain message digest, uses the digest</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"> * to calculate the next random number, and prevent depletion of the entropy</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"> * pool.</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"> * This PRNG is aimed at IV generation and similar miscellaneous tasks. Use</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment"> * \c rand_bytes() for higher-assurance functionality.</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"> * Retrieves len bytes of pseudo random data, and places it in output.</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment"> * @param output        Output buffer</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment"> * @param len           Length of the output buffer</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#a1d7c04eddcc6269ed0f1e76fe3f9ce0f">prng_bytes</a>(<a class="code" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> *output, <span class="keywordtype">int</span> len);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#ae8c523b770f0e2f30d44004797106508">prng_uninit</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">/* an analogue to the random() function, but use prng_bytes */</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="crypto_8h.html#a37fb65e30bd2c33564b14ad76a0c0794">get_random</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#a59685c1dc9130804ba9e40804ff5af56">print_cipher</a>(<span class="keyword">const</span> <a class="code" href="crypto__mbedtls_8h.html#aa82c97683560a0df89eddd2a3cf6e6d4">cipher_kt_t</a> *cipher);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#a3c572ced6eea1c2b933df8e82b848983">test_crypto</a>(<span class="keyword">struct</span> <a class="code" href="structcrypto__options.html">crypto_options</a> *co, <span class="keyword">struct</span> <a class="code" href="structframe.html">frame</a> *<a class="code" href="namespacehttp-client.html#aadb490246e2a9943d5fe72016ff60d19">f</a>);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">/* key direction functions */</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#abe602273d3919da32e45249dc2af3bc5">key_direction_state_init</a>(<span class="keyword">struct</span> <a class="code" href="structkey__direction__state.html">key_direction_state</a> *kds, <span class="keywordtype">int</span> key_direction);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#a30a5545a94f3f5be9a828a54fae87c60">verify_fix_key2</a>(<span class="keyword">struct</span> <a class="code" href="structkey2.html">key2</a> *<a class="code" href="structkey2.html">key2</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt, <span class="keyword">const</span> <span class="keywordtype">char</span> *shared_secret_file);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#a740d1036dfdb6ed93199f8bce8bbbbe9">must_have_n_keys</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpacket__id__persist.html#a4d627c299051f13bd6c8ae411ae89341">filename</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *option, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey2.html">key2</a> *<a class="code" href="structkey2.html">key2</a>, <span class="keywordtype">int</span> n);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keywordtype">int</span> <a class="code" href="crypto_8h.html#a6a09f04c154e9795c61d37fb79419cd4">ascii2keydirection</a>(<span class="keywordtype">int</span> msglevel, <span class="keyword">const</span> <span class="keywordtype">char</span> *str);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="crypto_8h.html#ab16d0ee42a623040eccffb7f9ad575c0">keydirection2ascii</a>(<span class="keywordtype">int</span> kd, <span class="keywordtype">bool</span> remote, <span class="keywordtype">bool</span> humanreadable);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">/* print keys */</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#a2a5874f830425ad932c70899d6d25b7d">key2_print</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey2.html">key2</a> *k,</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *kt,</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix0,</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix1);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="keywordtype">void</span> <a class="code" href="crypto_8h.html#aeed99ce5177c96881467847708e18b0e">crypto_read_openvpn_key</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__type.html">key_type</a> *<a class="code" href="structkey__type.html">key_type</a>,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                             <span class="keyword">struct</span> <a class="code" href="structkey__ctx__bi.html">key_ctx_bi</a> *ctx, <span class="keyword">const</span> <span class="keywordtype">char</span> *key_file,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                             <span class="keywordtype">bool</span> key_inline, <span class="keyword">const</span> <span class="keywordtype">int</span> key_direction,</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">char</span> *key_name, <span class="keyword">const</span> <span class="keywordtype">char</span> *opt_name);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment"> * Inline functions</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="keywordtype">int</span> <a class="code" href="crypto_8h.html#ac1bdaec22973ae0630f27870c7430dc1">memcmp_constant_time</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *a, <span class="keyword">const</span> <span class="keywordtype">void</span> *b, <span class="keywordtype">size_t</span> size);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="crypto_8h.html#af3e5e7a3b96977793b215f952186d820">  537</a></span>&#160;<a class="code" href="crypto_8h.html#af3e5e7a3b96977793b215f952186d820">key_ctx_bi_defined</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structkey__ctx__bi.html">key_ctx_bi</a> *<a class="code" href="structkey.html">key</a>)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;{</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structkey.html">key</a>-&gt;encrypt.<a class="code" href="structkey.html#a94ff5232b6e56df51d126b8695a9413c">cipher</a> || <a class="code" href="structkey.html">key</a>-&gt;encrypt.<a class="code" href="structkey.html#a9cdc2579088a9fd78f0484a3e56a5899">hmac</a> || <a class="code" href="structkey.html">key</a>-&gt;decrypt.<a class="code" href="structkey.html#a94ff5232b6e56df51d126b8695a9413c">cipher</a> || <a class="code" href="structkey.html">key</a>-&gt;decrypt.<a class="code" href="structkey.html#a9cdc2579088a9fd78f0484a3e56a5899">hmac</a>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;}</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="crypto_8h.html#a2d83f15bad7c91aaf90cff4640373d56">print_key_filename</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *str, <span class="keywordtype">bool</span> is_inline);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CRYPTO_H */</span><span class="preprocessor"></span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="astructkey__direction__state_html_acedd040b7d56fae540d55e6a380b42bb"><div class="ttname"><a href="structkey__direction__state.html#acedd040b7d56fae540d55e6a380b42bb">key_direction_state::out_key</a></div><div class="ttdeci">int out_key</div><div class="ttdoc">Index into the key2.keys array for the sending direction.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00200">crypto.h:200</a></div></div>
<div class="ttc" id="astructkey2_html_a325d016ea0977d9569d3d75fd4e7fe06"><div class="ttname"><a href="structkey2.html#a325d016ea0977d9569d3d75fd4e7fe06">key2::n</a></div><div class="ttdeci">int n</div><div class="ttdoc">The number of key objects stored in the key2.keys array.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00183">crypto.h:183</a></div></div>
<div class="ttc" id="acrypto_8h_html_a41e699455c3550f40ca4cbe7592a439a"><div class="ttname"><a href="crypto_8h.html#a41e699455c3550f40ca4cbe7592a439a">generate_ephemeral_key</a></div><div class="ttdeci">bool generate_ephemeral_key(struct buffer *key, const char *pem_name)</div><div class="ttdoc">Generate ephermal key material into the key structure.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01895">crypto.c:1895</a></div></div>
<div class="ttc" id="acrypto_8h_html_aba43c7afa9dab7d3d1bb9443a0fba6d8"><div class="ttname"><a href="crypto_8h.html#aba43c7afa9dab7d3d1bb9443a0fba6d8">fixup_key</a></div><div class="ttdeci">void fixup_key(struct key *key, const struct key_type *kt)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00972">crypto.c:972</a></div></div>
<div class="ttc" id="astructpacket__id__persist_html_a4d627c299051f13bd6c8ae411ae89341"><div class="ttname"><a href="structpacket__id__persist.html#a4d627c299051f13bd6c8ae411ae89341">packet_id_persist::filename</a></div><div class="ttdeci">const char * filename</div><div class="ttdef"><b>Definition:</b> <a href="packet__id_8h_source.html#l00152">packet_id.h:152</a></div></div>
<div class="ttc" id="acrypto__mbedtls_8h_html_a673f50867e637575e463123b9a6b8180"><div class="ttname"><a href="crypto__mbedtls_8h.html#a673f50867e637575e463123b9a6b8180">hmac_ctx_t</a></div><div class="ttdeci">mbedtls_md_context_t hmac_ctx_t</div><div class="ttdoc">Generic HMAC context.</div><div class="ttdef"><b>Definition:</b> <a href="crypto__mbedtls_8h_source.html#l00049">crypto_mbedtls.h:49</a></div></div>
<div class="ttc" id="acrypto_8h_html_a2a5874f830425ad932c70899d6d25b7d"><div class="ttname"><a href="crypto_8h.html#a2a5874f830425ad932c70899d6d25b7d">key2_print</a></div><div class="ttdeci">void key2_print(const struct key2 *k, const struct key_type *kt, const char *prefix0, const char *prefix1)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01063">crypto.c:1063</a></div></div>
<div class="ttc" id="acrypto_8h_html_af3e5e7a3b96977793b215f952186d820"><div class="ttname"><a href="crypto_8h.html#af3e5e7a3b96977793b215f952186d820">key_ctx_bi_defined</a></div><div class="ttdeci">static bool key_ctx_bi_defined(const struct key_ctx_bi *key)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00537">crypto.h:537</a></div></div>
<div class="ttc" id="astructkey__type_html_a0714213fa1e02f00924a2c85deb53caf"><div class="ttname"><a href="structkey__type.html#a0714213fa1e02f00924a2c85deb53caf">key_type::hmac_length</a></div><div class="ttdeci">uint8_t hmac_length</div><div class="ttdoc">HMAC length, in bytes.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00142">crypto.h:142</a></div></div>
<div class="ttc" id="acrypto_8h_html_ab99dea190ad93a642a0fc5a429b8f0ed"><div class="ttname"><a href="crypto_8h.html#ab99dea190ad93a642a0fc5a429b8f0ed">prng_init</a></div><div class="ttdeci">void prng_init(const char *md_name, const int nonce_secret_len_parm)</div><div class="ttdoc">Pseudo-random number generator initialisation.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01711">crypto.c:1711</a></div></div>
<div class="ttc" id="acrypto_8h_html_a59685c1dc9130804ba9e40804ff5af56"><div class="ttname"><a href="crypto_8h.html#a59685c1dc9130804ba9e40804ff5af56">print_cipher</a></div><div class="ttdeci">void print_cipher(const cipher_kt_t *cipher)</div><div class="ttdoc">Print a cipher list entry.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01783">crypto.c:1783</a></div></div>
<div class="ttc" id="acrypto_8h_html_aeed99ce5177c96881467847708e18b0e"><div class="ttname"><a href="crypto_8h.html#aeed99ce5177c96881467847708e18b0e">crypto_read_openvpn_key</a></div><div class="ttdeci">void crypto_read_openvpn_key(const struct key_type *key_type, struct key_ctx_bi *ctx, const char *key_file, bool key_inline, const int key_direction, const char *key_name, const char *opt_name)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01175">crypto.c:1175</a></div></div>
<div class="ttc" id="astructkey__ctx_html_aae41ef2b9e31ab2da86e7926cceed175"><div class="ttname"><a href="structkey__ctx.html#aae41ef2b9e31ab2da86e7926cceed175">key_ctx::cipher</a></div><div class="ttdeci">cipher_ctx_t * cipher</div><div class="ttdoc">Generic cipher context.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00166">crypto.h:166</a></div></div>
<div class="ttc" id="astructkey__ctx__bi_html_a7ef99b43dc7528037f1c81685d24a4d6"><div class="ttname"><a href="structkey__ctx__bi.html#a7ef99b43dc7528037f1c81685d24a4d6">key_ctx_bi::encrypt</a></div><div class="ttdeci">struct key_ctx encrypt</div><div class="ttdoc">Cipher and/or HMAC contexts for sending direction.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00221">crypto.h:221</a></div></div>
<div class="ttc" id="astructkey__ctx__bi_html_a2d1c4992f06672c3474722a569fb23b8"><div class="ttname"><a href="structkey__ctx__bi.html#a2d1c4992f06672c3474722a569fb23b8">key_ctx_bi::initialized</a></div><div class="ttdeci">bool initialized</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00225">crypto.h:225</a></div></div>
<div class="ttc" id="acrypto_8h_html_ab4bddbfa55994baf73b823dd49eb9320"><div class="ttname"><a href="crypto_8h.html#ab4bddbfa55994baf73b823dd49eb9320">init_key_ctx_bi</a></div><div class="ttdeci">void init_key_ctx_bi(struct key_ctx_bi *ctx, const struct key2 *key2, int key_direction, const struct key_type *kt, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00871">crypto.c:871</a></div></div>
<div class="ttc" id="astructkey_html_a9cdc2579088a9fd78f0484a3e56a5899"><div class="ttname"><a href="structkey.html#a9cdc2579088a9fd78f0484a3e56a5899">key::hmac</a></div><div class="ttdeci">uint8_t hmac[MAX_HMAC_KEY_LENGTH]</div><div class="ttdoc">Key material for HMAC operations.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00155">crypto.h:155</a></div></div>
<div class="ttc" id="astructframe_html"><div class="ttname"><a href="structframe.html">frame</a></div><div class="ttdoc">Packet geometry parameters.</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00093">mtu.h:93</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_a5ecba19b3b19dd1317e0fad83cfcd414"><div class="ttname"><a href="crypto__backend_8h.html#a5ecba19b3b19dd1317e0fad83cfcd414">MAX_CIPHER_KEY_LENGTH</a></div><div class="ttdeci">#define MAX_CIPHER_KEY_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="crypto__backend_8h_source.html#l00237">crypto_backend.h:237</a></div></div>
<div class="ttc" id="acrypto_8h_html_a3d1d59d591bbcb56e9b02116f1a66112"><div class="ttname"><a href="crypto_8h.html#a3d1d59d591bbcb56e9b02116f1a66112">write_pem_key_file</a></div><div class="ttdeci">void write_pem_key_file(const char *filename, const char *key_name)</div><div class="ttdoc">Generate a server key with enough randomness to fill a key struct and write to file.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01857">crypto.c:1857</a></div></div>
<div class="ttc" id="acrypto_8h_html_a37fb65e30bd2c33564b14ad76a0c0794"><div class="ttname"><a href="crypto_8h.html#a37fb65e30bd2c33564b14ad76a0c0794">get_random</a></div><div class="ttdeci">long int get_random(void)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01771">crypto.c:1771</a></div></div>
<div class="ttc" id="astructkey_html"><div class="ttname"><a href="structkey.html">key</a></div><div class="ttdoc">Container for unidirectional cipher and HMAC key material.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00151">crypto.h:151</a></div></div>
<div class="ttc" id="acrypto_8h_html_af3aee473fd00923f722cc0518add3d7c"><div class="ttname"><a href="crypto_8h.html#af3aee473fd00923f722cc0518add3d7c">free_key_ctx</a></div><div class="ttdeci">void free_key_ctx(struct key_ctx *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00891">crypto.c:891</a></div></div>
<div class="ttc" id="acrypto_8h_html_ab16d0ee42a623040eccffb7f9ad575c0"><div class="ttname"><a href="crypto_8h.html#ab16d0ee42a623040eccffb7f9ad575c0">keydirection2ascii</a></div><div class="ttdeci">const char * keydirection2ascii(int kd, bool remote, bool humanreadable)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01524">crypto.c:1524</a></div></div>
<div class="ttc" id="astructpacket__id_html"><div class="ttname"><a href="structpacket__id.html">packet_id</a></div><div class="ttdef"><b>Definition:</b> <a href="packet__id_8h_source.html#l00205">packet_id.h:205</a></div></div>
<div class="ttc" id="amtu_8h_html"><div class="ttname"><a href="mtu_8h.html">mtu.h</a></div></div>
<div class="ttc" id="acrypto_8h_html_a2d83f15bad7c91aaf90cff4640373d56"><div class="ttname"><a href="crypto_8h.html#a2d83f15bad7c91aaf90cff4640373d56">print_key_filename</a></div><div class="ttdeci">const char * print_key_filename(const char *str, bool is_inline)</div><div class="ttdoc">To be used when printing a string that may contain inline data.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01164">crypto.c:1164</a></div></div>
<div class="ttc" id="astructkey__ctx__bi_html"><div class="ttname"><a href="structkey__ctx__bi.html">key_ctx_bi</a></div><div class="ttdoc">Container for two sets of OpenSSL cipher and/or HMAC contexts for both sending and receiving directio...</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00219">crypto.h:219</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_a9ce521546cb78acc7159459c101aa46b"><div class="ttname"><a href="crypto__backend_8h.html#a9ce521546cb78acc7159459c101aa46b">MAX_HMAC_KEY_LENGTH</a></div><div class="ttdeci">#define MAX_HMAC_KEY_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="crypto__backend_8h_source.html#l00517">crypto_backend.h:517</a></div></div>
<div class="ttc" id="apacket__id_8h_html"><div class="ttname"><a href="packet__id_8h.html">packet_id.h</a></div></div>
<div class="ttc" id="astructkey__direction__state_html"><div class="ttname"><a href="structkey__direction__state.html">key_direction_state</a></div><div class="ttdoc">Key ordering of the key2.keys array.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00198">crypto.h:198</a></div></div>
<div class="ttc" id="astructkey__type_html_a24ca445d5f9e33112714deaf58cf3599"><div class="ttname"><a href="structkey__type.html#a24ca445d5f9e33112714deaf58cf3599">key_type::cipher_length</a></div><div class="ttdeci">uint8_t cipher_length</div><div class="ttdoc">Cipher length, in bytes.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00141">crypto.h:141</a></div></div>
<div class="ttc" id="acrypto_8h_html_ae629299ae8c5888623e26033c1784d31"><div class="ttname"><a href="crypto_8h.html#ae629299ae8c5888623e26033c1784d31">init_key_ctx</a></div><div class="ttdeci">void init_key_ctx(struct key_ctx *ctx, const struct key *key, const struct key_type *kt, int enc, const char *prefix)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00823">crypto.c:823</a></div></div>
<div class="ttc" id="acrypto__mbedtls_8h_html_a5fd03a052e0b72cb24747f7cccfc66dd"><div class="ttname"><a href="crypto__mbedtls_8h.html#a5fd03a052e0b72cb24747f7cccfc66dd">cipher_ctx_t</a></div><div class="ttdeci">mbedtls_cipher_context_t cipher_ctx_t</div><div class="ttdoc">Generic cipher context.</div><div class="ttdef"><b>Definition:</b> <a href="crypto__mbedtls_8h_source.html#l00043">crypto_mbedtls.h:43</a></div></div>
<div class="ttc" id="acrypto_8h_html_a6a09f04c154e9795c61d37fb79419cd4"><div class="ttname"><a href="crypto_8h.html#a6a09f04c154e9795c61d37fb79419cd4">ascii2keydirection</a></div><div class="ttdeci">int ascii2keydirection(int msglevel, const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01501">crypto.c:1501</a></div></div>
<div class="ttc" id="agroup__data__crypto_html_ga2756bad88224b98719d4e8f08cb11ef9"><div class="ttname"><a href="group__data__crypto.html#ga2756bad88224b98719d4e8f08cb11ef9">openvpn_encrypt</a></div><div class="ttdeci">void openvpn_encrypt(struct buffer *buf, struct buffer work, struct crypto_options *opt)</div><div class="ttdoc">Encrypt and HMAC sign a packet so that it can be sent as a data channel VPN tunnel packet to a remote...</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00299">crypto.c:299</a></div></div>
<div class="ttc" id="astructkey__ctx_html"><div class="ttname"><a href="structkey__ctx.html">key_ctx</a></div><div class="ttdoc">Container for one set of cipher and/or HMAC contexts.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00164">crypto.h:164</a></div></div>
<div class="ttc" id="acrypto_8h_html_ac2246d073775a03a612d337782cfa1a5"><div class="ttname"><a href="crypto_8h.html#ac2246d073775a03a612d337782cfa1a5">crypto_max_overhead</a></div><div class="ttdeci">unsigned int crypto_max_overhead(void)</div><div class="ttdoc">Return the worst-case OpenVPN crypto overhead (in bytes)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00716">crypto.c:716</a></div></div>
<div class="ttc" id="astructkey__direction__state_html_a650262f702aa180805a0101bbcb7646b"><div class="ttname"><a href="structkey__direction__state.html#a650262f702aa180805a0101bbcb7646b">key_direction_state::in_key</a></div><div class="ttdeci">int in_key</div><div class="ttdoc">Index into the key2.keys array for the receiving direction.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00202">crypto.h:202</a></div></div>
<div class="ttc" id="acrypto_8h_html_a5657fa40c2ed8eed4ac057b87902100b"><div class="ttname"><a href="crypto_8h.html#a5657fa40c2ed8eed4ac057b87902100b">init_key_type</a></div><div class="ttdeci">void init_key_type(struct key_type *kt, const char *ciphername, const char *authname, int keysize, bool tls_mode, bool warn)</div><div class="ttdoc">Initialize a key_type structure with.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00741">crypto.c:741</a></div></div>
<div class="ttc" id="agroup__data__crypto_html_gae91d99446478fcf3327672eb78ef0bf8"><div class="ttname"><a href="group__data__crypto.html#gae91d99446478fcf3327672eb78ef0bf8">openvpn_decrypt</a></div><div class="ttdeci">bool openvpn_decrypt(struct buffer *buf, struct buffer work, struct crypto_options *opt, const struct frame *frame, const uint8_t *ad_start)</div><div class="ttdoc">HMAC verify and decrypt a data channel packet received from a remote OpenVPN peer.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00656">crypto.c:656</a></div></div>
<div class="ttc" id="astructbuffer_html"><div class="ttname"><a href="structbuffer.html">buffer</a></div><div class="ttdoc">Wrapper structure for dynamically allocated memory.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00060">buffer.h:60</a></div></div>
<div class="ttc" id="acrypto__mbedtls_8h_html_ae9cda5ecb2fa1ec97a413d9ffbb0c87e"><div class="ttname"><a href="crypto__mbedtls_8h.html#ae9cda5ecb2fa1ec97a413d9ffbb0c87e">OPENVPN_MAX_IV_LENGTH</a></div><div class="ttdeci">#define OPENVPN_MAX_IV_LENGTH</div><div class="ttdoc">Maximum length of an IV.</div><div class="ttdef"><b>Definition:</b> <a href="crypto__mbedtls_8h_source.html#l00055">crypto_mbedtls.h:55</a></div></div>
<div class="ttc" id="astructkey__ctx_html_a094aa3b3f35e7d15ac58d5e4ef072eaa"><div class="ttname"><a href="structkey__ctx.html#a094aa3b3f35e7d15ac58d5e4ef072eaa">key_ctx::implicit_iv_len</a></div><div class="ttdeci">size_t implicit_iv_len</div><div class="ttdoc">The length of implicit_iv.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00170">crypto.h:170</a></div></div>
<div class="ttc" id="acrypto_8h_html_a3c572ced6eea1c2b933df8e82b848983"><div class="ttname"><a href="crypto_8h.html#a3c572ced6eea1c2b933df8e82b848983">test_crypto</a></div><div class="ttdeci">void test_crypto(struct crypto_options *co, struct frame *f)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01078">crypto.c:1078</a></div></div>
<div class="ttc" id="astructkey__type_html"><div class="ttname"><a href="structkey__type.html">key_type</a></div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00139">crypto.h:139</a></div></div>
<div class="ttc" id="acrypto_8h_html_a740d1036dfdb6ed93199f8bce8bbbbe9"><div class="ttname"><a href="crypto_8h.html#a740d1036dfdb6ed93199f8bce8bbbbe9">must_have_n_keys</a></div><div class="ttdeci">void must_have_n_keys(const char *filename, const char *option, const struct key2 *key2, int n)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01488">crypto.c:1488</a></div></div>
<div class="ttc" id="astructkey__direction__state_html_a235ef043e0135e9626b532d28c6a5ddc"><div class="ttname"><a href="structkey__direction__state.html#a235ef043e0135e9626b532d28c6a5ddc">key_direction_state::need_keys</a></div><div class="ttdeci">int need_keys</div><div class="ttdoc">The number of key objects necessary to support both sending and receiving.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00204">crypto.h:204</a></div></div>
<div class="ttc" id="acrypto_8h_html_abd4e2239c5b8afe85276885676851bcf"><div class="ttname"><a href="crypto_8h.html#abd4e2239c5b8afe85276885676851bcf">generate_key_random</a></div><div class="ttdeci">void generate_key_random(struct key *key, const struct key_type *kt)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01019">crypto.c:1019</a></div></div>
<div class="ttc" id="acrypto_8h_html_aa5a63a28549eab7b202ca3fa522a22d6"><div class="ttname"><a href="crypto_8h.html#aa5a63a28549eab7b202ca3fa522a22d6">read_key</a></div><div class="ttdeci">int read_key(struct key *key, const struct key_type *kt, struct buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01635">crypto.c:1635</a></div></div>
<div class="ttc" id="acrypto_8h_html_a1d7c04eddcc6269ed0f1e76fe3f9ce0f"><div class="ttname"><a href="crypto_8h.html#a1d7c04eddcc6269ed0f1e76fe3f9ce0f">prng_bytes</a></div><div class="ttdeci">void prng_bytes(uint8_t *output, int len)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01739">crypto.c:1739</a></div></div>
<div class="ttc" id="abuffer_8h_html"><div class="ttname"><a href="buffer_8h.html">buffer.h</a></div></div>
<div class="ttc" id="astructkey__ctx_html_a3abf80e0721314aa5ae121fa668620a7"><div class="ttname"><a href="structkey__ctx.html#a3abf80e0721314aa5ae121fa668620a7">key_ctx::implicit_iv</a></div><div class="ttdeci">uint8_t implicit_iv[OPENVPN_MAX_IV_LENGTH]</div><div class="ttdoc">The implicit part of the IV.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00168">crypto.h:168</a></div></div>
<div class="ttc" id="acrypto__mbedtls_8h_html_acd12a312c79aead7af792554fb5606d5"><div class="ttname"><a href="crypto__mbedtls_8h.html#acd12a312c79aead7af792554fb5606d5">md_kt_t</a></div><div class="ttdeci">mbedtls_md_info_t md_kt_t</div><div class="ttdoc">Generic message digest key type context.</div><div class="ttdef"><b>Definition:</b> <a href="crypto__mbedtls_8h_source.html#l00040">crypto_mbedtls.h:40</a></div></div>
<div class="ttc" id="acrypto_8h_html_af0c4bb63e6b4aae63502a87217a36c79"><div class="ttname"><a href="crypto_8h.html#af0c4bb63e6b4aae63502a87217a36c79">check_replay_consistency</a></div><div class="ttdeci">void check_replay_consistency(const struct key_type *kt, bool packet_id)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01003">crypto.c:1003</a></div></div>
<div class="ttc" id="astructgc__arena_html"><div class="ttname"><a href="structgc__arena.html">gc_arena</a></div><div class="ttdoc">Garbage collection arena used to keep track of dynamically allocated memory.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00116">buffer.h:116</a></div></div>
<div class="ttc" id="acrypto_8h_html_abe602273d3919da32e45249dc2af3bc5"><div class="ttname"><a href="crypto_8h.html#abe602273d3919da32e45249dc2af3bc5">key_direction_state_init</a></div><div class="ttdeci">void key_direction_state_init(struct key_direction_state *kds, int key_direction)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01553">crypto.c:1553</a></div></div>
<div class="ttc" id="astructsha256__digest_html_ab33fddc33bcbd885fc183ce3803a0ba3"><div class="ttname"><a href="structsha256__digest.html#ab33fddc33bcbd885fc183ce3803a0ba3">sha256_digest::digest</a></div><div class="ttdeci">uint8_t digest[SHA256_DIGEST_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00133">crypto.h:133</a></div></div>
<div class="ttc" id="astructkey__type_html_a496ad3263017e1eca30ec7f490a8011e"><div class="ttname"><a href="structkey__type.html#a496ad3263017e1eca30ec7f490a8011e">key_type::digest</a></div><div class="ttdeci">const md_kt_t * digest</div><div class="ttdoc">Message digest static parameters.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00144">crypto.h:144</a></div></div>
<div class="ttc" id="acrypto_8h_html_a30a5545a94f3f5be9a828a54fae87c60"><div class="ttname"><a href="crypto_8h.html#a30a5545a94f3f5be9a828a54fae87c60">verify_fix_key2</a></div><div class="ttdeci">void verify_fix_key2(struct key2 *key2, const struct key_type *kt, const char *shared_secret_file)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01582">crypto.c:1582</a></div></div>
<div class="ttc" id="acrypto_8h_html_ac1bdaec22973ae0630f27870c7430dc1"><div class="ttname"><a href="crypto_8h.html#ac1bdaec22973ae0630f27870c7430dc1">memcmp_constant_time</a></div><div class="ttdeci">int memcmp_constant_time(const void *a, const void *b, size_t size)</div><div class="ttdoc">As memcmp(), but constant-time.</div><div class="ttdef"><b>Definition:</b> <a href="crypto__openssl_8c_source.html#l01167">crypto_openssl.c:1167</a></div></div>
<div class="ttc" id="aopenvpn_2basic_8h_html"><div class="ttname"><a href="openvpn_2basic_8h.html">basic.h</a></div></div>
<div class="ttc" id="astructpacket__id__persist_html"><div class="ttname"><a href="structpacket__id__persist.html">packet_id_persist</a></div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00079">openvpn.h:79</a></div></div>
<div class="ttc" id="acrypto__mbedtls_8h_html_aa9cf0abf87b30c4c63e9c7e89c590579"><div class="ttname"><a href="crypto__mbedtls_8h.html#aa9cf0abf87b30c4c63e9c7e89c590579">SHA256_DIGEST_LENGTH</a></div><div class="ttdeci">#define SHA256_DIGEST_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="crypto__mbedtls_8h_source.html#l00078">crypto_mbedtls.h:78</a></div></div>
<div class="ttc" id="acrypto_8h_html_a0605d1e78bd3bf4e23d99e039301f934"><div class="ttname"><a href="crypto_8h.html#a0605d1e78bd3bf4e23d99e039301f934">free_key_ctx_bi</a></div><div class="ttdeci">void free_key_ctx_bi(struct key_ctx_bi *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00908">crypto.c:908</a></div></div>
<div class="ttc" id="astructkey__type_html_aba064fbaa853a46ae2d3afbc3ae98aff"><div class="ttname"><a href="structkey__type.html#aba064fbaa853a46ae2d3afbc3ae98aff">key_type::cipher</a></div><div class="ttdeci">const cipher_kt_t * cipher</div><div class="ttdoc">Cipher static parameters.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00143">crypto.h:143</a></div></div>
<div class="ttc" id="acrypto_8h_html_a1e6bbdde50a9843d441c22ada85e6345"><div class="ttname"><a href="crypto_8h.html#a1e6bbdde50a9843d441c22ada85e6345">crypto_check_replay</a></div><div class="ttdeci">bool crypto_check_replay(struct crypto_options *opt, const struct packet_id_net *pin, const char *error_prefix, struct gc_arena *gc)</div><div class="ttdoc">Check packet ID for replay, and perform replay administration.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00319">crypto.c:319</a></div></div>
<div class="ttc" id="acrypto_8h_html_a87b883dc7b32de49358a397c4e5a56a6"><div class="ttname"><a href="crypto_8h.html#a87b883dc7b32de49358a397c4e5a56a6">check_key</a></div><div class="ttdeci">bool check_key(struct key *key, const struct key_type *kt)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00933">crypto.c:933</a></div></div>
<div class="ttc" id="astructkey_html_a94ff5232b6e56df51d126b8695a9413c"><div class="ttname"><a href="structkey.html#a94ff5232b6e56df51d126b8695a9413c">key::cipher</a></div><div class="ttdeci">uint8_t cipher[MAX_CIPHER_KEY_LENGTH]</div><div class="ttdoc">Key material for cipher operations.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00153">crypto.h:153</a></div></div>
<div class="ttc" id="acrypto_8h_html_ac5e8c79c3087b70be89679a45aa3a310"><div class="ttname"><a href="crypto_8h.html#ac5e8c79c3087b70be89679a45aa3a310">write_key</a></div><div class="ttdeci">bool write_key(const struct key *key, const struct key_type *kt, struct buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01602">crypto.c:1602</a></div></div>
<div class="ttc" id="astructpacket__id__net_html"><div class="ttname"><a href="structpacket__id__net.html">packet_id_net</a></div><div class="ttdef"><b>Definition:</b> <a href="packet__id_8h_source.html#l00199">packet_id.h:199</a></div></div>
<div class="ttc" id="astructkey2_html"><div class="ttname"><a href="structkey2.html">key2</a></div><div class="ttdoc">Container for bidirectional cipher and HMAC key material.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00181">crypto.h:181</a></div></div>
<div class="ttc" id="acrypto__mbedtls_8h_html_aa82c97683560a0df89eddd2a3cf6e6d4"><div class="ttname"><a href="crypto__mbedtls_8h.html#aa82c97683560a0df89eddd2a3cf6e6d4">cipher_kt_t</a></div><div class="ttdeci">mbedtls_cipher_info_t cipher_kt_t</div><div class="ttdoc">Generic cipher key type context.</div><div class="ttdef"><b>Definition:</b> <a href="crypto__mbedtls_8h_source.html#l00037">crypto_mbedtls.h:37</a></div></div>
<div class="ttc" id="acrypto_8h_html_af597e0d765df961d66a200fa33ba4faf"><div class="ttname"><a href="crypto_8h.html#af597e0d765df961d66a200fa33ba4faf">crypto_adjust_frame_parameters</a></div><div class="ttdeci">void crypto_adjust_frame_parameters(struct frame *frame, const struct key_type *kt, bool packet_id, bool packet_id_long_form)</div><div class="ttdoc">Calculate crypto overhead and adjust frame to account for that.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00682">crypto.c:682</a></div></div>
<div class="ttc" id="astructsha256__digest_html"><div class="ttname"><a href="structsha256__digest.html">sha256_digest</a></div><div class="ttdoc">Wrapper struct to pass around SHA256 digests.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00132">crypto.h:132</a></div></div>
<div class="ttc" id="acrypto_8h_html_ae8c523b770f0e2f30d44004797106508"><div class="ttname"><a href="crypto_8h.html#ae8c523b770f0e2f30d44004797106508">prng_uninit</a></div><div class="ttdeci">void prng_uninit(void)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01730">crypto.c:1730</a></div></div>
<div class="ttc" id="acrypto_8h_html_a81c00d1ee124bc52b54b6b3082fba96e"><div class="ttname"><a href="crypto_8h.html#a81c00d1ee124bc52b54b6b3082fba96e">write_key_file</a></div><div class="ttdeci">int write_key_file(const int nkeys, const char *filename)</div><div class="ttdoc">Write nkeys 1024-bits keys to file.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01425">crypto.c:1425</a></div></div>
<div class="ttc" id="acrypto_8h_html_a4a653f6e2b03fc30f52845d37b5867a9"><div class="ttname"><a href="crypto_8h.html#a4a653f6e2b03fc30f52845d37b5867a9">read_pem_key_file</a></div><div class="ttdeci">bool read_pem_key_file(struct buffer *key, const char *pem_name, const char *key_file, bool key_inline)</div><div class="ttdoc">Read key material from a PEM encoded files into the key structure.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01913">crypto.c:1913</a></div></div>
<div class="ttc" id="astructkey__ctx_html_ac82e9ac5970ca208fa7d36c9a49bb4a7"><div class="ttname"><a href="structkey__ctx.html#ac82e9ac5970ca208fa7d36c9a49bb4a7">key_ctx::hmac</a></div><div class="ttdeci">hmac_ctx_t * hmac</div><div class="ttdoc">Generic HMAC context.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00167">crypto.h:167</a></div></div>
<div class="ttc" id="astructcrypto__options_html_a4f1cebf03b32cf2f3b44e90630079e88"><div class="ttname"><a href="structcrypto__options.html#a4f1cebf03b32cf2f3b44e90630079e88">crypto_options::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdoc">Bit-flags determining behavior of security operation functions.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00257">crypto.h:257</a></div></div>
<div class="ttc" id="astructkey2_html_a9698a633f0112a2000a0efdb8d960010"><div class="ttname"><a href="structkey2.html#a9698a633f0112a2000a0efdb8d960010">key2::keys</a></div><div class="ttdeci">struct key keys[2]</div><div class="ttdoc">Two unidirectional sets of key material.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00185">crypto.h:185</a></div></div>
<div class="ttc" id="astructcrypto__options_html_a64268b2eac664d85f5e6133264f937ce"><div class="ttname"><a href="structcrypto__options.html#a64268b2eac664d85f5e6133264f937ce">crypto_options::pid_persist</a></div><div class="ttdeci">struct packet_id_persist * pid_persist</div><div class="ttdoc">Persistent packet ID state for keeping state between successive OpenVPN process startups.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00240">crypto.h:240</a></div></div>
<div class="ttc" id="astructkey__ctx__bi_html_a552f7a501cae9ddf3a107d87a1b039fa"><div class="ttname"><a href="structkey__ctx__bi.html#a552f7a501cae9ddf3a107d87a1b039fa">key_ctx_bi::decrypt</a></div><div class="ttdeci">struct key_ctx decrypt</div><div class="ttdoc">cipher and/or HMAC contexts for receiving direction.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00223">crypto.h:223</a></div></div>
<div class="ttc" id="anamespacehttp-client_html_aadb490246e2a9943d5fe72016ff60d19"><div class="ttname"><a href="namespacehttp-client.html#aadb490246e2a9943d5fe72016ff60d19">http-client.f</a></div><div class="ttdeci">string f</div><div class="ttdef"><b>Definition:</b> <a href="http-client_8py_source.html#l00006">http-client.py:6</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html"><div class="ttname"><a href="crypto__backend_8h.html">crypto_backend.h</a></div></div>
<div class="ttc" id="acrypto_8h_html_a3482d06fa45961722769bcad30ed3407"><div class="ttname"><a href="crypto_8h.html#a3482d06fa45961722769bcad30ed3407">read_key_file</a></div><div class="ttdeci">void read_key_file(struct key2 *key2, const char *file, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01222">crypto.c:1222</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a9a941819355e6f658991890ff66b4b0e"><div class="ttname"><a href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a></div><div class="ttdeci">unsigned __int8 uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00164">config-msvc.h:164</a></div></div>
<div class="ttc" id="astructcrypto__options_html"><div class="ttname"><a href="structcrypto__options.html">crypto_options</a></div><div class="ttdoc">Security parameter state for processing data channel packets.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00232">crypto.h:232</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
