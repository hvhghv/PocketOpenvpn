<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: src/openvpn/crypto.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_92f13d409beef24f5ba1b81abfed1f1c.html">openvpn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">crypto.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="crypto__backend_8h_source.html">crypto_backend.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="openvpn_2basic_8h_source.html">basic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="buffer_8h_source.html">buffer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="packet__id_8h_source.html">packet_id.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mtu_8h_source.html">mtu.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for crypto.h:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8h__incl.png" border="0" usemap="#src_2openvpn_2crypto_8h" alt=""/></div>
<map name="src_2openvpn_2crypto_8h" id="src_2openvpn_2crypto_8h">
<area shape="rect" title=" " alt="" coords="517,5,661,32"/>
<area shape="rect" href="crypto__backend_8h.html" title=" " alt="" coords="441,155,567,181"/>
<area shape="rect" href="openvpn_2basic_8h.html" title=" " alt="" coords="609,379,673,405"/>
<area shape="rect" href="buffer_8h.html" title=" " alt="" coords="609,229,674,256"/>
<area shape="rect" href="packet__id_8h.html" title=" " alt="" coords="731,80,821,107"/>
<area shape="rect" href="mtu_8h.html" title=" " alt="" coords="562,80,617,107"/>
<area shape="rect" href="crypto__openssl_8h.html" title=" " alt="" coords="293,229,414,256"/>
<area shape="rect" title=" " alt="" coords="302,304,405,331"/>
<area shape="rect" title=" " alt="" coords="429,304,544,331"/>
<area shape="rect" title=" " alt="" coords="44,304,151,331"/>
<area shape="rect" title=" " alt="" coords="175,304,278,331"/>
<area shape="rect" href="openvpn_2error_8h.html" title=" " alt="" coords="944,304,1003,331"/>
<area shape="rect" title=" " alt="" coords="942,379,1005,405"/>
<area shape="rect" title=" " alt="" coords="1029,379,1104,405"/>
<area shape="rect" title=" " alt="" coords="1128,379,1197,405"/>
<area shape="rect" href="errlevel_8h.html" title=" " alt="" coords="843,379,917,405"/>
<area shape="rect" href="circ__list_8h.html" title=" " alt="" coords="847,155,926,181"/>
<area shape="rect" href="otime_8h.html" title=" " alt="" coords="743,155,809,181"/>
<area shape="rect" href="integer_8h.html" title=" " alt="" coords="805,229,877,256"/>
<area shape="rect" href="common_8h.html" title=" " alt="" coords="699,229,781,256"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="crypto_8h__dep__incl.png" border="0" usemap="#src_2openvpn_2crypto_8hdep" alt=""/></div>
<map name="src_2openvpn_2crypto_8hdep" id="src_2openvpn_2crypto_8hdep">
<area shape="rect" title=" " alt="" coords="2926,5,3070,32"/>
<area shape="rect" href="auth__token_8c.html" title=" " alt="" coords="2624,505,2796,531"/>
<area shape="rect" href="openvpn_8h.html" title=" " alt="" coords="832,244,990,271"/>
<area shape="rect" href="options_8c.html" title=" " alt="" coords="2110,505,2261,531"/>
<area shape="rect" href="proxy_8c.html" title=" " alt="" coords="1008,415,1147,442"/>
<area shape="rect" href="ssl_8h.html" title=" " alt="" coords="2614,169,2739,196"/>
<area shape="rect" href="tls__crypt_8c.html" title=" " alt="" coords="2896,244,3054,271"/>
<area shape="rect" href="ssl__common_8h.html" title=" " alt="" coords="2485,87,2668,114"/>
<area shape="rect" href="tls__crypt_8h.html" title=" " alt="" coords="2764,169,2922,196"/>
<area shape="rect" href="crypto_8c.html" title=" " alt="" coords="2844,87,2988,114"/>
<area shape="rect" href="crypto__openssl_8c.html" title=" " alt="" coords="3012,80,3146,121"/>
<area shape="rect" href="fragment_8c.html" title=" " alt="" coords="3170,87,3329,114"/>
<area shape="rect" href="httpdigest_8c.html" title=" " alt="" coords="3354,87,3519,114"/>
<area shape="rect" href="misc_8c.html" title=" " alt="" coords="3543,87,3679,114"/>
<area shape="rect" href="ntlm_8c.html" title=" " alt="" coords="3703,87,3836,114"/>
<area shape="rect" href="platform_8c.html" title=" " alt="" coords="3860,87,4015,114"/>
<area shape="rect" href="schedule_8c.html" title=" " alt="" coords="4039,87,4199,114"/>
<area shape="rect" href="session__id_8c.html" title=" " alt="" coords="4223,87,4394,114"/>
<area shape="rect" href="test__crypto_8c.html" title=" " alt="" coords="4418,80,4583,121"/>
<area shape="rect" href="test__auth__token_8c.html" title=" " alt="" coords="2627,587,2792,628"/>
<area shape="rect" href="forward_8h.html" title=" " alt="" coords="1365,326,1516,353"/>
<area shape="rect" href="sig_8c.html" title=" " alt="" coords="72,505,198,531"/>
<area shape="rect" href="socket_8c.html" title=" " alt="" coords="838,415,984,442"/>
<area shape="rect" href="init_8h.html" title=" " alt="" coords="635,326,760,353"/>
<area shape="rect" href="vlan_8h.html" title=" " alt="" coords="420,326,552,353"/>
<area shape="rect" href="ssl__ncp_8c.html" title=" " alt="" coords="162,326,316,353"/>
<area shape="rect" href="push_8h.html" title=" " alt="" coords="1939,415,2075,442"/>
<area shape="rect" href="forward_8c.html" title=" " alt="" coords="1277,505,1428,531"/>
<area shape="rect" href="helper_8c.html" title=" " alt="" coords="1756,505,1898,531"/>
<area shape="rect" href="multi_8c.html" title=" " alt="" coords="960,505,1096,531"/>
<area shape="rect" href="occ_8h.html" title=" " alt="" coords="1582,415,1712,442"/>
<area shape="rect" href="init_8c.html" title=" " alt="" coords="1452,505,1578,531"/>
<area shape="rect" href="occ_8c.html" title=" " alt="" coords="1602,505,1732,531"/>
<area shape="rect" href="ping_8h.html" title=" " alt="" coords="1374,415,1506,442"/>
<area shape="rect" href="multi_8h.html" title=" " alt="" coords="366,415,502,442"/>
<area shape="rect" href="mtcp_8c.html" title=" " alt="" coords="602,505,740,531"/>
<area shape="rect" href="mudp_8c.html" title=" " alt="" coords="785,505,925,531"/>
<area shape="rect" href="openvpn_8c.html" title=" " alt="" coords="379,505,536,531"/>
<area shape="rect" href="push_8c.html" title=" " alt="" coords="2286,505,2422,531"/>
<area shape="rect" href="ssl__verify_8c.html" title=" " alt="" coords="1923,505,2086,531"/>
<area shape="rect" href="ping_8c.html" title=" " alt="" coords="1121,505,1253,531"/>
<area shape="rect" href="vlan_8c.html" title=" " alt="" coords="222,505,354,531"/>
<area shape="rect" href="openvpn_2error_8c.html" title=" " alt="" coords="577,415,712,442"/>
<area shape="rect" href="test__ncp_8c.html" title=" " alt="" coords="24,408,190,449"/>
<area shape="rect" href="manage_8c.html" title=" " alt="" coords="2463,244,2618,271"/>
<area shape="rect" href="ssl_8c.html" title=" " alt="" coords="2820,505,2946,531"/>
<area shape="rect" href="test__tls__crypt_8c.html" title=" " alt="" coords="2895,319,3060,360"/>
<area shape="rect" href="ssl__verify_8h.html" title=" " alt="" coords="2200,415,2363,442"/>
<area shape="rect" href="ssl__openssl_8c.html" title=" " alt="" coords="2361,169,2538,196"/>
<area shape="rect" href="ssl__verify__openssl_8c.html" title=" " alt="" coords="2446,497,2600,539"/>
</map>
</div>
</div>
<p><a href="crypto_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsha256__digest.html">sha256_digest</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper struct to pass around SHA256 digests.  <a href="structsha256__digest.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__type.html">key_type</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey.html">key</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for unidirectional cipher and HMAC key material.  <a href="structkey.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__ctx.html">key_ctx</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for one set of cipher and/or HMAC contexts.  <a href="structkey__ctx.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey2.html">key2</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for bidirectional cipher and HMAC key material.  <a href="structkey2.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__direction__state.html">key_direction_state</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key ordering of the <code><a class="el" href="structkey2.html#a9698a633f0112a2000a0efdb8d960010" title="Two unidirectional sets of key material.">key2.keys</a></code> array.  <a href="structkey__direction__state.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for two sets of OpenSSL cipher and/or HMAC contexts for both sending and receiving directions.  <a href="structkey__ctx__bi.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__options.html">crypto_options</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Security parameter state for processing data channel packets.  <a href="structcrypto__options.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab8be0ec27dfc6dc8d779afa0c42db52c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ab8be0ec27dfc6dc8d779afa0c42db52c">KEY_DIRECTION_BIDIRECTIONAL</a>&#160;&#160;&#160;0 /* same keys for both directions */</td></tr>
<tr class="separator:ab8be0ec27dfc6dc8d779afa0c42db52c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09112b6672bf44b0ecef2eee6348244c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a09112b6672bf44b0ecef2eee6348244c">KEY_DIRECTION_NORMAL</a>&#160;&#160;&#160;1 /* encrypt with keys[0], decrypt with keys[1] */</td></tr>
<tr class="separator:a09112b6672bf44b0ecef2eee6348244c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad246376c36364cabaacea01498048ec7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ad246376c36364cabaacea01498048ec7">KEY_DIRECTION_INVERSE</a>&#160;&#160;&#160;2 /* encrypt with keys[1], decrypt with keys[0] */</td></tr>
<tr class="separator:ad246376c36364cabaacea01498048ec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10cf731ef4917a647cdca413d507ff81"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a10cf731ef4917a647cdca413d507ff81">CO_PACKET_ID_LONG_FORM</a>&#160;&#160;&#160;(1&lt;&lt;0)</td></tr>
<tr class="memdesc:a10cf731ef4917a647cdca413d507ff81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit-flag indicating whether to use OpenVPN's long packet ID format.  <a href="crypto_8h.html#a10cf731ef4917a647cdca413d507ff81">More...</a><br /></td></tr>
<tr class="separator:a10cf731ef4917a647cdca413d507ff81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46afc2f632a024378e286f6ada0ade76"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a46afc2f632a024378e286f6ada0ade76">CO_IGNORE_PACKET_ID</a>&#160;&#160;&#160;(1&lt;&lt;1)</td></tr>
<tr class="memdesc:a46afc2f632a024378e286f6ada0ade76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit-flag indicating whether to ignore the packet ID of a received packet.  <a href="crypto_8h.html#a46afc2f632a024378e286f6ada0ade76">More...</a><br /></td></tr>
<tr class="separator:a46afc2f632a024378e286f6ada0ade76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a897fcd411cae93fbed05653515ce480e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a897fcd411cae93fbed05653515ce480e">CO_MUTE_REPLAY_WARNINGS</a>&#160;&#160;&#160;(1&lt;&lt;2)</td></tr>
<tr class="memdesc:a897fcd411cae93fbed05653515ce480e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bit-flag indicating not to display replay warnings.  <a href="crypto_8h.html#a897fcd411cae93fbed05653515ce480e">More...</a><br /></td></tr>
<tr class="separator:a897fcd411cae93fbed05653515ce480e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c30c5ee1d0788ec86d22aec61952199"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a3c30c5ee1d0788ec86d22aec61952199">CRYPT_ERROR</a>(format)&#160;&#160;&#160;do { <a class="el" href="tapctl_2error_8h.html#ab7e01d5e5174b3ddbc247f4a2ac45141">msg</a>(<a class="el" href="errlevel_8h.html#a82c6e0357ff0b26eaa2ad2fb17cc1268">D_CRYPT_ERRORS</a>, &quot;%s: &quot; format, error_prefix); goto error_exit; } while (false)</td></tr>
<tr class="separator:a3c30c5ee1d0788ec86d22aec61952199"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3658531e5110d45db922d6a47fb2454b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a3658531e5110d45db922d6a47fb2454b">OPENVPN_AEAD_MIN_IV_LEN</a>&#160;&#160;&#160;(sizeof(<a class="el" href="packet__id_8h.html#a345f753b1c6ea20d24409e769aadb7e6">packet_id_type</a>) + 8)</td></tr>
<tr class="memdesc:a3658531e5110d45db922d6a47fb2454b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimal IV length for AEAD mode ciphers (in bytes): 4-byte packet id + 8 bytes implicit IV.  <a href="crypto_8h.html#a3658531e5110d45db922d6a47fb2454b">More...</a><br /></td></tr>
<tr class="separator:a3658531e5110d45db922d6a47fb2454b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abab39c003d995feddd945d8c680be0bd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#abab39c003d995feddd945d8c680be0bd">RKF_MUST_SUCCEED</a>&#160;&#160;&#160;(1&lt;&lt;0)</td></tr>
<tr class="separator:abab39c003d995feddd945d8c680be0bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88d01fb7acc16a3c70e24fbc61b741bc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a88d01fb7acc16a3c70e24fbc61b741bc">RKF_INLINE</a>&#160;&#160;&#160;(1&lt;&lt;1)</td></tr>
<tr class="separator:a88d01fb7acc16a3c70e24fbc61b741bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89d9152ef191855e0958554eca1e877c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a89d9152ef191855e0958554eca1e877c">NONCE_SECRET_LEN_MIN</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a89d9152ef191855e0958554eca1e877c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73f126605671fbbab2201edf86635df4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a73f126605671fbbab2201edf86635df4">NONCE_SECRET_LEN_MAX</a>&#160;&#160;&#160;64</td></tr>
<tr class="separator:a73f126605671fbbab2201edf86635df4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72d592a2e01dbbf9ac96d01aa811fee7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a72d592a2e01dbbf9ac96d01aa811fee7">PRNG_NONCE_RESET_BYTES</a>&#160;&#160;&#160;1024</td></tr>
<tr class="memdesc:a72d592a2e01dbbf9ac96d01aa811fee7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes of random to allow before resetting the nonce.  <a href="crypto_8h.html#a72d592a2e01dbbf9ac96d01aa811fee7">More...</a><br /></td></tr>
<tr class="separator:a72d592a2e01dbbf9ac96d01aa811fee7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3482d06fa45961722769bcad30ed3407"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a3482d06fa45961722769bcad30ed3407">read_key_file</a> (struct <a class="el" href="structkey2.html">key2</a> *<a class="el" href="structkey2.html">key2</a>, const char *file, const unsigned int flags)</td></tr>
<tr class="separator:a3482d06fa45961722769bcad30ed3407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81c00d1ee124bc52b54b6b3082fba96e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a81c00d1ee124bc52b54b6b3082fba96e">write_key_file</a> (const int nkeys, const char *filename)</td></tr>
<tr class="memdesc:a81c00d1ee124bc52b54b6b3082fba96e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write nkeys 1024-bits keys to file.  <a href="crypto_8h.html#a81c00d1ee124bc52b54b6b3082fba96e">More...</a><br /></td></tr>
<tr class="separator:a81c00d1ee124bc52b54b6b3082fba96e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd4e2239c5b8afe85276885676851bcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#abd4e2239c5b8afe85276885676851bcf">generate_key_random</a> (struct <a class="el" href="structkey.html">key</a> *<a class="el" href="structkey.html">key</a>, const struct <a class="el" href="structkey__type.html">key_type</a> *kt)</td></tr>
<tr class="separator:abd4e2239c5b8afe85276885676851bcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0c4bb63e6b4aae63502a87217a36c79"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#af0c4bb63e6b4aae63502a87217a36c79">check_replay_consistency</a> (const struct <a class="el" href="structkey__type.html">key_type</a> *kt, bool <a class="el" href="structpacket__id.html">packet_id</a>)</td></tr>
<tr class="separator:af0c4bb63e6b4aae63502a87217a36c79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87b883dc7b32de49358a397c4e5a56a6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a87b883dc7b32de49358a397c4e5a56a6">check_key</a> (struct <a class="el" href="structkey.html">key</a> *<a class="el" href="structkey.html">key</a>, const struct <a class="el" href="structkey__type.html">key_type</a> *kt)</td></tr>
<tr class="separator:a87b883dc7b32de49358a397c4e5a56a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba43c7afa9dab7d3d1bb9443a0fba6d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#aba43c7afa9dab7d3d1bb9443a0fba6d8">fixup_key</a> (struct <a class="el" href="structkey.html">key</a> *<a class="el" href="structkey.html">key</a>, const struct <a class="el" href="structkey__type.html">key_type</a> *kt)</td></tr>
<tr class="separator:aba43c7afa9dab7d3d1bb9443a0fba6d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5e8c79c3087b70be89679a45aa3a310"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac5e8c79c3087b70be89679a45aa3a310">write_key</a> (const struct <a class="el" href="structkey.html">key</a> *<a class="el" href="structkey.html">key</a>, const struct <a class="el" href="structkey__type.html">key_type</a> *kt, struct <a class="el" href="structbuffer.html">buffer</a> *buf)</td></tr>
<tr class="separator:ac5e8c79c3087b70be89679a45aa3a310"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5a63a28549eab7b202ca3fa522a22d6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#aa5a63a28549eab7b202ca3fa522a22d6">read_key</a> (struct <a class="el" href="structkey.html">key</a> *<a class="el" href="structkey.html">key</a>, const struct <a class="el" href="structkey__type.html">key_type</a> *kt, struct <a class="el" href="structbuffer.html">buffer</a> *buf)</td></tr>
<tr class="separator:aa5a63a28549eab7b202ca3fa522a22d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5657fa40c2ed8eed4ac057b87902100b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a5657fa40c2ed8eed4ac057b87902100b">init_key_type</a> (struct <a class="el" href="structkey__type.html">key_type</a> *kt, const char *ciphername, const char *authname, int keysize, bool tls_mode, bool warn)</td></tr>
<tr class="memdesc:a5657fa40c2ed8eed4ac057b87902100b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize a <a class="el" href="structkey__type.html">key_type</a> structure with.  <a href="crypto_8h.html#a5657fa40c2ed8eed4ac057b87902100b">More...</a><br /></td></tr>
<tr class="separator:a5657fa40c2ed8eed4ac057b87902100b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae629299ae8c5888623e26033c1784d31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ae629299ae8c5888623e26033c1784d31">init_key_ctx</a> (struct <a class="el" href="structkey__ctx.html">key_ctx</a> *ctx, const struct <a class="el" href="structkey.html">key</a> *<a class="el" href="structkey.html">key</a>, const struct <a class="el" href="structkey__type.html">key_type</a> *kt, int enc, const char *prefix)</td></tr>
<tr class="separator:ae629299ae8c5888623e26033c1784d31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3aee473fd00923f722cc0518add3d7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#af3aee473fd00923f722cc0518add3d7c">free_key_ctx</a> (struct <a class="el" href="structkey__ctx.html">key_ctx</a> *ctx)</td></tr>
<tr class="separator:af3aee473fd00923f722cc0518add3d7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4bddbfa55994baf73b823dd49eb9320"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ab4bddbfa55994baf73b823dd49eb9320">init_key_ctx_bi</a> (struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *ctx, const struct <a class="el" href="structkey2.html">key2</a> *<a class="el" href="structkey2.html">key2</a>, int key_direction, const struct <a class="el" href="structkey__type.html">key_type</a> *kt, const char *name)</td></tr>
<tr class="separator:ab4bddbfa55994baf73b823dd49eb9320"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0605d1e78bd3bf4e23d99e039301f934"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a0605d1e78bd3bf4e23d99e039301f934">free_key_ctx_bi</a> (struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *ctx)</td></tr>
<tr class="separator:a0605d1e78bd3bf4e23d99e039301f934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6bbdde50a9843d441c22ada85e6345"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a1e6bbdde50a9843d441c22ada85e6345">crypto_check_replay</a> (struct <a class="el" href="structcrypto__options.html">crypto_options</a> *opt, const struct <a class="el" href="structpacket__id__net.html">packet_id_net</a> *pin, const char *error_prefix, struct <a class="el" href="structgc__arena.html">gc_arena</a> *gc)</td></tr>
<tr class="memdesc:a1e6bbdde50a9843d441c22ada85e6345"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check packet ID for replay, and perform replay administration.  <a href="crypto_8h.html#a1e6bbdde50a9843d441c22ada85e6345">More...</a><br /></td></tr>
<tr class="separator:a1e6bbdde50a9843d441c22ada85e6345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af597e0d765df961d66a200fa33ba4faf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#af597e0d765df961d66a200fa33ba4faf">crypto_adjust_frame_parameters</a> (struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>, const struct <a class="el" href="structkey__type.html">key_type</a> *kt, bool <a class="el" href="structpacket__id.html">packet_id</a>, bool packet_id_long_form)</td></tr>
<tr class="memdesc:af597e0d765df961d66a200fa33ba4faf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate crypto overhead and adjust frame to account for that.  <a href="crypto_8h.html#af597e0d765df961d66a200fa33ba4faf">More...</a><br /></td></tr>
<tr class="separator:af597e0d765df961d66a200fa33ba4faf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2246d073775a03a612d337782cfa1a5"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac2246d073775a03a612d337782cfa1a5">crypto_max_overhead</a> (void)</td></tr>
<tr class="memdesc:ac2246d073775a03a612d337782cfa1a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the worst-case OpenVPN crypto overhead (in bytes)  <a href="crypto_8h.html#ac2246d073775a03a612d337782cfa1a5">More...</a><br /></td></tr>
<tr class="separator:ac2246d073775a03a612d337782cfa1a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d1d59d591bbcb56e9b02116f1a66112"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a3d1d59d591bbcb56e9b02116f1a66112">write_pem_key_file</a> (const char *filename, const char *key_name)</td></tr>
<tr class="memdesc:a3d1d59d591bbcb56e9b02116f1a66112"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a server key with enough randomness to fill a key struct and write to file.  <a href="crypto_8h.html#a3d1d59d591bbcb56e9b02116f1a66112">More...</a><br /></td></tr>
<tr class="separator:a3d1d59d591bbcb56e9b02116f1a66112"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41e699455c3550f40ca4cbe7592a439a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a41e699455c3550f40ca4cbe7592a439a">generate_ephemeral_key</a> (struct <a class="el" href="structbuffer.html">buffer</a> *<a class="el" href="structkey.html">key</a>, const char *pem_name)</td></tr>
<tr class="memdesc:a41e699455c3550f40ca4cbe7592a439a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate ephermal key material into the key structure.  <a href="crypto_8h.html#a41e699455c3550f40ca4cbe7592a439a">More...</a><br /></td></tr>
<tr class="separator:a41e699455c3550f40ca4cbe7592a439a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a653f6e2b03fc30f52845d37b5867a9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a4a653f6e2b03fc30f52845d37b5867a9">read_pem_key_file</a> (struct <a class="el" href="structbuffer.html">buffer</a> *<a class="el" href="structkey.html">key</a>, const char *pem_name, const char *key_file, bool key_inline)</td></tr>
<tr class="memdesc:a4a653f6e2b03fc30f52845d37b5867a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read key material from a PEM encoded files into the key structure.  <a href="crypto_8h.html#a4a653f6e2b03fc30f52845d37b5867a9">More...</a><br /></td></tr>
<tr class="separator:a4a653f6e2b03fc30f52845d37b5867a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab99dea190ad93a642a0fc5a429b8f0ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ab99dea190ad93a642a0fc5a429b8f0ed">prng_init</a> (const char *md_name, const int nonce_secret_len_parm)</td></tr>
<tr class="memdesc:ab99dea190ad93a642a0fc5a429b8f0ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pseudo-random number generator initialisation.  <a href="crypto_8h.html#ab99dea190ad93a642a0fc5a429b8f0ed">More...</a><br /></td></tr>
<tr class="separator:ab99dea190ad93a642a0fc5a429b8f0ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d7c04eddcc6269ed0f1e76fe3f9ce0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a1d7c04eddcc6269ed0f1e76fe3f9ce0f">prng_bytes</a> (<a class="el" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> *output, int len)</td></tr>
<tr class="separator:a1d7c04eddcc6269ed0f1e76fe3f9ce0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c523b770f0e2f30d44004797106508"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ae8c523b770f0e2f30d44004797106508">prng_uninit</a> (void)</td></tr>
<tr class="separator:ae8c523b770f0e2f30d44004797106508"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37fb65e30bd2c33564b14ad76a0c0794"><td class="memItemLeft" align="right" valign="top">long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a37fb65e30bd2c33564b14ad76a0c0794">get_random</a> (void)</td></tr>
<tr class="separator:a37fb65e30bd2c33564b14ad76a0c0794"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59685c1dc9130804ba9e40804ff5af56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a59685c1dc9130804ba9e40804ff5af56">print_cipher</a> (const <a class="el" href="crypto__mbedtls_8h.html#aa82c97683560a0df89eddd2a3cf6e6d4">cipher_kt_t</a> *cipher)</td></tr>
<tr class="memdesc:a59685c1dc9130804ba9e40804ff5af56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a cipher list entry.  <a href="crypto_8h.html#a59685c1dc9130804ba9e40804ff5af56">More...</a><br /></td></tr>
<tr class="separator:a59685c1dc9130804ba9e40804ff5af56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c572ced6eea1c2b933df8e82b848983"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a3c572ced6eea1c2b933df8e82b848983">test_crypto</a> (struct <a class="el" href="structcrypto__options.html">crypto_options</a> *co, struct <a class="el" href="structframe.html">frame</a> *f)</td></tr>
<tr class="separator:a3c572ced6eea1c2b933df8e82b848983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe602273d3919da32e45249dc2af3bc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#abe602273d3919da32e45249dc2af3bc5">key_direction_state_init</a> (struct <a class="el" href="structkey__direction__state.html">key_direction_state</a> *kds, int key_direction)</td></tr>
<tr class="separator:abe602273d3919da32e45249dc2af3bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a5545a94f3f5be9a828a54fae87c60"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a30a5545a94f3f5be9a828a54fae87c60">verify_fix_key2</a> (struct <a class="el" href="structkey2.html">key2</a> *<a class="el" href="structkey2.html">key2</a>, const struct <a class="el" href="structkey__type.html">key_type</a> *kt, const char *shared_secret_file)</td></tr>
<tr class="separator:a30a5545a94f3f5be9a828a54fae87c60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a740d1036dfdb6ed93199f8bce8bbbbe9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a740d1036dfdb6ed93199f8bce8bbbbe9">must_have_n_keys</a> (const char *filename, const char *option, const struct <a class="el" href="structkey2.html">key2</a> *<a class="el" href="structkey2.html">key2</a>, int n)</td></tr>
<tr class="separator:a740d1036dfdb6ed93199f8bce8bbbbe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a09f04c154e9795c61d37fb79419cd4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a6a09f04c154e9795c61d37fb79419cd4">ascii2keydirection</a> (int msglevel, const char *str)</td></tr>
<tr class="separator:a6a09f04c154e9795c61d37fb79419cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16d0ee42a623040eccffb7f9ad575c0"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ab16d0ee42a623040eccffb7f9ad575c0">keydirection2ascii</a> (int kd, bool remote, bool humanreadable)</td></tr>
<tr class="separator:ab16d0ee42a623040eccffb7f9ad575c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a5874f830425ad932c70899d6d25b7d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a2a5874f830425ad932c70899d6d25b7d">key2_print</a> (const struct <a class="el" href="structkey2.html">key2</a> *k, const struct <a class="el" href="structkey__type.html">key_type</a> *kt, const char *prefix0, const char *prefix1)</td></tr>
<tr class="separator:a2a5874f830425ad932c70899d6d25b7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed99ce5177c96881467847708e18b0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#aeed99ce5177c96881467847708e18b0e">crypto_read_openvpn_key</a> (const struct <a class="el" href="structkey__type.html">key_type</a> *<a class="el" href="structkey__type.html">key_type</a>, struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *ctx, const char *key_file, bool key_inline, const int key_direction, const char *key_name, const char *opt_name)</td></tr>
<tr class="separator:aeed99ce5177c96881467847708e18b0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1bdaec22973ae0630f27870c7430dc1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#ac1bdaec22973ae0630f27870c7430dc1">memcmp_constant_time</a> (const void *a, const void *b, size_t size)</td></tr>
<tr class="memdesc:ac1bdaec22973ae0630f27870c7430dc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">As memcmp(), but constant-time.  <a href="crypto_8h.html#ac1bdaec22973ae0630f27870c7430dc1">More...</a><br /></td></tr>
<tr class="separator:ac1bdaec22973ae0630f27870c7430dc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3e5e7a3b96977793b215f952186d820"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#af3e5e7a3b96977793b215f952186d820">key_ctx_bi_defined</a> (const struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *<a class="el" href="structkey.html">key</a>)</td></tr>
<tr class="separator:af3e5e7a3b96977793b215f952186d820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d83f15bad7c91aaf90cff4640373d56"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8h.html#a2d83f15bad7c91aaf90cff4640373d56">print_key_filename</a> (const char *str, bool is_inline)</td></tr>
<tr class="memdesc:a2d83f15bad7c91aaf90cff4640373d56"><td class="mdescLeft">&#160;</td><td class="mdescRight">To be used when printing a string that may contain inline data.  <a href="crypto_8h.html#a2d83f15bad7c91aaf90cff4640373d56">More...</a><br /></td></tr>
<tr class="separator:a2d83f15bad7c91aaf90cff4640373d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Functions for performing security operations on data channel packets</div></td></tr>
<tr class="memitem:ga2756bad88224b98719d4e8f08cb11ef9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__data__crypto.html#ga2756bad88224b98719d4e8f08cb11ef9">openvpn_encrypt</a> (struct <a class="el" href="structbuffer.html">buffer</a> *buf, struct <a class="el" href="structbuffer.html">buffer</a> work, struct <a class="el" href="structcrypto__options.html">crypto_options</a> *opt)</td></tr>
<tr class="memdesc:ga2756bad88224b98719d4e8f08cb11ef9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt and HMAC sign a packet so that it can be sent as a data channel VPN tunnel packet to a remote OpenVPN peer.  <a href="group__data__crypto.html#ga2756bad88224b98719d4e8f08cb11ef9">More...</a><br /></td></tr>
<tr class="separator:ga2756bad88224b98719d4e8f08cb11ef9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae91d99446478fcf3327672eb78ef0bf8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__data__crypto.html#gae91d99446478fcf3327672eb78ef0bf8">openvpn_decrypt</a> (struct <a class="el" href="structbuffer.html">buffer</a> *buf, struct <a class="el" href="structbuffer.html">buffer</a> work, struct <a class="el" href="structcrypto__options.html">crypto_options</a> *opt, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>, const <a class="el" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> *ad_start)</td></tr>
<tr class="memdesc:gae91d99446478fcf3327672eb78ef0bf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">HMAC verify and decrypt a data channel packet received from a remote OpenVPN peer.  <a href="group__data__crypto.html#gae91d99446478fcf3327672eb78ef0bf8">More...</a><br /></td></tr>
<tr class="separator:gae91d99446478fcf3327672eb78ef0bf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a46afc2f632a024378e286f6ada0ade76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46afc2f632a024378e286f6ada0ade76">&#9670;&nbsp;</a></span>CO_IGNORE_PACKET_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CO_IGNORE_PACKET_ID&#160;&#160;&#160;(1&lt;&lt;1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Bit-flag indicating whether to ignore the packet ID of a received packet. </p>
<p>This flag is used during processing of the first packet received from a client. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00248">248</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a897fcd411cae93fbed05653515ce480e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a897fcd411cae93fbed05653515ce480e">&#9670;&nbsp;</a></span>CO_MUTE_REPLAY_WARNINGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CO_MUTE_REPLAY_WARNINGS&#160;&#160;&#160;(1&lt;&lt;2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Bit-flag indicating not to display replay warnings. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00254">254</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a10cf731ef4917a647cdca413d507ff81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10cf731ef4917a647cdca413d507ff81">&#9670;&nbsp;</a></span>CO_PACKET_ID_LONG_FORM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CO_PACKET_ID_LONG_FORM&#160;&#160;&#160;(1&lt;&lt;0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Bit-flag indicating whether to use OpenVPN's long packet ID format. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00245">245</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a3c30c5ee1d0788ec86d22aec61952199"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c30c5ee1d0788ec86d22aec61952199">&#9670;&nbsp;</a></span>CRYPT_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRYPT_ERROR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">format</td><td>)</td>
          <td>&#160;&#160;&#160;do { <a class="el" href="tapctl_2error_8h.html#ab7e01d5e5174b3ddbc247f4a2ac45141">msg</a>(<a class="el" href="errlevel_8h.html#a82c6e0357ff0b26eaa2ad2fb17cc1268">D_CRYPT_ERRORS</a>, &quot;%s: &quot; format, error_prefix); goto error_exit; } while (false)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00261">261</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="ab8be0ec27dfc6dc8d779afa0c42db52c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8be0ec27dfc6dc8d779afa0c42db52c">&#9670;&nbsp;</a></span>KEY_DIRECTION_BIDIRECTIONAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEY_DIRECTION_BIDIRECTIONAL&#160;&#160;&#160;0 /* same keys for both directions */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00173">173</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="ad246376c36364cabaacea01498048ec7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad246376c36364cabaacea01498048ec7">&#9670;&nbsp;</a></span>KEY_DIRECTION_INVERSE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEY_DIRECTION_INVERSE&#160;&#160;&#160;2 /* encrypt with keys[1], decrypt with keys[0] */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00175">175</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a09112b6672bf44b0ecef2eee6348244c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09112b6672bf44b0ecef2eee6348244c">&#9670;&nbsp;</a></span>KEY_DIRECTION_NORMAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEY_DIRECTION_NORMAL&#160;&#160;&#160;1 /* encrypt with keys[0], decrypt with keys[1] */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00174">174</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a73f126605671fbbab2201edf86635df4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73f126605671fbbab2201edf86635df4">&#9670;&nbsp;</a></span>NONCE_SECRET_LEN_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NONCE_SECRET_LEN_MAX&#160;&#160;&#160;64</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00461">461</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a89d9152ef191855e0958554eca1e877c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89d9152ef191855e0958554eca1e877c">&#9670;&nbsp;</a></span>NONCE_SECRET_LEN_MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NONCE_SECRET_LEN_MIN&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00458">458</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a3658531e5110d45db922d6a47fb2454b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3658531e5110d45db922d6a47fb2454b">&#9670;&nbsp;</a></span>OPENVPN_AEAD_MIN_IV_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OPENVPN_AEAD_MIN_IV_LEN&#160;&#160;&#160;(sizeof(<a class="el" href="packet__id_8h.html#a345f753b1c6ea20d24409e769aadb7e6">packet_id_type</a>) + 8)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minimal IV length for AEAD mode ciphers (in bytes): 4-byte packet id + 8 bytes implicit IV. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00268">268</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a72d592a2e01dbbf9ac96d01aa811fee7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72d592a2e01dbbf9ac96d01aa811fee7">&#9670;&nbsp;</a></span>PRNG_NONCE_RESET_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRNG_NONCE_RESET_BYTES&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes of random to allow before resetting the nonce. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00464">464</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="a88d01fb7acc16a3c70e24fbc61b741bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88d01fb7acc16a3c70e24fbc61b741bc">&#9670;&nbsp;</a></span>RKF_INLINE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RKF_INLINE&#160;&#160;&#160;(1&lt;&lt;1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00271">271</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<a id="abab39c003d995feddd945d8c680be0bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abab39c003d995feddd945d8c680be0bd">&#9670;&nbsp;</a></span>RKF_MUST_SUCCEED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RKF_MUST_SUCCEED&#160;&#160;&#160;(1&lt;&lt;0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00270">270</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6a09f04c154e9795c61d37fb79419cd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a09f04c154e9795c61d37fb79419cd4">&#9670;&nbsp;</a></span>ascii2keydirection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ascii2keydirection </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>msglevel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01501">1501</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8h_source.html#l00173">KEY_DIRECTION_BIDIRECTIONAL</a>, <a class="el" href="crypto_8h_source.html#l00175">KEY_DIRECTION_INVERSE</a>, <a class="el" href="crypto_8h_source.html#l00174">KEY_DIRECTION_NORMAL</a>, and <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>.</p>

<p class="reference">Referenced by <a class="el" href="options_8c_source.html#l05256">add_option()</a>.</p>

</div>
</div>
<a id="a87b883dc7b32de49358a397c4e5a56a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87b883dc7b32de49358a397c4e5a56a6">&#9670;&nbsp;</a></span>check_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool check_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey.html">key</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00933">933</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8h_source.html#l00143">key_type::cipher</a>, <a class="el" href="crypto_8h_source.html#l00153">key::cipher</a>, <a class="el" href="crypto_8h_source.html#l00141">key_type::cipher_length</a>, <a class="el" href="crypto__openssl_8c_source.html#l00570">key_des_check()</a>, <a class="el" href="crypto__backend_8h.html#ad4d9be2aec664087528e31d2bc8c00ac">key_des_num_cblocks()</a>, and <a class="el" href="crypto_8c_source.html#l00915">key_is_zero()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l01809">generate_key_expansion()</a>, <a class="el" href="crypto_8c_source.html#l01019">generate_key_random()</a>, and <a class="el" href="crypto_8c_source.html#l01582">verify_fix_key2()</a>.</p>

</div>
</div>
<a id="af0c4bb63e6b4aae63502a87217a36c79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0c4bb63e6b4aae63502a87217a36c79">&#9670;&nbsp;</a></span>check_replay_consistency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_replay_consistency </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>packet_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01003">1003</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="crypto_8h_source.html#l00143">key_type::cipher</a>, <a class="el" href="crypto__openssl_8c_source.html#l00790">cipher_kt_mode_aead()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00781">cipher_kt_mode_ofb_cfb()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, and <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02579">do_init_crypto_static()</a>, and <a class="el" href="init_8c_source.html#l02814">do_init_crypto_tls()</a>.</p>

</div>
</div>
<a id="af597e0d765df961d66a200fa33ba4faf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af597e0d765df961d66a200fa33ba4faf">&#9670;&nbsp;</a></span>crypto_adjust_frame_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_adjust_frame_parameters </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structframe.html">frame</a> *&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>packet_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>packet_id_long_form</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate crypto overhead and adjust frame to account for that. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00682">682</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8h_source.html#l00143">key_type::cipher</a>, <a class="el" href="crypto__backend_8h.html#a5b2de050c2b6a78320fbed2340b25c60">cipher_kt_block_size()</a>, <a class="el" href="crypto__backend_8h.html#a902518439f09e88281986ebda8dd458b">cipher_kt_iv_size()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00790">cipher_kt_mode_aead()</a>, <a class="el" href="crypto__backend_8h.html#a04e1e83fd4bbaac94f1cd7ec40ab1d6b">cipher_kt_tag_size()</a>, <a class="el" href="errlevel_8h_source.html#l00124">D_MTU_DEBUG</a>, <a class="el" href="mtu_8h_source.html#l00274">frame_add_to_extra_frame()</a>, <a class="el" href="crypto_8h_source.html#l00142">key_type::hmac_length</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="packet__id_8h_source.html#l00305">packet_id_size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="options_8c_source.html#l03676">calc_options_string_link_mtu()</a>, <a class="el" href="init_8c_source.html#l02579">do_init_crypto_static()</a>, <a class="el" href="init_8c_source.html#l02814">do_init_crypto_tls()</a>, and <a class="el" href="ssl_8c_source.html#l01946">tls_session_update_crypto_params()</a>.</p>

</div>
</div>
<a id="a1e6bbdde50a9843d441c22ada85e6345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e6bbdde50a9843d441c22ada85e6345">&#9670;&nbsp;</a></span>crypto_check_replay()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool crypto_check_replay </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcrypto__options.html">crypto_options</a> *&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structpacket__id__net.html">packet_id_net</a> *&#160;</td>
          <td class="paramname"><em>pin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>error_prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgc__arena.html">gc_arena</a> *&#160;</td>
          <td class="paramname"><em>gc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check packet ID for replay, and perform replay administration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">opt</td><td>Crypto options for this packet, contains replay state. </td></tr>
    <tr><td class="paramname">pin</td><td>Packet ID read from packet. </td></tr>
    <tr><td class="paramname">error_prefix</td><td>Prefix to use when printing error messages. </td></tr>
    <tr><td class="paramname">gc</td><td>Garbage collector to use.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if packet ID is validated to be not a replay, false otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00319">319</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8h_source.html#l00254">CO_MUTE_REPLAY_WARNINGS</a>, <a class="el" href="crypto_8h_source.html#l00245">CO_PACKET_ID_LONG_FORM</a>, <a class="el" href="errlevel_8h_source.html#l00062">D_REPLAY_ERRORS</a>, <a class="el" href="crypto_8h_source.html#l00257">crypto_options::flags</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="crypto_8h_source.html#l00238">crypto_options::packet_id</a>, <a class="el" href="packet__id_8c_source.html#l00115">packet_id_add()</a>, <a class="el" href="packet__id_8c_source.html#l00391">packet_id_net_print()</a>, <a class="el" href="packet__id_8h_source.html#l00288">packet_id_persist_save_obj()</a>, <a class="el" href="packet__id_8h_source.html#l00334">packet_id_reap_test()</a>, <a class="el" href="packet__id_8c_source.html#l00202">packet_id_test()</a>, <a class="el" href="crypto_8h_source.html#l00240">crypto_options::pid_persist</a>, and <a class="el" href="packet__id_8h_source.html#l00208">packet_id::rec</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l00356">openvpn_decrypt_aead()</a>, <a class="el" href="crypto_8c_source.html#l00491">openvpn_decrypt_v1()</a>, and <a class="el" href="tls__crypt_8c_source.html#l00185">tls_crypt_unwrap()</a>.</p>

</div>
</div>
<a id="ac2246d073775a03a612d337782cfa1a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2246d073775a03a612d337782cfa1a5">&#9670;&nbsp;</a></span>crypto_max_overhead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int crypto_max_overhead </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the worst-case OpenVPN crypto overhead (in bytes) </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00716">716</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="integer_8h_source.html#l00044">max_int()</a>, <a class="el" href="crypto__backend_8h_source.html#l00042">OPENVPN_AEAD_TAG_LENGTH</a>, <a class="el" href="crypto__backend_8h_source.html#l00045">OPENVPN_MAX_CIPHER_BLOCK_SIZE</a>, <a class="el" href="crypto__backend_8h_source.html#l00048">OPENVPN_MAX_HMAC_SIZE</a>, <a class="el" href="crypto__mbedtls_8h_source.html#l00055">OPENVPN_MAX_IV_LENGTH</a>, and <a class="el" href="packet__id_8h_source.html#l00305">packet_id_size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="options_8c_source.html#l03676">calc_options_string_link_mtu()</a>, <a class="el" href="init_8c_source.html#l02814">do_init_crypto_tls()</a>, and <a class="el" href="ssl_8c_source.html#l01946">tls_session_update_crypto_params()</a>.</p>

</div>
</div>
<a id="aeed99ce5177c96881467847708e18b0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed99ce5177c96881467847708e18b0e">&#9670;&nbsp;</a></span>crypto_read_openvpn_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_read_openvpn_key </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>key_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>key_inline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>key_direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>opt_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01175">1175</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8c_source.html#l00871">init_key_ctx_bi()</a>, <a class="el" href="crypto_8c_source.html#l01553">key_direction_state_init()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00107">M_ERR</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="crypto_8c_source.html#l01488">must_have_n_keys()</a>, <a class="el" href="crypto_8h_source.html#l00183">key2::n</a>, <a class="el" href="crypto_8h_source.html#l00204">key_direction_state::need_keys</a>, <a class="el" href="crypto_8c_source.html#l01164">print_key_filename()</a>, <a class="el" href="crypto_8c_source.html#l01222">read_key_file()</a>, <a class="el" href="crypto_8h_source.html#l00271">RKF_INLINE</a>, <a class="el" href="crypto_8h_source.html#l00270">RKF_MUST_SUCCEED</a>, <a class="el" href="buffer_8h_source.html#l00401">secure_memzero()</a>, and <a class="el" href="crypto_8c_source.html#l01582">verify_fix_key2()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02579">do_init_crypto_static()</a>, <a class="el" href="init_8c_source.html#l02638">do_init_tls_wrap_key()</a>, and <a class="el" href="tls__crypt_8c_source.html#l00083">tls_crypt_init_key()</a>.</p>

</div>
</div>
<a id="aba43c7afa9dab7d3d1bb9443a0fba6d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba43c7afa9dab7d3d1bb9443a0fba6d8">&#9670;&nbsp;</a></span>fixup_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fixup_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey.html">key</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00972">972</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00242">check_debug_level()</a>, <a class="el" href="crypto_8h_source.html#l00143">key_type::cipher</a>, <a class="el" href="crypto_8h_source.html#l00153">key::cipher</a>, <a class="el" href="crypto_8h_source.html#l00141">key_type::cipher_length</a>, <a class="el" href="errlevel_8h_source.html#l00146">D_CRYPTO_DEBUG</a>, <a class="el" href="openvpn_2error_8h_source.html#l00171">dmsg</a>, <a class="el" href="buffer_8h_source.html#l00510">format_hex()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00607">key_des_fixup()</a>, and <a class="el" href="crypto__backend_8h.html#ad4d9be2aec664087528e31d2bc8c00ac">key_des_num_cblocks()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l01809">generate_key_expansion()</a>, <a class="el" href="crypto_8c_source.html#l01019">generate_key_random()</a>, and <a class="el" href="crypto_8c_source.html#l01582">verify_fix_key2()</a>.</p>

</div>
</div>
<a id="af3aee473fd00923f722cc0518add3d7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3aee473fd00923f722cc0518add3d7c">&#9670;&nbsp;</a></span>free_key_ctx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_key_ctx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey__ctx.html">key_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00891">891</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8h_source.html#l00166">key_ctx::cipher</a>, <a class="el" href="crypto__backend_8h.html#a73c6b517d2db7a437931b96c03879264">cipher_ctx_free()</a>, <a class="el" href="crypto_8h_source.html#l00167">key_ctx::hmac</a>, <a class="el" href="crypto__backend_8h.html#ac960fcce4aa9c28177a1838fb7e8600f">hmac_ctx_cleanup()</a>, <a class="el" href="crypto__backend_8h.html#a7e7f39d6459b1bae48d57c83f476a484">hmac_ctx_free()</a>, and <a class="el" href="crypto_8h_source.html#l00170">key_ctx::implicit_iv_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00144">auth_token_fail_invalid_key()</a>, <a class="el" href="test__auth__token_8c_source.html#l00362">auth_token_test_key_load()</a>, <a class="el" href="test__auth__token_8c_source.html#l00338">auth_token_test_random_keys()</a>, <a class="el" href="init_8c_source.html#l03623">do_close_free_key_schedule()</a>, <a class="el" href="crypto_8c_source.html#l00908">free_key_ctx_bi()</a>, <a class="el" href="init_8c_source.html#l02539">key_schedule_free()</a>, <a class="el" href="test__auth__token_8c_source.html#l00119">teardown()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00285">tls_crypt_fail_invalid_key()</a>, and <a class="el" href="tls__crypt_8c_source.html#l00642">tls_crypt_v2_write_client_key_file()</a>.</p>

</div>
</div>
<a id="a0605d1e78bd3bf4e23d99e039301f934"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0605d1e78bd3bf4e23d99e039301f934">&#9670;&nbsp;</a></span>free_key_ctx_bi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void free_key_ctx_bi </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00908">908</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8h_source.html#l00223">key_ctx_bi::decrypt</a>, <a class="el" href="crypto_8h_source.html#l00221">key_ctx_bi::encrypt</a>, and <a class="el" href="crypto_8c_source.html#l00891">free_key_ctx()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l03623">do_close_free_key_schedule()</a>, <a class="el" href="init_8c_source.html#l02539">key_schedule_free()</a>, <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00179">test_tls_crypt_teardown()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00382">test_tls_crypt_v2_teardown()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00485">tls_crypt_v2_wrap_unwrap_wrong_key()</a>, <a class="el" href="tls__crypt_8c_source.html#l00642">tls_crypt_v2_write_client_key_file()</a>, <a class="el" href="ssl_8c_source.html#l03706">tls_pre_decrypt_lite()</a>, and <a class="el" href="ssl_8h_source.html#l00519">tls_wrap_free()</a>.</p>

</div>
</div>
<a id="a41e699455c3550f40ca4cbe7592a439a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41e699455c3550f40ca4cbe7592a439a">&#9670;&nbsp;</a></span>generate_ephemeral_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool generate_ephemeral_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pem_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate ephermal key material into the key structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key structure that will hold the key material </td></tr>
    <tr><td class="paramname">pem_name</td><td>the name used for logging </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if key generation was successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01895">1895</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l00130">BCAP</a>, <a class="el" href="buffer_8h_source.html#l00125">BEND</a>, <a class="el" href="buffer_8h_source.html#l00595">buf_inc_len()</a>, <a class="el" href="buffer_8h_source.html#l00066">buffer::len</a>, <a class="el" href="errlevel_8h_source.html#l00055">M_INFO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00093">M_WARN</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="crypto__openssl_8c_source.html#l00532">rand_bytes()</a>.</p>

<p class="reference">Referenced by <a class="el" href="auth__token_8c_source.html#l00139">auth_token_init_secret()</a>.</p>

</div>
</div>
<a id="abd4e2239c5b8afe85276885676851bcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd4e2239c5b8afe85276885676851bcf">&#9670;&nbsp;</a></span>generate_key_random()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void generate_key_random </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey.html">key</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01019">1019</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8c_source.html#l00933">check_key()</a>, <a class="el" href="crypto_8h_source.html#l00143">key_type::cipher</a>, <a class="el" href="crypto_8h_source.html#l00153">key::cipher</a>, <a class="el" href="crypto_8h_source.html#l00141">key_type::cipher_length</a>, <a class="el" href="openvpn_2basic_8h_source.html#l00033">CLEAR</a>, <a class="el" href="errlevel_8h_source.html#l00120">D_SHOW_KEY_SOURCE</a>, <a class="el" href="crypto_8h_source.html#l00144">key_type::digest</a>, <a class="el" href="openvpn_2error_8h_source.html#l00171">dmsg</a>, <a class="el" href="crypto_8c_source.html#l00972">fixup_key()</a>, <a class="el" href="buffer_8h_source.html#l00510">format_hex()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="crypto_8h_source.html#l00155">key::hmac</a>, <a class="el" href="crypto_8h_source.html#l00142">key_type::hmac_length</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="crypto__backend_8h_source.html#l00237">MAX_CIPHER_KEY_LENGTH</a>, <a class="el" href="crypto__backend_8h_source.html#l00517">MAX_HMAC_KEY_LENGTH</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="crypto__openssl_8c_source.html#l00532">rand_bytes()</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01425">write_key_file()</a>.</p>

</div>
</div>
<a id="a37fb65e30bd2c33564b14ad76a0c0794"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37fb65e30bd2c33564b14ad76a0c0794">&#9670;&nbsp;</a></span>get_random()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long int get_random </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01771">1771</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8c_source.html#l01739">prng_bytes()</a>.</p>

<p class="reference">Referenced by <a class="el" href="occ_8c_source.html#l00216">check_send_occ_msg_dowork()</a>, <a class="el" href="forward_8c_source.html#l00776">check_timeout_random_component_dowork()</a>, <a class="el" href="init_8c_source.html#l02814">do_init_crypto_tls()</a>, <a class="el" href="fragment_8c_source.html#l00091">fragment_init()</a>, <a class="el" href="ntlm_8c_source.html#l00123">gen_nonce()</a>, <a class="el" href="init_8c_source.html#l00431">init_connection_list()</a>, <a class="el" href="multi_8c_source.html#l00295">multi_init()</a>, <a class="el" href="packet__id_8c_source.html#l00115">packet_id_add()</a>, and <a class="el" href="platform_8c_source.html#l00342">platform_create_temp_file()</a>.</p>

</div>
</div>
<a id="ae629299ae8c5888623e26033c1784d31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae629299ae8c5888623e26033c1784d31">&#9670;&nbsp;</a></span>init_key_ctx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_key_ctx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey__ctx.html">key_ctx</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey.html">key</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>enc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prefix</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00823">823</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8h_source.html#l00143">key_type::cipher</a>, <a class="el" href="crypto_8h_source.html#l00153">key::cipher</a>, <a class="el" href="crypto_8h_source.html#l00166">key_ctx::cipher</a>, <a class="el" href="crypto__backend_8h.html#ae5e32ed624a8747a76f28ffb6db79f51">cipher_ctx_init()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00816">cipher_ctx_new()</a>, <a class="el" href="crypto__backend_8h.html#a5b2de050c2b6a78320fbed2340b25c60">cipher_kt_block_size()</a>, <a class="el" href="crypto__backend_8h.html#a902518439f09e88281986ebda8dd458b">cipher_kt_iv_size()</a>, <a class="el" href="crypto__backend_8h.html#aa7653846be359a2fc26cdf1677e668dd">cipher_kt_name()</a>, <a class="el" href="crypto_8h_source.html#l00141">key_type::cipher_length</a>, <a class="el" href="openvpn_2basic_8h_source.html#l00033">CLEAR</a>, <a class="el" href="errlevel_8h_source.html#l00146">D_CRYPTO_DEBUG</a>, <a class="el" href="errlevel_8h_source.html#l00072">D_HANDSHAKE</a>, <a class="el" href="errlevel_8h_source.html#l00119">D_SHOW_KEYS</a>, <a class="el" href="crypto_8h_source.html#l00144">key_type::digest</a>, <a class="el" href="openvpn_2error_8h_source.html#l00171">dmsg</a>, <a class="el" href="buffer_8h_source.html#l00510">format_hex()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="crypto_8h_source.html#l00155">key::hmac</a>, <a class="el" href="crypto_8h_source.html#l00167">key_ctx::hmac</a>, <a class="el" href="crypto__backend_8h.html#a3a5dca2c6f7a8a820bc3470c460a8a68">hmac_ctx_init()</a>, <a class="el" href="crypto__openssl_8c_source.html#l01108">hmac_ctx_new()</a>, <a class="el" href="crypto__backend_8h.html#a8625131329a13b2097ccacb82c83b3fe">hmac_ctx_size()</a>, <a class="el" href="crypto_8h_source.html#l00142">key_type::hmac_length</a>, <a class="el" href="crypto__backend_8h.html#af596da696fc79c7839c3abab26e935f2">md_kt_name()</a>, <a class="el" href="crypto__backend_8h.html#aaf03842b74cab3e4304e655aeaf75d2e">md_kt_size()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="crypto_8c_source.html#l00724">warn_insecure_key_type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00144">auth_token_fail_invalid_key()</a>, <a class="el" href="auth__token_8c_source.html#l00139">auth_token_init_secret()</a>, <a class="el" href="crypto_8c_source.html#l00871">init_key_ctx_bi()</a>, <a class="el" href="test__auth__token_8c_source.html#l00089">setup()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00146">test_tls_crypt_setup()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00285">tls_crypt_fail_invalid_key()</a>, and <a class="el" href="tls__crypt_8c_source.html#l00325">tls_crypt_v2_init_server_key()</a>.</p>

</div>
</div>
<a id="ab4bddbfa55994baf73b823dd49eb9320"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4bddbfa55994baf73b823dd49eb9320">&#9670;&nbsp;</a></span>init_key_ctx_bi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_key_ctx_bi </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey2.html">key2</a> *&#160;</td>
          <td class="paramname"><em>key2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>key_direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00871">871</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8h_source.html#l00223">key_ctx_bi::decrypt</a>, <a class="el" href="crypto_8h_source.html#l00221">key_ctx_bi::encrypt</a>, <a class="el" href="crypto_8h_source.html#l00202">key_direction_state::in_key</a>, <a class="el" href="crypto_8c_source.html#l00823">init_key_ctx()</a>, <a class="el" href="crypto_8h_source.html#l00225">key_ctx_bi::initialized</a>, <a class="el" href="crypto_8c_source.html#l01553">key_direction_state_init()</a>, <a class="el" href="crypto_8h_source.html#l00185">key2::keys</a>, <a class="el" href="crypto__mbedtls_8h_source.html#l00073">OPENVPN_OP_DECRYPT</a>, <a class="el" href="crypto__mbedtls_8h_source.html#l00070">OPENVPN_OP_ENCRYPT</a>, <a class="el" href="buffer_8c_source.html#l00299">openvpn_snprintf()</a>, and <a class="el" href="crypto_8h_source.html#l00200">key_direction_state::out_key</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01175">crypto_read_openvpn_key()</a>, <a class="el" href="ssl_8c_source.html#l01809">generate_key_expansion()</a>, <a class="el" href="test__tls__crypt_8c_source.html#l00353">test_tls_crypt_v2_setup()</a>, <a class="el" href="tls__crypt_8c_source.html#l00285">tls_crypt_v2_load_client_key()</a>, and <a class="el" href="test__tls__crypt_8c_source.html#l00485">tls_crypt_v2_wrap_unwrap_wrong_key()</a>.</p>

</div>
</div>
<a id="a5657fa40c2ed8eed4ac057b87902100b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5657fa40c2ed8eed4ac057b87902100b">&#9670;&nbsp;</a></span>init_key_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_key_type </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ciphername</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>authname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keysize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>tls_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>warn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize a <a class="el" href="structkey__type.html">key_type</a> structure with. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kt</td><td>The struct <a class="el" href="structkey__type.html">key_type</a> to initialize </td></tr>
    <tr><td class="paramname">ciphername</td><td>The name of the cipher to use </td></tr>
    <tr><td class="paramname">authname</td><td>The name of the HMAC digest to use </td></tr>
    <tr><td class="paramname">keysize</td><td>The length of the cipher key to use, in bytes. Only valid for ciphers that support variable length keys. </td></tr>
    <tr><td class="paramname">tls_mode</td><td>Specifies whether we are running in TLS mode, which allows more ciphers than static key mode. </td></tr>
    <tr><td class="paramname">warn</td><td>Print warnings when null cipher / auth is used. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00741">741</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="crypto_8h_source.html#l00143">key_type::cipher</a>, <a class="el" href="crypto__backend_8h.html#a5b2de050c2b6a78320fbed2340b25c60">cipher_kt_block_size()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00635">cipher_kt_get()</a>, <a class="el" href="crypto__backend_8h.html#a7f36be41d0b97d8e3d9e8d586c2213e4">cipher_kt_key_size()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00790">cipher_kt_mode_aead()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00773">cipher_kt_mode_cbc()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00781">cipher_kt_mode_ofb_cfb()</a>, <a class="el" href="crypto_8h_source.html#l00141">key_type::cipher_length</a>, <a class="el" href="openvpn_2basic_8h_source.html#l00033">CLEAR</a>, <a class="el" href="crypto_8h_source.html#l00144">key_type::digest</a>, <a class="el" href="config_8h_source.html#l00062">ENABLE_OFB_CFB_MODE</a>, <a class="el" href="crypto_8h_source.html#l00142">key_type::hmac_length</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00093">M_WARN</a>, <a class="el" href="crypto__backend_8h_source.html#l00237">MAX_CIPHER_KEY_LENGTH</a>, <a class="el" href="crypto__openssl_8c_source.html#l00952">md_kt_get()</a>, <a class="el" href="crypto__backend_8h.html#aaf03842b74cab3e4304e655aeaf75d2e">md_kt_size()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="crypto__backend_8h_source.html#l00045">OPENVPN_MAX_CIPHER_BLOCK_SIZE</a>, and <a class="el" href="crypto_8c_source.html#l00724">warn_insecure_key_type()</a>.</p>

<p class="reference">Referenced by <a class="el" href="options_8c_source.html#l03676">calc_options_string_link_mtu()</a>, <a class="el" href="init_8c_source.html#l02579">do_init_crypto_static()</a>, <a class="el" href="init_8c_source.html#l02718">do_init_crypto_tls_c1()</a>, <a class="el" href="options_8c_source.html#l03762">options_string()</a>, and <a class="el" href="ssl_8c_source.html#l01946">tls_session_update_crypto_params()</a>.</p>

</div>
</div>
<a id="a2a5874f830425ad932c70899d6d25b7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a5874f830425ad932c70899d6d25b7d">&#9670;&nbsp;</a></span>key2_print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void key2_print </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structkey2.html">key2</a> *&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prefix0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prefix1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01063">1063</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="crypto_8h_source.html#l00153">key::cipher</a>, <a class="el" href="crypto_8h_source.html#l00141">key_type::cipher_length</a>, <a class="el" href="buffer_8h_source.html#l00510">format_hex()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="crypto_8h_source.html#l00155">key::hmac</a>, <a class="el" href="crypto_8h_source.html#l00142">key_type::hmac_length</a>, <a class="el" href="crypto_8h_source.html#l00185">key2::keys</a>, <a class="el" href="errlevel_8h_source.html#l00055">M_INFO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="crypto_8h_source.html#l00183">key2::n</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l01809">generate_key_expansion()</a>.</p>

</div>
</div>
<a id="af3e5e7a3b96977793b215f952186d820"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3e5e7a3b96977793b215f952186d820">&#9670;&nbsp;</a></span>key_ctx_bi_defined()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool key_ctx_bi_defined </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structkey__ctx__bi.html">key_ctx_bi</a> *&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8h_source.html#l00537">537</a> of file <a class="el" href="crypto_8h_source.html">crypto.h</a>.</p>

<p class="reference">References <a class="el" href="crypto_8h_source.html#l00153">key::cipher</a>, and <a class="el" href="crypto_8h_source.html#l00155">key::hmac</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02579">do_init_crypto_static()</a>.</p>

</div>
</div>
<a id="abe602273d3919da32e45249dc2af3bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe602273d3919da32e45249dc2af3bc5">&#9670;&nbsp;</a></span>key_direction_state_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void key_direction_state_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey__direction__state.html">key_direction_state</a> *&#160;</td>
          <td class="paramname"><em>kds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>key_direction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01553">1553</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="openvpn_2basic_8h_source.html#l00033">CLEAR</a>, <a class="el" href="crypto_8h_source.html#l00202">key_direction_state::in_key</a>, <a class="el" href="crypto_8h_source.html#l00173">KEY_DIRECTION_BIDIRECTIONAL</a>, <a class="el" href="crypto_8h_source.html#l00175">KEY_DIRECTION_INVERSE</a>, <a class="el" href="crypto_8h_source.html#l00174">KEY_DIRECTION_NORMAL</a>, <a class="el" href="crypto_8h_source.html#l00204">key_direction_state::need_keys</a>, and <a class="el" href="crypto_8h_source.html#l00200">key_direction_state::out_key</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01175">crypto_read_openvpn_key()</a>, and <a class="el" href="crypto_8c_source.html#l00871">init_key_ctx_bi()</a>.</p>

</div>
</div>
<a id="ab16d0ee42a623040eccffb7f9ad575c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab16d0ee42a623040eccffb7f9ad575c0">&#9670;&nbsp;</a></span>keydirection2ascii()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* keydirection2ascii </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>remote</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>humanreadable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01524">1524</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="crypto_8h_source.html#l00173">KEY_DIRECTION_BIDIRECTIONAL</a>, <a class="el" href="crypto_8h_source.html#l00175">KEY_DIRECTION_INVERSE</a>, and <a class="el" href="crypto_8h_source.html#l00174">KEY_DIRECTION_NORMAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="options_8c_source.html#l03762">options_string()</a>, <a class="el" href="options_8c_source.html#l01448">show_connection_entry()</a>, and <a class="el" href="options_8c_source.html#l01532">show_settings()</a>.</p>

</div>
</div>
<a id="ac1bdaec22973ae0630f27870c7430dc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1bdaec22973ae0630f27870c7430dc1">&#9670;&nbsp;</a></span>memcmp_constant_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int memcmp_constant_time </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>As memcmp(), but constant-time. </p>
<p>Returns 0 when data is equal, non-zero otherwise. </p>

<p class="definition">Definition at line <a class="el" href="crypto__openssl_8c_source.html#l01167">1167</a> of file <a class="el" href="crypto__openssl_8c_source.html">crypto_openssl.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="auth__token_8c_source.html#l00286">check_hmac_token()</a>, <a class="el" href="auth__token_8h_source.html#l00127">is_auth_token()</a>, <a class="el" href="crypto_8c_source.html#l00491">openvpn_decrypt_v1()</a>, <a class="el" href="tls__crypt_8c_source.html#l00185">tls_crypt_unwrap()</a>, <a class="el" href="tls__crypt_8c_source.html#l00405">tls_crypt_v2_unwrap_client_key()</a>, and <a class="el" href="auth__token_8c_source.html#l00302">verify_auth_token()</a>.</p>

</div>
</div>
<a id="a740d1036dfdb6ed93199f8bce8bbbbe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a740d1036dfdb6ed93199f8bce8bbbbe9">&#9670;&nbsp;</a></span>must_have_n_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void must_have_n_keys </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>option</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey2.html">key2</a> *&#160;</td>
          <td class="paramname"><em>key2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01488">1488</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="crypto_8h_source.html#l00183">key2::n</a>, and <a class="el" href="config-msvc-version_8h_source.html#l00004">PACKAGE</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01175">crypto_read_openvpn_key()</a>.</p>

</div>
</div>
<a id="a59685c1dc9130804ba9e40804ff5af56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59685c1dc9130804ba9e40804ff5af56">&#9670;&nbsp;</a></span>print_cipher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_cipher </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="crypto__mbedtls_8h.html#aa82c97683560a0df89eddd2a3cf6e6d4">cipher_kt_t</a> *&#160;</td>
          <td class="paramname"><em>cipher</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print a cipher list entry. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01783">1783</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8h_source.html#l00153">key::cipher</a>, <a class="el" href="crypto__backend_8h.html#a5b2de050c2b6a78320fbed2340b25c60">cipher_kt_block_size()</a>, <a class="el" href="crypto__backend_8h.html#a7f36be41d0b97d8e3d9e8d586c2213e4">cipher_kt_key_size()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00773">cipher_kt_mode_cbc()</a>, <a class="el" href="crypto__backend_8h.html#aa7653846be359a2fc26cdf1677e668dd">cipher_kt_name()</a>, and <a class="el" href="crypto__mbedtls_8h_source.html#l00153">cipher_kt_var_key_size()</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto__openssl_8c_source.html#l00316">show_available_ciphers()</a>.</p>

</div>
</div>
<a id="a2d83f15bad7c91aaf90cff4640373d56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d83f15bad7c91aaf90cff4640373d56">&#9670;&nbsp;</a></span>print_key_filename()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* print_key_filename </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>is_inline</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To be used when printing a string that may contain inline data. </p>
<p>If "is_inline" is true, return the inline tag. If "is_inline" is false and "str" is not NULL, return "str". Return the constant string "[NULL]" otherwise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">str</td><td>the original string to return when is_inline is false </td></tr>
    <tr><td class="paramname">is_inline</td><td>true when str contains an inline data of some sort </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01164">1164</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="multi-auth_8c_source.html#l00145">np()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__openssl_8c_source.html#l01107">backend_tls_ctx_reload_crl()</a>, <a class="el" href="crypto_8c_source.html#l01175">crypto_read_openvpn_key()</a>, <a class="el" href="crypto_8c_source.html#l01222">read_key_file()</a>, <a class="el" href="ssl__openssl_8c_source.html#l01567">tls_ctx_load_ca()</a>, <a class="el" href="ssl__openssl_8c_source.html#l00688">tls_ctx_load_dh_params()</a>, <a class="el" href="ssl__openssl_8c_source.html#l01719">tls_ctx_load_extra_certs()</a>, and <a class="el" href="ssl__openssl_8c_source.html#l01040">tls_ctx_load_priv_file()</a>.</p>

</div>
</div>
<a id="a1d7c04eddcc6269ed0f1e76fe3f9ce0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d7c04eddcc6269ed0f1e76fe3f9ce0f">&#9670;&nbsp;</a></span>prng_bytes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prng_bytes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01739">1739</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="crypto__backend_8h.html#a70d35559ec46dbb97b8b8a83a1e4ecbf">md_full()</a>, <a class="el" href="crypto__backend_8h.html#aaf03842b74cab3e4304e655aeaf75d2e">md_kt_size()</a>, <a class="el" href="integer_8h_source.html#l00057">min_int()</a>, <a class="el" href="crypto_8c_source.html#l01684">nonce_data</a>, <a class="el" href="crypto_8c_source.html#l01685">nonce_md</a>, <a class="el" href="crypto_8c_source.html#l01686">nonce_secret_len</a>, <a class="el" href="crypto_8h_source.html#l00464">PRNG_NONCE_RESET_BYTES</a>, <a class="el" href="crypto_8c_source.html#l01690">prng_reset_nonce()</a>, and <a class="el" href="crypto__openssl_8c_source.html#l00532">rand_bytes()</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01771">get_random()</a>, <a class="el" href="misc_8c_source.html#l00104">hostname_randomize()</a>, <a class="el" href="init_8c_source.html#l00782">init_static()</a>, <a class="el" href="crypto_8c_source.html#l00157">openvpn_encrypt_v1()</a>, and <a class="el" href="session__id_8c_source.html#l00051">session_id_random()</a>.</p>

</div>
</div>
<a id="ab99dea190ad93a642a0fc5a429b8f0ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab99dea190ad93a642a0fc5a429b8f0ed">&#9670;&nbsp;</a></span>prng_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prng_init </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>md_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nonce_secret_len_parm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pseudo-random number generator initialisation. </p>
<p>(see <code>prng_rand_bytes()</code>)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">md_name</td><td>Name of the message digest to use </td></tr>
    <tr><td class="paramname">nonce_secret_len_param</td><td>Length of the nonce to use </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01711">1711</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="buffer_8h_source.html#l01102">check_malloc_return()</a>, <a class="el" href="errlevel_8h_source.html#l00146">D_CRYPTO_DEBUG</a>, <a class="el" href="openvpn_2error_8h_source.html#l00171">dmsg</a>, <a class="el" href="crypto__openssl_8c_source.html#l00952">md_kt_get()</a>, <a class="el" href="crypto__backend_8h.html#af596da696fc79c7839c3abab26e935f2">md_kt_name()</a>, <a class="el" href="crypto__backend_8h.html#aaf03842b74cab3e4304e655aeaf75d2e">md_kt_size()</a>, <a class="el" href="crypto_8c_source.html#l01684">nonce_data</a>, <a class="el" href="crypto_8c_source.html#l01685">nonce_md</a>, <a class="el" href="crypto_8c_source.html#l01686">nonce_secret_len</a>, <a class="el" href="crypto_8h_source.html#l00461">NONCE_SECRET_LEN_MAX</a>, <a class="el" href="crypto_8h_source.html#l00458">NONCE_SECRET_LEN_MIN</a>, <a class="el" href="crypto_8c_source.html#l01690">prng_reset_nonce()</a>, and <a class="el" href="crypto_8c_source.html#l01730">prng_uninit()</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l02718">do_init_crypto_tls_c1()</a>, and <a class="el" href="init_8c_source.html#l00782">init_static()</a>.</p>

</div>
</div>
<a id="ae8c523b770f0e2f30d44004797106508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8c523b770f0e2f30d44004797106508">&#9670;&nbsp;</a></span>prng_uninit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prng_uninit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01730">1730</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8c_source.html#l01684">nonce_data</a>, <a class="el" href="crypto_8c_source.html#l01685">nonce_md</a>, and <a class="el" href="crypto_8c_source.html#l01686">nonce_secret_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l00346">free_ssl_lib()</a>, <a class="el" href="init_8c_source.html#l00782">init_static()</a>, and <a class="el" href="crypto_8c_source.html#l01711">prng_init()</a>.</p>

</div>
</div>
<a id="aa5a63a28549eab7b202ca3fa522a22d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5a63a28549eab7b202ca3fa522a22d6">&#9670;&nbsp;</a></span>read_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey.html">key</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01635">1635</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l00784">buf_read()</a>, <a class="el" href="crypto_8h_source.html#l00153">key::cipher</a>, <a class="el" href="crypto_8h_source.html#l00141">key_type::cipher_length</a>, <a class="el" href="openvpn_2basic_8h_source.html#l00033">CLEAR</a>, <a class="el" href="errlevel_8h_source.html#l00059">D_TLS_ERRORS</a>, <a class="el" href="crypto_8h_source.html#l00155">key::hmac</a>, <a class="el" href="crypto_8h_source.html#l00142">key_type::hmac_length</a>, and <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>.</p>

</div>
</div>
<a id="a3482d06fa45961722769bcad30ed3407"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3482d06fa45961722769bcad30ed3407">&#9670;&nbsp;</a></span>read_key_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_key_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey2.html">key2</a> *&#160;</td>
          <td class="paramname"><em>key2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01222">1222</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="buffer_8c_source.html#l00164">buf_clear()</a>, <a class="el" href="buffer_8h_source.html#l00335">buf_set_read()</a>, <a class="el" href="buffer_8h_source.html#l00221">buf_valid()</a>, <a class="el" href="buffer_8c_source.html#l01395">buffer_read_from_file()</a>, <a class="el" href="openvpn_2basic_8h_source.html#l00033">CLEAR</a>, <a class="el" href="buffer_8h_source.html#l00068">buffer::data</a>, <a class="el" href="buffer_8c_source.html#l00499">format_hex_ex()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="crypto_8h_source.html#l00185">key2::keys</a>, <a class="el" href="buffer_8h_source.html#l00066">buffer::len</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="errlevel_8h_source.html#l00055">M_INFO</a>, <a class="el" href="automatic_8c_source.html#l00112">match()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="crypto_8h_source.html#l00183">key2::n</a>, <a class="el" href="crypto_8c.html#a5e828e90e6c95a8286b0897f43877d29">PARSE_DATA</a>, <a class="el" href="crypto_8c.html#a980345ca92d0d4bc1b3b6046af74c162">PARSE_DATA_COMPLETE</a>, <a class="el" href="crypto_8c.html#a6ecdf92e034652cce30a224a8c17dd8b">PARSE_FINISHED</a>, <a class="el" href="crypto_8c.html#a5a033ce6f000f20383d5767786272738">PARSE_FOOT</a>, <a class="el" href="crypto_8c.html#a9d864891dd4264b6e0513a643f102508">PARSE_HEAD</a>, <a class="el" href="crypto_8c.html#a8c5180842263932c0015276334ab4c98">PARSE_INITIAL</a>, <a class="el" href="crypto_8c_source.html#l01164">print_key_filename()</a>, <a class="el" href="crypto_8c_source.html#l01213">printable_char_fmt</a>, <a class="el" href="crypto_8h_source.html#l00271">RKF_INLINE</a>, <a class="el" href="crypto_8h_source.html#l00270">RKF_MUST_SUCCEED</a>, <a class="el" href="openvpn_2basic_8h_source.html#l00030">SIZE</a>, <a class="el" href="crypto_8c_source.html#l01211">static_key_foot</a>, <a class="el" href="crypto_8c_source.html#l01210">static_key_head</a>, and <a class="el" href="crypto_8c_source.html#l01216">unprintable_char_fmt</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01175">crypto_read_openvpn_key()</a>.</p>

</div>
</div>
<a id="a4a653f6e2b03fc30f52845d37b5867a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a653f6e2b03fc30f52845d37b5867a9">&#9670;&nbsp;</a></span>read_pem_key_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool read_pem_key_file </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pem_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>key_inline</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read key material from a PEM encoded files into the key structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key</td><td>the key structure that will hold the key material </td></tr>
    <tr><td class="paramname">pem_name</td><td>the name used in the pem encoding start/end lines </td></tr>
    <tr><td class="paramname">key_file</td><td>name of the file to read or the key itself if key_inline is true </td></tr>
    <tr><td class="paramname">key_inline</td><td>True if key_file contains an inline key, False otherwise. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if reading into key was successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01913">1913</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00164">buf_clear()</a>, <a class="el" href="buffer_8h_source.html#l00335">buf_set_read()</a>, <a class="el" href="buffer_8h_source.html#l00221">buf_valid()</a>, <a class="el" href="buffer_8c_source.html#l01395">buffer_read_from_file()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00470">crypto_pem_decode()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00093">M_WARN</a>, and <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>.</p>

<p class="reference">Referenced by <a class="el" href="auth__token_8c_source.html#l00139">auth_token_init_secret()</a>, <a class="el" href="tls__crypt_8c_source.html#l00300">tls_crypt_v2_init_client_key()</a>, and <a class="el" href="tls__crypt_8c_source.html#l00325">tls_crypt_v2_init_server_key()</a>.</p>

</div>
</div>
<a id="a3c572ced6eea1c2b933df8e82b848983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c572ced6eea1c2b933df8e82b848983">&#9670;&nbsp;</a></span>test_crypto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_crypto </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcrypto__options.html">crypto_options</a> *&#160;</td>
          <td class="paramname"><em>co</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structframe.html">frame</a> *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01078">1078</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00090">alloc_buf_gc()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="buffer_8h_source.html#l00127">BLEN</a>, <a class="el" href="buffer_8h_source.html#l00124">BPTR</a>, <a class="el" href="buffer_8h_source.html#l00196">buf_init</a>, <a class="el" href="mtu_8h_source.html#l00194">BUF_SIZE</a>, <a class="el" href="buffer_8h_source.html#l00640">buf_write_alloc()</a>, <a class="el" href="buffer_8h_source.html#l00062">buffer::capacity</a>, <a class="el" href="crypto_8h_source.html#l00166">key_ctx::cipher</a>, <a class="el" href="crypto__openssl_8c_source.html#l00880">cipher_ctx_get_cipher_kt()</a>, <a class="el" href="crypto__backend_8h.html#a902518439f09e88281986ebda8dd458b">cipher_kt_iv_size()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00790">cipher_kt_mode_aead()</a>, <a class="el" href="buffer_8h_source.html#l00209">clear_buf()</a>, <a class="el" href="crypto_8h_source.html#l00223">key_ctx_bi::decrypt</a>, <a class="el" href="crypto_8h_source.html#l00221">key_ctx_bi::encrypt</a>, <a class="el" href="mtu_8h_source.html#l00187">FRAME_HEADROOM</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="crypto_8h_source.html#l00168">key_ctx::implicit_iv</a>, <a class="el" href="crypto_8h_source.html#l00170">key_ctx::implicit_iv_len</a>, <a class="el" href="crypto_8h_source.html#l00234">crypto_options::key_ctx_bi</a>, <a class="el" href="buffer_8h_source.html#l00066">buffer::len</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="errlevel_8h_source.html#l00055">M_INFO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="crypto_8h_source.html#l00268">OPENVPN_AEAD_MIN_IV_LEN</a>, <a class="el" href="crypto_8c_source.html#l00656">openvpn_decrypt()</a>, <a class="el" href="crypto_8c_source.html#l00299">openvpn_encrypt()</a>, <a class="el" href="crypto__mbedtls_8h_source.html#l00055">OPENVPN_MAX_IV_LENGTH</a>, <a class="el" href="config-msvc-version_8h_source.html#l00001">PACKAGE_NAME</a>, <a class="el" href="crypto__openssl_8c_source.html#l00532">rand_bytes()</a>, <a class="el" href="mtu_8h_source.html#l00156">TUN_MTU_SIZE</a>, and <a class="el" href="otime_8h_source.html#l00094">update_time()</a>.</p>

<p class="reference">Referenced by <a class="el" href="options_8c_source.html#l01532">show_settings()</a>, and <a class="el" href="init_8c_source.html#l04746">test_crypto_thread()</a>.</p>

</div>
</div>
<a id="a30a5545a94f3f5be9a828a54fae87c60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30a5545a94f3f5be9a828a54fae87c60">&#9670;&nbsp;</a></span>verify_fix_key2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void verify_fix_key2 </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structkey2.html">key2</a> *&#160;</td>
          <td class="paramname"><em>key2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>shared_secret_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01582">1582</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="crypto_8c_source.html#l00933">check_key()</a>, <a class="el" href="crypto_8c_source.html#l00972">fixup_key()</a>, <a class="el" href="crypto_8h_source.html#l00185">key2::keys</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="crypto_8h_source.html#l00183">key2::n</a>.</p>

<p class="reference">Referenced by <a class="el" href="crypto_8c_source.html#l01175">crypto_read_openvpn_key()</a>.</p>

</div>
</div>
<a id="ac5e8c79c3087b70be89679a45aa3a310"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5e8c79c3087b70be89679a45aa3a310">&#9670;&nbsp;</a></span>write_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool write_key </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structkey.html">key</a> *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structkey__type.html">key_type</a> *&#160;</td>
          <td class="paramname"><em>kt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01602">1602</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="buffer_8h_source.html#l00673">buf_write()</a>, <a class="el" href="crypto_8h_source.html#l00153">key::cipher</a>, <a class="el" href="crypto_8h_source.html#l00141">key_type::cipher_length</a>, <a class="el" href="crypto_8h_source.html#l00155">key::hmac</a>, <a class="el" href="crypto_8h_source.html#l00142">key_type::hmac_length</a>, <a class="el" href="crypto__backend_8h_source.html#l00237">MAX_CIPHER_KEY_LENGTH</a>, and <a class="el" href="crypto__backend_8h_source.html#l00517">MAX_HMAC_KEY_LENGTH</a>.</p>

</div>
</div>
<a id="a81c00d1ee124bc52b54b6b3082fba96e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81c00d1ee124bc52b54b6b3082fba96e">&#9670;&nbsp;</a></span>write_key_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int write_key_file </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nkeys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write nkeys 1024-bits keys to file. </p>
<dl class="section return"><dt>Returns</dt><dd>number of random bits written, or -1 on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01425">1425</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00090">alloc_buf_gc()</a>, <a class="el" href="buffer_8h_source.html#l00127">BLEN</a>, <a class="el" href="buffer_8h_source.html#l00124">BPTR</a>, <a class="el" href="buffer_8c_source.html#l00164">buf_clear()</a>, <a class="el" href="buffer_8c_source.html#l00245">buf_printf()</a>, <a class="el" href="buffer_8c_source.html#l00349">buffer_write_file()</a>, <a class="el" href="buffer_8c_source.html#l00499">format_hex_ex()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="crypto_8c_source.html#l01019">generate_key_random()</a>, <a class="el" href="buffer_8h_source.html#l00401">secure_memzero()</a>, <a class="el" href="crypto_8c_source.html#l01211">static_key_foot</a>, and <a class="el" href="crypto_8c_source.html#l01210">static_key_head</a>.</p>

<p class="reference">Referenced by <a class="el" href="init_8c_source.html#l01101">do_genkey()</a>.</p>

</div>
</div>
<a id="a3d1d59d591bbcb56e9b02116f1a66112"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d1d59d591bbcb56e9b02116f1a66112">&#9670;&nbsp;</a></span>write_pem_key_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write_pem_key_file </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a server key with enough randomness to fill a key struct and write to file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Filename of the server key file to create. </td></tr>
    <tr><td class="paramname">pem_name</td><td>The name to use in the PEM header/footer. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01857">1857</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l00127">BLEN</a>, <a class="el" href="buffer_8h_source.html#l00124">BPTR</a>, <a class="el" href="buffer_8c_source.html#l00164">buf_clear()</a>, <a class="el" href="buffer_8h_source.html#l00335">buf_set_read()</a>, <a class="el" href="buffer_8c_source.html#l00349">buffer_write_file()</a>, <a class="el" href="buffer_8h_source.html#l00209">clear_buf()</a>, <a class="el" href="crypto__openssl_8c_source.html#l00442">crypto_pem_encode()</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00107">M_ERR</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00093">M_WARN</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="crypto__openssl_8c_source.html#l00532">rand_bytes()</a>, and <a class="el" href="buffer_8h_source.html#l00401">secure_memzero()</a>.</p>

<p class="reference">Referenced by <a class="el" href="auth__token_8c_source.html#l00133">auth_token_write_server_key_file()</a>, and <a class="el" href="tls__crypt_8c_source.html#l00636">tls_crypt_v2_write_server_key_file()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
