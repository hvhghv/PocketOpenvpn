<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: src/openvpn/push.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_92f13d409beef24f5ba1b81abfed1f1c.html">openvpn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">push.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="push_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  OpenVPN -- An application to securely tunnel IP networks</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *             over a single TCP/UDP port, with support for SSL/TLS-based</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *             session authentication and key exchange,</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *             packet encryption, packet authentication, and</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *             packet compression.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *  Copyright (C) 2002-2022 OpenVPN Inc &lt;sales@openvpn.net&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *  This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  it under the terms of the GNU General Public License version 2</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *  as published by the Free Software Foundation.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *  This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *  GNU General Public License for more details.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *  You should have received a copy of the GNU General Public License along</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *  with this program; if not, write to the Free Software Foundation, Inc.,</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *  51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="config_8h.html">config.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#elif defined(_MSC_VER)</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="config-msvc_8h.html">config-msvc.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="syshead_8h.html">syshead.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="push_8h.html">push.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="options_8h.html">options.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ssl_8h.html">ssl.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ssl__verify_8h.html">ssl_verify.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ssl__ncp_8h.html">ssl_ncp.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="manage_8h.html">manage.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdbg_8h.html">memdbg.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="push_8c.html#a526fbfb56d0a579146a01c2c0db9584e">   43</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="push_8c.html#a526fbfb56d0a579146a01c2c0db9584e">push_reply_cmd</a>[] = <span class="stringliteral">&quot;PUSH_REPLY&quot;</span>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> * Auth username/password</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> * Client received an authentication failed message from server.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> * Runs on client.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="push_8h.html#a1146746ce08245cf99ee59592d775acc">   52</a></span>&#160;<a class="code" href="push_8c.html#a1146746ce08245cf99ee59592d775acc">receive_auth_failed</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *<a class="code" href="structbuffer.html">buffer</a>)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a2c9a69063637763ee444c8f4a25188ba">M_VERB0</a>, <span class="stringliteral">&quot;AUTH: Received control message: %s&quot;</span>, <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(<a class="code" href="structbuffer.html">buffer</a>));</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#adb8ec5e44523e50a40777073262d41a2">no_advance</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">pull</a>)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="comment">/* Before checking how to react on AUTH_FAILED, first check if the</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">         * failed auth might be the result of an expired auth-token.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">         * Note that a server restart will trigger a generic AUTH_FAILED</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">         * instead an AUTH_FAILED,SESSION so handle all AUTH_FAILED message</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">         * identical for this scenario */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ssl_8c.html#aea948c70f8ca194a60dd1b17adb5247d">ssl_clean_auth_token</a>())</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> = <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>; <span class="comment">/* SOFT-SIGUSR1 -- Auth failure error */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a> = <span class="stringliteral">&quot;auth-failure (auth-token)&quot;</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="options_8c.html#ade63586867ed9b0f268b4857ac8e7a5f">auth_retry_get</a>())</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="options_8h.html#aa4019b2e0b0d1bc21cdb433db9d5507d">AR_NONE</a>:</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> = <a class="code" href="config-msvc_8h.html#a682182a5e5f38fd61f4311501e9dac5d">SIGTERM</a>; <span class="comment">/* SOFT-SIGTERM -- Auth failure error */</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="options_8h.html#a570ecbd9a01e98df42199d078454f848">AR_INTERACT</a>:</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                    <a class="code" href="ssl_8c.html#a004bfec7a400d6c55a880bde27ff8b23">ssl_purge_auth</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="options_8h.html#aa9cc77b228a8b97a2b65e6865b7ae005">AR_NOINTERACT</a>:</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> = <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>; <span class="comment">/* SOFT-SIGUSR1 -- Auth failure error */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(0);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a> = <span class="stringliteral">&quot;auth-failure&quot;</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *reason = NULL;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf = *<a class="code" href="structbuffer.html">buffer</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="buffer_8c.html#a042e9b112fb90777619ec9cd1678d5b5">buf_string_compare_advance</a>(&amp;buf, <span class="stringliteral">&quot;AUTH_FAILED,&quot;</span>) &amp;&amp; <a class="code" href="buffer_8h.html#ab7be565801383d9f7371ab9a6aa99077">BLEN</a>(&amp;buf))</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                reason = <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;buf);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <a class="code" href="manage_8c.html#a02c5232bf0d3d6b276058c9756de52c2">management_auth_failure</a>(<a class="code" href="structmanagement.html">management</a>, <a class="code" href="ssl__common_8h.html#ac71370f88da0ddceccb01fb990f83a0f">UP_TYPE_AUTH</a>, reason);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">         * Save the dynamic-challenge text even when management is defined</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf = *<a class="code" href="structbuffer.html">buffer</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="buffer_8c.html#ade2c81fb41f1c4838dc6e85a7b1d1f3b">buf_string_match_head_str</a>(&amp;buf, <span class="stringliteral">&quot;AUTH_FAILED,CRV1:&quot;</span>) &amp;&amp; <a class="code" href="buffer_8h.html#ab7be565801383d9f7371ab9a6aa99077">BLEN</a>(&amp;buf))</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <a class="code" href="buffer_8h.html#a7ac72e76e9e41235a31f872f63bf58fe">buf_advance</a>(&amp;buf, 12); <span class="comment">/* Length of &quot;AUTH_FAILED,&quot; substring */</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <a class="code" href="ssl_8c.html#a474cc01c012410f92375140e781f714d">ssl_put_auth_challenge</a>(<a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;buf));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> * Act on received restart message from server</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="push_8h.html#a38474861b2c7ef798cf3ff27a8b16ea8">  121</a></span>&#160;<a class="code" href="push_8c.html#a38474861b2c7ef798cf3ff27a8b16ea8">server_pushed_signal</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *<a class="code" href="structbuffer.html">buffer</a>, <span class="keyword">const</span> <span class="keywordtype">bool</span> restart, <span class="keyword">const</span> <span class="keywordtype">int</span> adv)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;{</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">pull</a>)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf = *<a class="code" href="structbuffer.html">buffer</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *m = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="buffer_8h.html#a7ac72e76e9e41235a31f872f63bf58fe">buf_advance</a>(&amp;buf, adv) &amp;&amp; <a class="code" href="buffer_8h.html#ab7b6746dd30a4cfaf4a9218f42c6dabe">buf_read_u8</a>(&amp;buf) == <span class="charliteral">&#39;,&#39;</span> &amp;&amp; <a class="code" href="buffer_8h.html#ab7be565801383d9f7371ab9a6aa99077">BLEN</a>(&amp;buf))</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            m = <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;buf);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">/* preserve cached passwords? */</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">/* advance to next server? */</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordtype">bool</span> purge = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">if</span> (m[0] == <span class="charliteral">&#39;[&#39;</span>)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <span class="keywordflow">for</span> (i = 1; m[i] != <span class="charliteral">&#39;\0&#39;</span> &amp;&amp; m[i] != <span class="charliteral">&#39;]&#39;</span>; ++i)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                    <span class="keywordflow">if</span> (m[i] == <span class="charliteral">&#39;P&#39;</span>)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                        purge = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                    }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m[i] == <span class="charliteral">&#39;N&#39;</span>)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                    {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                        <span class="comment">/* next server? */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#adb8ec5e44523e50a40777073262d41a2">no_advance</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">if</span> (purge)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <a class="code" href="ssl_8c.html#a004bfec7a400d6c55a880bde27ff8b23">ssl_purge_auth</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> (restart)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a8449a1755d1636b2ed9925c109353f46">D_STREAM_ERRORS</a>, <span class="stringliteral">&quot;Connection reset command was pushed by server (&#39;%s&#39;)&quot;</span>, m);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> = <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>; <span class="comment">/* SOFT-SIGUSR1 -- server-pushed connection reset */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a> = <span class="stringliteral">&quot;server-pushed-connection-reset&quot;</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a8449a1755d1636b2ed9925c109353f46">D_STREAM_ERRORS</a>, <span class="stringliteral">&quot;Halt command was pushed by server (&#39;%s&#39;)&quot;</span>, m);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> = <a class="code" href="config-msvc_8h.html#a682182a5e5f38fd61f4311501e9dac5d">SIGTERM</a>; <span class="comment">/* SOFT-SIGTERM -- server-pushed halt */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a> = <span class="stringliteral">&quot;server-pushed-halt&quot;</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <a class="code" href="manage_8c.html#af797c4485e4c1d150a3ec5abdbf22f99">management_notify</a>(<a class="code" href="structmanagement.html">management</a>, <span class="stringliteral">&quot;info&quot;</span>, c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a>, m);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="push_8h.html#a7f6650958bc623e7676ffa5ada2949d8">  181</a></span>&#160;<a class="code" href="push_8c.html#a7f6650958bc623e7676ffa5ada2949d8">server_pushed_info</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *<a class="code" href="structbuffer.html">buffer</a>,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">int</span> adv)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;{</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *m = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf = *<a class="code" href="structbuffer.html">buffer</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="buffer_8h.html#a7ac72e76e9e41235a31f872f63bf58fe">buf_advance</a>(&amp;buf, adv) &amp;&amp; <a class="code" href="buffer_8h.html#ab7b6746dd30a4cfaf4a9218f42c6dabe">buf_read_u8</a>(&amp;buf) == <span class="charliteral">&#39;,&#39;</span> &amp;&amp; <a class="code" href="buffer_8h.html#ab7be565801383d9f7371ab9a6aa99077">BLEN</a>(&amp;buf))</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        m = <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;buf);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">         * We use &gt;INFOMSG here instead of plain &gt;INFO since INFO is used to</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">         * for management greeting and we don&#39;t want to confuse the client</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> out = <a class="code" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c">alloc_buf_gc</a>(256, &amp;gc);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;out, <span class="stringliteral">&quot;&gt;%s:%s&quot;</span>, <span class="stringliteral">&quot;INFOMSG&quot;</span>, m);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="manage_8c.html#aa6413bcc39609b0f51090d792aea0454">management_notify_generic</a>(<a class="code" href="structmanagement.html">management</a>, <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;out));</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;Info command was pushed by server (&#39;%s&#39;)&quot;</span>, m);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="push_8h.html#a3e9f079d617f92e84b1268218704d821">  213</a></span>&#160;<a class="code" href="push_8c.html#a3e9f079d617f92e84b1268218704d821">receive_cr_response</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *<a class="code" href="structbuffer.html">buffer</a>)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;{</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf = *<a class="code" href="structbuffer.html">buffer</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *m = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="buffer_8h.html#a7ac72e76e9e41235a31f872f63bf58fe">buf_advance</a>(&amp;buf, 11) &amp;&amp; <a class="code" href="buffer_8h.html#ab7b6746dd30a4cfaf4a9218f42c6dabe">buf_read_u8</a>(&amp;buf) == <span class="charliteral">&#39;,&#39;</span> &amp;&amp; <a class="code" href="buffer_8h.html#ab7be565801383d9f7371ab9a6aa99077">BLEN</a>(&amp;buf))</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        m = <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;buf);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">#ifdef MANAGEMENT_DEF_AUTH</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keyword">struct </span><a class="code" href="structtls__session.html">tls_session</a> *<a class="code" href="structsession.html">session</a> = &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a74e065e432f819307a830ef38d5be73c">session</a>[<a class="code" href="group__control__processor.html#gad3c70b02a0ca4537fba1d53802e1e429">TM_ACTIVE</a>];</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keyword">struct </span>man_def_auth_context *mda = <a class="code" href="structsession.html">session</a>-&gt;opt-&gt;mda_context;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keyword">struct </span><a class="code" href="structenv__set.html">env_set</a> *es = <a class="code" href="structsession.html">session</a>-&gt;opt-&gt;es;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">int</span> key_id = <a class="code" href="structsession.html">session</a>-&gt;<a class="code" href="structsession.html#ae5684b6cb3c3f9767343789e45a21b17">key</a>[<a class="code" href="group__control__processor.html#ga53a47713d8d3afdedf8826560da3e8b1">KS_PRIMARY</a>].key_id;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    management_notify_client_cr_response(key_id, mda, es, m);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;CR response was sent by client (&#39;%s&#39;)&quot;</span>, m);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="push_8c.html#a069d396329687a74283023cefc397c93">push_option_fmt</a>(<span class="keyword">struct</span> <a class="code" href="structgc__arena.html">gc_arena</a> *<a class="code" href="structenv__set.html#ac1f5edea620699ff13763b84a008e365">gc</a>, <span class="keyword">struct</span> <a class="code" href="structpush__list.html">push_list</a> *<a class="code" href="structpush__list.html">push_list</a>,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                            <span class="keywordtype">int</span> msglevel, <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">#ifdef __GNUC__</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#if __USE_MINGW_ANSI_STDIO</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;__attribute__ ((format(gnu_printf, 4, 5)))</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;__attribute__ ((format(__printf__, 4, 5)))</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"> * Send auth failed message from server to client.</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="push_8h.html#a4a16d4e40446d6f6c3f2c8b0b319f652">  262</a></span>&#160;<a class="code" href="push_8c.html#a4a16d4e40446d6f6c3f2c8b0b319f652">send_auth_failed</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *client_reason)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;{</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> auth_failed[] = <span class="stringliteral">&quot;AUTH_FAILED&quot;</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordtype">size_t</span> len;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="forward_8c.html#a77516756998a056dedada8aeb0f0f2e3">schedule_exit</a>(c, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a238616194d17beb9b5b6605ff747085c">scheduled_exit_interval</a>, <a class="code" href="config-msvc_8h.html#a682182a5e5f38fd61f4311501e9dac5d">SIGTERM</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    len = (client_reason ? strlen(client_reason)+1 : 0) + <span class="keyword">sizeof</span>(auth_failed);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (len &gt; <a class="code" href="common_8h.html#acffcd4cb515881c936f8b7092f235f3e">PUSH_BUNDLE_SIZE</a>)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        len = <a class="code" href="common_8h.html#acffcd4cb515881c936f8b7092f235f3e">PUSH_BUNDLE_SIZE</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf = <a class="code" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c">alloc_buf_gc</a>(<a class="code" href="structbuffer.html#ada52eab703a091ff327114b3b3b0140a">len</a>, &amp;gc);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;buf, auth_failed);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">if</span> (client_reason)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;buf, <span class="stringliteral">&quot;,%s&quot;</span>, client_reason);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a>(c, <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;buf), <a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="push_8h.html#afaee70b7fdf7f50f31c5505b926b0acb">  290</a></span>&#160;<a class="code" href="push_8c.html#afaee70b7fdf7f50f31c5505b926b0acb">send_auth_pending_messages</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *extra)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;{</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <a class="code" href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a>(c, <span class="stringliteral">&quot;AUTH_PENDING&quot;</span>, <a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> info_pre[] = <span class="stringliteral">&quot;INFO_PRE,&quot;</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structbuffer.html#ada52eab703a091ff327114b3b3b0140a">len</a> = strlen(extra)+1 + <span class="keyword">sizeof</span>(info_pre);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structbuffer.html#ada52eab703a091ff327114b3b3b0140a">len</a> &gt; <a class="code" href="common_8h.html#acffcd4cb515881c936f8b7092f235f3e">PUSH_BUNDLE_SIZE</a>)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf = <a class="code" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c">alloc_buf_gc</a>(<a class="code" href="structbuffer.html#ada52eab703a091ff327114b3b3b0140a">len</a>, &amp;gc);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;buf, info_pre);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;buf, <span class="stringliteral">&quot;%s&quot;</span>, extra);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a>(c, <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;buf), <a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"> * Send restart message from server to client.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="push_8h.html#a153e89097ea94283b2a9df7e381f619f">  317</a></span>&#160;<a class="code" href="push_8c.html#a153e89097ea94283b2a9df7e381f619f">send_restart</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *kill_msg)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;{</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="forward_8c.html#a77516756998a056dedada8aeb0f0f2e3">schedule_exit</a>(c, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a238616194d17beb9b5b6605ff747085c">scheduled_exit_interval</a>, <a class="code" href="config-msvc_8h.html#a682182a5e5f38fd61f4311501e9dac5d">SIGTERM</a>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a>(c, kill_msg ? kill_msg : <span class="stringliteral">&quot;RESTART&quot;</span>, <a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;}</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"> * Push/Pull</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="push_8h.html#ac33633059f09bb30f8a33fee87f33aa2">  328</a></span>&#160;<a class="code" href="push_8c.html#ac33633059f09bb30f8a33fee87f33aa2">incoming_push_message</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *<a class="code" href="structbuffer.html">buffer</a>)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;{</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> option_types_found = 0;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;PUSH: Received control message: &#39;%s&#39;&quot;</span>, <a class="code" href="misc_8c.html#ad9f9ea2091b3303cef77c02575fdf91d">sanitize_control_message</a>(<a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(<a class="code" href="structbuffer.html">buffer</a>), &amp;gc));</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> = <a class="code" href="push_8c.html#ae4505044645e0855d4dd7296697a411c">process_incoming_push_msg</a>(c, <a class="code" href="structbuffer.html">buffer</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">pull</a>,</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                           <a class="code" href="init_8c.html#aded279bc953617852338a38e3d1a256b">pull_permission_mask</a>(c),</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                           &amp;option_types_found);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> == <a class="code" href="push_8h.html#aa1310ae98441e0758a65fcc02d371601">PUSH_MSG_ERROR</a>)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ab1f5456810dd6e5c6ab78c1b3d35f1c0">D_PUSH_ERRORS</a>, <span class="stringliteral">&quot;WARNING: Received bad push/pull message: %s&quot;</span>, <a class="code" href="misc_8c.html#ad9f9ea2091b3303cef77c02575fdf91d">sanitize_control_message</a>(<a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(<a class="code" href="structbuffer.html">buffer</a>), &amp;gc));</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> == <a class="code" href="push_8h.html#ac3324c7b44e0338dd4817c4965ad7b93">PUSH_MSG_REPLY</a> || <a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> == <a class="code" href="push_8h.html#af425e5cb988d69e642be32fc01e9765c">PUSH_MSG_CONTINUATION</a>)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a2809c3210f04037afdfcbffcabb42a2a">push_option_types_found</a> |= option_types_found;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="comment">/* delay bringing tun/tap up until --push parms received from remote */</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> == <a class="code" href="push_8h.html#ac3324c7b44e0338dd4817c4965ad7b93">PUSH_MSG_REPLY</a>)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="init_8c.html#a9b053b7a612943b6be1d1be2c25181bf">do_up</a>(c, <span class="keyword">true</span>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a2809c3210f04037afdfcbffcabb42a2a">push_option_types_found</a>))</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ab1f5456810dd6e5c6ab78c1b3d35f1c0">D_PUSH_ERRORS</a>, <span class="stringliteral">&quot;Failed to open tun/tap interface&quot;</span>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="keywordflow">goto</span> error;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <a class="code" href="interval_8h.html#a882171fabcf7627fd129fe3268052069">event_timeout_clear</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a74f0885f811abb630be6afb8bfe1e144">push_request_interval</a>);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <a class="code" href="interval_8h.html#a882171fabcf7627fd129fe3268052069">event_timeout_clear</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a6e148857a12de912aef0d3476a85baea">wait_for_connect</a>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;error:</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417">register_signal</a>(c, <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>, <span class="stringliteral">&quot;process-push-msg-failed&quot;</span>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;cleanup:</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="push_8h.html#a95f1b9a8d9ce1ff67684e847c90d2489">  369</a></span>&#160;<a class="code" href="push_8c.html#a95f1b9a8d9ce1ff67684e847c90d2489">send_push_request</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;{</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> max_push_requests = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6b960ac0e59bda605e2b6879d024afa2">handshake_window</a> / <a class="code" href="common_8h.html#a82f7052097bbb3782cda1437e443eeea">PUSH_REQUEST_INTERVAL</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">if</span> (++c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ac9c31be53653726a665561a5efa77399">n_sent_push_requests</a> &lt;= max_push_requests)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a>(c, <span class="stringliteral">&quot;PUSH_REQUEST&quot;</span>, <a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a8449a1755d1636b2ed9925c109353f46">D_STREAM_ERRORS</a>, <span class="stringliteral">&quot;No reply from server after sending %d push requests&quot;</span>, max_push_requests);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> = <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>; <span class="comment">/* SOFT-SIGUSR1 -- server-pushed connection reset */</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a> = <span class="stringliteral">&quot;no-push-reply&quot;</span>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="push_8c.html#a88e70a623d2eb74b70c23fdc4092c229">  394</a></span>&#160;<a class="code" href="push_8c.html#a88e70a623d2eb74b70c23fdc4092c229">prepare_auth_token_push_reply</a>(<span class="keyword">struct</span> <a class="code" href="structtls__multi.html">tls_multi</a> *<a class="code" href="structtls__multi.html">tls_multi</a>, <span class="keyword">struct</span> <a class="code" href="structgc__arena.html">gc_arena</a> *gc,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                              <span class="keyword">struct</span> <a class="code" href="structpush__list.html">push_list</a> *<a class="code" href="structpush__list.html">push_list</a>)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;{</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">     * If server uses --auth-gen-token and we have an auth token</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">     * to send to the client</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structtls__multi.html">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#aa03c9a1c7487bd7bed7e4f73e266614d">auth_token</a>)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <a class="code" href="push_8c.html#a069d396329687a74283023cefc397c93">push_option_fmt</a>(gc, <a class="code" href="structpush__list.html">push_list</a>, <a class="code" href="openvpn_2error_8h.html#a446cccfde267d5f96d18513d217286fe">M_USAGE</a>,</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        <span class="stringliteral">&quot;auth-token %s&quot;</span>,</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                        <a class="code" href="structtls__multi.html">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#aa03c9a1c7487bd7bed7e4f73e266614d">auth_token</a>);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="structtls__multi.html">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a067765b59cac7a31d0736d3e3e8bfe28">auth_token_initial</a>)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">             * Save the initial auth token for clients that ignore</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">             * the updates to the token</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <a class="code" href="structtls__multi.html">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a067765b59cac7a31d0736d3e3e8bfe28">auth_token_initial</a> = strdup(<a class="code" href="structtls__multi.html">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#aa03c9a1c7487bd7bed7e4f73e266614d">auth_token</a>);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="push_8c.html#ad5c8ae2114245fa689a4d075177a81c7">  427</a></span>&#160;<a class="code" href="push_8c.html#ad5c8ae2114245fa689a4d075177a81c7">prepare_push_reply</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">struct</span> <a class="code" href="structgc__arena.html">gc_arena</a> *gc,</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                   <span class="keyword">struct</span> <a class="code" href="structpush__list.html">push_list</a> *<a class="code" href="structpush__list.html">push_list</a>)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;{</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keyword">struct </span><a class="code" href="structtls__multi.html">tls_multi</a> *<a class="code" href="structtls__multi.html">tls_multi</a> = c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keyword">struct </span><a class="code" href="structoptions.html">options</a> *o = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">/* ipv6 */</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a0c202bede566ebdc332a947f625677be">push_ifconfig_ipv6_defined</a> &amp;&amp; !o-&gt;<a class="code" href="structoptions.html#a624da06f35ed664a7f7c3519dd0846cc">push_ifconfig_ipv6_blocked</a>)</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="push_8c.html#a069d396329687a74283023cefc397c93">push_option_fmt</a>(<a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>, <a class="code" href="structpush__list.html">push_list</a>, <a class="code" href="openvpn_2error_8h.html#a446cccfde267d5f96d18513d217286fe">M_USAGE</a>, <span class="stringliteral">&quot;ifconfig-ipv6 %s/%d %s&quot;</span>,</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                        <a class="code" href="socket_8c.html#a9a911c5dde4c809f7cb3eef8e5918a8e">print_in6_addr</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a9e665bde380a5c86d14625d990d831e5">push_ifconfig_ipv6_local</a>, 0, <a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>),</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a8b3a694dbf8a1836815eedf14c39d923">push_ifconfig_ipv6_netbits</a>,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        <a class="code" href="socket_8c.html#a9a911c5dde4c809f7cb3eef8e5918a8e">print_in6_addr</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdeab25ad036b57d8a520e0f2c7ca4b">push_ifconfig_ipv6_remote</a>,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                       0, <a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>));</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">/* ipv4 */</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2b16aba3b459e82db77ceddaf77f8426">push_ifconfig_defined</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#afd1f50ebf21448a621dcf0c1b21e1d63">push_ifconfig_local</a></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        &amp;&amp; c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ac5b35ba45869db49edb7092e07e81d8f">push_ifconfig_remote_netmask</a></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        &amp;&amp; !o-&gt;<a class="code" href="structoptions.html#aecf13b277bacf5c1cb2bdfb7e9733d4f">push_ifconfig_ipv4_blocked</a>)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="config-msvc_8h.html#a64ca7e440847b0f5d19cbe94f9e114bd">in_addr_t</a> <a class="code" href="structoptions.html#a6c5eef6691660bf4aa7618c2a5485558">ifconfig_local</a> = c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#afd1f50ebf21448a621dcf0c1b21e1d63">push_ifconfig_local</a>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa77badbb770cedf77546d656d961d3ac">push_ifconfig_local_alias</a>)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <a class="code" href="structoptions.html#a6c5eef6691660bf4aa7618c2a5485558">ifconfig_local</a> = c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa77badbb770cedf77546d656d961d3ac">push_ifconfig_local_alias</a>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <a class="code" href="push_8c.html#a069d396329687a74283023cefc397c93">push_option_fmt</a>(<a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>, <a class="code" href="structpush__list.html">push_list</a>, <a class="code" href="openvpn_2error_8h.html#a446cccfde267d5f96d18513d217286fe">M_USAGE</a>, <span class="stringliteral">&quot;ifconfig %s %s&quot;</span>,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                        <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(<a class="code" href="structoptions.html#a6c5eef6691660bf4aa7618c2a5485558">ifconfig_local</a>, 0, <a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>),</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                        <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ac5b35ba45869db49edb7092e07e81d8f">push_ifconfig_remote_netmask</a>,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                        0, <a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>));</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structtls__multi.html">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#aa1c6b330c9dd68a9f9dd6bf05d454642">use_peer_id</a>)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <a class="code" href="push_8c.html#a069d396329687a74283023cefc397c93">push_option_fmt</a>(<a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>, <a class="code" href="structpush__list.html">push_list</a>, <a class="code" href="openvpn_2error_8h.html#a446cccfde267d5f96d18513d217286fe">M_USAGE</a>, <span class="stringliteral">&quot;peer-id %d&quot;</span>,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                        <a class="code" href="structtls__multi.html">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a93c90f22f9fbbd1898ea9708a49ee1f7">peer_id</a>);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">     * If server uses --auth-gen-token and we have an auth token</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">     * to send to the client</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="push_8c.html#a88e70a623d2eb74b70c23fdc4092c229">prepare_auth_token_push_reply</a>(<a class="code" href="structtls__multi.html">tls_multi</a>, <a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>, <a class="code" href="structpush__list.html">push_list</a>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">     * Push the selected cipher, at this point the cipher has been</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">     * already negotiated and been fixed.</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">     * We avoid pushing the cipher to clients not supporting NCP</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">     * to avoid error messages in their logs</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ssl__ncp_8c.html#ac1a6ca132f8c8f36946e7219726f53a0">tls_peer_supports_ncp</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a4a562d513904cc568d8a91af8255ebdf">peer_info</a>))</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="push_8c.html#a069d396329687a74283023cefc397c93">push_option_fmt</a>(<a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>, <a class="code" href="structpush__list.html">push_list</a>, <a class="code" href="openvpn_2error_8h.html#a446cccfde267d5f96d18513d217286fe">M_USAGE</a>, <span class="stringliteral">&quot;cipher %s&quot;</span>, o-&gt;<a class="code" href="structoptions.html#a7f09235fee401590074265aff177491a">ciphername</a>);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00486"></a><span class="lineno"><a class="line" href="push_8c.html#ada981d7b3b5819cfcefbb875889b8d57">  486</a></span>&#160;<a class="code" href="push_8c.html#ada981d7b3b5819cfcefbb875889b8d57">send_push_options</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *buf,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                  <span class="keyword">struct</span> <a class="code" href="structpush__list.html">push_list</a> *<a class="code" href="structpush__list.html">push_list</a>, <span class="keywordtype">int</span> safe_cap,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                  <span class="keywordtype">bool</span> *push_sent, <span class="keywordtype">bool</span> *multi_push)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;{</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keyword">struct </span><a class="code" href="structpush__entry.html">push_entry</a> *e = <a class="code" href="structpush__list.html">push_list</a>-&gt;<a class="code" href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">head</a>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    e = <a class="code" href="structpush__list.html">push_list</a>-&gt;<a class="code" href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">head</a>;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">while</span> (e)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structpush__entry.html#ae890e41d491f778ed1ee7396fec98b6e">enable</a>)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> l = strlen(e-&gt;<a class="code" href="structpush__entry.html#af7709664ab4d399ea2454640db321411">option</a>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="buffer_8h.html#ab7be565801383d9f7371ab9a6aa99077">BLEN</a>(buf) + l &gt;= safe_cap)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(buf, <span class="stringliteral">&quot;,push-continuation 2&quot;</span>);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> = <a class="code" href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a>(c, <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(buf), <a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                    {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                    }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                    *push_sent = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                    *multi_push = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    <a class="code" href="buffer_8h.html#ab8c6f1a02df80ea23d7df737eda163d5">buf_reset_len</a>(buf);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                    <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(buf, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="push_8c.html#a526fbfb56d0a579146a01c2c0db9584e">push_reply_cmd</a>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="buffer_8h.html#ab7be565801383d9f7371ab9a6aa99077">BLEN</a>(buf) + l &gt;= safe_cap)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;--push option is too long&quot;</span>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(buf, <span class="stringliteral">&quot;,%s&quot;</span>, e-&gt;<a class="code" href="structpush__entry.html#af7709664ab4d399ea2454640db321411">option</a>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        e = e-&gt;<a class="code" href="structpush__entry.html#a2a6b3c293572711f5f661628b23b3716">next</a>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="push_8h.html#afeaacd608704c9ef6ddfa1bea7a280e8">  526</a></span>&#160;<a class="code" href="push_8c.html#afeaacd608704c9ef6ddfa1bea7a280e8">send_push_reply_auth_token</a>(<span class="keyword">struct</span> <a class="code" href="structtls__multi.html">tls_multi</a> *multi)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;{</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keyword">struct </span><a class="code" href="structpush__list.html">push_list</a> <a class="code" href="structpush__list.html">push_list</a> = { 0 };</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="push_8c.html#a88e70a623d2eb74b70c23fdc4092c229">prepare_auth_token_push_reply</a>(multi, &amp;gc, &amp;<a class="code" href="structpush__list.html">push_list</a>);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">/* prepare auth token should always add the auth-token option */</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keyword">struct </span><a class="code" href="structpush__entry.html">push_entry</a> *e = <a class="code" href="structpush__list.html">push_list</a>.<a class="code" href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">head</a>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(e &amp;&amp; e-&gt;<a class="code" href="structpush__entry.html#ae890e41d491f778ed1ee7396fec98b6e">enable</a>);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">/* Construct a mimimal control channel push reply message */</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf = <a class="code" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c">alloc_buf_gc</a>(<a class="code" href="common_8h.html#acffcd4cb515881c936f8b7092f235f3e">PUSH_BUNDLE_SIZE</a>, &amp;gc);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;buf, <span class="stringliteral">&quot;%s,%s&quot;</span>, <a class="code" href="push_8c.html#a526fbfb56d0a579146a01c2c0db9584e">push_reply_cmd</a>, e-&gt;<a class="code" href="structpush__entry.html#af7709664ab4d399ea2454640db321411">option</a>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="forward_8c.html#a9a8912859db26b7a9588ed5cdff63be4">send_control_channel_string_dowork</a>(multi, <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;buf), <a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;}</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00545"></a><span class="lineno"><a class="line" href="push_8c.html#ae7ebce816788a80c521efae5c3c65cc8">  545</a></span>&#160;<a class="code" href="push_8c.html#ae7ebce816788a80c521efae5c3c65cc8">send_push_reply</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">struct</span> <a class="code" href="structpush__list.html">push_list</a> *per_client_push_list)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;{</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf = <a class="code" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c">alloc_buf_gc</a>(<a class="code" href="common_8h.html#acffcd4cb515881c936f8b7092f235f3e">PUSH_BUNDLE_SIZE</a>, &amp;gc);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordtype">bool</span> multi_push = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> extra = 84; <span class="comment">/* extra space for possible trailing ifconfig and push-continuation */</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> safe_cap = <a class="code" href="buffer_8h.html#ac08c75bf761b2c048b14e5b6cbf2c8f3">BCAP</a>(&amp;buf) - extra;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordtype">bool</span> push_sent = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;buf, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="push_8c.html#a526fbfb56d0a579146a01c2c0db9584e">push_reply_cmd</a>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">/* send options which are common to all clients */</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="push_8c.html#ada981d7b3b5819cfcefbb875889b8d57">send_push_options</a>(c, &amp;buf, &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6fbf9febd6c9d47be739af08bb728b30">push_list</a>, safe_cap,</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                           &amp;push_sent, &amp;multi_push))</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">goto</span> fail;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">/* send client-specific options */</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="push_8c.html#ada981d7b3b5819cfcefbb875889b8d57">send_push_options</a>(c, &amp;buf, per_client_push_list, safe_cap,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                           &amp;push_sent, &amp;multi_push))</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">goto</span> fail;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">if</span> (multi_push)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;buf, <span class="stringliteral">&quot;,push-continuation 1&quot;</span>);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="buffer_8h.html#ab7be565801383d9f7371ab9a6aa99077">BLEN</a>(&amp;buf) &gt; <span class="keyword">sizeof</span>(<a class="code" href="push_8c.html#a526fbfb56d0a579146a01c2c0db9584e">push_reply_cmd</a>)-1)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> = <a class="code" href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a>(c, <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;buf), <a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="keywordflow">goto</span> fail;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        push_sent = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">/* If nothing have been pushed, send an empty push,</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">     * as the client is expecting a response</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">if</span> (!push_sent)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <a class="code" href="buffer_8h.html#ab8c6f1a02df80ea23d7df737eda163d5">buf_reset_len</a>(&amp;buf);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;buf, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="push_8c.html#a526fbfb56d0a579146a01c2c0db9584e">push_reply_cmd</a>);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> = <a class="code" href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a>(c, <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;buf), <a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordflow">goto</span> fail;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;fail:</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;}</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="push_8c.html#a9717f9c37176ef0790dce9767afa9c04">  610</a></span>&#160;<a class="code" href="push_8c.html#a9717f9c37176ef0790dce9767afa9c04">push_option_ex</a>(<span class="keyword">struct</span> <a class="code" href="structgc__arena.html">gc_arena</a> *gc, <span class="keyword">struct</span> <a class="code" href="structpush__list.html">push_list</a> *<a class="code" href="structpush__list.html">push_list</a>,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">char</span> *opt, <span class="keywordtype">bool</span> enable, <span class="keywordtype">int</span> msglevel)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;{</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="buffer_8c.html#a5812c761d1e2721c86e7188336019712">string_class</a>(opt, <a class="code" href="buffer_8h.html#a3b991db1fc57fb2bb726631949070759">CC_ANY</a>, <a class="code" href="buffer_8h.html#a098a04bcd360e15e50ecf50cc19812da">CC_COMMA</a>))</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(msglevel, <span class="stringliteral">&quot;PUSH OPTION FAILED (illegal comma (&#39;,&#39;) in string): &#39;%s&#39;&quot;</span>, opt);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keyword">struct </span><a class="code" href="structpush__entry.html">push_entry</a> *e;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <a class="code" href="buffer_8h.html#ab4491b7f3124ff7b050e37c38c2e620b">ALLOC_OBJ_CLEAR_GC</a>(e, <span class="keyword">struct</span> <a class="code" href="structpush__entry.html">push_entry</a>, gc);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        e-&gt;<a class="code" href="structpush__entry.html#ae890e41d491f778ed1ee7396fec98b6e">enable</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        e-&gt;<a class="code" href="structpush__entry.html#af7709664ab4d399ea2454640db321411">option</a> = opt;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structpush__list.html">push_list</a>-&gt;<a class="code" href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">head</a>)</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(<a class="code" href="structpush__list.html">push_list</a>-&gt;<a class="code" href="structpush__list.html#af220ca38d22bafe403729f37462c2662">tail</a>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <a class="code" href="structpush__list.html">push_list</a>-&gt;<a class="code" href="structpush__list.html#af220ca38d22bafe403729f37462c2662">tail</a>-&gt;<a class="code" href="structpush__entry.html#a2a6b3c293572711f5f661628b23b3716">next</a> = e;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <a class="code" href="structpush__list.html">push_list</a>-&gt;<a class="code" href="structpush__list.html#af220ca38d22bafe403729f37462c2662">tail</a> = e;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(!<a class="code" href="structpush__list.html">push_list</a>-&gt;<a class="code" href="structpush__list.html#af220ca38d22bafe403729f37462c2662">tail</a>);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <a class="code" href="structpush__list.html">push_list</a>-&gt;<a class="code" href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">head</a> = e;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <a class="code" href="structpush__list.html">push_list</a>-&gt;<a class="code" href="structpush__list.html#af220ca38d22bafe403729f37462c2662">tail</a> = e;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;}</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00639"></a><span class="lineno"><a class="line" href="push_8h.html#a1b8f5d8a9cc1fb6d16fdb762bd0fa166">  639</a></span>&#160;<a class="code" href="push_8c.html#a1b8f5d8a9cc1fb6d16fdb762bd0fa166">push_option</a>(<span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *o, <span class="keyword">const</span> <span class="keywordtype">char</span> *opt, <span class="keywordtype">int</span> msglevel)</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;{</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="push_8c.html#a9717f9c37176ef0790dce9767afa9c04">push_option_ex</a>(&amp;o-&gt;<a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>, &amp;o-&gt;<a class="code" href="structoptions.html#a6fbf9febd6c9d47be739af08bb728b30">push_list</a>, opt, <span class="keyword">true</span>, msglevel);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;}</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00645"></a><span class="lineno"><a class="line" href="push_8h.html#a5cc8cf61e20ec3c4af9763897bbc345e">  645</a></span>&#160;<a class="code" href="push_8c.html#a5cc8cf61e20ec3c4af9763897bbc345e">clone_push_list</a>(<span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *o)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;{</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a6fbf9febd6c9d47be739af08bb728b30">push_list</a>.<a class="code" href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">head</a>)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structpush__entry.html">push_entry</a> *e = o-&gt;<a class="code" href="structoptions.html#a6fbf9febd6c9d47be739af08bb728b30">push_list</a>.<a class="code" href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">head</a>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <a class="code" href="push_8c.html#a39c47f14c23a4c035f07d1332bd11969">push_reset</a>(o);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordflow">while</span> (e)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            <a class="code" href="push_8c.html#a9717f9c37176ef0790dce9767afa9c04">push_option_ex</a>(&amp;o-&gt;<a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>, &amp;o-&gt;<a class="code" href="structoptions.html#a6fbf9febd6c9d47be739af08bb728b30">push_list</a>,</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                           <a class="code" href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca">string_alloc</a>(e-&gt;<a class="code" href="structpush__entry.html#af7709664ab4d399ea2454640db321411">option</a>, &amp;o-&gt;<a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>), <span class="keyword">true</span>, <a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            e = e-&gt;<a class="code" href="structpush__entry.html#a2a6b3c293572711f5f661628b23b3716">next</a>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;}</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="push_8h.html#aca7466ecfd21e88f32f0b2bc92e940c6">  661</a></span>&#160;<a class="code" href="push_8c.html#aca7466ecfd21e88f32f0b2bc92e940c6">push_options</a>(<span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *o, <span class="keywordtype">char</span> **p, <span class="keywordtype">int</span> msglevel, <span class="keyword">struct</span> <a class="code" href="structgc__arena.html">gc_arena</a> *gc)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;{</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> **<a class="code" href="structargv.html">argv</a> = <a class="code" href="misc_8c.html#a6e01966def524e1f1e965d41a956279e">make_extended_arg_array</a>(p, <span class="keyword">false</span>, gc);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordtype">char</span> *opt = <a class="code" href="buffer_8c.html#a9fa59da93f5503603025786ec8f33726">print_argv</a>(<a class="code" href="structargv.html">argv</a>, gc, 0);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="push_8c.html#a1b8f5d8a9cc1fb6d16fdb762bd0fa166">push_option</a>(o, opt, msglevel);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00669"></a><span class="lineno"><a class="line" href="push_8c.html#a069d396329687a74283023cefc397c93">  669</a></span>&#160;<a class="code" href="push_8c.html#a069d396329687a74283023cefc397c93">push_option_fmt</a>(<span class="keyword">struct</span> <a class="code" href="structgc__arena.html">gc_arena</a> *gc, <span class="keyword">struct</span> <a class="code" href="structpush__list.html">push_list</a> *<a class="code" href="structpush__list.html">push_list</a>,</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <span class="keywordtype">int</span> msglevel, <span class="keyword">const</span> <span class="keywordtype">char</span> *format, ...)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;{</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    va_list arglist;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordtype">char</span> tmp[256] = {0};</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordtype">int</span> len;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    va_start(arglist, format);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    len = vsnprintf(tmp, <span class="keyword">sizeof</span>(tmp), format, arglist);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    va_end(arglist);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">if</span> (len &gt; <span class="keyword">sizeof</span>(tmp)-1)</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="push_8c.html#a9717f9c37176ef0790dce9767afa9c04">push_option_ex</a>(gc, <a class="code" href="structpush__list.html">push_list</a>, <a class="code" href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca">string_alloc</a>(tmp, gc), <span class="keyword">true</span>, msglevel);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00687"></a><span class="lineno"><a class="line" href="push_8h.html#a39c47f14c23a4c035f07d1332bd11969">  687</a></span>&#160;<a class="code" href="push_8c.html#a39c47f14c23a4c035f07d1332bd11969">push_reset</a>(<span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *o)</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;{</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(o-&gt;<a class="code" href="structoptions.html#a6fbf9febd6c9d47be739af08bb728b30">push_list</a>);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;}</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="push_8h.html#aab1d17b50bf9ae2b4c7d530174439c79">  693</a></span>&#160;<a class="code" href="push_8c.html#aab1d17b50bf9ae2b4c7d530174439c79">push_remove_option</a>(<span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *o, <span class="keyword">const</span> <span class="keywordtype">char</span> *p)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;{</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a5e25095305ce2ad10907ed529d71e780">D_PUSH_DEBUG</a>, <span class="stringliteral">&quot;PUSH_REMOVE searching for: &#39;%s&#39;&quot;</span>, p);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">/* ifconfig is special, as not part of the push list */</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="options_8h.html#a4841717e2f45399a58c25188a1247c7a">streq</a>(p, <span class="stringliteral">&quot;ifconfig&quot;</span>))</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        o-&gt;<a class="code" href="structoptions.html#aecf13b277bacf5c1cb2bdfb7e9733d4f">push_ifconfig_ipv4_blocked</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">/* ifconfig-ipv6 is special, as not part of the push list */</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="options_8h.html#a4841717e2f45399a58c25188a1247c7a">streq</a>( p, <span class="stringliteral">&quot;ifconfig-ipv6&quot;</span> ))</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        o-&gt;<a class="code" href="structoptions.html#a624da06f35ed664a7f7c3519dd0846cc">push_ifconfig_ipv6_blocked</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span> (o &amp;&amp; o-&gt;<a class="code" href="structoptions.html#a6fbf9febd6c9d47be739af08bb728b30">push_list</a>.<a class="code" href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">head</a>)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keyword">struct </span><a class="code" href="structpush__entry.html">push_entry</a> *e = o-&gt;<a class="code" href="structoptions.html#a6fbf9febd6c9d47be739af08bb728b30">push_list</a>.<a class="code" href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">head</a>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="comment">/* cycle through the push list */</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">while</span> (e)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structpush__entry.html#ae890e41d491f778ed1ee7396fec98b6e">enable</a></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                &amp;&amp; strncmp( e-&gt;<a class="code" href="structpush__entry.html#af7709664ab4d399ea2454640db321411">option</a>, p, strlen(p) ) == 0)</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a5e25095305ce2ad10907ed529d71e780">D_PUSH_DEBUG</a>, <span class="stringliteral">&quot;PUSH_REMOVE removing: &#39;%s&#39;&quot;</span>, e-&gt;<a class="code" href="structpush__entry.html#af7709664ab4d399ea2454640db321411">option</a>);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                e-&gt;<a class="code" href="structpush__entry.html#ae890e41d491f778ed1ee7396fec98b6e">enable</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            }</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            e = e-&gt;<a class="code" href="structpush__entry.html#a2a6b3c293572711f5f661628b23b3716">next</a>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;}</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00731"></a><span class="lineno"><a class="line" href="push_8h.html#a009af85288d9c300844fd8c9eb7acd8f">  731</a></span>&#160;<a class="code" href="push_8c.html#a009af85288d9c300844fd8c9eb7acd8f">process_incoming_push_request</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;{</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordtype">int</span> ret = <a class="code" href="push_8h.html#aa1310ae98441e0758a65fcc02d371601">PUSH_MSG_ERROR</a>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkey__state.html">key_state</a> *ks = &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a74e065e432f819307a830ef38d5be73c">session</a>[<a class="code" href="group__control__processor.html#gad3c70b02a0ca4537fba1d53802e1e429">TM_ACTIVE</a>].<a class="code" href="structtls__session.html#a1de4672c1233dd4887122a909b10c314">key</a>[<a class="code" href="group__control__processor.html#ga53a47713d8d3afdedf8826560da3e8b1">KS_PRIMARY</a>];</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ssl__verify_8c.html#ac6de478954452cfd54e8352f57638772">tls_authentication_status</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>, 0) == <a class="code" href="ssl__verify_8h.html#adb92f06c9f67108dcbee96c176639f7d">TLS_AUTHENTICATION_FAILED</a></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        || c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a1d3b9daaf89d4525dffd4a0245a469cd">multi_state</a> == <a class="code" href="ssl__common_8h.html#aaef501a7608e75db29eaff7c694de678aabef0f819c262c68ce7dfd1eda4f1538">CAS_FAILED</a>)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *client_reason = <a class="code" href="ssl__verify_8h.html#a3108becbbaf11fc99381c5e720691fee">tls_client_reason</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <a class="code" href="push_8c.html#a4a16d4e40446d6f6c3f2c8b0b319f652">send_auth_failed</a>(c, client_reason);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        ret = <a class="code" href="push_8h.html#ae794321ea408c30cd2e62cbde62f4e37">PUSH_MSG_AUTH_FAILURE</a>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a1d3b9daaf89d4525dffd4a0245a469cd">multi_state</a> == <a class="code" href="ssl__common_8h.html#aaef501a7608e75db29eaff7c694de678a7a54af4f8022fd0ab824c8a6bb15371c">CAS_SUCCEEDED</a></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;             &amp;&amp; ks-&gt;<a class="code" href="structkey__state.html#ab84de4d6239e39c6f3721ce2ec9b4868">authenticated</a> == <a class="code" href="ssl__common_8h.html#a7efefa3a14114fca5c9b3c4606d19c67a11cbbaa4ec98bc132542d3744ef69ead">KS_AUTH_TRUE</a>)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        time_t <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <a class="code" href="otime_8h.html#a936f2be57845060fd991cad8f7c14359">openvpn_time</a>(&amp;<a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a76b40e7c96ea199128151f98616aaaf8">sent_push_reply_expiry</a> &gt; <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            ret = <a class="code" href="push_8h.html#afd8981e6ab23f3420713df99d26638b7">PUSH_MSG_ALREADY_REPLIED</a>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="comment">/* per-client push options - peer-id, cipher, ifconfig, ipv6-ifconfig */</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="keyword">struct </span><a class="code" href="structpush__list.html">push_list</a> <a class="code" href="structpush__list.html">push_list</a> = { 0 };</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="push_8c.html#ad5c8ae2114245fa689a4d075177a81c7">prepare_push_reply</a>(c, &amp;gc, &amp;<a class="code" href="structpush__list.html">push_list</a>)</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                &amp;&amp; <a class="code" href="push_8c.html#ae7ebce816788a80c521efae5c3c65cc8">send_push_reply</a>(c, &amp;<a class="code" href="structpush__list.html">push_list</a>))</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                ret = <a class="code" href="push_8h.html#a4cc7f6235968b022867f491ca6206068">PUSH_MSG_REQUEST</a>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a76b40e7c96ea199128151f98616aaaf8">sent_push_reply_expiry</a> = <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a> + 30;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        ret = <a class="code" href="push_8h.html#a7b7adc015455fcc000d7948366c0b939">PUSH_MSG_REQUEST_DEFERRED</a>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;}</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00777"></a><span class="lineno"><a class="line" href="push_8c.html#ada4d6cedea0774388c33b6838aa80004">  777</a></span>&#160;<a class="code" href="push_8c.html#ada4d6cedea0774388c33b6838aa80004">push_update_digest</a>(<a class="code" href="crypto__mbedtls_8h.html#a6da44e00be96174088b0ee604751629a">md_ctx_t</a> *ctx, <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *buf, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *opt)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;{</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordtype">char</span> line[<a class="code" href="options_8h.html#a825f21709295c8352598df7341d98fb8">OPTION_PARM_SIZE</a>];</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="buffer_8c.html#ac55fefaff3ce0991e97c76e78725d1c9">buf_parse</a>(buf, <span class="charliteral">&#39;,&#39;</span>, line, <span class="keyword">sizeof</span>(line)))</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <span class="comment">/* peer-id and auth-token might change on restart and this should not trigger reopening tun */</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="buffer_8h.html#add5bab9239f486b22e62806cd7533acb">strprefix</a>(line, <span class="stringliteral">&quot;peer-id &quot;</span>)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            || <a class="code" href="buffer_8h.html#add5bab9239f486b22e62806cd7533acb">strprefix</a>(line, <span class="stringliteral">&quot;auth-token &quot;</span>)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            || <a class="code" href="buffer_8h.html#add5bab9239f486b22e62806cd7533acb">strprefix</a>(line, <span class="stringliteral">&quot;auth-token-user &quot;</span>))</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="comment">/* tun reopen only needed if cipher change can change tun MTU */</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="buffer_8h.html#add5bab9239f486b22e62806cd7533acb">strprefix</a>(line, <span class="stringliteral">&quot;cipher &quot;</span>) &amp;&amp; !opt-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a90482e8f2d1ab61167f705cec826abee">tun_mtu_defined</a>)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <a class="code" href="crypto__backend_8h.html#a36efaa6a9f49bcbf88d439c5535d20d4">md_ctx_update</a>(ctx, (<span class="keyword">const</span> <a class="code" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> *) line, strlen(line)+1);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;}</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00799"></a><span class="lineno"><a class="line" href="push_8c.html#a9274a931710135403eb7c8f11f29d7e6">  799</a></span>&#160;<a class="code" href="push_8c.html#a9274a931710135403eb7c8f11f29d7e6">process_incoming_push_reply</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c,</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> permission_mask,</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *option_types_found,</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                            <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *buf)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;{</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordtype">int</span> ret = <a class="code" href="push_8h.html#aa1310ae98441e0758a65fcc02d371601">PUSH_MSG_ERROR</a>;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keyword">const</span> <a class="code" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> ch = <a class="code" href="buffer_8h.html#ab7b6746dd30a4cfaf4a9218f42c6dabe">buf_read_u8</a>(buf);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;,&#39;</span>)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf_orig = (*buf);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a5485b6bf84eeeeb2c0e93de268709b67">pulled_options_digest_init_done</a>)</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">pulled_options_state</a> = <a class="code" href="crypto__backend_8h.html#ae9289665161bfe6af9b43dd4cfcfc578">md_ctx_new</a>();</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            <a class="code" href="crypto__backend_8h.html#a9c6d6b5b29ecea803113caabe525baf1">md_ctx_init</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">pulled_options_state</a>, <a class="code" href="crypto__backend_8h.html#a9cbbade2b528fe5d1e6ae65bbaf1e765">md_kt_get</a>(<span class="stringliteral">&quot;SHA256&quot;</span>));</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a5485b6bf84eeeeb2c0e93de268709b67">pulled_options_digest_init_done</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#afd2684dc9b7c5834fafcaf4a4ff4e8d4">did_pre_pull_restore</a>)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <a class="code" href="options_8c.html#a0669ac79557c619c356a9bb5e9931c9c">pre_pull_restore</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ad4aeb5d46c4a32dc490a124af2c0770a">gc</a>);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#afd2684dc9b7c5834fafcaf4a4ff4e8d4">did_pre_pull_restore</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="options_8c.html#a666b73630dd3292a270ebb01e3b09fdb">apply_push_options</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>,</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                               buf,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                               permission_mask,</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                               option_types_found,</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                               c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>))</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <a class="code" href="push_8c.html#ada4d6cedea0774388c33b6838aa80004">push_update_digest</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">pulled_options_state</a>, &amp;buf_orig,</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                               &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="keywordflow">switch</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a77a14cd5c15171158188cb278773a049">push_continuation</a>)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                    <a class="code" href="crypto__backend_8h.html#ae8c3deb337af077a04d4d7ed233f54d2">md_ctx_final</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">pulled_options_state</a>,</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                                 c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#adbe7d67b15dc3e5fe37856a3eafcaaa6">pulled_options_digest</a>.<a class="code" href="structsha256__digest.html#ab33fddc33bcbd885fc183ce3803a0ba3">digest</a>);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                    <a class="code" href="crypto__backend_8h.html#ad92889d868bb18d919c8965fc4b05436">md_ctx_cleanup</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">pulled_options_state</a>);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                    <a class="code" href="crypto__backend_8h.html#afdb937666eb44c6bbb45860ed209773d">md_ctx_free</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">pulled_options_state</a>);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">pulled_options_state</a> = NULL;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a5485b6bf84eeeeb2c0e93de268709b67">pulled_options_digest_init_done</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                    ret = <a class="code" href="push_8h.html#ac3324c7b44e0338dd4817c4965ad7b93">PUSH_MSG_REPLY</a>;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                    ret = <a class="code" href="push_8h.html#af425e5cb988d69e642be32fc01e9765c">PUSH_MSG_CONTINUATION</a>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    }</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        ret = <a class="code" href="push_8h.html#ac3324c7b44e0338dd4817c4965ad7b93">PUSH_MSG_REPLY</a>;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="comment">/* show_settings (&amp;c-&gt;options); */</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;}</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00856"></a><span class="lineno"><a class="line" href="push_8h.html#ae4505044645e0855d4dd7296697a411c">  856</a></span>&#160;<a class="code" href="push_8c.html#ae4505044645e0855d4dd7296697a411c">process_incoming_push_msg</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c,</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                          <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbuffer.html">buffer</a> *<a class="code" href="structbuffer.html">buffer</a>,</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                          <span class="keywordtype">bool</span> honor_received_options,</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> permission_mask,</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *option_types_found)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;{</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf = *<a class="code" href="structbuffer.html">buffer</a>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="buffer_8c.html#a042e9b112fb90777619ec9cd1678d5b5">buf_string_compare_advance</a>(&amp;buf, <span class="stringliteral">&quot;PUSH_REQUEST&quot;</span>))</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a01c57a22104a41ebe7986c73b9a86e6f">push_request_received</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="push_8c.html#a009af85288d9c300844fd8c9eb7acd8f">process_incoming_push_request</a>(c);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (honor_received_options</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;             &amp;&amp; <a class="code" href="buffer_8c.html#a042e9b112fb90777619ec9cd1678d5b5">buf_string_compare_advance</a>(&amp;buf, <a class="code" href="push_8c.html#a526fbfb56d0a579146a01c2c0db9584e">push_reply_cmd</a>))</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="push_8c.html#a9274a931710135403eb7c8f11f29d7e6">process_incoming_push_reply</a>(c, permission_mask,</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                                           option_types_found, &amp;buf);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="push_8h.html#aa1310ae98441e0758a65fcc02d371601">PUSH_MSG_ERROR</a>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;}</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment"> * Remove iroutes from the push_list.</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00886"></a><span class="lineno"><a class="line" href="push_8h.html#add7f7089b803fc76165f16f3f023e4d4">  886</a></span>&#160;<a class="code" href="push_8c.html#add7f7089b803fc76165f16f3f023e4d4">remove_iroutes_from_push_route_list</a>(<span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *o)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;{</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordflow">if</span> (o &amp;&amp; o-&gt;<a class="code" href="structoptions.html#a6fbf9febd6c9d47be739af08bb728b30">push_list</a>.<a class="code" href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">head</a> &amp;&amp; o-&gt;<a class="code" href="structoptions.html#ab768582628e933abb7d60f6fa43b92be">iroutes</a>)</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keyword">struct </span><a class="code" href="structpush__entry.html">push_entry</a> *e = o-&gt;<a class="code" href="structoptions.html#a6fbf9febd6c9d47be739af08bb728b30">push_list</a>.<a class="code" href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">head</a>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="comment">/* cycle through the push list */</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">while</span> (e)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keywordtype">char</span> *p[<a class="code" href="options_8h.html#abc112140dccf35b37370da1791c3d8c3">MAX_PARMS</a>+1];</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="structpush__entry.html#ae890e41d491f778ed1ee7396fec98b6e">enable</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="comment">/* parse the push item */</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(p);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordflow">if</span> (e-&gt;<a class="code" href="structpush__entry.html#ae890e41d491f778ed1ee7396fec98b6e">enable</a></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                &amp;&amp; <a class="code" href="options_8c.html#aa702a60af6acc222f99aa441e0b1c3c1">parse_line</a>(e-&gt;<a class="code" href="structpush__entry.html#af7709664ab4d399ea2454640db321411">option</a>, p, <a class="code" href="openvpn_2basic_8h.html#afd2537d19a3cb6556b0f727580ec6ee7">SIZE</a>(p)-1, <span class="stringliteral">&quot;[PUSH_ROUTE_REMOVE]&quot;</span>, 1, <a class="code" href="errlevel_8h.html#a4b1b340ab75c81b27e427d091d6f2e50">D_ROUTE_DEBUG</a>, &amp;gc))</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <span class="comment">/* is the push item a route directive? */</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <span class="keywordflow">if</span> (p[0] &amp;&amp; !strcmp(p[0], <span class="stringliteral">&quot;route&quot;</span>) &amp;&amp; !p[3])</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                    <span class="comment">/* get route parameters */</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                    <span class="keywordtype">bool</span> status1, status2;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                    <span class="keyword">const</span> <a class="code" href="config-msvc_8h.html#a64ca7e440847b0f5d19cbe94f9e114bd">in_addr_t</a> network = <a class="code" href="socket_8c.html#aed74c8b5931192c1ad5829bd90e01603">getaddr</a>(<a class="code" href="socket_8h.html#a5b618d8716696f3ebe96642be56bec03">GETADDR_HOST_ORDER</a>, p[1], 0, &amp;status1, NULL);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    <span class="keyword">const</span> <a class="code" href="config-msvc_8h.html#a64ca7e440847b0f5d19cbe94f9e114bd">in_addr_t</a> netmask = <a class="code" href="socket_8c.html#aed74c8b5931192c1ad5829bd90e01603">getaddr</a>(<a class="code" href="socket_8h.html#a5b618d8716696f3ebe96642be56bec03">GETADDR_HOST_ORDER</a>, p[2] ? p[2] : <span class="stringliteral">&quot;255.255.255.255&quot;</span>, 0, &amp;status2, NULL);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                    <span class="comment">/* did route parameters parse correctly? */</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                    <span class="keywordflow">if</span> (status1 &amp;&amp; status2)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                    {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structiroute.html">iroute</a> *ir;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        <span class="comment">/* does route match an iroute? */</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                        <span class="keywordflow">for</span> (ir = o-&gt;<a class="code" href="structoptions.html#ab768582628e933abb7d60f6fa43b92be">iroutes</a>; ir != NULL; ir = ir-&gt;<a class="code" href="structiroute.html#aac0f458d6167f41ae6a7b44e2282c442">next</a>)</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                        {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="structiroute.html#a2ed510022cbb3635cb6b4b07350da3c6">network</a> == ir-&gt;<a class="code" href="structiroute.html#a2ed510022cbb3635cb6b4b07350da3c6">network</a> &amp;&amp; netmask == <a class="code" href="route_8h.html#a5b4755dbf69b1e053f1ebb38c2f76eed">netbits_to_netmask</a>(ir-&gt;<a class="code" href="structiroute.html#a3328004549c90fe748d4959b153b78b7">netbits</a> &gt;= 0 ? ir-&gt;<a class="code" href="structiroute.html#a3328004549c90fe748d4959b153b78b7">netbits</a> : 32))</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                            {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                enable = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                            }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                        }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                    }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                <span class="comment">/* should we copy the push item? */</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                e-&gt;<a class="code" href="structpush__entry.html#ae890e41d491f778ed1ee7396fec98b6e">enable</a> = enable;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <span class="keywordflow">if</span> (!enable)</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;REMOVE PUSH ROUTE: &#39;%s&#39;&quot;</span>, e-&gt;<a class="code" href="structpush__entry.html#af7709664ab4d399ea2454640db321411">option</a>);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            e = e-&gt;<a class="code" href="structpush__entry.html#a2a6b3c293572711f5f661628b23b3716">next</a>;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;}</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* if P2MP */</span><span class="preprocessor"></span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="astructcontext__2_html_a5485b6bf84eeeeb2c0e93de268709b67"><div class="ttname"><a href="structcontext__2.html#a5485b6bf84eeeeb2c0e93de268709b67">context_2::pulled_options_digest_init_done</a></div><div class="ttdeci">bool pulled_options_digest_init_done</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00455">openvpn.h:455</a></div></div>
<div class="ttc" id="ainit_8c_html_aded279bc953617852338a38e3d1a256b"><div class="ttname"><a href="init_8c.html#aded279bc953617852338a38e3d1a256b">pull_permission_mask</a></div><div class="ttdeci">unsigned int pull_permission_mask(const struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02232">init.c:2232</a></div></div>
<div class="ttc" id="astructtls__multi_html_aa03c9a1c7487bd7bed7e4f73e266614d"><div class="ttname"><a href="structtls__multi.html#aa03c9a1c7487bd7bed7e4f73e266614d">tls_multi::auth_token</a></div><div class="ttdeci">char * auth_token</div><div class="ttdoc">If server sends a generated auth-token, this is the token to use for future user/pass authentications...</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00567">ssl_common.h:567</a></div></div>
<div class="ttc" id="astructsignal__info_html_a10c4ea0e5a7070d7d802d2e9c7eecb67"><div class="ttname"><a href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_info::signal_received</a></div><div class="ttdeci">volatile int signal_received</div><div class="ttdef"><b>Definition:</b> <a href="sig_8h_source.html#l00045">sig.h:45</a></div></div>
<div class="ttc" id="astructiroute_html"><div class="ttname"><a href="structiroute.html">iroute</a></div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00235">route.h:235</a></div></div>
<div class="ttc" id="apush_8h_html_a7b7adc015455fcc000d7948366c0b939"><div class="ttname"><a href="push_8h.html#a7b7adc015455fcc000d7948366c0b939">PUSH_MSG_REQUEST_DEFERRED</a></div><div class="ttdeci">#define PUSH_MSG_REQUEST_DEFERRED</div><div class="ttdef"><b>Definition:</b> <a href="push_8h_source.html#l00034">push.h:34</a></div></div>
<div class="ttc" id="astructenv__set_html_ac1f5edea620699ff13763b84a008e365"><div class="ttname"><a href="structenv__set.html#ac1f5edea620699ff13763b84a008e365">env_set::gc</a></div><div class="ttdeci">struct gc_arena * gc</div><div class="ttdef"><b>Definition:</b> <a href="env__set_8h_source.html#l00043">env_set.h:43</a></div></div>
<div class="ttc" id="astructpush__list_html_aaf52137850b55d9ea474283857c1c073"><div class="ttname"><a href="structpush__list.html#aaf52137850b55d9ea474283857c1c073">push_list::head</a></div><div class="ttdeci">struct push_entry * head</div><div class="ttdef"><b>Definition:</b> <a href="pushlist_8h_source.html#l00036">pushlist.h:36</a></div></div>
<div class="ttc" id="apush_8c_html_a9274a931710135403eb7c8f11f29d7e6"><div class="ttname"><a href="push_8c.html#a9274a931710135403eb7c8f11f29d7e6">process_incoming_push_reply</a></div><div class="ttdeci">static int process_incoming_push_reply(struct context *c, unsigned int permission_mask, unsigned int *option_types_found, struct buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00799">push.c:799</a></div></div>
<div class="ttc" id="apush_8c_html_afeaacd608704c9ef6ddfa1bea7a280e8"><div class="ttname"><a href="push_8c.html#afeaacd608704c9ef6ddfa1bea7a280e8">send_push_reply_auth_token</a></div><div class="ttdeci">void send_push_reply_auth_token(struct tls_multi *multi)</div><div class="ttdoc">Sends a push reply message only containin the auth-token to update the auth-token on the client.</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00526">push.c:526</a></div></div>
<div class="ttc" id="abuffer_8h_html_ae55eafba09aa53323a5ce9e85f00f710"><div class="ttname"><a href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a></div><div class="ttdeci">static struct gc_arena gc_new(void)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l01024">buffer.h:1024</a></div></div>
<div class="ttc" id="apush_8c_html_aab1d17b50bf9ae2b4c7d530174439c79"><div class="ttname"><a href="push_8c.html#aab1d17b50bf9ae2b4c7d530174439c79">push_remove_option</a></div><div class="ttdeci">void push_remove_option(struct options *o, const char *p)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00693">push.c:693</a></div></div>
<div class="ttc" id="astructcontext__2_html_a758cf7724377be181e7fab59b7a2a30e"><div class="ttname"><a href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">context_2::tls_multi</a></div><div class="ttdeci">struct tls_multi * tls_multi</div><div class="ttdoc">TLS state structure for this VPN tunnel.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00340">openvpn.h:340</a></div></div>
<div class="ttc" id="astructsignal__info_html_a0062d540b64b1957a2fdd7155ef9edf9"><div class="ttname"><a href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_info::signal_text</a></div><div class="ttdeci">const char * signal_text</div><div class="ttdef"><b>Definition:</b> <a href="sig_8h_source.html#l00047">sig.h:47</a></div></div>
<div class="ttc" id="astructbuffer_html_ada52eab703a091ff327114b3b3b0140a"><div class="ttname"><a href="structbuffer.html#ada52eab703a091ff327114b3b3b0140a">buffer::len</a></div><div class="ttdeci">int len</div><div class="ttdoc">Length in bytes of the actual content within the allocated memory.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00066">buffer.h:66</a></div></div>
<div class="ttc" id="astructoptions_html_a6fbf9febd6c9d47be739af08bb728b30"><div class="ttname"><a href="structoptions.html#a6fbf9febd6c9d47be739af08bb728b30">options::push_list</a></div><div class="ttdeci">struct push_list push_list</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00441">options.h:441</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a65ed7f4ae1be12a19362e90b962d72ac"><div class="ttname"><a href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a></div><div class="ttdeci">#define M_FATAL</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00091">error.h:91</a></div></div>
<div class="ttc" id="acrypto__mbedtls_8h_html_a6da44e00be96174088b0ee604751629a"><div class="ttname"><a href="crypto__mbedtls_8h.html#a6da44e00be96174088b0ee604751629a">md_ctx_t</a></div><div class="ttdeci">mbedtls_md_context_t md_ctx_t</div><div class="ttdoc">Generic message digest context.</div><div class="ttdef"><b>Definition:</b> <a href="crypto__mbedtls_8h_source.html#l00046">crypto_mbedtls.h:46</a></div></div>
<div class="ttc" id="astructpush__entry_html"><div class="ttname"><a href="structpush__entry.html">push_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="pushlist_8h_source.html#l00029">pushlist.h:29</a></div></div>
<div class="ttc" id="astructargv_html"><div class="ttname"><a href="structargv.html">argv</a></div><div class="ttdef"><b>Definition:</b> <a href="argv_8h_source.html#l00035">argv.h:35</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a64ca7e440847b0f5d19cbe94f9e114bd"><div class="ttname"><a href="config-msvc_8h.html#a64ca7e440847b0f5d19cbe94f9e114bd">in_addr_t</a></div><div class="ttdeci">#define in_addr_t</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00144">config-msvc.h:144</a></div></div>
<div class="ttc" id="apush_8h_html_a4cc7f6235968b022867f491ca6206068"><div class="ttname"><a href="push_8h.html#a4cc7f6235968b022867f491ca6206068">PUSH_MSG_REQUEST</a></div><div class="ttdeci">#define PUSH_MSG_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="push_8h_source.html#l00032">push.h:32</a></div></div>
<div class="ttc" id="aoptions_8h_html_a4841717e2f45399a58c25188a1247c7a"><div class="ttname"><a href="options_8h.html#a4841717e2f45399a58c25188a1247c7a">streq</a></div><div class="ttdeci">#define streq(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00669">options.h:669</a></div></div>
<div class="ttc" id="amanage_8c_html_a02c5232bf0d3d6b276058c9756de52c2"><div class="ttname"><a href="manage_8c.html#a02c5232bf0d3d6b276058c9756de52c2">management_auth_failure</a></div><div class="ttdeci">void management_auth_failure(struct management *man, const char *type, const char *reason)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l03096">manage.c:3096</a></div></div>
<div class="ttc" id="amanage_8h_html"><div class="ttname"><a href="manage_8h.html">manage.h</a></div></div>
<div class="ttc" id="agroup__control__processor_html_ga53a47713d8d3afdedf8826560da3e8b1"><div class="ttname"><a href="group__control__processor.html#ga53a47713d8d3afdedf8826560da3e8b1">KS_PRIMARY</a></div><div class="ttdeci">#define KS_PRIMARY</div><div class="ttdoc">Primary key state index.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00381">ssl_common.h:381</a></div></div>
<div class="ttc" id="astructcontext_html"><div class="ttname"><a href="structcontext.html">context</a></div><div class="ttdoc">Contains all state information for one tunnel.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00489">openvpn.h:489</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_a9c6d6b5b29ecea803113caabe525baf1"><div class="ttname"><a href="crypto__backend_8h.html#a9c6d6b5b29ecea803113caabe525baf1">md_ctx_init</a></div><div class="ttdeci">void md_ctx_init(md_ctx_t *ctx, const md_kt_t *kt)</div></div>
<div class="ttc" id="astructtls__multi_html_a74e065e432f819307a830ef38d5be73c"><div class="ttname"><a href="structtls__multi.html#a74e065e432f819307a830ef38d5be73c">tls_multi::session</a></div><div class="ttdeci">struct tls_session session[TM_SIZE]</div><div class="ttdoc">Array of tls_session objects representing control channel sessions with the remote peer.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00597">ssl_common.h:597</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a90482e8f2d1ab61167f705cec826abee"><div class="ttname"><a href="structconnection__entry.html#a90482e8f2d1ab61167f705cec826abee">connection_entry::tun_mtu_defined</a></div><div class="ttdeci">bool tun_mtu_defined</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00115">options.h:115</a></div></div>
<div class="ttc" id="abuffer_8h_html_a34c800967d7b9583cb64236eadab94dd"><div class="ttname"><a href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a></div><div class="ttdeci">#define BSTR(buf)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00129">buffer.h:129</a></div></div>
<div class="ttc" id="astructcontext__2_html_a9e665bde380a5c86d14625d990d831e5"><div class="ttname"><a href="structcontext__2.html#a9e665bde380a5c86d14625d990d831e5">context_2::push_ifconfig_ipv6_local</a></div><div class="ttdeci">struct in6_addr push_ifconfig_ipv6_local</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00446">openvpn.h:446</a></div></div>
<div class="ttc" id="asocket_8c_html_aed74c8b5931192c1ad5829bd90e01603"><div class="ttname"><a href="socket_8c.html#aed74c8b5931192c1ad5829bd90e01603">getaddr</a></div><div class="ttdeci">in_addr_t getaddr(unsigned int flags, const char *hostname, int resolve_retry_seconds, bool *succeeded, volatile int *signal_received)</div><div class="ttdoc">Translate an IPv4 addr or hostname from string form to in_addr_t.</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l00193">socket.c:193</a></div></div>
<div class="ttc" id="aoptions_8h_html_aa4019b2e0b0d1bc21cdb433db9d5507d"><div class="ttname"><a href="options_8h.html#aa4019b2e0b0d1bc21cdb433db9d5507d">AR_NONE</a></div><div class="ttdeci">#define AR_NONE</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00851">options.h:851</a></div></div>
<div class="ttc" id="astructoptions_html_ab768582628e933abb7d60f6fa43b92be"><div class="ttname"><a href="structoptions.html#ab768582628e933abb7d60f6fa43b92be">options::iroutes</a></div><div class="ttdeci">struct iroute * iroutes</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00463">options.h:463</a></div></div>
<div class="ttc" id="apush_8c_html_a069d396329687a74283023cefc397c93"><div class="ttname"><a href="push_8c.html#a069d396329687a74283023cefc397c93">push_option_fmt</a></div><div class="ttdeci">static bool push_option_fmt(struct gc_arena *gc, struct push_list *push_list, int msglevel, const char *fmt,...)</div><div class="ttdoc">Add an option to the given push list by providing a format string.</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00669">push.c:669</a></div></div>
<div class="ttc" id="apush_8c_html_aca7466ecfd21e88f32f0b2bc92e940c6"><div class="ttname"><a href="push_8c.html#aca7466ecfd21e88f32f0b2bc92e940c6">push_options</a></div><div class="ttdeci">void push_options(struct options *o, char **p, int msglevel, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00661">push.c:661</a></div></div>
<div class="ttc" id="amisc_8c_html_a6e01966def524e1f1e965d41a956279e"><div class="ttname"><a href="misc_8c.html#a6e01966def524e1f1e965d41a956279e">make_extended_arg_array</a></div><div class="ttdeci">const char ** make_extended_arg_array(char **p, bool is_inline, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="misc_8c_source.html#l00641">misc.c:641</a></div></div>
<div class="ttc" id="abuffer_8c_html_aa35bf7feb6a99bf5d364b2d4eba1195c"><div class="ttname"><a href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c">alloc_buf_gc</a></div><div class="ttdeci">struct buffer alloc_buf_gc(size_t size, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00090">buffer.c:90</a></div></div>
<div class="ttc" id="astructcontext__2_html_a59b42a3c7d754a42ba10acf3c035a1c2"><div class="ttname"><a href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">context_2::es</a></div><div class="ttdeci">struct env_set * es</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00429">openvpn.h:429</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html"><div class="ttname"><a href="config-msvc_8h.html">config-msvc.h</a></div></div>
<div class="ttc" id="astructcontext__2_html_a2b16aba3b459e82db77ceddaf77f8426"><div class="ttname"><a href="structcontext__2.html#a2b16aba3b459e82db77ceddaf77f8426">context_2::push_ifconfig_defined</a></div><div class="ttdeci">bool push_ifconfig_defined</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00439">openvpn.h:439</a></div></div>
<div class="ttc" id="apush_8c_html_add7f7089b803fc76165f16f3f023e4d4"><div class="ttname"><a href="push_8c.html#add7f7089b803fc76165f16f3f023e4d4">remove_iroutes_from_push_route_list</a></div><div class="ttdeci">void remove_iroutes_from_push_route_list(struct options *o)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00886">push.c:886</a></div></div>
<div class="ttc" id="astructsession_html_ae5684b6cb3c3f9767343789e45a21b17"><div class="ttname"><a href="structsession.html#ae5684b6cb3c3f9767343789e45a21b17">session::key</a></div><div class="ttdeci">char key[48]</div><div class="ttdef"><b>Definition:</b> <a href="keyingmaterialexporter_8c_source.html#l00058">keyingmaterialexporter.c:58</a></div></div>
<div class="ttc" id="astructcontext__2_html_afd1f50ebf21448a621dcf0c1b21e1d63"><div class="ttname"><a href="structcontext__2.html#afd1f50ebf21448a621dcf0c1b21e1d63">context_2::push_ifconfig_local</a></div><div class="ttdeci">in_addr_t push_ifconfig_local</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00441">openvpn.h:441</a></div></div>
<div class="ttc" id="aoptions_8c_html_aa702a60af6acc222f99aa441e0b1c3c1"><div class="ttname"><a href="options_8c.html#aa702a60af6acc222f99aa441e0b1c3c1">parse_line</a></div><div class="ttdeci">int parse_line(const char *line, char *p[], const int n, const char *file, const int line_num, int msglevel, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="options_8c_source.html#l04497">options.c:4497</a></div></div>
<div class="ttc" id="aoptions_8h_html_abc112140dccf35b37370da1791c3d8c3"><div class="ttname"><a href="options_8h.html#abc112140dccf35b37370da1791c3d8c3">MAX_PARMS</a></div><div class="ttdeci">#define MAX_PARMS</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00051">options.h:51</a></div></div>
<div class="ttc" id="astructtls__multi_html_a1d3b9daaf89d4525dffd4a0245a469cd"><div class="ttname"><a href="structtls__multi.html#a1d3b9daaf89d4525dffd4a0245a469cd">tls_multi::multi_state</a></div><div class="ttdeci">enum client_connect_status multi_state</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00537">ssl_common.h:537</a></div></div>
<div class="ttc" id="astructoptions_html_a6f0d2996992b45f52c8f8403e22c51ce"><div class="ttname"><a href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">options::ce</a></div><div class="ttdeci">struct connection_entry ce</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00245">options.h:245</a></div></div>
<div class="ttc" id="astructcontext__2_html_afd2684dc9b7c5834fafcaf4a4ff4e8d4"><div class="ttname"><a href="structcontext__2.html#afd2684dc9b7c5834fafcaf4a4ff4e8d4">context_2::did_pre_pull_restore</a></div><div class="ttdeci">bool did_pre_pull_restore</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00452">openvpn.h:452</a></div></div>
<div class="ttc" id="astructiroute_html_a3328004549c90fe748d4959b153b78b7"><div class="ttname"><a href="structiroute.html#a3328004549c90fe748d4959b153b78b7">iroute::netbits</a></div><div class="ttdeci">int netbits</div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00237">route.h:237</a></div></div>
<div class="ttc" id="assl__verify_8h_html_a3108becbbaf11fc99381c5e720691fee"><div class="ttname"><a href="ssl__verify_8h.html#a3108becbbaf11fc99381c5e720691fee">tls_client_reason</a></div><div class="ttdeci">static const char * tls_client_reason(struct tls_multi *multi)</div><div class="ttdef"><b>Definition:</b> <a href="ssl__verify_8h_source.html#l00239">ssl_verify.h:239</a></div></div>
<div class="ttc" id="astructcontext__2_html_a38783ebd2fe0f390023a14ff23966f6e"><div class="ttname"><a href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">context_2::pulled_options_state</a></div><div class="ttdeci">md_ctx_t * pulled_options_state</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00456">openvpn.h:456</a></div></div>
<div class="ttc" id="apush_8h_html_aa1310ae98441e0758a65fcc02d371601"><div class="ttname"><a href="push_8h.html#aa1310ae98441e0758a65fcc02d371601">PUSH_MSG_ERROR</a></div><div class="ttdeci">#define PUSH_MSG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="push_8h_source.html#l00031">push.h:31</a></div></div>
<div class="ttc" id="aoptions_8h_html"><div class="ttname"><a href="options_8h.html">options.h</a></div></div>
<div class="ttc" id="ainit_8c_html_a9b053b7a612943b6be1d1be2c25181bf"><div class="ttname"><a href="init_8c.html#a9b053b7a612943b6be1d1be2c25181bf">do_up</a></div><div class="ttdeci">bool do_up(struct context *c, bool pulled_options, unsigned int option_types_found)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02155">init.c:2155</a></div></div>
<div class="ttc" id="astructoptions_html_a77a14cd5c15171158188cb278773a049"><div class="ttname"><a href="structoptions.html#a77a14cd5c15171158188cb278773a049">options::push_continuation</a></div><div class="ttdeci">int push_continuation</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00504">options.h:504</a></div></div>
<div class="ttc" id="astructtls__multi_html"><div class="ttname"><a href="structtls__multi.html">tls_multi</a></div><div class="ttdoc">Security parameter state for a single VPN tunnel.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00510">ssl_common.h:510</a></div></div>
<div class="ttc" id="astructpush__entry_html_af7709664ab4d399ea2454640db321411"><div class="ttname"><a href="structpush__entry.html#af7709664ab4d399ea2454640db321411">push_entry::option</a></div><div class="ttdeci">const char * option</div><div class="ttdef"><b>Definition:</b> <a href="pushlist_8h_source.html#l00032">pushlist.h:32</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_ae9289665161bfe6af9b43dd4cfcfc578"><div class="ttname"><a href="crypto__backend_8h.html#ae9289665161bfe6af9b43dd4cfcfc578">md_ctx_new</a></div><div class="ttdeci">md_ctx_t * md_ctx_new(void)</div><div class="ttdef"><b>Definition:</b> <a href="crypto__openssl_8c_source.html#l01052">crypto_openssl.c:1052</a></div></div>
<div class="ttc" id="astructkey__state_html_ab84de4d6239e39c6f3721ce2ec9b4868"><div class="ttname"><a href="structkey__state.html#ab84de4d6239e39c6f3721ce2ec9b4868">key_state::authenticated</a></div><div class="ttdeci">enum ks_auth_state authenticated</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00208">ssl_common.h:208</a></div></div>
<div class="ttc" id="apush_8c_html_a39c47f14c23a4c035f07d1332bd11969"><div class="ttname"><a href="push_8c.html#a39c47f14c23a4c035f07d1332bd11969">push_reset</a></div><div class="ttdeci">void push_reset(struct options *o)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00687">push.c:687</a></div></div>
<div class="ttc" id="astructkey__state_html"><div class="ttname"><a href="structkey__state.html">key_state</a></div><div class="ttdoc">Security parameter state of one TLS and data channel key session.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00166">ssl_common.h:166</a></div></div>
<div class="ttc" id="astructcontext__2_html_a01c57a22104a41ebe7986c73b9a86e6f"><div class="ttname"><a href="structcontext__2.html#a01c57a22104a41ebe7986c73b9a86e6f">context_2::push_request_received</a></div><div class="ttdeci">bool push_request_received</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00438">openvpn.h:438</a></div></div>
<div class="ttc" id="abuffer_8h_html_ab8c6f1a02df80ea23d7df737eda163d5"><div class="ttname"><a href="buffer_8h.html#ab8c6f1a02df80ea23d7df737eda163d5">buf_reset_len</a></div><div class="ttdeci">static void buf_reset_len(struct buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00299">buffer.h:299</a></div></div>
<div class="ttc" id="amanage_8c_html_aa6413bcc39609b0f51090d792aea0454"><div class="ttname"><a href="manage_8c.html#aa6413bcc39609b0f51090d792aea0454">management_notify_generic</a></div><div class="ttdeci">void management_notify_generic(struct management *man, const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l02908">manage.c:2908</a></div></div>
<div class="ttc" id="astructiroute_html_aac0f458d6167f41ae6a7b44e2282c442"><div class="ttname"><a href="structiroute.html#aac0f458d6167f41ae6a7b44e2282c442">iroute::next</a></div><div class="ttdeci">struct iroute * next</div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00238">route.h:238</a></div></div>
<div class="ttc" id="aautomatic_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="automatic_8c_source.html#l00043">automatic.c:43</a></div></div>
<div class="ttc" id="astructcontext__2_html_a6e148857a12de912aef0d3476a85baea"><div class="ttname"><a href="structcontext__2.html#a6e148857a12de912aef0d3476a85baea">context_2::wait_for_connect</a></div><div class="ttdeci">struct event_timeout wait_for_connect</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00304">openvpn.h:304</a></div></div>
<div class="ttc" id="aopenvpn_2basic_8h_html_ab0ba4dd6e237b96132c0a66be2fb3bc2"><div class="ttname"><a href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a></div><div class="ttdeci">#define CLEAR(x)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2basic_8h_source.html#l00033">basic.h:33</a></div></div>
<div class="ttc" id="astructiroute_html_a2ed510022cbb3635cb6b4b07350da3c6"><div class="ttname"><a href="structiroute.html#a2ed510022cbb3635cb6b4b07350da3c6">iroute::network</a></div><div class="ttdeci">in_addr_t network</div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00236">route.h:236</a></div></div>
<div class="ttc" id="assl__common_8h_html_aaef501a7608e75db29eaff7c694de678a7a54af4f8022fd0ab824c8a6bb15371c"><div class="ttname"><a href="ssl__common_8h.html#aaef501a7608e75db29eaff7c694de678a7a54af4f8022fd0ab824c8a6bb15371c">CAS_SUCCEEDED</a></div><div class="ttdeci">@ CAS_SUCCEEDED</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00489">ssl_common.h:489</a></div></div>
<div class="ttc" id="astructcontext_html_a8d609499dcba303c18f50ef7b648644c"><div class="ttname"><a href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">context::c2</a></div><div class="ttdeci">struct context_2 c2</div><div class="ttdoc">Level 2 context.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00530">openvpn.h:530</a></div></div>
<div class="ttc" id="astructcontext__2_html_a7bdeab25ad036b57d8a520e0f2c7ca4b"><div class="ttname"><a href="structcontext__2.html#a7bdeab25ad036b57d8a520e0f2c7ca4b">context_2::push_ifconfig_ipv6_remote</a></div><div class="ttdeci">struct in6_addr push_ifconfig_ipv6_remote</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00448">openvpn.h:448</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_ae8c3deb337af077a04d4d7ed233f54d2"><div class="ttname"><a href="crypto__backend_8h.html#ae8c3deb337af077a04d4d7ed233f54d2">md_ctx_final</a></div><div class="ttdeci">void md_ctx_final(md_ctx_t *ctx, uint8_t *dst)</div></div>
<div class="ttc" id="apush_8c_html_a1b8f5d8a9cc1fb6d16fdb762bd0fa166"><div class="ttname"><a href="push_8c.html#a1b8f5d8a9cc1fb6d16fdb762bd0fa166">push_option</a></div><div class="ttdeci">void push_option(struct options *o, const char *opt, int msglevel)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00639">push.c:639</a></div></div>
<div class="ttc" id="agroup__control__processor_html_gad3c70b02a0ca4537fba1d53802e1e429"><div class="ttname"><a href="group__control__processor.html#gad3c70b02a0ca4537fba1d53802e1e429">TM_ACTIVE</a></div><div class="ttdeci">#define TM_ACTIVE</div><div class="ttdoc">Active tls_session.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00462">ssl_common.h:462</a></div></div>
<div class="ttc" id="assl__verify_8h_html_adb92f06c9f67108dcbee96c176639f7d"><div class="ttname"><a href="ssl__verify_8h.html#adb92f06c9f67108dcbee96c176639f7d">TLS_AUTHENTICATION_FAILED</a></div><div class="ttdeci">#define TLS_AUTHENTICATION_FAILED</div><div class="ttdef"><b>Definition:</b> <a href="ssl__verify_8h_source.html#l00069">ssl_verify.h:69</a></div></div>
<div class="ttc" id="abuffer_8c_html_a06e0220403278399596a7a1b6b601fca"><div class="ttname"><a href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca">string_alloc</a></div><div class="ttdeci">char * string_alloc(const char *str, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00665">buffer.c:665</a></div></div>
<div class="ttc" id="astructcontext__2_html_ad4aeb5d46c4a32dc490a124af2c0770a"><div class="ttname"><a href="structcontext__2.html#ad4aeb5d46c4a32dc490a124af2c0770a">context_2::gc</a></div><div class="ttdeci">struct gc_arena gc</div><div class="ttdoc">Garbage collection arena for allocations done in the level 2 scope of this context_2 structure.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00232">openvpn.h:232</a></div></div>
<div class="ttc" id="apush_8c_html_a88e70a623d2eb74b70c23fdc4092c229"><div class="ttname"><a href="push_8c.html#a88e70a623d2eb74b70c23fdc4092c229">prepare_auth_token_push_reply</a></div><div class="ttdeci">void prepare_auth_token_push_reply(struct tls_multi *tls_multi, struct gc_arena *gc, struct push_list *push_list)</div><div class="ttdoc">Prepare push option for auth-token.</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00394">push.c:394</a></div></div>
<div class="ttc" id="assl__verify_8h_html"><div class="ttname"><a href="ssl__verify_8h.html">ssl_verify.h</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_aca68c0d4ac8df0838e209fb5300f7be3"><div class="ttname"><a href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a></div><div class="ttdeci">#define ASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00218">error.h:218</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a8449a1755d1636b2ed9925c109353f46"><div class="ttname"><a href="errlevel_8h.html#a8449a1755d1636b2ed9925c109353f46">D_STREAM_ERRORS</a></div><div class="ttdeci">#define D_STREAM_ERRORS</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00063">errlevel.h:63</a></div></div>
<div class="ttc" id="asocket_8c_html_a9a911c5dde4c809f7cb3eef8e5918a8e"><div class="ttname"><a href="socket_8c.html#a9a911c5dde4c809f7cb3eef8e5918a8e">print_in6_addr</a></div><div class="ttdeci">const char * print_in6_addr(struct in6_addr a6, unsigned int flags, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l03021">socket.c:3021</a></div></div>
<div class="ttc" id="apush_8c_html_a4a16d4e40446d6f6c3f2c8b0b319f652"><div class="ttname"><a href="push_8c.html#a4a16d4e40446d6f6c3f2c8b0b319f652">send_auth_failed</a></div><div class="ttdeci">void send_auth_failed(struct context *c, const char *client_reason)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00262">push.c:262</a></div></div>
<div class="ttc" id="abuffer_8h_html_a7ac72e76e9e41235a31f872f63bf58fe"><div class="ttname"><a href="buffer_8h.html#a7ac72e76e9e41235a31f872f63bf58fe">buf_advance</a></div><div class="ttdeci">static bool buf_advance(struct buffer *buf, int size)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00623">buffer.h:623</a></div></div>
<div class="ttc" id="apush_8c_html_a9717f9c37176ef0790dce9767afa9c04"><div class="ttname"><a href="push_8c.html#a9717f9c37176ef0790dce9767afa9c04">push_option_ex</a></div><div class="ttdeci">static void push_option_ex(struct gc_arena *gc, struct push_list *push_list, const char *opt, bool enable, int msglevel)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00610">push.c:610</a></div></div>
<div class="ttc" id="aoptions_8h_html_a825f21709295c8352598df7341d98fb8"><div class="ttname"><a href="options_8h.html#a825f21709295c8352598df7341d98fb8">OPTION_PARM_SIZE</a></div><div class="ttdeci">#define OPTION_PARM_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00056">options.h:56</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_a9cbbade2b528fe5d1e6ae65bbaf1e765"><div class="ttname"><a href="crypto__backend_8h.html#a9cbbade2b528fe5d1e6ae65bbaf1e765">md_kt_get</a></div><div class="ttdeci">const md_kt_t * md_kt_get(const char *digest)</div><div class="ttdoc">Return message digest parameters, based on the given digest name.</div><div class="ttdef"><b>Definition:</b> <a href="crypto__openssl_8c_source.html#l00952">crypto_openssl.c:952</a></div></div>
<div class="ttc" id="amanage_8c_html_af797c4485e4c1d150a3ec5abdbf22f99"><div class="ttname"><a href="manage_8c.html#af797c4485e4c1d150a3ec5abdbf22f99">management_notify</a></div><div class="ttdeci">void management_notify(struct management *man, const char *severity, const char *type, const char *text)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l02902">manage.c:2902</a></div></div>
<div class="ttc" id="apush_8h_html_afd8981e6ab23f3420713df99d26638b7"><div class="ttname"><a href="push_8h.html#afd8981e6ab23f3420713df99d26638b7">PUSH_MSG_ALREADY_REPLIED</a></div><div class="ttdeci">#define PUSH_MSG_ALREADY_REPLIED</div><div class="ttdef"><b>Definition:</b> <a href="push_8h_source.html#l00037">push.h:37</a></div></div>
<div class="ttc" id="aoptions_8c_html_a0669ac79557c619c356a9bb5e9931c9c"><div class="ttname"><a href="options_8c.html#a0669ac79557c619c356a9bb5e9931c9c">pre_pull_restore</a></div><div class="ttdeci">void pre_pull_restore(struct options *o, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="options_8c_source.html#l03612">options.c:3612</a></div></div>
<div class="ttc" id="assl_8c_html_aea948c70f8ca194a60dd1b17adb5247d"><div class="ttname"><a href="ssl_8c.html#aea948c70f8ca194a60dd1b17adb5247d">ssl_clean_auth_token</a></div><div class="ttdeci">bool ssl_clean_auth_token(void)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l00465">ssl.c:465</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a2c9a69063637763ee444c8f4a25188ba"><div class="ttname"><a href="errlevel_8h.html#a2c9a69063637763ee444c8f4a25188ba">M_VERB0</a></div><div class="ttdeci">#define M_VERB0</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00053">errlevel.h:53</a></div></div>
<div class="ttc" id="abuffer_8h_html_ab7be565801383d9f7371ab9a6aa99077"><div class="ttname"><a href="buffer_8h.html#ab7be565801383d9f7371ab9a6aa99077">BLEN</a></div><div class="ttdeci">#define BLEN(buf)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00127">buffer.h:127</a></div></div>
<div class="ttc" id="assl_8c_html_a474cc01c012410f92375140e781f714d"><div class="ttname"><a href="ssl_8c.html#a474cc01c012410f92375140e781f714d">ssl_put_auth_challenge</a></div><div class="ttdeci">void ssl_put_auth_challenge(const char *cr_str)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l00501">ssl.c:501</a></div></div>
<div class="ttc" id="apush_8c_html_a95f1b9a8d9ce1ff67684e847c90d2489"><div class="ttname"><a href="push_8c.html#a95f1b9a8d9ce1ff67684e847c90d2489">send_push_request</a></div><div class="ttdeci">bool send_push_request(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00369">push.c:369</a></div></div>
<div class="ttc" id="apush_8c_html_a5cc8cf61e20ec3c4af9763897bbc345e"><div class="ttname"><a href="push_8c.html#a5cc8cf61e20ec3c4af9763897bbc345e">clone_push_list</a></div><div class="ttdeci">void clone_push_list(struct options *o)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00645">push.c:645</a></div></div>
<div class="ttc" id="astructtls__session_html_a1de4672c1233dd4887122a909b10c314"><div class="ttname"><a href="structtls__session.html#a1de4672c1233dd4887122a909b10c314">tls_session::key</a></div><div class="ttdeci">struct key_state key[KS_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00442">ssl_common.h:442</a></div></div>
<div class="ttc" id="apush_8c_html_ada981d7b3b5819cfcefbb875889b8d57"><div class="ttname"><a href="push_8c.html#ada981d7b3b5819cfcefbb875889b8d57">send_push_options</a></div><div class="ttdeci">static bool send_push_options(struct context *c, struct buffer *buf, struct push_list *push_list, int safe_cap, bool *push_sent, bool *multi_push)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00486">push.c:486</a></div></div>
<div class="ttc" id="apush_8c_html_a38474861b2c7ef798cf3ff27a8b16ea8"><div class="ttname"><a href="push_8c.html#a38474861b2c7ef798cf3ff27a8b16ea8">server_pushed_signal</a></div><div class="ttdeci">void server_pushed_signal(struct context *c, const struct buffer *buffer, const bool restart, const int adv)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00121">push.c:121</a></div></div>
<div class="ttc" id="astructoptions_html_a624da06f35ed664a7f7c3519dd0846cc"><div class="ttname"><a href="structoptions.html#a624da06f35ed664a7f7c3519dd0846cc">options::push_ifconfig_ipv6_blocked</a></div><div class="ttdeci">bool push_ifconfig_ipv6_blocked</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00477">options.h:477</a></div></div>
<div class="ttc" id="apush_8h_html"><div class="ttname"><a href="push_8h.html">push.h</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_ad92889d868bb18d919c8965fc4b05436"><div class="ttname"><a href="crypto__backend_8h.html#ad92889d868bb18d919c8965fc4b05436">md_ctx_cleanup</a></div><div class="ttdeci">void md_ctx_cleanup(md_ctx_t *ctx)</div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_ad17a45f62ba6f3c0949d434a66ccb20a"><div class="ttname"><a href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a></div><div class="ttdeci">#define M_WARN</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00093">error.h:93</a></div></div>
<div class="ttc" id="abuffer_8h_html_ab4491b7f3124ff7b050e37c38c2e620b"><div class="ttname"><a href="buffer_8h.html#ab4491b7f3124ff7b050e37c38c2e620b">ALLOC_OBJ_CLEAR_GC</a></div><div class="ttdeci">#define ALLOC_OBJ_CLEAR_GC(dptr, type, gc)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l01096">buffer.h:1096</a></div></div>
<div class="ttc" id="astructcontext_html_aa9a5e593e669fc88b8b1c7a9d69c5df1"><div class="ttname"><a href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">context::options</a></div><div class="ttdeci">struct options options</div><div class="ttdoc">Options loaded from command line or configuration file.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00491">openvpn.h:491</a></div></div>
<div class="ttc" id="apush_8h_html_ae794321ea408c30cd2e62cbde62f4e37"><div class="ttname"><a href="push_8h.html#ae794321ea408c30cd2e62cbde62f4e37">PUSH_MSG_AUTH_FAILURE</a></div><div class="ttdeci">#define PUSH_MSG_AUTH_FAILURE</div><div class="ttdef"><b>Definition:</b> <a href="push_8h_source.html#l00035">push.h:35</a></div></div>
<div class="ttc" id="assl__ncp_8c_html_ac1a6ca132f8c8f36946e7219726f53a0"><div class="ttname"><a href="ssl__ncp_8c.html#ac1a6ca132f8c8f36946e7219726f53a0">tls_peer_supports_ncp</a></div><div class="ttdeci">bool tls_peer_supports_ncp(const char *peer_info)</div><div class="ttdoc">Returns whether the client supports NCP either by announcing IV_NCP&gt;=2 or the IV_CIPHERS list.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__ncp_8c_source.html#l00078">ssl_ncp.c:78</a></div></div>
<div class="ttc" id="aforward_8c_html_a9a8912859db26b7a9588ed5cdff63be4"><div class="ttname"><a href="forward_8c.html#a9a8912859db26b7a9588ed5cdff63be4">send_control_channel_string_dowork</a></div><div class="ttdeci">bool send_control_channel_string_dowork(struct tls_multi *multi, const char *str, int msglevel)</div><div class="ttdef"><b>Definition:</b> <a href="forward_8c_source.html#l00358">forward.c:358</a></div></div>
<div class="ttc" id="astructoptions_html"><div class="ttname"><a href="structoptions.html">options</a></div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00210">options.h:210</a></div></div>
<div class="ttc" id="astructcontext__2_html_aa77badbb770cedf77546d656d961d3ac"><div class="ttname"><a href="structcontext__2.html#aa77badbb770cedf77546d656d961d3ac">context_2::push_ifconfig_local_alias</a></div><div class="ttdeci">in_addr_t push_ifconfig_local_alias</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00443">openvpn.h:443</a></div></div>
<div class="ttc" id="apush_8c_html_ada4d6cedea0774388c33b6838aa80004"><div class="ttname"><a href="push_8c.html#ada4d6cedea0774388c33b6838aa80004">push_update_digest</a></div><div class="ttdeci">static void push_update_digest(md_ctx_t *ctx, struct buffer *buf, const struct options *opt)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00777">push.c:777</a></div></div>
<div class="ttc" id="apush_8c_html_afaee70b7fdf7f50f31c5505b926b0acb"><div class="ttname"><a href="push_8c.html#afaee70b7fdf7f50f31c5505b926b0acb">send_auth_pending_messages</a></div><div class="ttdeci">bool send_auth_pending_messages(struct context *c, const char *extra)</div><div class="ttdoc">Sends the auth pending control messages to a client.</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00290">push.c:290</a></div></div>
<div class="ttc" id="astructoptions_html_aa397848a05d2511b2aaf320f5edb65d2"><div class="ttname"><a href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">options::gc</a></div><div class="ttdeci">struct gc_arena gc</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00212">options.h:212</a></div></div>
<div class="ttc" id="astructoptions_html_adb8ec5e44523e50a40777073262d41a2"><div class="ttname"><a href="structoptions.html#adb8ec5e44523e50a40777073262d41a2">options::no_advance</a></div><div class="ttdeci">bool no_advance</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00250">options.h:250</a></div></div>
<div class="ttc" id="aoptions_8c_html_ade63586867ed9b0f268b4857ac8e7a5f"><div class="ttname"><a href="options_8c.html#ade63586867ed9b0f268b4857ac8e7a5f">auth_retry_get</a></div><div class="ttdeci">int auth_retry_get(void)</div><div class="ttdef"><b>Definition:</b> <a href="options_8c_source.html#l04306">options.c:4306</a></div></div>
<div class="ttc" id="astructcontext__2_html_a8b3a694dbf8a1836815eedf14c39d923"><div class="ttname"><a href="structcontext__2.html#a8b3a694dbf8a1836815eedf14c39d923">context_2::push_ifconfig_ipv6_netbits</a></div><div class="ttdeci">int push_ifconfig_ipv6_netbits</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00447">openvpn.h:447</a></div></div>
<div class="ttc" id="assl__common_8h_html_aaef501a7608e75db29eaff7c694de678aabef0f819c262c68ce7dfd1eda4f1538"><div class="ttname"><a href="ssl__common_8h.html#aaef501a7608e75db29eaff7c694de678aabef0f819c262c68ce7dfd1eda4f1538">CAS_FAILED</a></div><div class="ttdeci">@ CAS_FAILED</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00493">ssl_common.h:493</a></div></div>
<div class="ttc" id="assl__common_8h_html_a7efefa3a14114fca5c9b3c4606d19c67a11cbbaa4ec98bc132542d3744ef69ead"><div class="ttname"><a href="ssl__common_8h.html#a7efefa3a14114fca5c9b3c4606d19c67a11cbbaa4ec98bc132542d3744ef69ead">KS_AUTH_TRUE</a></div><div class="ttdeci">@ KS_AUTH_TRUE</div><div class="ttdoc">Key state is authenticated.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00141">ssl_common.h:141</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a4b1b340ab75c81b27e427d091d6f2e50"><div class="ttname"><a href="errlevel_8h.html#a4b1b340ab75c81b27e427d091d6f2e50">D_ROUTE_DEBUG</a></div><div class="ttdeci">#define D_ROUTE_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00131">errlevel.h:131</a></div></div>
<div class="ttc" id="apush_8h_html_ac3324c7b44e0338dd4817c4965ad7b93"><div class="ttname"><a href="push_8h.html#ac3324c7b44e0338dd4817c4965ad7b93">PUSH_MSG_REPLY</a></div><div class="ttdeci">#define PUSH_MSG_REPLY</div><div class="ttdef"><b>Definition:</b> <a href="push_8h_source.html#l00033">push.h:33</a></div></div>
<div class="ttc" id="astructoptions_html_a238616194d17beb9b5b6605ff747085c"><div class="ttname"><a href="structoptions.html#a238616194d17beb9b5b6605ff747085c">options::scheduled_exit_interval</a></div><div class="ttdeci">int scheduled_exit_interval</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00509">options.h:509</a></div></div>
<div class="ttc" id="apush_8c_html_ae4505044645e0855d4dd7296697a411c"><div class="ttname"><a href="push_8c.html#ae4505044645e0855d4dd7296697a411c">process_incoming_push_msg</a></div><div class="ttdeci">int process_incoming_push_msg(struct context *c, const struct buffer *buffer, bool honor_received_options, unsigned int permission_mask, unsigned int *option_types_found)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00856">push.c:856</a></div></div>
<div class="ttc" id="astructtls__multi_html_a4a562d513904cc568d8a91af8255ebdf"><div class="ttname"><a href="structtls__multi.html#a4a562d513904cc568d8a91af8255ebdf">tls_multi::peer_info</a></div><div class="ttdeci">char * peer_info</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00566">ssl_common.h:566</a></div></div>
<div class="ttc" id="aopenvpn_2basic_8h_html_afd2537d19a3cb6556b0f727580ec6ee7"><div class="ttname"><a href="openvpn_2basic_8h.html#afd2537d19a3cb6556b0f727580ec6ee7">SIZE</a></div><div class="ttdeci">#define SIZE(x)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2basic_8h_source.html#l00030">basic.h:30</a></div></div>
<div class="ttc" id="astructbuffer_html"><div class="ttname"><a href="structbuffer.html">buffer</a></div><div class="ttdoc">Wrapper structure for dynamically allocated memory.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00060">buffer.h:60</a></div></div>
<div class="ttc" id="astructcontext__2_html_a76b40e7c96ea199128151f98616aaaf8"><div class="ttname"><a href="structcontext__2.html#a76b40e7c96ea199128151f98616aaaf8">context_2::sent_push_reply_expiry</a></div><div class="ttdeci">time_t sent_push_reply_expiry</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00440">openvpn.h:440</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_a36efaa6a9f49bcbf88d439c5535d20d4"><div class="ttname"><a href="crypto__backend_8h.html#a36efaa6a9f49bcbf88d439c5535d20d4">md_ctx_update</a></div><div class="ttdeci">void md_ctx_update(md_ctx_t *ctx, const uint8_t *src, int src_len)</div></div>
<div class="ttc" id="aerrlevel_8h_html_ab1f5456810dd6e5c6ab78c1b3d35f1c0"><div class="ttname"><a href="errlevel_8h.html#ab1f5456810dd6e5c6ab78c1b3d35f1c0">D_PUSH_ERRORS</a></div><div class="ttdeci">#define D_PUSH_ERRORS</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00067">errlevel.h:67</a></div></div>
<div class="ttc" id="abuffer_8h_html_a098a04bcd360e15e50ecf50cc19812da"><div class="ttname"><a href="buffer_8h.html#a098a04bcd360e15e50ecf50cc19812da">CC_COMMA</a></div><div class="ttdeci">#define CC_COMMA</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00912">buffer.h:912</a></div></div>
<div class="ttc" id="asocket_8c_html_a2741d6007f1e5a670409883f4304da61"><div class="ttname"><a href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a></div><div class="ttdeci">const char * print_in_addr_t(in_addr_t addr, unsigned int flags, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l03001">socket.c:3001</a></div></div>
<div class="ttc" id="astructoptions_html_a6b960ac0e59bda605e2b6879d024afa2"><div class="ttname"><a href="structoptions.html#a6b960ac0e59bda605e2b6879d024afa2">options::handshake_window</a></div><div class="ttdeci">int handshake_window</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00600">options.h:600</a></div></div>
<div class="ttc" id="abuffer_8h_html_ac08c75bf761b2c048b14e5b6cbf2c8f3"><div class="ttname"><a href="buffer_8h.html#ac08c75bf761b2c048b14e5b6cbf2c8f3">BCAP</a></div><div class="ttdeci">#define BCAP(buf)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00130">buffer.h:130</a></div></div>
<div class="ttc" id="assl_8h_html"><div class="ttname"><a href="ssl_8h.html">ssl.h</a></div></div>
<div class="ttc" id="astructcontext__2_html_ac9c31be53653726a665561a5efa77399"><div class="ttname"><a href="structcontext__2.html#ac9c31be53653726a665561a5efa77399">context_2::n_sent_push_requests</a></div><div class="ttdeci">int n_sent_push_requests</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00451">openvpn.h:451</a></div></div>
<div class="ttc" id="abuffer_8h_html_a3b991db1fc57fb2bb726631949070759"><div class="ttname"><a href="buffer_8h.html#a3b991db1fc57fb2bb726631949070759">CC_ANY</a></div><div class="ttdeci">#define CC_ANY</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00891">buffer.h:891</a></div></div>
<div class="ttc" id="astructtls__session_html"><div class="ttname"><a href="structtls__session.html">tls_session</a></div><div class="ttdoc">Security parameter state of a single session within a VPN tunnel.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00404">ssl_common.h:404</a></div></div>
<div class="ttc" id="asyshead_8h_html"><div class="ttname"><a href="syshead_8h.html">syshead.h</a></div></div>
<div class="ttc" id="astructoptions_html_aecf13b277bacf5c1cb2bdfb7e9733d4f"><div class="ttname"><a href="structoptions.html#aecf13b277bacf5c1cb2bdfb7e9733d4f">options::push_ifconfig_ipv4_blocked</a></div><div class="ttdeci">bool push_ifconfig_ipv4_blocked</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00472">options.h:472</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a682182a5e5f38fd61f4311501e9dac5d"><div class="ttname"><a href="config-msvc_8h.html#a682182a5e5f38fd61f4311501e9dac5d">SIGTERM</a></div><div class="ttdeci">#define SIGTERM</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00159">config-msvc.h:159</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a18d60aad51f694ab7a74361c1e20de63"><div class="ttname"><a href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a></div><div class="ttdeci">#define D_PUSH</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00083">errlevel.h:83</a></div></div>
<div class="ttc" id="assl__common_8h_html_ac71370f88da0ddceccb01fb990f83a0f"><div class="ttname"><a href="ssl__common_8h.html#ac71370f88da0ddceccb01fb990f83a0f">UP_TYPE_AUTH</a></div><div class="ttdeci">#define UP_TYPE_AUTH</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00041">ssl_common.h:41</a></div></div>
<div class="ttc" id="astructgc__arena_html"><div class="ttname"><a href="structgc__arena.html">gc_arena</a></div><div class="ttdoc">Garbage collection arena used to keep track of dynamically allocated memory.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00116">buffer.h:116</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a3ac39702968675a6552a43d7c68bf7f9"><div class="ttname"><a href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a></div><div class="ttdeci">#define msg</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00170">error.h:170</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a944a8250e34bfd7991123abd3436d8c0"><div class="ttname"><a href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a></div><div class="ttdeci">#define SIGUSR1</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00157">config-msvc.h:157</a></div></div>
<div class="ttc" id="astructcontext_html_a4a8aea25993019921e9568f611106773"><div class="ttname"><a href="structcontext.html#a4a8aea25993019921e9568f611106773">context::sig</a></div><div class="ttdeci">struct signal_info * sig</div><div class="ttdoc">Internal error signaling object.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00516">openvpn.h:516</a></div></div>
<div class="ttc" id="abuffer_8c_html_a5812c761d1e2721c86e7188336019712"><div class="ttname"><a href="buffer_8c.html#a5812c761d1e2721c86e7188336019712">string_class</a></div><div class="ttdeci">bool string_class(const char *str, const unsigned int inclusive, const unsigned int exclusive)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l01038">buffer.c:1038</a></div></div>
<div class="ttc" id="astructsha256__digest_html_ab33fddc33bcbd885fc183ce3803a0ba3"><div class="ttname"><a href="structsha256__digest.html#ab33fddc33bcbd885fc183ce3803a0ba3">sha256_digest::digest</a></div><div class="ttdeci">uint8_t digest[SHA256_DIGEST_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00133">crypto.h:133</a></div></div>
<div class="ttc" id="astructenv__set_html"><div class="ttname"><a href="structenv__set.html">env_set</a></div><div class="ttdef"><b>Definition:</b> <a href="env__set_8h_source.html#l00042">env_set.h:42</a></div></div>
<div class="ttc" id="asig_8c_html_a76174cdf16caa2f356ddb93af281e417"><div class="ttname"><a href="sig_8c.html#a76174cdf16caa2f356ddb93af281e417">register_signal</a></div><div class="ttdeci">void register_signal(struct context *c, int sig, const char *text)</div><div class="ttdef"><b>Definition:</b> <a href="sig_8c_source.html#l00457">sig.c:457</a></div></div>
<div class="ttc" id="astructpush__list_html_af220ca38d22bafe403729f37462c2662"><div class="ttname"><a href="structpush__list.html#af220ca38d22bafe403729f37462c2662">push_list::tail</a></div><div class="ttdeci">struct push_entry * tail</div><div class="ttdef"><b>Definition:</b> <a href="pushlist_8h_source.html#l00037">pushlist.h:37</a></div></div>
<div class="ttc" id="abuffer_8h_html_add5bab9239f486b22e62806cd7533acb"><div class="ttname"><a href="buffer_8h.html#add5bab9239f486b22e62806cd7533acb">strprefix</a></div><div class="ttdeci">static bool strprefix(const char *str, const char *prefix)</div><div class="ttdoc">Return true iff str starts with prefix.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00971">buffer.h:971</a></div></div>
<div class="ttc" id="astructtls__multi_html_aa1c6b330c9dd68a9f9dd6bf05d454642"><div class="ttname"><a href="structtls__multi.html#aa1c6b330c9dd68a9f9dd6bf05d454642">tls_multi::use_peer_id</a></div><div class="ttdeci">bool use_peer_id</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00590">ssl_common.h:590</a></div></div>
<div class="ttc" id="abuffer_8c_html_ade2c81fb41f1c4838dc6e85a7b1d1f3b"><div class="ttname"><a href="buffer_8c.html#ade2c81fb41f1c4838dc6e85a7b1d1f3b">buf_string_match_head_str</a></div><div class="ttdeci">bool buf_string_match_head_str(const struct buffer *src, const char *match)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00794">buffer.c:794</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_afdb937666eb44c6bbb45860ed209773d"><div class="ttname"><a href="crypto__backend_8h.html#afdb937666eb44c6bbb45860ed209773d">md_ctx_free</a></div><div class="ttdeci">void md_ctx_free(md_ctx_t *ctx)</div></div>
<div class="ttc" id="asocket_8h_html_a5b618d8716696f3ebe96642be56bec03"><div class="ttname"><a href="socket_8h.html#a5b618d8716696f3ebe96642be56bec03">GETADDR_HOST_ORDER</a></div><div class="ttdeci">#define GETADDR_HOST_ORDER</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00525">socket.h:525</a></div></div>
<div class="ttc" id="apush_8c_html_a153e89097ea94283b2a9df7e381f619f"><div class="ttname"><a href="push_8c.html#a153e89097ea94283b2a9df7e381f619f">send_restart</a></div><div class="ttdeci">void send_restart(struct context *c, const char *kill_msg)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00317">push.c:317</a></div></div>
<div class="ttc" id="aotime_8h_html_a936f2be57845060fd991cad8f7c14359"><div class="ttname"><a href="otime_8h.html#a936f2be57845060fd991cad8f7c14359">openvpn_time</a></div><div class="ttdeci">static time_t openvpn_time(time_t *t)</div><div class="ttdef"><b>Definition:</b> <a href="otime_8h_source.html#l00124">otime.h:124</a></div></div>
<div class="ttc" id="abuffer_8c_html_a042e9b112fb90777619ec9cd1678d5b5"><div class="ttname"><a href="buffer_8c.html#a042e9b112fb90777619ec9cd1678d5b5">buf_string_compare_advance</a></div><div class="ttdeci">bool buf_string_compare_advance(struct buffer *src, const char *match)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00805">buffer.c:805</a></div></div>
<div class="ttc" id="aroute_8h_html_a5b4755dbf69b1e053f1ebb38c2f76eed"><div class="ttname"><a href="route_8h.html#a5b4755dbf69b1e053f1ebb38c2f76eed">netbits_to_netmask</a></div><div class="ttdeci">static in_addr_t netbits_to_netmask(const int netbits)</div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00379">route.h:379</a></div></div>
<div class="ttc" id="acommon_8h_html_a82f7052097bbb3782cda1437e443eeea"><div class="ttname"><a href="common_8h.html#a82f7052097bbb3782cda1437e443eeea">PUSH_REQUEST_INTERVAL</a></div><div class="ttdeci">#define PUSH_REQUEST_INTERVAL</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00089">common.h:89</a></div></div>
<div class="ttc" id="assl_8c_html_a004bfec7a400d6c55a880bde27ff8b23"><div class="ttname"><a href="ssl_8c.html#a004bfec7a400d6c55a880bde27ff8b23">ssl_purge_auth</a></div><div class="ttdeci">void ssl_purge_auth(const bool auth_user_pass_only)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l00476">ssl.c:476</a></div></div>
<div class="ttc" id="astructcontext__2_html_ac5b35ba45869db49edb7092e07e81d8f"><div class="ttname"><a href="structcontext__2.html#ac5b35ba45869db49edb7092e07e81d8f">context_2::push_ifconfig_remote_netmask</a></div><div class="ttdeci">in_addr_t push_ifconfig_remote_netmask</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00442">openvpn.h:442</a></div></div>
<div class="ttc" id="astructmanagement_html"><div class="ttname"><a href="structmanagement.html">management</a></div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00322">manage.h:322</a></div></div>
<div class="ttc" id="abuffer_8h_html_ad1a8ee23a868bbed76d1a4e396290e9b"><div class="ttname"><a href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a></div><div class="ttdeci">static void gc_free(struct gc_arena *a)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l01032">buffer.h:1032</a></div></div>
<div class="ttc" id="apush_8c_html_a7f6650958bc623e7676ffa5ada2949d8"><div class="ttname"><a href="push_8c.html#a7f6650958bc623e7676ffa5ada2949d8">server_pushed_info</a></div><div class="ttdeci">void server_pushed_info(struct context *c, const struct buffer *buffer, const int adv)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00181">push.c:181</a></div></div>
<div class="ttc" id="apush_8c_html_ad5c8ae2114245fa689a4d075177a81c7"><div class="ttname"><a href="push_8c.html#ad5c8ae2114245fa689a4d075177a81c7">prepare_push_reply</a></div><div class="ttdeci">bool prepare_push_reply(struct context *c, struct gc_arena *gc, struct push_list *push_list)</div><div class="ttdoc">Prepare push options, based on local options.</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00427">push.c:427</a></div></div>
<div class="ttc" id="aforward_8c_html_a77516756998a056dedada8aeb0f0f2e3"><div class="ttname"><a href="forward_8c.html#a77516756998a056dedada8aeb0f0f2e3">schedule_exit</a></div><div class="ttdeci">void schedule_exit(struct context *c, const int n_seconds, const int signal)</div><div class="ttdef"><b>Definition:</b> <a href="forward_8c_source.html#l00482">forward.c:482</a></div></div>
<div class="ttc" id="astructcontext__2_html_adbe7d67b15dc3e5fe37856a3eafcaaa6"><div class="ttname"><a href="structcontext__2.html#adbe7d67b15dc3e5fe37856a3eafcaaa6">context_2::pulled_options_digest</a></div><div class="ttdeci">struct sha256_digest pulled_options_digest</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00457">openvpn.h:457</a></div></div>
<div class="ttc" id="aotime_8c_html_a3c3ca8cc859a31aec6578f0dcf1b32a5"><div class="ttname"><a href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a></div><div class="ttdeci">time_t now</div><div class="ttdef"><b>Definition:</b> <a href="otime_8c_source.html#l00036">otime.c:36</a></div></div>
<div class="ttc" id="aoptions_8h_html_a570ecbd9a01e98df42199d078454f848"><div class="ttname"><a href="options_8h.html#a570ecbd9a01e98df42199d078454f848">AR_INTERACT</a></div><div class="ttdeci">#define AR_INTERACT</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00852">options.h:852</a></div></div>
<div class="ttc" id="aconfig_8h_html"><div class="ttname"><a href="config_8h.html">config.h</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a5e25095305ce2ad10907ed529d71e780"><div class="ttname"><a href="errlevel_8h.html#a5e25095305ce2ad10907ed529d71e780">D_PUSH_DEBUG</a></div><div class="ttdeci">#define D_PUSH_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00150">errlevel.h:150</a></div></div>
<div class="ttc" id="assl__ncp_8h_html"><div class="ttname"><a href="ssl__ncp_8h.html">ssl_ncp.h</a></div></div>
<div class="ttc" id="astructtls__multi_html_a93c90f22f9fbbd1898ea9708a49ee1f7"><div class="ttname"><a href="structtls__multi.html#a93c90f22f9fbbd1898ea9708a49ee1f7">tls_multi::peer_id</a></div><div class="ttdeci">uint32_t peer_id</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00589">ssl_common.h:589</a></div></div>
<div class="ttc" id="amisc_8c_html_ad9f9ea2091b3303cef77c02575fdf91d"><div class="ttname"><a href="misc_8c.html#ad9f9ea2091b3303cef77c02575fdf91d">sanitize_control_message</a></div><div class="ttdeci">const char * sanitize_control_message(const char *src, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="misc_8c_source.html#l00671">misc.c:671</a></div></div>
<div class="ttc" id="astructcontext__2_html_a74f0885f811abb630be6afb8bfe1e144"><div class="ttname"><a href="structcontext__2.html#a74f0885f811abb630be6afb8bfe1e144">context_2::push_request_interval</a></div><div class="ttdeci">struct event_timeout push_request_interval</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00450">openvpn.h:450</a></div></div>
<div class="ttc" id="apush_8c_html_a526fbfb56d0a579146a01c2c0db9584e"><div class="ttname"><a href="push_8c.html#a526fbfb56d0a579146a01c2c0db9584e">push_reply_cmd</a></div><div class="ttdeci">static char push_reply_cmd[]</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00043">push.c:43</a></div></div>
<div class="ttc" id="astructpush__entry_html_a2a6b3c293572711f5f661628b23b3716"><div class="ttname"><a href="structpush__entry.html#a2a6b3c293572711f5f661628b23b3716">push_entry::next</a></div><div class="ttdeci">struct push_entry * next</div><div class="ttdef"><b>Definition:</b> <a href="pushlist_8h_source.html#l00030">pushlist.h:30</a></div></div>
<div class="ttc" id="aoptions_8h_html_aa9cc77b228a8b97a2b65e6865b7ae005"><div class="ttname"><a href="options_8h.html#aa9cc77b228a8b97a2b65e6865b7ae005">AR_NOINTERACT</a></div><div class="ttdeci">#define AR_NOINTERACT</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00853">options.h:853</a></div></div>
<div class="ttc" id="acommon_8h_html_acffcd4cb515881c936f8b7092f235f3e"><div class="ttname"><a href="common_8h.html#acffcd4cb515881c936f8b7092f235f3e">PUSH_BUNDLE_SIZE</a></div><div class="ttdeci">#define PUSH_BUNDLE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00084">common.h:84</a></div></div>
<div class="ttc" id="astructoptions_html_a2809c3210f04037afdfcbffcabb42a2a"><div class="ttname"><a href="structoptions.html#a2809c3210f04037afdfcbffcabb42a2a">options::push_option_types_found</a></div><div class="ttdeci">unsigned int push_option_types_found</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00505">options.h:505</a></div></div>
<div class="ttc" id="astructsession_html"><div class="ttname"><a href="structsession.html">session</a></div><div class="ttdef"><b>Definition:</b> <a href="keyingmaterialexporter_8c_source.html#l00056">keyingmaterialexporter.c:56</a></div></div>
<div class="ttc" id="apush_8c_html_a1146746ce08245cf99ee59592d775acc"><div class="ttname"><a href="push_8c.html#a1146746ce08245cf99ee59592d775acc">receive_auth_failed</a></div><div class="ttdeci">void receive_auth_failed(struct context *c, const struct buffer *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00052">push.c:52</a></div></div>
<div class="ttc" id="apush_8c_html_a3e9f079d617f92e84b1268218704d821"><div class="ttname"><a href="push_8c.html#a3e9f079d617f92e84b1268218704d821">receive_cr_response</a></div><div class="ttdeci">void receive_cr_response(struct context *c, const struct buffer *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00213">push.c:213</a></div></div>
<div class="ttc" id="abuffer_8h_html_ab7b6746dd30a4cfaf4a9218f42c6dabe"><div class="ttname"><a href="buffer_8h.html#ab7b6746dd30a4cfaf4a9218f42c6dabe">buf_read_u8</a></div><div class="ttdeci">static int buf_read_u8(struct buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00796">buffer.h:796</a></div></div>
<div class="ttc" id="astructcontext__2_html_a0c202bede566ebdc332a947f625677be"><div class="ttname"><a href="structcontext__2.html#a0c202bede566ebdc332a947f625677be">context_2::push_ifconfig_ipv6_defined</a></div><div class="ttdeci">bool push_ifconfig_ipv6_defined</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00445">openvpn.h:445</a></div></div>
<div class="ttc" id="aoptions_8c_html_a666b73630dd3292a270ebb01e3b09fdb"><div class="ttname"><a href="options_8c.html#a666b73630dd3292a270ebb01e3b09fdb">apply_push_options</a></div><div class="ttdeci">bool apply_push_options(struct options *options, struct buffer *buf, unsigned int permission_mask, unsigned int *option_types_found, struct env_set *es)</div><div class="ttdef"><b>Definition:</b> <a href="options_8c_source.html#l05034">options.c:5034</a></div></div>
<div class="ttc" id="apush_8c_html_ae7ebce816788a80c521efae5c3c65cc8"><div class="ttname"><a href="push_8c.html#ae7ebce816788a80c521efae5c3c65cc8">send_push_reply</a></div><div class="ttdeci">bool send_push_reply(struct context *c, struct push_list *per_client_push_list)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00545">push.c:545</a></div></div>
<div class="ttc" id="ainterval_8h_html_a882171fabcf7627fd129fe3268052069"><div class="ttname"><a href="interval_8h.html#a882171fabcf7627fd129fe3268052069">event_timeout_clear</a></div><div class="ttdeci">static void event_timeout_clear(struct event_timeout *et)</div><div class="ttdef"><b>Definition:</b> <a href="interval_8h_source.html#l00150">interval.h:150</a></div></div>
<div class="ttc" id="astructtls__multi_html_a067765b59cac7a31d0736d3e3e8bfe28"><div class="ttname"><a href="structtls__multi.html#a067765b59cac7a31d0736d3e3e8bfe28">tls_multi::auth_token_initial</a></div><div class="ttdeci">char * auth_token_initial</div><div class="ttdoc">The first auth-token we sent to a client, for clients that do not update their auth-token (older Open...</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00571">ssl_common.h:571</a></div></div>
<div class="ttc" id="abuffer_8c_html_a9fa59da93f5503603025786ec8f33726"><div class="ttname"><a href="buffer_8c.html#a9fa59da93f5503603025786ec8f33726">print_argv</a></div><div class="ttdeci">char * print_argv(const char **p, struct gc_arena *gc, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00733">buffer.c:733</a></div></div>
<div class="ttc" id="apush_8h_html_af425e5cb988d69e642be32fc01e9765c"><div class="ttname"><a href="push_8h.html#af425e5cb988d69e642be32fc01e9765c">PUSH_MSG_CONTINUATION</a></div><div class="ttdeci">#define PUSH_MSG_CONTINUATION</div><div class="ttdef"><b>Definition:</b> <a href="push_8h_source.html#l00036">push.h:36</a></div></div>
<div class="ttc" id="assl__verify_8c_html_ac6de478954452cfd54e8352f57638772"><div class="ttname"><a href="ssl__verify_8c.html#ac6de478954452cfd54e8352f57638772">tls_authentication_status</a></div><div class="ttdeci">int tls_authentication_status(struct tls_multi *multi, const int latency)</div><div class="ttdef"><b>Definition:</b> <a href="ssl__verify_8c_source.html#l00950">ssl_verify.c:950</a></div></div>
<div class="ttc" id="astructoptions_html_a6c5eef6691660bf4aa7618c2a5485558"><div class="ttname"><a href="structoptions.html#a6c5eef6691660bf4aa7618c2a5485558">options::ifconfig_local</a></div><div class="ttdeci">const char * ifconfig_local</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00267">options.h:267</a></div></div>
<div class="ttc" id="amemdbg_8h_html"><div class="ttname"><a href="memdbg_8h.html">memdbg.h</a></div></div>
<div class="ttc" id="apush_8c_html_ac33633059f09bb30f8a33fee87f33aa2"><div class="ttname"><a href="push_8c.html#ac33633059f09bb30f8a33fee87f33aa2">incoming_push_message</a></div><div class="ttdeci">void incoming_push_message(struct context *c, const struct buffer *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00328">push.c:328</a></div></div>
<div class="ttc" id="astructoptions_html_a7f09235fee401590074265aff177491a"><div class="ttname"><a href="structoptions.html#a7f09235fee401590074265aff177491a">options::ciphername</a></div><div class="ttdeci">const char * ciphername</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00520">options.h:520</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a446cccfde267d5f96d18513d217286fe"><div class="ttname"><a href="openvpn_2error_8h.html#a446cccfde267d5f96d18513d217286fe">M_USAGE</a></div><div class="ttdeci">#define M_USAGE</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00108">error.h:108</a></div></div>
<div class="ttc" id="astructpush__entry_html_ae890e41d491f778ed1ee7396fec98b6e"><div class="ttname"><a href="structpush__entry.html#ae890e41d491f778ed1ee7396fec98b6e">push_entry::enable</a></div><div class="ttdeci">bool enable</div><div class="ttdef"><b>Definition:</b> <a href="pushlist_8h_source.html#l00031">pushlist.h:31</a></div></div>
<div class="ttc" id="abuffer_8c_html_a3307f08331b1ce42168bafd2ecf7874a"><div class="ttname"><a href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a></div><div class="ttdeci">bool buf_printf(struct buffer *buf, const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00245">buffer.c:245</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a9a941819355e6f658991890ff66b4b0e"><div class="ttname"><a href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a></div><div class="ttdeci">unsigned __int8 uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00164">config-msvc.h:164</a></div></div>
<div class="ttc" id="astructoptions_html_a8f6720d70314b86f89ba09c24bda9c18"><div class="ttname"><a href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">options::pull</a></div><div class="ttdeci">bool pull</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00503">options.h:503</a></div></div>
<div class="ttc" id="astructpush__list_html"><div class="ttname"><a href="structpush__list.html">push_list</a></div><div class="ttdef"><b>Definition:</b> <a href="pushlist_8h_source.html#l00035">pushlist.h:35</a></div></div>
<div class="ttc" id="apush_8c_html_a009af85288d9c300844fd8c9eb7acd8f"><div class="ttname"><a href="push_8c.html#a009af85288d9c300844fd8c9eb7acd8f">process_incoming_push_request</a></div><div class="ttdeci">int process_incoming_push_request(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="push_8c_source.html#l00731">push.c:731</a></div></div>
<div class="ttc" id="aforward_8c_html_a7a409db050be184362b60f3ce7b56b35"><div class="ttname"><a href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a></div><div class="ttdeci">bool send_control_channel_string(struct context *c, const char *str, int msglevel)</div><div class="ttdef"><b>Definition:</b> <a href="forward_8c_source.html#l00377">forward.c:377</a></div></div>
<div class="ttc" id="abuffer_8c_html_ac55fefaff3ce0991e97c76e78725d1c9"><div class="ttname"><a href="buffer_8c.html#ac55fefaff3ce0991e97c76e78725d1c9">buf_parse</a></div><div class="ttdeci">bool buf_parse(struct buffer *buf, const int delim, char *line, const int size)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00841">buffer.c:841</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
