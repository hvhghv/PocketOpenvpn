<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: src/openvpn/init.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_92f13d409beef24f5ba1b81abfed1f1c.html">openvpn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">init.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="init_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *  OpenVPN -- An application to securely tunnel IP networks</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *             over a single TCP/UDP port, with support for SSL/TLS-based</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *             session authentication and key exchange,</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *             packet encryption, packet authentication, and</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *             packet compression.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *  Copyright (C) 2002-2022 OpenVPN Inc &lt;sales@openvpn.net&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *  This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  it under the terms of the GNU General Public License version 2</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *  as published by the Free Software Foundation.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *  This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *  GNU General Public License for more details.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *  You should have received a copy of the GNU General Public License along</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *  with this program; if not, write to the Free Software Foundation, Inc.,</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *  51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="config_8h.html">config.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#elif defined(_MSC_VER)</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="config-msvc_8h.html">config-msvc.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="syshead_8h.html">syshead.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#ifdef ENABLE_SYSTEMD</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;systemd/sd-daemon.h&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="win32_8h.html">win32.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="init_8h.html">init.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="run__command_8h.html">run_command.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sig_8h.html">sig.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="occ_8h.html">occ.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="list_8h.html">list.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="otime_8h.html">otime.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pool_8h.html">pool.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gremlin_8h.html">gremlin.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="occ_8h.html">occ.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pkcs11_8h.html">pkcs11.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ps_8h.html">ps.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lladdr_8h.html">lladdr.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ping_8h.html">ping.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mstats_8h.html">mstats.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ssl__verify_8h.html">ssl_verify.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ssl__ncp_8h.html">ssl_ncp.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tls__crypt_8h.html">tls_crypt.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="forward_8h.html">forward.h</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="auth__token_8h.html">auth_token.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="memdbg_8h.html">memdbg.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="init_8c.html#a5726665a3a94e70598b71c22b77c5693">   60</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *<a class="code" href="init_8c.html#a5726665a3a94e70598b71c22b77c5693">static_context</a>; <span class="comment">/* GLOBAL */</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="init_8c.html#a162b20591bd0d83be031b7fe1bf7dbef">   61</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="init_8c.html#a162b20591bd0d83be031b7fe1bf7dbef">saved_pid_file_name</a>; <span class="comment">/* GLOBAL */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> * Crypto initialization flags</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="init_8c.html#a4f3c4044edc3d306325c49f75e18c931">   66</a></span>&#160;<span class="preprocessor">#define CF_LOAD_PERSISTED_PACKET_ID (1&lt;&lt;0)</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="init_8c.html#a57cbdb902da19e518279d624dd22b5c4">   67</a></span>&#160;<span class="preprocessor">#define CF_INIT_TLS_MULTI           (1&lt;&lt;1)</span></div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="init_8c.html#adc52e27fb65137f8ac18a18cd03551f6">   68</a></span>&#160;<span class="preprocessor">#define CF_INIT_TLS_AUTH_STANDALONE (1&lt;&lt;2)</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="init_8c.html#a05df1a443a6eac2dc6faa292fb433f27">do_init_first_time</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="init_8h.html#a80646beaaf6a2d8fa45e74b125da02d6">   73</a></span>&#160;<a class="code" href="init_8c.html#a80646beaaf6a2d8fa45e74b125da02d6">context_clear</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;{</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(*c);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="init_8h.html#a3333f41a29ff31266dce5dc83396ee5b">   79</a></span>&#160;<a class="code" href="init_8c.html#a3333f41a29ff31266dce5dc83396ee5b">context_clear_1</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="init_8h.html#a7e2affa0cea0aa844a58b3185222a3c9">   85</a></span>&#160;<a class="code" href="init_8c.html#a7e2affa0cea0aa844a58b3185222a3c9">context_clear_2</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="init_8h.html#af0a7adfd1ff37789d61c4066d798060e">   91</a></span>&#160;<a class="code" href="init_8c.html#af0a7adfd1ff37789d61c4066d798060e">context_clear_all_except_first_time</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> first_time_save = c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcontext__persist.html">context_persist</a> cpsave = c-&gt;<a class="code" href="structcontext.html#af52fc5d2e241fbee78d2216e9ff7ed72">persist</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="init_8c.html#a80646beaaf6a2d8fa45e74b125da02d6">context_clear</a>(c);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a> = first_time_save;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    c-&gt;<a class="code" href="structcontext.html#af52fc5d2e241fbee78d2216e9ff7ed72">persist</a> = cpsave;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> * Pass tunnel endpoint and MTU parms to a user-supplied script.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> * Used to execute the up/down script/plugins.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="init_8c.html#a0e4c816db034fa84e7b3dc0917bb58c5">  105</a></span>&#160;<a class="code" href="init_8c.html#a0e4c816db034fa84e7b3dc0917bb58c5">run_up_down</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *command,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structplugin__list.html">plugin_list</a> *plugins,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordtype">int</span> plugin_type,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *arg,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;#ifdef _WIN32</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            DWORD adapter_index,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;#endif</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *dev_type,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordtype">int</span> tun_mtu,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordtype">int</span> link_mtu,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *ifconfig_local,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *ifconfig_remote,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structcontext.html">context</a>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *signal_text,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *script_type,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keyword">struct</span> <a class="code" href="structenv__set.html">env_set</a> *es)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (signal_text)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="env__set_8c.html#a872620e2e324ded9c1bc8af1c253faf9">setenv_str</a>(es, <span class="stringliteral">&quot;signal&quot;</span>, signal_text);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="env__set_8c.html#a872620e2e324ded9c1bc8af1c253faf9">setenv_str</a>(es, <span class="stringliteral">&quot;script_context&quot;</span>, <a class="code" href="structcontext.html">context</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="env__set_8c.html#a2ee1297d7cd864a08edff8440efa4143">setenv_int</a>(es, <span class="stringliteral">&quot;tun_mtu&quot;</span>, tun_mtu);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="env__set_8c.html#a2ee1297d7cd864a08edff8440efa4143">setenv_int</a>(es, <span class="stringliteral">&quot;link_mtu&quot;</span>, link_mtu);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="env__set_8c.html#a872620e2e324ded9c1bc8af1c253faf9">setenv_str</a>(es, <span class="stringliteral">&quot;dev&quot;</span>, arg);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (dev_type)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <a class="code" href="env__set_8c.html#a872620e2e324ded9c1bc8af1c253faf9">setenv_str</a>(es, <span class="stringliteral">&quot;dev_type&quot;</span>, dev_type);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="env__set_8c.html#a2ee1297d7cd864a08edff8440efa4143">setenv_int</a>(es, <span class="stringliteral">&quot;dev_idx&quot;</span>, adapter_index);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (!ifconfig_local)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        ifconfig_local = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">if</span> (!ifconfig_remote)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        ifconfig_remote = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="structcontext.html">context</a>)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="structcontext.html">context</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="plugin_8c.html#afbccf58e824f3405cd8d088a9c5e4d61">plugin_defined</a>(plugins, plugin_type))</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keyword">struct </span><a class="code" href="structargv.html">argv</a> <a class="code" href="structargv.html">argv</a> = <a class="code" href="argv_8c.html#ae03da330eccab6d3239253b774a92d4d">argv_new</a>();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(arg);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="argv_8c.html#acb8c504c4703e6e88c52463da877c8a8">argv_printf</a>(&amp;<a class="code" href="structargv.html">argv</a>,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    <span class="stringliteral">&quot;%s %d %d %s %s %s&quot;</span>,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    arg,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    tun_mtu, link_mtu,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    ifconfig_local, ifconfig_remote,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    <a class="code" href="structcontext.html">context</a>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="plugin_8h.html#aa1988b85df1aa0a7c628e038868e6d39">plugin_call</a>(plugins, plugin_type, &amp;<a class="code" href="structargv.html">argv</a>, NULL, es) != <a class="code" href="openvpn-plugin_8h.html#abc63437901a486826ebe0ba0a84bc7cb">OPENVPN_PLUGIN_FUNC_SUCCESS</a>)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;ERROR: up/down plugin call failed&quot;</span>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="argv_8c.html#a8563bed2ee30eda7125eee7bdb9ab4eb">argv_free</a>(&amp;<a class="code" href="structargv.html">argv</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (command)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keyword">struct </span><a class="code" href="structargv.html">argv</a> <a class="code" href="structargv.html">argv</a> = <a class="code" href="argv_8c.html#ae03da330eccab6d3239253b774a92d4d">argv_new</a>();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(arg);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="env__set_8c.html#a872620e2e324ded9c1bc8af1c253faf9">setenv_str</a>(es, <span class="stringliteral">&quot;script_type&quot;</span>, script_type);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="argv_8c.html#a774ef043771e6da40b48dde907f1e205">argv_parse_cmd</a>(&amp;<a class="code" href="structargv.html">argv</a>, command);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="argv_8c.html#ad62a50a5c6133eaea0422cee6ba840cf">argv_printf_cat</a>(&amp;<a class="code" href="structargv.html">argv</a>, <span class="stringliteral">&quot;%s %d %d %s %s %s&quot;</span>, arg, tun_mtu, link_mtu,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        ifconfig_local, ifconfig_remote, <a class="code" href="structcontext.html">context</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <a class="code" href="argv_8c.html#a4d63823a8aeddf605a2e4a4a420e1dd4">argv_msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, &amp;<a class="code" href="structargv.html">argv</a>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <a class="code" href="run__command_8h.html#a3a933e13c7546d8b3d63042f3feba310">openvpn_run_script</a>(&amp;<a class="code" href="structargv.html">argv</a>, es, <a class="code" href="run__command_8h.html#a2a6d02b9ff0a76e78bf5c76834a29d89">S_FATAL</a>, <span class="stringliteral">&quot;--up/--down&quot;</span>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="argv_8c.html#a8563bed2ee30eda7125eee7bdb9ab4eb">argv_free</a>(&amp;<a class="code" href="structargv.html">argv</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;<a class="code" href="structargv.html#ae844a7fbae650ec7e67a8edcea262169">gc</a>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> * Should be called after options-&gt;ce is modified at the top</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> * of a SIGUSR1 restart.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="init_8c.html#a806d01fa4ef5f524a58ace959090142d">  193</a></span>&#160;<a class="code" href="init_8c.html#a806d01fa4ef5f524a58ace959090142d">update_options_ce_post</a>(<span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a>)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">     * In pull mode, we usually import --ping/--ping-restart parameters from</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">     * the server.  However we should also set an initial default --ping-restart</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">     * for the period of time before we pull the --ping-restart parameter</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">     * from the server.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">pull</a></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a96e979feb652ac4f21f59df5cf1ca108">ping_rec_timeout_action</a> == <a class="code" href="options_8h.html#abcdaecd776459d0a5d76b05a0054cd18">PING_UNDEF</a></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        &amp;&amp; <a class="code" href="socket_8c.html#adbff197bdb9734118cdf9889650477ae">proto_is_dgram</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>))</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac7d983496a189237f68f99e6816708c8">ping_rec_timeout</a> = <a class="code" href="ping_8h.html#a2f702ad5cbd6fd7490f79350cd3d0b37">PRE_PULL_INITIAL_PING_RESTART</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a96e979feb652ac4f21f59df5cf1ca108">ping_rec_timeout_action</a> = <a class="code" href="options_8h.html#a8e032ec08d6a5385f64a7f57eafd06c0">PING_RESTART</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="init_8c.html#a5c4a6e02a7ce255f07b18c8fa91165d1">  214</a></span>&#160;<a class="code" href="init_8c.html#a5c4a6e02a7ce255f07b18c8fa91165d1">management_callback_proxy_cmd</a>(<span class="keywordtype">void</span> *arg, <span class="keyword">const</span> <span class="keywordtype">char</span> **p)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;{</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *c = arg;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconnection__entry.html">connection_entry</a> *ce = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> *gc = &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ad4aeb5d46c4a32dc490a124af2c0770a">gc</a>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="otime_8h.html#ab47928897d13fd5569f20f0f8d068ce0">update_time</a>();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="options_8h.html#a4841717e2f45399a58c25188a1247c7a">streq</a>(p[1], <span class="stringliteral">&quot;NONE&quot;</span>))</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p[2] &amp;&amp; p[3])</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="options_8h.html#a4841717e2f45399a58c25188a1247c7a">streq</a>(p[1], <span class="stringliteral">&quot;HTTP&quot;</span>))</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keyword">struct </span><a class="code" href="structhttp__proxy__options.html">http_proxy_options</a> *ho;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keywordflow">if</span> (ce-&gt;<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a> != <a class="code" href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599a44547a13166ee3f0220fb3c4fc60e544">PROTO_TCP</a> &amp;&amp; ce-&gt;<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a> != <a class="code" href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599a4f54544a7b77bc839a23e1124f7e9c95">PROTO_TCP_CLIENT</a>)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;HTTP proxy support only works for TCP based connections&quot;</span>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            ho = <a class="code" href="proxy_8c.html#afe1f244314792f7cb0addf0d2a9e795f">init_http_proxy_options_once</a>(&amp;ce-&gt;<a class="code" href="structconnection__entry.html#a70c458a2aee1a9b085b2bc05281722e6">http_proxy_options</a>, gc);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            ho-&gt;<a class="code" href="structhttp__proxy__options.html#afa4d014cd5174ce3cc82947c54be8a54">server</a> = <a class="code" href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca">string_alloc</a>(p[2], gc);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            ho-&gt;<a class="code" href="structhttp__proxy__options.html#a5eec9078cb40b9e5839f7322a9f25b8b">port</a> = <a class="code" href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca">string_alloc</a>(p[3], gc);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            ho-&gt;<a class="code" href="structhttp__proxy__options.html#ab231c657d09bf5f0842af2d408dc3135">auth_retry</a> = (p[4] &amp;&amp; <a class="code" href="options_8h.html#a4841717e2f45399a58c25188a1247c7a">streq</a>(p[4], <span class="stringliteral">&quot;nct&quot;</span>) ? <a class="code" href="proxy_8h.html#a1c6ead53828182f53154be4dad1a9974">PAR_NCT</a> : <a class="code" href="proxy_8h.html#afd3fed7388af2b44a47465369b992731">PAR_ALL</a>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="options_8h.html#a4841717e2f45399a58c25188a1247c7a">streq</a>(p[1], <span class="stringliteral">&quot;SOCKS&quot;</span>))</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            ce-&gt;<a class="code" href="structconnection__entry.html#aacc02906ca3f2d2be9f28171bcd60452">socks_proxy_server</a> = <a class="code" href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca">string_alloc</a>(p[2], gc);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            ce-&gt;<a class="code" href="structconnection__entry.html#a524bd17937bd36d74874af04eef7f131">socks_proxy_port</a> = <a class="code" href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca">string_alloc</a>(p[3], gc);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;Bad proxy command&quot;</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    ce-&gt;<a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> &amp;= ~<a class="code" href="options_8h.html#a6f832667f1cde366f5b88caa08e457fa">CE_MAN_QUERY_PROXY</a>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="line" href="init_8c.html#a36115f317c9e0a45963d1aa9b2dd9da9">  260</a></span>&#160;<a class="code" href="init_8c.html#a36115f317c9e0a45963d1aa9b2dd9da9">ce_management_query_proxy</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;{</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structconnection__list.html">connection_list</a> *l = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a111f57f3a14727b141dc4d359cc02ea2">connection_list</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconnection__entry.html">connection_entry</a> *ce = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">bool</span> ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="otime_8h.html#ab47928897d13fd5569f20f0f8d068ce0">update_time</a>();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> out = <a class="code" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c">alloc_buf_gc</a>(256, &amp;gc);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;out, <span class="stringliteral">&quot;&gt;PROXY:%u,%s,%s&quot;</span>, (l ? l-&gt;<a class="code" href="structconnection__list.html#a4c93ccd743bba6ee89f05abc2b3008b0">current</a> : 0) + 1,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                       (<a class="code" href="socket_8c.html#a86424bdc75e8f05f00a649f30f897110">proto_is_udp</a>(ce-&gt;<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>) ? <span class="stringliteral">&quot;UDP&quot;</span> : <span class="stringliteral">&quot;TCP&quot;</span>), <a class="code" href="multi-auth_8c.html#a24e51cc1f9098289e2fe7317b7ab6b27">np</a>(ce-&gt;<a class="code" href="structconnection__entry.html#a474c4038934a015bdcb5b038b98b35d1">remote</a>));</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <a class="code" href="manage_8c.html#aa6413bcc39609b0f51090d792aea0454">management_notify_generic</a>(<a class="code" href="structmanagement.html">management</a>, <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;out));</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <a class="code" href="structmanagement.html">management</a>-&gt;<a class="code" href="structmanagement.html#a090962161ff1082218010728e25f2fd5">persist</a>.<a class="code" href="structman__persist.html#af00c1b9b0fcb84e3085c4be10aed542d">special_state_msg</a> = <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;out);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        ce-&gt;<a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> |= <a class="code" href="options_8h.html#a6f832667f1cde366f5b88caa08e457fa">CE_MAN_QUERY_PROXY</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">while</span> (ce-&gt;<a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> &amp; <a class="code" href="options_8h.html#a6f832667f1cde366f5b88caa08e457fa">CE_MAN_QUERY_PROXY</a>)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <a class="code" href="manage_8c.html#a83332dbcb123df4f813115349c276888">management_event_loop_n_seconds</a>(<a class="code" href="structmanagement.html">management</a>, 1);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(c))</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="structmanagement.html">management</a>-&gt;<a class="code" href="structmanagement.html#a090962161ff1082218010728e25f2fd5">persist</a>.<a class="code" href="structman__persist.html#af00c1b9b0fcb84e3085c4be10aed542d">special_state_msg</a> = NULL;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="init_8c.html#aeb934fcc37236813bbde6746b45708f1">  310</a></span>&#160;<a class="code" href="init_8c.html#aeb934fcc37236813bbde6746b45708f1">management_callback_send_cc_message</a>(<span class="keywordtype">void</span> *arg,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *command,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *parameters)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *c = (<span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *) arg;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">size_t</span> len = strlen(command) + 1 + strlen(parameters) + 1;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">if</span> (len &gt; <a class="code" href="common_8h.html#acffcd4cb515881c936f8b7092f235f3e">PUSH_BUNDLE_SIZE</a>)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> buf = <a class="code" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c">alloc_buf_gc</a>(<a class="code" href="structbuffer.html#ada52eab703a091ff327114b3b3b0140a">len</a>, &amp;gc);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(<a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;buf, <span class="stringliteral">&quot;%s&quot;</span>, command));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (parameters)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(<a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;buf, <span class="stringliteral">&quot;,%s&quot;</span>, parameters));</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a> = <a class="code" href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a>(c, <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;buf), <a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="init_8c.html#a09027bba2ec659835b859d8b4b54bc58">  335</a></span>&#160;<a class="code" href="init_8c.html#a09027bba2ec659835b859d8b4b54bc58">management_callback_remote_cmd</a>(<span class="keywordtype">void</span> *arg, <span class="keyword">const</span> <span class="keywordtype">char</span> **p)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;{</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *c = (<span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *) arg;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconnection__entry.html">connection_entry</a> *ce = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordtype">int</span> ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> (p[1] &amp;&amp; ((ce-&gt;<a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a>&gt;&gt;<a class="code" href="options_8h.html#a957713f97d301a5952ff94dfbec12f85">CE_MAN_QUERY_REMOTE_SHIFT</a>)&amp;<a class="code" href="options_8h.html#a7d9b7e8d8f0f60e0bbe4b2dbd2cf6dfa">CE_MAN_QUERY_REMOTE_MASK</a>) == <a class="code" href="options_8h.html#a1cc6b9295cead6f264ec42e35bb786fc">CE_MAN_QUERY_REMOTE_QUERY</a>)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> = 0;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">if</span> (!strcmp(p[1], <span class="stringliteral">&quot;ACCEPT&quot;</span>))</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> = <a class="code" href="options_8h.html#abdb8e8245d2cc5900fb064c5f371a5e9">CE_MAN_QUERY_REMOTE_ACCEPT</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(p[1], <span class="stringliteral">&quot;SKIP&quot;</span>))</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> = <a class="code" href="options_8h.html#a54e37a6d99074717a43aa65d8b1b2e83">CE_MAN_QUERY_REMOTE_SKIP</a>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(p[1], <span class="stringliteral">&quot;MOD&quot;</span>) &amp;&amp; p[2] &amp;&amp; p[3])</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">if</span> (strlen(p[2]) &lt; <a class="code" href="options_8h.html#aac0966b4ee4569318eb2fa0c1f2af10c">RH_HOST_LEN</a> &amp;&amp; strlen(p[3]) &lt; <a class="code" href="options_8h.html#a91dc7e314ac4ab9357585c15de7b48c8">RH_PORT_LEN</a>)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keyword">struct </span><a class="code" href="structremote__host__store.html">remote_host_store</a> *rhs = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a505d7766d3e0af765edf710f2a69b3a9">rh_store</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordflow">if</span> (!rhs)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    <a class="code" href="buffer_8h.html#ab4491b7f3124ff7b050e37c38c2e620b">ALLOC_OBJ_CLEAR_GC</a>(rhs, <span class="keyword">struct</span> <a class="code" href="structremote__host__store.html">remote_host_store</a>, &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a505d7766d3e0af765edf710f2a69b3a9">rh_store</a> = rhs;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                <a class="code" href="buffer_8h.html#acf5c0f0d704fd5b44b4d066044efb52c">strncpynt</a>(rhs-&gt;<a class="code" href="structremote__host__store.html#ab6854214ebc227e7b7bb7c326e20b8ea">host</a>, p[2], <a class="code" href="options_8h.html#aac0966b4ee4569318eb2fa0c1f2af10c">RH_HOST_LEN</a>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <a class="code" href="buffer_8h.html#acf5c0f0d704fd5b44b4d066044efb52c">strncpynt</a>(rhs-&gt;<a class="code" href="structremote__host__store.html#a2d542ea8cd04452e39d0d0134f9864d6">port</a>, p[3], <a class="code" href="options_8h.html#a91dc7e314ac4ab9357585c15de7b48c8">RH_PORT_LEN</a>);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                ce-&gt;<a class="code" href="structconnection__entry.html#a474c4038934a015bdcb5b038b98b35d1">remote</a> = rhs-&gt;<a class="code" href="structremote__host__store.html#ab6854214ebc227e7b7bb7c326e20b8ea">host</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                ce-&gt;<a class="code" href="structconnection__entry.html#aa399cea883d3a239190c049c004ad793">remote_port</a> = rhs-&gt;<a class="code" href="structremote__host__store.html#a2d542ea8cd04452e39d0d0134f9864d6">port</a>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                flags = <a class="code" href="options_8h.html#a6f5a418c90b160f847fa7683d0a54a59">CE_MAN_QUERY_REMOTE_MOD</a>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">if</span> (ret)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            ce-&gt;<a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> &amp;= ~(<a class="code" href="options_8h.html#a7d9b7e8d8f0f60e0bbe4b2dbd2cf6dfa">CE_MAN_QUERY_REMOTE_MASK</a>&lt;&lt;<a class="code" href="options_8h.html#a957713f97d301a5952ff94dfbec12f85">CE_MAN_QUERY_REMOTE_SHIFT</a>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            ce-&gt;<a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> |= ((flags&amp;<a class="code" href="options_8h.html#a7d9b7e8d8f0f60e0bbe4b2dbd2cf6dfa">CE_MAN_QUERY_REMOTE_MASK</a>)&lt;&lt;<a class="code" href="options_8h.html#a957713f97d301a5952ff94dfbec12f85">CE_MAN_QUERY_REMOTE_SHIFT</a>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="init_8c.html#a913cfd7844824eb629dc8d6920a6aef8">  382</a></span>&#160;<a class="code" href="init_8c.html#a913cfd7844824eb629dc8d6920a6aef8">ce_management_query_remote</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structconnection__entry.html">connection_entry</a> *ce = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordtype">int</span> ce_changed = <span class="keyword">true</span>; <span class="comment">/* presume the connection entry will be changed */</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="otime_8h.html#ab47928897d13fd5569f20f0f8d068ce0">update_time</a>();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> out = <a class="code" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c">alloc_buf_gc</a>(256, &amp;gc);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;out, <span class="stringliteral">&quot;&gt;REMOTE:%s,%s,%s&quot;</span>, <a class="code" href="multi-auth_8c.html#a24e51cc1f9098289e2fe7317b7ab6b27">np</a>(ce-&gt;<a class="code" href="structconnection__entry.html#a474c4038934a015bdcb5b038b98b35d1">remote</a>), ce-&gt;<a class="code" href="structconnection__entry.html#aa399cea883d3a239190c049c004ad793">remote_port</a>,</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                   <a class="code" href="socket_8c.html#a6ebb8e0bd35afb3cda6a0392f1479433">proto2ascii</a>(ce-&gt;<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>, ce-&gt;<a class="code" href="structconnection__entry.html#ac49b7ba49fbc7efd0d77535d1c66a7d9">af</a>, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <a class="code" href="manage_8c.html#aa6413bcc39609b0f51090d792aea0454">management_notify_generic</a>(<a class="code" href="structmanagement.html">management</a>, <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;out));</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <a class="code" href="structmanagement.html">management</a>-&gt;<a class="code" href="structmanagement.html#a090962161ff1082218010728e25f2fd5">persist</a>.<a class="code" href="structman__persist.html#af00c1b9b0fcb84e3085c4be10aed542d">special_state_msg</a> = <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;out);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        ce-&gt;<a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> &amp;= ~(<a class="code" href="options_8h.html#a7d9b7e8d8f0f60e0bbe4b2dbd2cf6dfa">CE_MAN_QUERY_REMOTE_MASK</a> &lt;&lt; <a class="code" href="options_8h.html#a957713f97d301a5952ff94dfbec12f85">CE_MAN_QUERY_REMOTE_SHIFT</a>);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        ce-&gt;<a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> |= (<a class="code" href="options_8h.html#a1cc6b9295cead6f264ec42e35bb786fc">CE_MAN_QUERY_REMOTE_QUERY</a> &lt;&lt; <a class="code" href="options_8h.html#a957713f97d301a5952ff94dfbec12f85">CE_MAN_QUERY_REMOTE_SHIFT</a>);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">while</span> (((ce-&gt;<a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> &gt;&gt; <a class="code" href="options_8h.html#a957713f97d301a5952ff94dfbec12f85">CE_MAN_QUERY_REMOTE_SHIFT</a>)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                &amp; <a class="code" href="options_8h.html#a7d9b7e8d8f0f60e0bbe4b2dbd2cf6dfa">CE_MAN_QUERY_REMOTE_MASK</a>) == <a class="code" href="options_8h.html#a1cc6b9295cead6f264ec42e35bb786fc">CE_MAN_QUERY_REMOTE_QUERY</a>)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <a class="code" href="manage_8c.html#a83332dbcb123df4f813115349c276888">management_event_loop_n_seconds</a>(<a class="code" href="structmanagement.html">management</a>, 1);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(c))</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                ce_changed = <span class="keyword">false</span>; <span class="comment">/* connection entry have not been set */</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <a class="code" href="structmanagement.html">management</a>-&gt;<a class="code" href="structmanagement.html#a090962161ff1082218010728e25f2fd5">persist</a>.<a class="code" href="structman__persist.html#af00c1b9b0fcb84e3085c4be10aed542d">special_state_msg</a> = NULL;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span> (ce_changed)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="comment">/* If it is likely a connection entry was modified,</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">         * check what changed in the flags and that it was not skipped</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> flags = ((ce-&gt;<a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> &gt;&gt; <a class="code" href="options_8h.html#a957713f97d301a5952ff94dfbec12f85">CE_MAN_QUERY_REMOTE_SHIFT</a>)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                           &amp; <a class="code" href="options_8h.html#a7d9b7e8d8f0f60e0bbe4b2dbd2cf6dfa">CE_MAN_QUERY_REMOTE_MASK</a>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        ce_changed = (flags != <a class="code" href="options_8h.html#a54e37a6d99074717a43aa65d8b1b2e83">CE_MAN_QUERY_REMOTE_SKIP</a>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">return</span> ce_changed;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;}</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ENABLE_MANAGEMENT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"> * Initialize and possibly randomize connection list.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="init_8c.html#ad0b5dc166d3a7e0d118bdf1771323674">  431</a></span>&#160;<a class="code" href="init_8c.html#ad0b5dc166d3a7e0d118bdf1771323674">init_connection_list</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;{</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconnection__list.html">connection_list</a> *l = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a111f57f3a14727b141dc4d359cc02ea2">connection_list</a>;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    l-&gt;<a class="code" href="structconnection__list.html#a4c93ccd743bba6ee89f05abc2b3008b0">current</a> = -1;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ad1253168302c07ba9e2c89e1bdff9547">remote_random</a>)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; l-&gt;<a class="code" href="structconnection__list.html#a7ec9bc2e47f7ac458a6a1ae17d0cf304">len</a>; ++i)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> j = <a class="code" href="crypto_8c.html#a37fb65e30bd2c33564b14ad76a0c0794">get_random</a>() % l-&gt;<a class="code" href="structconnection__list.html#a7ec9bc2e47f7ac458a6a1ae17d0cf304">len</a>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="keywordflow">if</span> (i != j)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                <span class="keyword">struct </span><a class="code" href="structconnection__entry.html">connection_entry</a> *tmp;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                tmp = l-&gt;<a class="code" href="structconnection__list.html#a57ecc9c713fcb3c347253dd3d86308b5">array</a>[i];</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                l-&gt;<a class="code" href="structconnection__list.html#a57ecc9c713fcb3c347253dd3d86308b5">array</a>[i] = l-&gt;<a class="code" href="structconnection__list.html#a57ecc9c713fcb3c347253dd3d86308b5">array</a>[j];</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                l-&gt;<a class="code" href="structconnection__list.html#a57ecc9c713fcb3c347253dd3d86308b5">array</a>[j] = tmp;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"> * Clear the remote address list</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="init_8c.html#a3e428634830c20841874c8143b46a2e4">  457</a></span>&#160;<a class="code" href="init_8c.html#a3e428634830c20841874c8143b46a2e4">clear_remote_addrlist</a>(<span class="keyword">struct</span> <a class="code" href="structlink__socket__addr.html">link_socket_addr</a> *lsa, <span class="keywordtype">bool</span> free)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;{</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">if</span> (lsa-&gt;<a class="code" href="structlink__socket__addr.html#a4eb1c90dc35a5fcd2952072cbe8f6c83">remote_list</a> &amp;&amp; free)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        freeaddrinfo(lsa-&gt;<a class="code" href="structlink__socket__addr.html#a4eb1c90dc35a5fcd2952072cbe8f6c83">remote_list</a>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    lsa-&gt;<a class="code" href="structlink__socket__addr.html#a4eb1c90dc35a5fcd2952072cbe8f6c83">remote_list</a> = NULL;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    lsa-&gt;<a class="code" href="structlink__socket__addr.html#a86eeebfb3c5eee93573fa9b577b12f7a">current_remote</a> = NULL;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;}</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"> * Increment to next connection entry</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="init_8c.html#a0c6a92888206f636e794b6d3c9edb343">  471</a></span>&#160;<a class="code" href="init_8c.html#a0c6a92888206f636e794b6d3c9edb343">next_connection_entry</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;{</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconnection__list.html">connection_list</a> *l = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a111f57f3a14727b141dc4d359cc02ea2">connection_list</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">bool</span> ce_defined;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keyword">struct </span><a class="code" href="structconnection__entry.html">connection_entry</a> *ce;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">int</span> n_cycles = 0;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        ce_defined = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#adb8ec5e44523e50a40777073262d41a2">no_advance</a> &amp;&amp; l-&gt;<a class="code" href="structconnection__list.html#a4c93ccd743bba6ee89f05abc2b3008b0">current</a> &gt;= 0)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#adb8ec5e44523e50a40777073262d41a2">no_advance</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="comment">/* Check if there is another resolved address to try for</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">             * the current connection */</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a86eeebfb3c5eee93573fa9b577b12f7a">current_remote</a></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a86eeebfb3c5eee93573fa9b577b12f7a">current_remote</a>-&gt;ai_next)</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a86eeebfb3c5eee93573fa9b577b12f7a">current_remote</a> =</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a86eeebfb3c5eee93573fa9b577b12f7a">current_remote</a>-&gt;ai_next;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="comment">/* FIXME (schwabe) fix the persist-remote-ip option for real,</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">                 * this is broken probably ever since connection lists and multiple</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">                 * remote existed</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">                 */</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ada37ffb590fc8620f2f5e8f9615defeb">persist_remote_ip</a>)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    <span class="comment">/* Connection entry addrinfo objects might have been</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">                     * resolved earlier but the entry itself might have been</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">                     * skipped by management on the previous loop.</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">                     * If so, clear the addrinfo objects as close_instance does</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">                     */</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a4eb1c90dc35a5fcd2952072cbe8f6c83">remote_list</a>)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                        <a class="code" href="init_8c.html#a3e428634830c20841874c8143b46a2e4">clear_remote_addrlist</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>,</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                              !c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a055000dd88801bd1be2262bf8b447ec9">resolve_in_advance</a>);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                    }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    <span class="comment">/* close_instance should have cleared the addrinfo objects */</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a86eeebfb3c5eee93573fa9b577b12f7a">current_remote</a> == NULL);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a4eb1c90dc35a5fcd2952072cbe8f6c83">remote_list</a> == NULL);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a86eeebfb3c5eee93573fa9b577b12f7a">current_remote</a> =</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a4eb1c90dc35a5fcd2952072cbe8f6c83">remote_list</a>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                <span class="comment">/*</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">                 * Increase the number of connection attempts</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">                 * If this is connect-retry-max * size(l)</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">                 * OpenVPN will quit</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">                 */</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6b6701741dc1e5698babf4ce474984f7">unsuccessful_attempts</a>++;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="keywordflow">if</span> (++l-&gt;<a class="code" href="structconnection__list.html#a4c93ccd743bba6ee89f05abc2b3008b0">current</a> &gt;= l-&gt;<a class="code" href="structconnection__list.html#a7ec9bc2e47f7ac458a6a1ae17d0cf304">len</a>)</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    l-&gt;<a class="code" href="structconnection__list.html#a4c93ccd743bba6ee89f05abc2b3008b0">current</a> = 0;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    <span class="keywordflow">if</span> (++n_cycles &gt;= 2)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;No usable connection profiles are present&quot;</span>);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        ce = l-&gt;<a class="code" href="structconnection__list.html#a57ecc9c713fcb3c347253dd3d86308b5">array</a>[l-&gt;<a class="code" href="structconnection__list.html#a4c93ccd743bba6ee89f05abc2b3008b0">current</a>];</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">if</span> (ce-&gt;<a class="code" href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">flags</a> &amp; <a class="code" href="options_8h.html#afcee9aa7bf8251da70176204a05d9f9b">CE_DISABLED</a>)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            ce_defined = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a> = *ce;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">if</span> (ce_defined &amp;&amp; <a class="code" href="structmanagement.html">management</a> &amp;&amp; <a class="code" href="manage_8h.html#a120badbf4a3d07337d53e6ece2d33b7d">management_query_remote_enabled</a>(<a class="code" href="structmanagement.html">management</a>))</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="comment">/* allow management interface to override connection entry details */</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            ce_defined = <a class="code" href="init_8c.html#a913cfd7844824eb629dc8d6920a6aef8">ce_management_query_remote</a>(c);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(c))</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ce_defined &amp;&amp; <a class="code" href="structmanagement.html">management</a> &amp;&amp; <a class="code" href="manage_8h.html#a3aad2fe946f1e8a079e442fc92b3e7a7">management_query_proxy_enabled</a>(<a class="code" href="structmanagement.html">management</a>))</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            ce_defined = <a class="code" href="init_8c.html#a36115f317c9e0a45963d1aa9b2dd9da9">ce_management_query_proxy</a>(c);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(c))</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    } <span class="keywordflow">while</span> (!ce_defined);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">/* Check if this connection attempt would bring us over the limit */</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8cf8cffcea3a27764644702bc382d35c">connect_retry_max</a> &gt; 0</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6b6701741dc1e5698babf4ce474984f7">unsuccessful_attempts</a> &gt; (l-&gt;<a class="code" href="structconnection__list.html#a7ec9bc2e47f7ac458a6a1ae17d0cf304">len</a>  * c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8cf8cffcea3a27764644702bc382d35c">connect_retry_max</a>))</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;All connections have been connect-retry-max (%d) times unsuccessful, exiting&quot;</span>,</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8cf8cffcea3a27764644702bc382d35c">connect_retry_max</a>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <a class="code" href="init_8c.html#a806d01fa4ef5f524a58ace959090142d">update_options_ce_post</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;}</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"> * Query for private key and auth-user-pass username/passwords</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00587"></a><span class="lineno"><a class="line" href="init_8h.html#a7876e414d4cb824cab1e8ad6b2c7c35c">  587</a></span>&#160;<a class="code" href="init_8c.html#a7876e414d4cb824cab1e8ad6b2c7c35c">init_query_passwords</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">/* Certificate password input */</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a69bd45d624f2701927f2d71589f402ee">key_pass_file</a>)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <a class="code" href="ssl_8c.html#abdf2bf9dc07fb2b93c112d29b2441659">pem_password_setup</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a69bd45d624f2701927f2d71589f402ee">key_pass_file</a>);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">/* Auth user/pass input */</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a80357ca49c6ac35d1ff5c621bd66ac96">auth_user_pass_file</a>)</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="ssl_8c.html#adeddfd12301fff7f7d0233e0d3875a83">enable_auth_user_pass</a>();</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <a class="code" href="ssl_8c.html#adf693b365b24d141b0d30053e3f25afa">auth_user_pass_setup</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a80357ca49c6ac35d1ff5c621bd66ac96">auth_user_pass_file</a>, &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a7934e68d00c2cf1aa45ca566ed163d71">sc_info</a>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <a class="code" href="ssl_8c.html#adf693b365b24d141b0d30053e3f25afa">auth_user_pass_setup</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a80357ca49c6ac35d1ff5c621bd66ac96">auth_user_pass_file</a>, NULL);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;}</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"> * Initialize/Uninitialize HTTP or SOCKS proxy</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="init_8c.html#ab9fa9b1c374767a587500f8b351548af">  614</a></span>&#160;<a class="code" href="init_8c.html#ab9fa9b1c374767a587500f8b351548af">uninit_proxy_dowork</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;{</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a4df958b48a25d1ceec216de0287cc7dd">http_proxy_owned</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa41670c0d47426f2b7630ecde06d509e">http_proxy</a>)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <a class="code" href="proxy_8c.html#a567500691abe4a2cb2a4d2efcd09310e">http_proxy_close</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa41670c0d47426f2b7630ecde06d509e">http_proxy</a>);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa41670c0d47426f2b7630ecde06d509e">http_proxy</a> = NULL;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a4df958b48a25d1ceec216de0287cc7dd">http_proxy_owned</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aaac4b2b8b2b667ffe53c32dcfb137144">socks_proxy_owned</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#af266db9e924917e0dab9ca0f01259df1">socks_proxy</a>)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <a class="code" href="socks_8c.html#afc9ad215c8de030df0dd7de7969510d1">socks_proxy_close</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#af266db9e924917e0dab9ca0f01259df1">socks_proxy</a>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#af266db9e924917e0dab9ca0f01259df1">socks_proxy</a> = NULL;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aaac4b2b8b2b667ffe53c32dcfb137144">socks_proxy_owned</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;}</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="init_8c.html#ad13e5c0bc1a51c802468a92b3ae66aa6">  631</a></span>&#160;<a class="code" href="init_8c.html#ad13e5c0bc1a51c802468a92b3ae66aa6">init_proxy_dowork</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;{</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordtype">bool</span> did_http = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="init_8c.html#ab9fa9b1c374767a587500f8b351548af">uninit_proxy_dowork</a>(c);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a70c458a2aee1a9b085b2bc05281722e6">http_proxy_options</a>)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="comment">/* Possible HTTP proxy user/pass input */</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa41670c0d47426f2b7630ecde06d509e">http_proxy</a> = <a class="code" href="proxy_8c.html#ae8c759f7897aee01596bafa797058945">http_proxy_new</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a70c458a2aee1a9b085b2bc05281722e6">http_proxy_options</a>);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa41670c0d47426f2b7630ecde06d509e">http_proxy</a>)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            did_http = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a4df958b48a25d1ceec216de0287cc7dd">http_proxy_owned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">if</span> (!did_http &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#aacc02906ca3f2d2be9f28171bcd60452">socks_proxy_server</a>)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#af266db9e924917e0dab9ca0f01259df1">socks_proxy</a> = <a class="code" href="socks_8c.html#adcc6f9ee8bd4825a6ffe8d9a8bc54dab">socks_proxy_new</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#aacc02906ca3f2d2be9f28171bcd60452">socks_proxy_server</a>,</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a524bd17937bd36d74874af04eef7f131">socks_proxy_port</a>,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a9f38a4424c365c8c9cb23f12f1b74806">socks_proxy_authfile</a>);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#af266db9e924917e0dab9ca0f01259df1">socks_proxy</a>)</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aaac4b2b8b2b667ffe53c32dcfb137144">socks_proxy_owned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;}</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="init_8c.html#ae6bf15962c96c4c75cec9baa6a20dc6a">  661</a></span>&#160;<a class="code" href="init_8c.html#ae6bf15962c96c4c75cec9baa6a20dc6a">init_proxy</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;{</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="init_8c.html#ad13e5c0bc1a51c802468a92b3ae66aa6">init_proxy_dowork</a>(c);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;}</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00667"></a><span class="lineno"><a class="line" href="init_8c.html#a04bb98ad987538a3b9a2db4f34e5063e">  667</a></span>&#160;<a class="code" href="init_8c.html#a04bb98ad987538a3b9a2db4f34e5063e">uninit_proxy</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;{</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <a class="code" href="init_8c.html#ab9fa9b1c374767a587500f8b351548af">uninit_proxy_dowork</a>(c);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment"> * Saves the initial state of NCP-regotiable</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment"> * options into a storage which persists over SIGUSR1.</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="init_8c.html#afbe8fb5ea05f1ae656b5d9e86b966451">  677</a></span>&#160;<a class="code" href="init_8c.html#afbe8fb5ea05f1ae656b5d9e86b966451">save_ncp_options</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;{</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#ad11841ba9d26ef246e5812a7a7db27b6">ciphername</a> = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a7f09235fee401590074265aff177491a">ciphername</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#ad9a55fafb79287621cc7dfde3851df49">authname</a> = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a3b2503d5f5f98a176450b3baf1953a20">authname</a>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a6f12c9d9f20f780524ecd9849e36a574">keysize</a> = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ae644c14875e0dd32c008a4685f3ee3e3">keysize</a>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;}</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">/* Restores NCP-negotiable options to original values */</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00686"></a><span class="lineno"><a class="line" href="init_8c.html#a102f942e503c6a61f394ad6e4c66a5d7">  686</a></span>&#160;<a class="code" href="init_8c.html#a102f942e503c6a61f394ad6e4c66a5d7">restore_ncp_options</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;{</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a7f09235fee401590074265aff177491a">ciphername</a> = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#ad11841ba9d26ef246e5812a7a7db27b6">ciphername</a>;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a3b2503d5f5f98a176450b3baf1953a20">authname</a> = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#ad9a55fafb79287621cc7dfde3851df49">authname</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ae644c14875e0dd32c008a4685f3ee3e3">keysize</a> = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a6f12c9d9f20f780524ecd9849e36a574">keysize</a>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;}</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00694"></a><span class="lineno"><a class="line" href="init_8h.html#a58388a630bb35708de3e8bd6ae4b9000">  694</a></span>&#160;<a class="code" href="init_8c.html#a58388a630bb35708de3e8bd6ae4b9000">context_init_1</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;{</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <a class="code" href="init_8c.html#a3333f41a29ff31266dce5dc83396ee5b">context_clear_1</a>(c);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <a class="code" href="openvpn_8h.html#a65137f59c4038945b8df98139a6cef77">packet_id_persist_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa20a2b143b3a7f2db2cc9a1af3cdf3e2">pid_persist</a>);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <a class="code" href="init_8c.html#ad0b5dc166d3a7e0d118bdf1771323674">init_connection_list</a>(c);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="init_8c.html#afbe8fb5ea05f1ae656b5d9e86b966451">save_ncp_options</a>(c);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="preprocessor">#if defined(ENABLE_PKCS11)</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a>)</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        pkcs11_initialize(<span class="keyword">true</span>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.pkcs11_pin_cache_period);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keywordflow">for</span> (i = 0; i&lt;<a class="code" href="options_8h.html#abc112140dccf35b37370da1791c3d8c3">MAX_PARMS</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.pkcs11_providers[i] != NULL; i++)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            pkcs11_addProvider(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.pkcs11_providers[i], c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.pkcs11_protected_authentication[i],</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                               c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.pkcs11_private_mode[i], c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.pkcs11_cert_private[i]);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="preprocessor">#if 0 </span><span class="comment">/* test get_user_pass with GET_USER_PASS_NEED_OK flag */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">         * In the management interface, you can okay the request by entering &quot;needok token-insertion-request ok&quot;</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keyword">struct </span><a class="code" href="structuser__pass.html">user_pass</a> up;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(up);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        strcpy(up.<a class="code" href="structuser__pass.html#afd95ee9ee0c23614ce570b8bca3ad0e9">username</a>, <span class="stringliteral">&quot;Please insert your cryptographic token&quot;</span>); <span class="comment">/* put the high-level message in up.username */</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <a class="code" href="misc_8h.html#ad06b994f06c422312b8612eadad51f50">get_user_pass</a>(&amp;up, NULL, <span class="stringliteral">&quot;token-insertion-request&quot;</span>, <a class="code" href="misc_8h.html#a2918bca6e88a6f6a9908dfb2e4beea43">GET_USER_PASS_MANAGEMENT</a>|<a class="code" href="misc_8h.html#aa3b9382e904cb704e27839af86ec6019">GET_USER_PASS_NEED_OK</a>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;RET:%s&quot;</span>, up.<a class="code" href="structuser__pass.html#adccfd3c88600d76b99aa88926f3fb131">password</a>); <span class="comment">/* will return the third argument to management interface</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">                                             * &#39;needok&#39; command, usually &#39;ok&#39; or &#39;cancel&#39;. */</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="preprocessor">#ifdef ENABLE_SYSTEMD</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">/* We can report the PID via getpid() to systemd here as OpenVPN will not</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">     * do any fork due to daemon() a future call.</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">     * See possibly_become_daemon() [init.c] for more details.</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    sd_notifyf(0, <span class="stringliteral">&quot;READY=1\nSTATUS=Pre-connection initialization successful\nMAINPID=%lu&quot;</span>,</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;               (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) getpid());</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;}</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="init_8h.html#a6e6b19367c9c40f7c22c5d5addf2f962">  743</a></span>&#160;<a class="code" href="init_8c.html#a6e6b19367c9c40f7c22c5d5addf2f962">context_gc_free</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;{</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ad4aeb5d46c4a32dc490a124af2c0770a">gc</a>);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">gc</a>);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;c-&gt;<a class="code" href="structcontext.html#ad2b1fffbd57d0ba779aa9b5ef8a9c78d">gc</a>);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;}</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="preprocessor">#if PORT_SHARE</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;close_port_share(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;{</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">if</span> (port_share)</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        port_share_close(port_share);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        port_share = NULL;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;}</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;init_port_share(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;{</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">if</span> (!port_share &amp;&amp; (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.port_share_host &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.port_share_port))</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        port_share = port_share_open(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.port_share_host,</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                                     c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.port_share_port,</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                                     <a class="code" href="mtu_8h.html#a7f2c5e48f4bac08cafc93ad2d906221b">MAX_RW_SIZE_LINK</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>),</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                                     c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.port_share_journal_dir);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keywordflow">if</span> (port_share == NULL)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;Fatal error: Port sharing failed&quot;</span>);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;}</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* if PORT_SHARE */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00782"></a><span class="lineno"><a class="line" href="init_8h.html#aaf57aca5b6d652ab6f00af4b9a746c38">  782</a></span>&#160;<a class="code" href="init_8c.html#aaf57aca5b6d652ab6f00af4b9a746c38">init_static</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;{</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">/* configure_path (); */</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="preprocessor">#if defined(DMALLOC)</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    crypto_init_dmalloc();</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">     * Initialize random number seed.  random() is only used</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">     * when &quot;weak&quot; random numbers are acceptable.</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">     * SSL library routines are always used when cryptographically</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">     * strong random numbers are required.</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keyword">struct </span>timeval tv;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (!gettimeofday(&amp;tv, NULL))</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> seed = (<span class="keywordtype">unsigned</span> int) tv.tv_sec ^ tv.tv_usec;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <a class="code" href="syshead_8h.html#a36b803e0123070cccb24a3fe98994b16">srandom</a>(seed);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <a class="code" href="openvpn_2error_8c.html#a0b40f361c449800d74f89d1c14dfa3cc">error_reset</a>();              <span class="comment">/* initialize error.c */</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <a class="code" href="openvpn_2error_8c.html#ac013439368e05d67a8515f9a6295359c">reset_check_status</a>();       <span class="comment">/* initialize status check code in socket.c */</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <a class="code" href="win32_8c.html#a8f32d3babe165d21d5e2d5fb9877e3a5">init_win32</a>();</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="preprocessor">#ifdef OPENVPN_DEBUG_COMMAND_LINE</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; argc; ++i)</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;argv[%d] = &#39;%s&#39;&quot;</span>, i, <a class="code" href="structargv.html">argv</a>[i]);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    }</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <a class="code" href="otime_8h.html#ab47928897d13fd5569f20f0f8d068ce0">update_time</a>();</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <a class="code" href="ssl_8c.html#abe608677ee7a8169f4d3402444fa1cd0">init_ssl_lib</a>();</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="comment">/* init PRNG used for IV generation */</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="comment">/* When forking, copy this to more places in the code to avoid fork</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">     * random-state predictability */</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <a class="code" href="crypto_8c.html#ab99dea190ad93a642a0fc5a429b8f0ed">prng_init</a>(NULL, 0);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="preprocessor">#ifdef PID_TEST</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    packet_id_interactive_test();       <span class="comment">/* test the sequence number code */</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="preprocessor">#ifdef SCHEDULE_TEST</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    schedule_test();</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="preprocessor">#ifdef LIST_TEST</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    list_test();</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="preprocessor">#ifdef IFCONFIG_POOL_TEST</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    ifconfig_pool_test(0x0A010004, 0x0A0100FF);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="preprocessor">#ifdef CHARACTER_CLASS_DEBUG</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    character_class_debug();</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor">#ifdef EXTRACT_X509_FIELD_TEST</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="ssl_8h.html#aa398f159e1dca57893fbfd67ad24a512">extract_x509_field_test</a>();</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="preprocessor">#ifdef TIME_TEST</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <a class="code" href="otime_8h.html#ace107c9b76ee90e28373c1a313bc11d9">time_test</a>();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="preprocessor">#ifdef TEST_GET_DEFAULT_GATEWAY</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keyword">struct </span><a class="code" href="structroute__gateway__info.html">route_gateway_info</a> rgi;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keyword">struct </span><a class="code" href="structroute__ipv6__gateway__info.html">route_ipv6_gateway_info</a> rgi6;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <a class="code" href="route_8c.html#a79f572aab37f656876a0ea96120aa320">get_default_gateway</a>(&amp;rgi);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <a class="code" href="route_8c.html#a482ac780b2d08fc96aa2547a9902b1a8">get_default_gateway_ipv6</a>(&amp;rgi6, NULL);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <a class="code" href="route_8c.html#a7d24ae5eacf30d776d7c7dd91b43428c">print_default_gateway</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, &amp;rgi, &amp;rgi6);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="preprocessor">#ifdef GEN_PATH_TEST</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *fn = gen_path(<span class="stringliteral">&quot;foo&quot;</span>,</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                                  <span class="stringliteral">&quot;bar&quot;</span>,</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                                  &amp;gc);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        printf(<span class="stringliteral">&quot;%s\n&quot;</span>, fn);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="preprocessor">#ifdef STATUS_PRINTF_TEST</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *tmp_file = <a class="code" href="platform_8c.html#a4bfdae25f711f8c20daf740b3fb4e045">platform_create_temp_file</a>(<span class="stringliteral">&quot;/tmp&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>, &amp;gc);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keyword">struct </span><a class="code" href="structstatus__output.html">status_output</a> *so = <a class="code" href="status_8c.html#ab196e92cac48e356eab474978232e453">status_open</a>(tmp_file, 0, -1, NULL, <a class="code" href="status_8h.html#a2f6001bad7228f20b8e74d5aace81085">STATUS_OUTPUT_WRITE</a>);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <a class="code" href="status_8c.html#a8d855058c1a32820d55c92ecee2289cd">status_printf</a>(so, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <a class="code" href="status_8c.html#a8d855058c1a32820d55c92ecee2289cd">status_printf</a>(so, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="status_8c.html#af524160156e0aa1ba6f4666bddb4bbd9">status_close</a>(so))</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;STATUS_PRINTF_TEST: %s: write error&quot;</span>, tmp_file);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="preprocessor">#ifdef PRNG_TEST</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <a class="code" href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a> rndbuf[8];</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <a class="code" href="crypto_8c.html#ab99dea190ad93a642a0fc5a429b8f0ed">prng_init</a>(<span class="stringliteral">&quot;sha1&quot;</span>, 16);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="comment">/*prng_init (NULL, 0);*/</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> factor = 1;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; factor * 8; ++i)</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <a class="code" href="crypto_8c.html#a1d7c04eddcc6269ed0f1e76fe3f9ce0f">prng_bytes</a>(rndbuf, <span class="keyword">sizeof</span>(rndbuf));</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(<a class="code" href="crypto__backend_8h.html#a8a19f717f5824ff4455b6925af81299c">rand_bytes</a>(rndbuf, <span class="keyword">sizeof</span>(rndbuf)));</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            printf(<span class="stringliteral">&quot;[%d] %s\n&quot;</span>, i, <a class="code" href="buffer_8h.html#ae3916f38b92823f35c1a1bea1aac378e">format_hex</a>(rndbuf, <span class="keyword">sizeof</span>(rndbuf), 0, &amp;gc));</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <a class="code" href="crypto_8c.html#ae8c523b770f0e2f30d44004797106508">prng_uninit</a>();</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ifdef PRNG_TEST */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="preprocessor">#ifdef BUFFER_LIST_AGGREGATE_TEST</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">/* test buffer_list_aggregate function */</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *text[] = {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <span class="stringliteral">&quot;It was a bright cold day in April, &quot;</span>,</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <span class="stringliteral">&quot;and the clocks were striking &quot;</span>,</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <span class="stringliteral">&quot;thirteen. &quot;</span>,</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <span class="stringliteral">&quot;Winston Smith, &quot;</span>,</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <span class="stringliteral">&quot;his chin nuzzled into his breast in an &quot;</span>,</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <span class="stringliteral">&quot;effort to escape the vile wind, &quot;</span>,</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <span class="stringliteral">&quot;slipped quickly through the glass doors &quot;</span>,</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            <span class="stringliteral">&quot;of Victory Mansions, though not quickly &quot;</span>,</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <span class="stringliteral">&quot;enough to prevent a swirl of gritty dust from &quot;</span>,</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="stringliteral">&quot;entering along with him.&quot;</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        };</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="keywordtype">int</span> iter, listcap;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="keywordflow">for</span> (listcap = 0; listcap &lt; 12; ++listcap)</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <span class="keywordflow">for</span> (iter = 0; iter &lt; 512; ++iter)</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                <span class="keyword">struct </span><a class="code" href="structbuffer__list.html">buffer_list</a> *bl = <a class="code" href="buffer_8c.html#a802172b567a3ac89a544452fe02a45bf">buffer_list_new</a>(listcap);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="openvpn_2basic_8h.html#afd2537d19a3cb6556b0f727580ec6ee7">SIZE</a>(text); ++i)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                    {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                        <a class="code" href="buffer_8c.html#ad797dd5e6257e3f4f4b4e7394dc2dfa9">buffer_list_push</a>(bl, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)text[i]);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                    }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                printf(<span class="stringliteral">&quot;[cap=%d i=%d] *************************\n&quot;</span>, listcap, iter);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                <span class="keywordflow">if</span> (!(iter &amp; 8))</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    <a class="code" href="buffer_8c.html#a2269d0f9d34d67a509c29c505e44ee2b">buffer_list_aggregate</a>(bl, iter/2);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                <span class="keywordflow">if</span> (!(iter &amp; 16))</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                    <a class="code" href="buffer_8c.html#ad797dd5e6257e3f4f4b4e7394dc2dfa9">buffer_list_push</a>(bl, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<span class="stringliteral">&quot;Even more text...&quot;</span>);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                }</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                <a class="code" href="buffer_8c.html#a2269d0f9d34d67a509c29c505e44ee2b">buffer_list_aggregate</a>(bl, iter);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                <span class="keywordflow">if</span> (!(iter &amp; 1))</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                    <a class="code" href="buffer_8c.html#ad797dd5e6257e3f4f4b4e7394dc2dfa9">buffer_list_push</a>(bl, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<span class="stringliteral">&quot;More text...&quot;</span>);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                }</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                {</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                    <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> *buf;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                    <span class="keywordflow">while</span> ((buf = <a class="code" href="buffer_8c.html#a1a7d06931a18e800e86ba7c2145f2f12">buffer_list_peek</a>(bl)))</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                    {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                        <span class="keywordtype">int</span> c;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                        printf(<span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                        <span class="keywordflow">while</span> ((c = <a class="code" href="buffer_8h.html#ab7b6746dd30a4cfaf4a9218f42c6dabe">buf_read_u8</a>(buf)) &gt;= 0)</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                        {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                            putchar(c);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                        }</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                        printf(<span class="stringliteral">&quot;&#39;\n&quot;</span>);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                        <a class="code" href="buffer_8c.html#a110fbabcea4a371d6408ac164af94367">buffer_list_advance</a>(bl, 0);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                    }</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                <a class="code" href="buffer_8c.html#a83e3bf61c9804dc763bbe7ac9fdd08b0">buffer_list_free</a>(bl);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ifdef BUFFER_LIST_AGGREGATE_TEST */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="preprocessor">#ifdef MSTATS_TEST</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        mstats_open(<span class="stringliteral">&quot;/dev/shm/mstats.dat&quot;</span>);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 30; ++i)</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            mmap_stats-&gt;n_clients += 1;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            mmap_stats-&gt;link_write_bytes += 8;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;            mmap_stats-&gt;link_read_bytes += 16;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <a class="code" href="syshead_8h.html#a82b8e21bd452d01ad6d32a0d73fbfdc8">sleep</a>(1);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        mstats_close();</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;}</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"><a class="line" href="init_8h.html#a69da0027cf5c712abfc06b7e4f41a7b3"> 1011</a></span>&#160;<a class="code" href="init_8c.html#a69da0027cf5c712abfc06b7e4f41a7b3">uninit_static</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;{</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="ssl_8c.html#ac19d79dce177648026a5a8abf27f521d">free_ssl_lib</a>();</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="preprocessor">#ifdef ENABLE_PKCS11</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    pkcs11_terminate();</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="preprocessor">#if PORT_SHARE</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    close_port_share();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="preprocessor">#if defined(MEASURE_TLS_HANDSHAKE_STATS)</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    show_tls_performance_stats();</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"><a class="line" href="init_8h.html#a164331d37fecc9ad095eae0e8dce53de"> 1029</a></span>&#160;<a class="code" href="init_8c.html#a164331d37fecc9ad095eae0e8dce53de">init_verb_mute</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags)</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;{</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="init_8h.html#a5066d160ca7be6632e188a5044eeba09">IVM_LEVEL_1</a>)</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        <span class="comment">/* set verbosity and mute levels */</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        <a class="code" href="openvpn_2error_8c.html#ab76eae70d91e60b44b8c6478c72baae5">set_check_status</a>(<a class="code" href="errlevel_8h.html#afb139197853f179439ffc6d0ccaf0fdd">D_LINK_ERRORS</a>, <a class="code" href="errlevel_8h.html#abe74dee3b7a9490bbbf2e9ce72f3718a">D_READ_WRITE</a>);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        <a class="code" href="openvpn_2error_8c.html#af250e34abb4c2f896fcfa37e10aaeebf">set_debug_level</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ae86dddeb121da4d534e9705c2fa063fc">verbosity</a>, <a class="code" href="openvpn_2error_8h.html#a2e211f58831bf4b3ebe6e33d35d02b05">SDL_CONSTRAIN</a>);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <a class="code" href="openvpn_2error_8c.html#aa24606a2ec1cb6e454a387c4fd709545">set_mute_cutoff</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a4262860a03a36842bb63d1d3dae60e2d">mute</a>);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="comment">/* special D_LOG_RW mode */</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="init_8h.html#a2fde4b1cea35c1d5ecc1dfcc4ac16a38">IVM_LEVEL_2</a>)</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#acfe86f2a045249246aeda38971cbceaa">log_rw</a> = (<a class="code" href="openvpn_2error_8h.html#a7b09cca005dc641923899a6baa0d6e3c">check_debug_level</a>(<a class="code" href="errlevel_8h.html#ae4c9a74306b42f3348401bf4ede9e9c0">D_LOG_RW</a>) &amp;&amp; !<a class="code" href="openvpn_2error_8h.html#a7b09cca005dc641923899a6baa0d6e3c">check_debug_level</a>(<a class="code" href="errlevel_8h.html#ae4c9a74306b42f3348401bf4ede9e9c0">D_LOG_RW</a> + 1));</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    }</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;}</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment"> * Possibly set --dev based on --dev-node.</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment"> * For example, if --dev-node /tmp/foo/tun, and --dev undefined,</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment"> * set --dev to tun.</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"><a class="line" href="init_8h.html#a71d85953b4bd00f0071015c2ecce3dc3"> 1052</a></span>&#160;<a class="code" href="init_8c.html#a71d85953b4bd00f0071015c2ecce3dc3">init_options_dev</a>(<span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a>)</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;{</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a> &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ad1e91361004780f9f9c8bf2e8d7180f4">dev_node</a>)</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordtype">char</span> *dev_node = <a class="code" href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca">string_alloc</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ad1e91361004780f9f9c8bf2e8d7180f4">dev_node</a>, NULL); <span class="comment">/* POSIX basename() implementations may modify its arguments */</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a> = <a class="code" href="compat-basename_8c.html#ac29c0b4b98013197963f0fb479dc0360">basename</a>(dev_node);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    }</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;}</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"><a class="line" href="init_8h.html#a8e6926f8074e0ab4b54ff2eb47cca9b7"> 1062</a></span>&#160;<a class="code" href="init_8c.html#a8e6926f8074e0ab4b54ff2eb47cca9b7">print_openssl_info</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a>)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;{</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">     * OpenSSL info print mode?</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a98fc9a0879158d9aaf12696ff8726b35">show_ciphers</a> || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a4aa894e058d4e005aa5c533183f86439">show_digests</a> || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6627153e6bb2d0952fce58f65ee07329">show_engines</a></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a73c23de77b777cbd7a59bea56f1ee366">show_tls_ciphers</a> || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a916e724576aa058a30902dc1c34862e8">show_curves</a>)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a98fc9a0879158d9aaf12696ff8726b35">show_ciphers</a>)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <a class="code" href="crypto__backend_8h.html#a3ec944116f6654d1ca69afb933f4418b">show_available_ciphers</a>();</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a4aa894e058d4e005aa5c533183f86439">show_digests</a>)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <a class="code" href="crypto__backend_8h.html#af252e66e3834a956ab00264d7aa3e282">show_available_digests</a>();</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6627153e6bb2d0952fce58f65ee07329">show_engines</a>)</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            <a class="code" href="crypto__backend_8h.html#a194e1ecb3b8a6267eaedd2d885114b39">show_available_engines</a>();</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a73c23de77b777cbd7a59bea56f1ee366">show_tls_ciphers</a>)</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            <a class="code" href="ssl_8c.html#af75a6085c60ee6926f3000781e2089c3">show_available_tls_ciphers</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#abd58a7a4b0ea3e30121218d08ba6c9f9">cipher_list</a>,</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                                       <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ab89e9276f4be407b43cda6d95b49226e">cipher_list_tls13</a>,</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                       <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a74fd79cb23d82f4e47840ea1568aade3">tls_cert_profile</a>);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a916e724576aa058a30902dc1c34862e8">show_curves</a>)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            <a class="code" href="ssl__backend_8h.html#a4c6eeb6ed5aa07f2f93d28d88c77dfb8">show_available_curves</a>();</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;}</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment"> * Static pre-shared key generation mode?</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"><a class="line" href="init_8h.html#a095a721e463c315c4dbdebd50358abd0"> 1101</a></span>&#160;<a class="code" href="init_8c.html#a095a721e463c315c4dbdebd50358abd0">do_genkey</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a>)</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;{</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="comment">/* should we disable paging? */</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#aa016b4614f03c9fc02b643846812bbc7">mlock</a> &amp;&amp; (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c99b66271ee7577a665de983a3d6346">genkey</a>))</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <a class="code" href="platform_8c.html#a81c983ed37e32842f86b6677e3b830ba">platform_mlockall</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    }</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">     * We do not want user to use --genkey with --secret. In the transistion</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">     * phase we for secret.</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c99b66271ee7577a665de983a3d6346">genkey</a> &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#afa8198209f419fdc2b37c3d11a7d7852">genkey_type</a> != <a class="code" href="options_8h.html#a9c6881e2e86f302489916b1fa05b627aa328347907cf8af2f9404a719acf99fd7">GENKEY_SECRET</a></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af4f6ab25d97dd623648d3c2342659e0d">shared_secret_file</a>)</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a446cccfde267d5f96d18513d217286fe">M_USAGE</a>, <span class="stringliteral">&quot;Using --genkey type with --secret filename is &quot;</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <span class="stringliteral">&quot;not supported.  Use --genkey type filename instead.&quot;</span>);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    }</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c99b66271ee7577a665de983a3d6346">genkey</a> &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#afa8198209f419fdc2b37c3d11a7d7852">genkey_type</a> == <a class="code" href="options_8h.html#a9c6881e2e86f302489916b1fa05b627aa328347907cf8af2f9404a719acf99fd7">GENKEY_SECRET</a>)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keywordtype">int</span> nbits_written;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *genkey_filename = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac1cc609fa36b2e22998af855c8c12e97">genkey_filename</a>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af4f6ab25d97dd623648d3c2342659e0d">shared_secret_file</a> &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac1cc609fa36b2e22998af855c8c12e97">genkey_filename</a>)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a446cccfde267d5f96d18513d217286fe">M_USAGE</a>, <span class="stringliteral">&quot;You must provide a filename to either --genkey &quot;</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                <span class="stringliteral">&quot;or --secret, not both&quot;</span>);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">         * Copy filename from shared_secret_file to genkey_filename to support</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">         * the old --genkey --secret foo.file syntax.</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af4f6ab25d97dd623648d3c2342659e0d">shared_secret_file</a>)</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: Using --genkey --secret filename is &quot;</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                <span class="stringliteral">&quot;DEPRECATED.  Use --genkey secret filename instead.&quot;</span>);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            genkey_filename = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af4f6ab25d97dd623648d3c2342659e0d">shared_secret_file</a>;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        nbits_written = <a class="code" href="crypto_8c.html#a81c00d1ee124bc52b54b6b3082fba96e">write_key_file</a>(2, genkey_filename);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordflow">if</span> (nbits_written &lt; 0)</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;Failed to write key file&quot;</span>);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160; </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#aab8b5b527fa4e3cdc68897cc57e01dac">D_GENKEY</a> | <a class="code" href="openvpn_2error_8h.html#a39772a2bdab0bd56c1b6dd518a65c2c3">M_NOPREFIX</a>,</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <span class="stringliteral">&quot;Randomly generated %d bit key written to %s&quot;</span>, nbits_written,</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af4f6ab25d97dd623648d3c2342659e0d">shared_secret_file</a>);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    }</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c99b66271ee7577a665de983a3d6346">genkey</a> &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#afa8198209f419fdc2b37c3d11a7d7852">genkey_type</a> == <a class="code" href="options_8h.html#a9c6881e2e86f302489916b1fa05b627aaa3fe6359df3225108eb498611fe2dbe2">GENKEY_TLS_CRYPTV2_SERVER</a>)</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <a class="code" href="group__tls__crypt.html#gabc1250a0d15da5d5b50f49f1aec7ef19">tls_crypt_v2_write_server_key_file</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac1cc609fa36b2e22998af855c8c12e97">genkey_filename</a>);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    }</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c99b66271ee7577a665de983a3d6346">genkey</a> &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#afa8198209f419fdc2b37c3d11a7d7852">genkey_type</a> == <a class="code" href="options_8h.html#a9c6881e2e86f302489916b1fa05b627aacb8e8ccf1788376766a166614aba251d">GENKEY_TLS_CRYPTV2_CLIENT</a>)</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    {</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a55380b90dad74714c58db877537238ee">tls_crypt_v2_file</a>)</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a446cccfde267d5f96d18513d217286fe">M_USAGE</a>,</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                <span class="stringliteral">&quot;--genkey tls-crypt-v2-client requires a server key to be set via --tls-crypt-v2 to create a client key&quot;</span>);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <a class="code" href="group__tls__crypt.html#ga7c2e1553c38344d7858a9dcf062f7f54">tls_crypt_v2_write_client_key_file</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac1cc609fa36b2e22998af855c8c12e97">genkey_filename</a>,</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                           <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a084474ef1254a1571f1da2b7c42f4d51">genkey_extra_data</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a55380b90dad74714c58db877537238ee">tls_crypt_v2_file</a>,</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                           <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#add35f7d415b4722cb856774cc959dc52">tls_crypt_v2_file_inline</a>);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c99b66271ee7577a665de983a3d6346">genkey</a> &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#afa8198209f419fdc2b37c3d11a7d7852">genkey_type</a> == <a class="code" href="options_8h.html#a9c6881e2e86f302489916b1fa05b627aa2abd9ec10d68997a7334d8e0a61e18f0">GENKEY_AUTH_TOKEN</a>)</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <a class="code" href="auth__token_8c.html#a3c1f33bc014ff76d54a50720ef0f8711">auth_token_write_server_key_file</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac1cc609fa36b2e22998af855c8c12e97">genkey_filename</a>);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;}</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment"> * Persistent TUN/TAP device management mode?</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"><a class="line" href="init_8h.html#aa7f085114efc1767f2cff733b82508ed"> 1184</a></span>&#160;<a class="code" href="init_8c.html#aa7f085114efc1767f2cff733b82508ed">do_persist_tuntap</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a>, <a class="code" href="networking_8h.html#aff0b513686f6c72428bbca270ce87a77">openvpn_net_ctx_t</a> *ctx)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;{</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a0fa2c5ba57c9ffb4a898bafc3725e88f">persist_config</a>)</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <span class="comment">/* sanity check on options for --mktun or --rmtun */</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <a class="code" href="options_8c.html#ae678cc28cf97c0517fe75b612f57e28a">notnull</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a>, <span class="stringliteral">&quot;TUN/TAP device (--dev)&quot;</span>);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a474c4038934a015bdcb5b038b98b35d1">remote</a> || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6c5eef6691660bf4aa7618c2a5485558">ifconfig_local</a></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ae70b5eee99cad7ca77438a457078d62c">ifconfig_remote_netmask</a></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af4f6ab25d97dd623648d3c2342659e0d">shared_secret_file</a></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;            || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8cc67b442d93909bc5500945a8ac08ff">tls_server</a> || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a92cffd160044d2b84a1085fa3ddb9a2d">tls_client</a></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            )</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>|<a class="code" href="openvpn_2error_8h.html#a02fdddb17b95f31a428bf1f989df57f5">M_OPTERR</a>,</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                <span class="stringliteral">&quot;options --mktun or --rmtun should only be used together with --dev&quot;</span>);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="preprocessor">#ifdef ENABLE_FEATURE_TUN_PERSIST</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        <a class="code" href="tun_8h.html#afef2adbc3d7467cec1a651e1d513f227">tuncfg</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a46085bfaf25d5996f2f21c7553411a65">dev_type</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ad1e91361004780f9f9c8bf2e8d7180f4">dev_node</a>,</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;               <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a46e9ecdbdf449d7298f3fe42d587b5f4">persist_mode</a>,</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;               <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8388094487ff9931a91eb02e7fa8d472">username</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#add57437239b837341d533dac68982743">groupname</a>, &amp;<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7464e4dafe3c9f80b09c620c83f22227">tuntap_options</a>,</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;               ctx);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a46e9ecdbdf449d7298f3fe42d587b5f4">persist_mode</a> &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ae774b572dbe4d6eb691db24d6cbd3481">lladdr</a>)</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        {</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            <a class="code" href="lladdr_8c.html#acb6e2182e310c1ace3822972beb591bd">set_lladdr</a>(ctx, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ae774b572dbe4d6eb691db24d6cbd3481">lladdr</a>, NULL);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="preprocessor">#else  </span><span class="comment">/* ifdef ENABLE_FEATURE_TUN_PERSIST */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>( <a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>|<a class="code" href="openvpn_2error_8h.html#a02fdddb17b95f31a428bf1f989df57f5">M_OPTERR</a>,</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;             <span class="stringliteral">&quot;options --mktun and --rmtun are not available on your operating &quot;</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;             <span class="stringliteral">&quot;system.  Please check &#39;man tun&#39; (or &#39;tap&#39;), whether your system &quot;</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;             <span class="stringliteral">&quot;supports using &#39;ifconfig %s create&#39; / &#39;destroy&#39; to create/remove &quot;</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;             <span class="stringliteral">&quot;persistent tunnel interfaces.&quot;</span>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a> );</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;}</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment"> * Should we become a daemon?</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment"> * Return true if we did it.</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"><a class="line" href="init_8h.html#acd4b5343f4f2c63b813a3f67d2c3ef46"> 1225</a></span>&#160;<a class="code" href="init_8c.html#acd4b5343f4f2c63b813a3f67d2c3ef46">possibly_become_daemon</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a>)</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;{</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="preprocessor">#ifdef ENABLE_SYSTEMD</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="comment">/* return without forking if we are running from systemd */</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordflow">if</span> (sd_notify(0, <span class="stringliteral">&quot;READY=0&quot;</span>) &gt; 0)</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    }</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a17176de9689460974a9eb1e7df7fb020">daemon</a>)</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    {</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(!<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a313ef9730dd723427ca9ab74896109a6">inetd</a>);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="comment">/* Don&#39;t chdir immediately, but the end of the init sequence, if needed */</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="compat-daemon_8c.html#af298996def620cbda4cd529988218cb0">daemon</a>(1, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac409c0cbee0a011db8215dc8c9bf6a9d">log</a>) &lt; 0)</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        {</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ab5286dbd1378331f3d1c3a0522b6a43f">M_ERR</a>, <span class="stringliteral">&quot;daemon() failed or unsupported&quot;</span>);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <a class="code" href="sig_8c.html#a90955f1d36eb2dbcc7aacb204d5ea523">restore_signal_state</a>();</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac409c0cbee0a011db8215dc8c9bf6a9d">log</a>)</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        {</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            <a class="code" href="misc_8c.html#a6e7deed7d2affb7c6a734ec2aea7951d">set_std_files_to_null</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;}</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment"> * Actually do UID/GID downgrade, chroot and SELinux context switching, if requested.</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"><a class="line" href="init_8c.html#a169d584d7f1127019c1aaf17091e3e61"> 1260</a></span>&#160;<a class="code" href="init_8c.html#a169d584d7f1127019c1aaf17091e3e61">do_uid_gid_chroot</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keywordtype">bool</span> no_delay)</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;{</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> why_not[] = <span class="stringliteral">&quot;will be delayed because of --client, --pull, or --up-delay&quot;</span>;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="keyword">struct </span><a class="code" href="structcontext__0.html">context_0</a> *c0 = c-&gt;<a class="code" href="structcontext.html#a1d0cd1cb672a5fee441bdc504fc0fa93">c0</a>;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">if</span> (c0 &amp;&amp; !c0-&gt;<a class="code" href="structcontext__0.html#adf83164d54c6c56957e5550a45b63338">uid_gid_chroot_set</a>)</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <span class="comment">/* chroot if requested */</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ac37a2848b8a1a91de9dfde7c1c9d8fa5">chroot_dir</a>)</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        {</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            <span class="keywordflow">if</span> (no_delay)</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <a class="code" href="platform_8c.html#a82c8419a350edc0a41c53bb0d495235f">platform_chroot</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ac37a2848b8a1a91de9dfde7c1c9d8fa5">chroot_dir</a>);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a>)</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;NOTE: chroot %s&quot;</span>, why_not);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            }</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="comment">/* set user and/or group if we want to setuid/setgid */</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="keywordflow">if</span> (c0-&gt;<a class="code" href="structcontext__0.html#af599a649761ec7fd83b5aa3dab4a502e">uid_gid_specified</a>)</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        {</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            <span class="keywordflow">if</span> (no_delay)</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                <a class="code" href="platform_8c.html#a9fa1294012cccd23c3d8145837883057">platform_group_set</a>(&amp;c0-&gt;<a class="code" href="structcontext__0.html#a2b214a974983a9c9f74e3c80dc1f0161">platform_state_group</a>);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                <a class="code" href="platform_8c.html#a99cf5236d05fa18d32f2b7790c9e7cb4">platform_user_set</a>(&amp;c0-&gt;<a class="code" href="structcontext__0.html#a663b5e3cf38a4fc003b34fed87e9555c">platform_state_user</a>);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            }</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a>)</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            {</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;NOTE: UID/GID downgrade %s&quot;</span>, why_not);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            }</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="preprocessor">#ifdef ENABLE_MEMSTATS</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.memstats_fn)</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            mstats_open(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.memstats_fn);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        }</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="preprocessor">#ifdef ENABLE_SELINUX</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="comment">/* Apply a SELinux context in order to restrict what OpenVPN can do</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">         * to _only_ what it is supposed to do after initialization is complete</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">         * (basically just network I/O operations). Doing it after chroot</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">         * requires /proc to be mounted in the chroot (which is annoying indeed</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">         * but doing it before requires more complex SELinux policies.</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.selinux_context)</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            <span class="keywordflow">if</span> (no_delay)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                <span class="keywordflow">if</span> (-1 == setcon(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.selinux_context))</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ab5286dbd1378331f3d1c3a0522b6a43f">M_ERR</a>, <span class="stringliteral">&quot;setcon to &#39;%s&#39; failed; is /proc accessible?&quot;</span>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.selinux_context);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;setcon to &#39;%s&#39; succeeded&quot;</span>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.selinux_context);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a>)</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            {</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;NOTE: setcon %s&quot;</span>, why_not);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            }</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <span class="comment">/* Privileges are going to be dropped by now (if requested), be sure</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment">         * to prevent any future privilege dropping attempts from now on.</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="keywordflow">if</span> (no_delay)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            c0-&gt;<a class="code" href="structcontext__0.html#adf83164d54c6c56957e5550a45b63338">uid_gid_chroot_set</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        }</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    }</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;}</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment"> * Return common name in a way that is formatted for</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment"> * prepending to msg() output.</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *</div>
<div class="line"><a name="l01343"></a><span class="lineno"><a class="line" href="init_8h.html#a2ba15f7443831872eb1200f9b945d158"> 1343</a></span>&#160;<a class="code" href="init_8c.html#a2ba15f7443831872eb1200f9b945d158">format_common_name</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">struct</span> <a class="code" href="structgc__arena.html">gc_arena</a> *gc)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;{</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbuffer.html">buffer</a> out = <a class="code" href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c">alloc_buf_gc</a>(256, gc);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>)</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <a class="code" href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a>(&amp;out, <span class="stringliteral">&quot;[%s] &quot;</span>, <a class="code" href="ssl__verify_8c.html#af3b8a3f413dbfc086e05cc5b09efb998">tls_common_name</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>, <span class="keyword">false</span>));</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a>(&amp;out);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;}</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160; </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"><a class="line" href="init_8h.html#a59a07bcc9f2a989620749a9742d5330b"> 1354</a></span>&#160;<a class="code" href="init_8c.html#a59a07bcc9f2a989620749a9742d5330b">pre_setup</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a>)</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;{</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a3bebca31ab113909af281557e2854820">exit_event_name</a>)</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    {</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <a class="code" href="win32_8c.html#a1d275db1b13e814e051e72d0572a437c">win32_signal_open</a>(&amp;<a class="code" href="structwin32__signal.html">win32_signal</a>,</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                          <a class="code" href="win32_8h.html#a85379b8442b837a6cb5638874f0eeb05">WSO_FORCE_SERVICE</a>,</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                          <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a3bebca31ab113909af281557e2854820">exit_event_name</a>,</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                          <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a78da4b42325fb1037a4e3e0f07a76c99">exit_event_initial_state</a>);</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    }</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <a class="code" href="win32_8c.html#a1d275db1b13e814e051e72d0572a437c">win32_signal_open</a>(&amp;<a class="code" href="structwin32__signal.html">win32_signal</a>,</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                          <a class="code" href="win32_8h.html#aa266d0aadfd92744f1737efd29dcb9c5">WSO_FORCE_CONSOLE</a>,</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                          NULL,</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                          <span class="keyword">false</span>);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="comment">/* put a title on the top window bar */</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structwin32__signal.html">win32_signal</a>.<a class="code" href="structwin32__signal.html#ae1315d34c8036d2abf42b59d943ab1d0">mode</a> == <a class="code" href="win32_8h.html#a4646ba90c8db4e373568cd773cd6f575">WSO_MODE_CONSOLE</a>)</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            <a class="code" href="win32_8c.html#a38e77ce645f0df53b453d5a6e76acc57">window_title_save</a>(&amp;<a class="code" href="structwindow__title.html">window_title</a>);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            <a class="code" href="win32_8c.html#a2265f1473daf634b6c54a12ed1d1fda1">window_title_generate</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ab10b9cdcad048c3ef63cdae7ffd09444">config</a>);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    }</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ifdef _WIN32 */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;}</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"><a class="line" href="init_8h.html#a5eea9a05e4580cb48e8b0daad33c59fe"> 1382</a></span>&#160;<a class="code" href="init_8c.html#a5eea9a05e4580cb48e8b0daad33c59fe">reset_coarse_timers</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;{</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7a1136ef8707e675d479855614eadb10">coarse_timer_wakeup</a> = 0;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;}</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment"> * Initialise the server poll timeout timer</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment"> * This timer is used in the http/socks proxy setup so it needs to be setup</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment"> * before</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"><a class="line" href="init_8c.html#aa178c8a6f722ca1be6e847e1310f3897"> 1393</a></span>&#160;<a class="code" href="init_8c.html#aa178c8a6f722ca1be6e847e1310f3897">do_init_server_poll_timeout</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;{</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <a class="code" href="otime_8h.html#ab47928897d13fd5569f20f0f8d068ce0">update_time</a>();</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a51429ed22fd30ac08ed94d0df42f46e2">connect_timeout</a>)</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <a class="code" href="interval_8h.html#a2a19b468bda9494ddab767cf6a81f201">event_timeout_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a1aeeedd8cd4780c69f7626bcb81f4b90">server_poll_interval</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a51429ed22fd30ac08ed94d0df42f46e2">connect_timeout</a>, <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;}</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment"> * Initialize timers</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"><a class="line" href="init_8c.html#a4ce16743e82e7bcab17fe41d03b3fd44"> 1406</a></span>&#160;<a class="code" href="init_8c.html#a4ce16743e82e7bcab17fe41d03b3fd44">do_init_timers</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keywordtype">bool</span> deferred)</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;{</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <a class="code" href="otime_8h.html#ab47928897d13fd5569f20f0f8d068ce0">update_time</a>();</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <a class="code" href="init_8c.html#a5eea9a05e4580cb48e8b0daad33c59fe">reset_coarse_timers</a>(c);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160; </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="comment">/* initialize inactivity timeout */</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6ac631694e763190d479679978e19c08">inactivity_timeout</a>)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <a class="code" href="interval_8h.html#a2a19b468bda9494ddab767cf6a81f201">event_timeout_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aee3f1b158710abd4c3020369b56b9f7a">inactivity_interval</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6ac631694e763190d479679978e19c08">inactivity_timeout</a>, <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="comment">/* initialize pings */</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#acee62ed6d25e482506731cada8f1ecaa">ping_send_timeout</a>)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <a class="code" href="interval_8h.html#a2a19b468bda9494ddab767cf6a81f201">event_timeout_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a32c2fe431b3437e963b149780188174f">ping_send_interval</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#acee62ed6d25e482506731cada8f1ecaa">ping_send_timeout</a>, 0);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    }</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ac7d983496a189237f68f99e6816708c8">ping_rec_timeout</a>)</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <a class="code" href="interval_8h.html#a2a19b468bda9494ddab767cf6a81f201">event_timeout_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#af7d86fdde3cc1792be2bd85e735a2676">ping_rec_interval</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ac7d983496a189237f68f99e6816708c8">ping_rec_timeout</a>, <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    }</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="keywordflow">if</span> (!deferred)</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <span class="comment">/* initialize connection establishment timer */</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <a class="code" href="interval_8h.html#a2a19b468bda9494ddab767cf6a81f201">event_timeout_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a6e148857a12de912aef0d3476a85baea">wait_for_connect</a>, 1, <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="comment">/* initialize occ timers */</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160; </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#af42951e43928baf71be50f6d6680358a">occ</a></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            &amp;&amp; !<a class="code" href="openvpn_8h.html#a21ce4ae478838de79c2470ff07c22288">TLS_MODE</a>(c)</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;            &amp;&amp; c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a04ff4807150572d100c753bb76b47b1b">options_string_local</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2cf3b03b810f97b5ee02e92dd9682589">options_string_remote</a>)</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        {</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            <a class="code" href="interval_8h.html#a2a19b468bda9494ddab767cf6a81f201">event_timeout_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa60bf2f20efb63adcd121d2d8abebd27">occ_interval</a>, <a class="code" href="occ_8h.html#ade72809df06131abb19efa249b48ae42">OCC_INTERVAL_SECONDS</a>, <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>);</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        }</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ab706c7c232f46620eb6f20e3846c21f6">mtu_test</a>)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            <a class="code" href="interval_8h.html#a2a19b468bda9494ddab767cf6a81f201">event_timeout_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a1ae023240723f91c19a2376e890c302e">occ_mtu_load_test_interval</a>, <a class="code" href="occ_8h.html#a0f99ca3b587db5d145244969973521e8">OCC_MTU_LOAD_INTERVAL_SECONDS</a>, <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>);</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <span class="comment">/* initialize packet_id persistence timer */</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a5463781f357b5c1c13070e92645c6194">packet_id_file</a>)</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            <a class="code" href="interval_8h.html#a2a19b468bda9494ddab767cf6a81f201">event_timeout_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ab43cb5718dec488e16b44b0646d12a83">packet_id_persist_interval</a>, 60, <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        }</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160; </div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        <span class="comment">/* initialize tmp_int optimization that limits the number of times we call</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment">         * tls_multi_process in the main event loop */</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        <a class="code" href="interval_8c.html#aabf9bc926cf4d0888ea85e6224103c3a">interval_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a5fd70b82d77870b98844a107ce3cf7dd">tmp_int</a>, <a class="code" href="ssl_8h.html#aa72b1d36bfe00e33ecb2656035cbd718">TLS_MULTI_HORIZON</a>, <a class="code" href="ssl_8h.html#ababe78be9417be84f1523f5f98b9a0fe">TLS_MULTI_REFRESH</a>);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    }</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;}</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment"> * Initialize traffic shaper.</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"><a class="line" href="init_8c.html#a3b4a0a2b9abc79b1a2ea53ecc6125303"> 1464</a></span>&#160;<a class="code" href="init_8c.html#a3b4a0a2b9abc79b1a2ea53ecc6125303">do_init_traffic_shaper</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;{</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="preprocessor">#ifdef ENABLE_FEATURE_SHAPER</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">/* initialize traffic shaper (i.e. transmit bandwidth limiter) */</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a2bdc0d25499a3e547741c2a3ab06ba97">shaper</a>)</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        shaper_init(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a6ff63ee9b82d8fa423db071e6fa0fa7e">shaper</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a2bdc0d25499a3e547741c2a3ab06ba97">shaper</a>);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <a class="code" href="shaper_8c.html#a78b8c75f51364fbf22082f54c6e2bcf0">shaper_msg</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a6ff63ee9b82d8fa423db071e6fa0fa7e">shaper</a>);</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    }</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;}</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="comment"> * Allocate route list structures for IPv4 and IPv6</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment"> * (we do this for IPv4 even if no --route option has been seen, as other</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment"> * parts of OpenVPN might want to fill the route-list with info, e.g. DHCP)</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"><a class="line" href="init_8c.html#a55e5b704206c7d367d7f87593b67cde0"> 1482</a></span>&#160;<a class="code" href="init_8c.html#a55e5b704206c7d367d7f87593b67cde0">do_alloc_route_list</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;{</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a5fce2b35dc960bcdc0cab91b278048f7">route_list</a>)</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    {</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <a class="code" href="buffer_8h.html#ab4491b7f3124ff7b050e37c38c2e620b">ALLOC_OBJ_CLEAR_GC</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a5fce2b35dc960bcdc0cab91b278048f7">route_list</a>, <span class="keyword">struct</span> <a class="code" href="structroute__list.html">route_list</a>, &amp;c-&gt;<a class="code" href="structcontext.html#ad2b1fffbd57d0ba779aa9b5ef8a9c78d">gc</a>);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    }</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ad3572f352bd2aa332207cddfdc607ff4">routes_ipv6</a> &amp;&amp; !c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a987a02f5590d85e75031d36a6dc2fe5c">route_ipv6_list</a>)</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    {</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        <a class="code" href="buffer_8h.html#ab4491b7f3124ff7b050e37c38c2e620b">ALLOC_OBJ_CLEAR_GC</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a987a02f5590d85e75031d36a6dc2fe5c">route_ipv6_list</a>, <span class="keyword">struct</span> <a class="code" href="structroute__ipv6__list.html">route_ipv6_list</a>, &amp;c-&gt;<a class="code" href="structcontext.html#ad2b1fffbd57d0ba779aa9b5ef8a9c78d">gc</a>);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    }</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;}</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160; </div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment"> * Initialize the route list, resolving any DNS names in route</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment"> * options and saving routes in the environment.</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"><a class="line" href="init_8c.html#a0670147c5b4477a7b449df5dc36d1855"> 1500</a></span>&#160;<a class="code" href="init_8c.html#a0670147c5b4477a7b449df5dc36d1855">do_init_route_list</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a>,</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                   <span class="keyword">struct</span> <a class="code" href="structroute__list.html">route_list</a> *<a class="code" href="structroute__list.html">route_list</a>,</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                   <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlink__socket__info.html">link_socket_info</a> *<a class="code" href="structlink__socket__info.html">link_socket_info</a>,</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                   <span class="keyword">struct</span> <a class="code" href="structenv__set.html">env_set</a> *es,</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                   <a class="code" href="networking_8h.html#aff0b513686f6c72428bbca270ce87a77">openvpn_net_ctx_t</a> *ctx)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;{</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *gw = NULL;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="keywordtype">int</span> dev = <a class="code" href="tun_8c.html#a167ef5d50e4284066beb05f5466bd858">dev_type_enum</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a46085bfaf25d5996f2f21c7553411a65">dev_type</a>);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keywordtype">int</span> metric = 0;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">if</span> (dev == <a class="code" href="proto_8h.html#a7bd06f1b39bc1fa6f63378e4cf00bac0">DEV_TYPE_TUN</a> &amp;&amp; (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7a75e271f54a80de7c345599e69bcfe9">topology</a> == <a class="code" href="proto_8h.html#a5432683e30ddc0abd4deb132f20477df">TOP_NET30</a> || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7a75e271f54a80de7c345599e69bcfe9">topology</a> == <a class="code" href="proto_8h.html#ac294ee23be7863f7b64a51ad6971bfc5">TOP_P2P</a>))</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        gw = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ae70b5eee99cad7ca77438a457078d62c">ifconfig_remote_netmask</a>;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a781486d9be15f2560d4f73e5eb822db7">route_default_gateway</a>)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        gw = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a781486d9be15f2560d4f73e5eb822db7">route_default_gateway</a>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    }</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a1853e40c6a50fe479d6f0cb8e0a97216">route_default_metric</a>)</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        metric = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a1853e40c6a50fe479d6f0cb8e0a97216">route_default_metric</a>;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="route_8c.html#aaf3c1abc7823f84b83ec11c5de232e9c">init_route_list</a>(<a class="code" href="structroute__list.html">route_list</a>,</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                        <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a599b21d6f45322992703af0b4e12741e">routes</a>,</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                        gw,</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                        metric,</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                        <a class="code" href="socket_8c.html#aac12ee565b36579ed3bd5dc9377e35b2">link_socket_current_remote</a>(<a class="code" href="structlink__socket__info.html">link_socket_info</a>),</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                        es,</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                        ctx))</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    {</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="comment">/* copy routes to environment */</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <a class="code" href="route_8c.html#aef4915408d31ea4a260b875e960ef3cb">setenv_routes</a>(es, <a class="code" href="structroute__list.html">route_list</a>);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;}</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"><a class="line" href="init_8c.html#a2d77fd4177bf5b5b4eb7914038c2d82b"> 1537</a></span>&#160;<a class="code" href="init_8c.html#a2d77fd4177bf5b5b4eb7914038c2d82b">do_init_route_ipv6_list</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a>,</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                        <span class="keyword">struct</span> <a class="code" href="structroute__ipv6__list.html">route_ipv6_list</a> *<a class="code" href="structroute__ipv6__list.html">route_ipv6_list</a>,</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlink__socket__info.html">link_socket_info</a> *<a class="code" href="structlink__socket__info.html">link_socket_info</a>,</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;                        <span class="keyword">struct</span> <a class="code" href="structenv__set.html">env_set</a> *es,</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                        <a class="code" href="networking_8h.html#aff0b513686f6c72428bbca270ce87a77">openvpn_net_ctx_t</a> *ctx)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;{</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *gw = NULL;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordtype">int</span> metric = -1;            <span class="comment">/* no metric set */</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    gw = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a128e966186c103e2d5dc456b90647420">ifconfig_ipv6_remote</a>;         <span class="comment">/* default GW = remote end */</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a9252a0ebe6f96e66e7c7cb947cf16645">route_ipv6_default_gateway</a>)</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    {</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        gw = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a9252a0ebe6f96e66e7c7cb947cf16645">route_ipv6_default_gateway</a>;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a1853e40c6a50fe479d6f0cb8e0a97216">route_default_metric</a>)</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    {</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        metric = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a1853e40c6a50fe479d6f0cb8e0a97216">route_default_metric</a>;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    }</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="comment">/* redirect (IPv6) gateway to VPN?  if yes, add a few more specifics</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ad3572f352bd2aa332207cddfdc607ff4">routes_ipv6</a>-&gt;<a class="code" href="structroute__ipv6__option__list.html#a04b38996423c8facdac8c843fae37a17">flags</a> &amp; <a class="code" href="route_8h.html#ab07d6bb8e6ac70ec4345c4790b2f7945">RG_REROUTE_GW</a>)</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        <span class="keywordtype">char</span> *opt_list[] = { <span class="stringliteral">&quot;::/3&quot;</span>, <span class="stringliteral">&quot;2000::/4&quot;</span>, <span class="stringliteral">&quot;3000::/4&quot;</span>, <span class="stringliteral">&quot;fc00::/7&quot;</span>, NULL };</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        <span class="keywordflow">for</span> (i = 0; opt_list[i]; i++)</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;            <a class="code" href="route_8c.html#a479e469a922c8a2ca4ddc596840ea9ba">add_route_ipv6_to_option_list</a>( <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ad3572f352bd2aa332207cddfdc607ff4">routes_ipv6</a>,</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                                           <a class="code" href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca">string_alloc</a>(opt_list[i], <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ad3572f352bd2aa332207cddfdc607ff4">routes_ipv6</a>-&gt;<a class="code" href="structroute__ipv6__option__list.html#a8dcffed95f93c2a93747de1d9e165999">gc</a>),</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                                           NULL, NULL );</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    }</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="route_8c.html#a6a96e2d57770d4096ab35549eaf66258">init_route_ipv6_list</a>(<a class="code" href="structroute__ipv6__list.html">route_ipv6_list</a>,</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                             <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ad3572f352bd2aa332207cddfdc607ff4">routes_ipv6</a>,</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                             gw,</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                             metric,</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                             <a class="code" href="socket_8c.html#afb62f9fc3adfae5d11fcc9e57650d3ad">link_socket_current_remote_ipv6</a>(<a class="code" href="structlink__socket__info.html">link_socket_info</a>),</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                             es,</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                             ctx))</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    {</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="comment">/* copy routes to environment */</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <a class="code" href="route_8c.html#a1da011e5f99e883c8cd3e400ccb7d619">setenv_routes_ipv6</a>(es, <a class="code" href="structroute__ipv6__list.html">route_ipv6_list</a>);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    }</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;}</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; </div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment"> * Called after all initialization has been completed.</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"><a class="line" href="init_8h.html#a0efe2bfd4ac02795b81d7aafe116fd25"> 1590</a></span>&#160;<a class="code" href="init_8c.html#a0efe2bfd4ac02795b81d7aafe116fd25">initialization_sequence_completed</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags)</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;{</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> message[] = <span class="stringliteral">&quot;Initialization Sequence Completed&quot;</span>;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="comment">/* Reset the unsuccessful connection counter on complete initialisation */</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6b6701741dc1e5698babf4ce474984f7">unsuccessful_attempts</a> = 0;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="comment">/* If we delayed UID/GID downgrade or chroot, do it now */</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <a class="code" href="init_8c.html#a169d584d7f1127019c1aaf17091e3e61">do_uid_gid_chroot</a>(c, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160; </div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="comment">/* Test if errors */</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="init_8h.html#a296e92a38befc01c2716f5b97aeb4b3d">ISC_ERRORS</a>)</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        <a class="code" href="route_8c.html#a5d725239839720fa55f3921c74098fa3">show_routes</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>|<a class="code" href="openvpn_2error_8h.html#a39772a2bdab0bd56c1b6dd518a65c2c3">M_NOPREFIX</a>);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <a class="code" href="tun_8c.html#a6f5544632174db40d087aaf55d70f5c6">show_adapters</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>|<a class="code" href="openvpn_2error_8h.html#a39772a2bdab0bd56c1b6dd518a65c2c3">M_NOPREFIX</a>);</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;%s With Errors ( see http://openvpn.net/faq.html#dhcpclientserv )&quot;</span>, message);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="preprocessor">#ifdef ENABLE_SYSTEMD</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        sd_notifyf(0, <span class="stringliteral">&quot;STATUS=Failed to start up: %s With Errors\nERRNO=1&quot;</span>, message);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_SYSTEMD_SD_DAEMON_H */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;%s With Errors&quot;</span>, message);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    }</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="preprocessor">#ifdef ENABLE_SYSTEMD</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        sd_notifyf(0, <span class="stringliteral">&quot;STATUS=%s&quot;</span>, message);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;%s&quot;</span>, message);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160; </div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    <span class="comment">/* Flag that we initialized */</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="keywordflow">if</span> ((flags &amp; (<a class="code" href="init_8h.html#a296e92a38befc01c2716f5b97aeb4b3d">ISC_ERRORS</a>|<a class="code" href="init_8h.html#ab2740fb90ab4f2983813d8cb9351de8e">ISC_SERVER</a>)) == 0)</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    {</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#adb8ec5e44523e50a40777073262d41a2">no_advance</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    }</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160; </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <a class="code" href="tun_8c.html#a18e98c6a82bdccea18fe3d6c3475ed43">fork_register_dns_action</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">/* Tell management interface that we initialized */</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    {</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <a class="code" href="config-msvc_8h.html#a64ca7e440847b0f5d19cbe94f9e114bd">in_addr_t</a> *tun_local = NULL;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        <span class="keyword">struct </span>in6_addr *tun_local6 = NULL;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="keyword">struct </span><a class="code" href="structopenvpn__sockaddr.html">openvpn_sockaddr</a> local, remote;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        <span class="keyword">struct </span><a class="code" href="structlink__socket__actual.html">link_socket_actual</a> *actual;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        socklen_t sa_len = <span class="keyword">sizeof</span>(local);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *detail = <span class="stringliteral">&quot;SUCCESS&quot;</span>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        <span class="keywordflow">if</span> (flags &amp; <a class="code" href="init_8h.html#a296e92a38befc01c2716f5b97aeb4b3d">ISC_ERRORS</a>)</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        {</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            detail = <span class="stringliteral">&quot;ERROR&quot;</span>;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        }</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160; </div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(local);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        actual = &amp;<a class="code" href="forward_8h.html#a75a6c09ea9647b5fc1829683c4483bd2">get_link_socket_info</a>(c)-&gt;<a class="code" href="structlink__socket__info.html#a3000ece81909a84b167b6e6f1fd54fd5">lsa</a>-&gt;<a class="code" href="structlink__socket__addr.html#a31cf151a4d7544429e7740cbda55193c">actual</a>;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        remote = actual-&gt;<a class="code" href="structlink__socket__actual.html#abf5bf8e6a58e0af01a0ca0675e2a2a5c">dest</a>;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        getsockname(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>-&gt;<a class="code" href="structlink__socket.html#aef0ab7aed42bb525241ae838e98ce8cd">sd</a>, &amp;local.<a class="code" href="structopenvpn__sockaddr.html#ad1adf8548f410507490b0bf17f93e3ea">addr</a>.<a class="code" href="structopenvpn__sockaddr.html#abc5254db5ef7e60854146a476054abe1">sa</a>, &amp;sa_len);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="preprocessor">#if ENABLE_IP_PKTINFO</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="socket_8h.html#ab06be2882f62f51cd0212029a84aba09">addr_defined</a>(&amp;local))</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        {</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            <span class="keywordflow">switch</span> (local.<a class="code" href="structopenvpn__sockaddr.html#ad1adf8548f410507490b0bf17f93e3ea">addr</a>.<a class="code" href="structopenvpn__sockaddr.html#abc5254db5ef7e60854146a476054abe1">sa</a>.sa_family)</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            {</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                <span class="keywordflow">case</span> AF_INET:</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="preprocessor">#if defined(HAVE_IN_PKTINFO) &amp;&amp; defined(HAVE_IPI_SPEC_DST)</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                    local.<a class="code" href="structopenvpn__sockaddr.html#ad1adf8548f410507490b0bf17f93e3ea">addr</a>.<a class="code" href="structopenvpn__sockaddr.html#ae8fa2e6454c8c93b86eda19abca112b3">in4</a>.sin_addr = actual-&gt;pi.in4.ipi_spec_dst;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                    local.<a class="code" href="structopenvpn__sockaddr.html#ad1adf8548f410507490b0bf17f93e3ea">addr</a>.<a class="code" href="structopenvpn__sockaddr.html#ae8fa2e6454c8c93b86eda19abca112b3">in4</a>.sin_addr = actual-&gt;pi.in4;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160; </div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                <span class="keywordflow">case</span> AF_INET6:</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                    local.<a class="code" href="structopenvpn__sockaddr.html#ad1adf8548f410507490b0bf17f93e3ea">addr</a>.<a class="code" href="structopenvpn__sockaddr.html#afcdd41c2aad5907c7041ffdb59ed46aa">in6</a>.sin6_addr = actual-&gt;pi.in6.ipi6_addr;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            }</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        }</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>)</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            tun_local = &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#a310bbe962b4610e99c122fc7147bfbd4">local</a>;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            tun_local6 = &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#ab854704d9efd886f25b7a0083b0196c6">local_ipv6</a>;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        }</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        <a class="code" href="manage_8c.html#a8ad93473fd4ba6402ecea847d69afae1">management_set_state</a>(<a class="code" href="structmanagement.html">management</a>,</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                             <a class="code" href="manage_8h.html#a5ebe89a25083180eb735c308c265a477">OPENVPN_STATE_CONNECTED</a>,</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                             detail,</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                             tun_local,</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                             tun_local6,</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                             &amp;local,</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;                             &amp;remote);</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        <span class="keywordflow">if</span> (tun_local)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            <a class="code" href="manage_8c.html#af967391d82b8095326136311cb24d635">management_post_tunnel_open</a>(<a class="code" href="structmanagement.html">management</a>, *tun_local);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    }</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ifdef ENABLE_MANAGEMENT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;}</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; </div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment"> * Possibly add routes and/or call route-up script</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment"> * based on options.</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"><a class="line" href="init_8h.html#a72b3b82c87f67f0574e741fc3d70a5b6"> 1696</a></span>&#160;<a class="code" href="init_8c.html#a72b3b82c87f67f0574e741fc3d70a5b6">do_route</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a>,</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;         <span class="keyword">struct</span> <a class="code" href="structroute__list.html">route_list</a> *<a class="code" href="structroute__list.html">route_list</a>,</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;         <span class="keyword">struct</span> <a class="code" href="structroute__ipv6__list.html">route_ipv6_list</a> *<a class="code" href="structroute__ipv6__list.html">route_ipv6_list</a>,</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;         <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtuntap.html">tuntap</a> *tt,</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;         <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structplugin__list.html">plugin_list</a> *plugins,</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;         <span class="keyword">struct</span> <a class="code" href="structenv__set.html">env_set</a> *es,</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;         <a class="code" href="networking_8h.html#aff0b513686f6c72428bbca270ce87a77">openvpn_net_ctx_t</a> *ctx)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;{</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a358bbf5e604ead362690b34e147324e0">route_noexec</a> &amp;&amp; ( <a class="code" href="structroute__list.html">route_list</a> || <a class="code" href="structroute__ipv6__list.html">route_ipv6_list</a> ) )</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    {</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <a class="code" href="route_8c.html#af448f9859b34521c0ec218327676eaf0">add_routes</a>(<a class="code" href="structroute__list.html">route_list</a>, <a class="code" href="structroute__ipv6__list.html">route_ipv6_list</a>, tt, <a class="code" href="options_8h.html#acda4e6b8f4a9086033b6f58bbceed617">ROUTE_OPTION_FLAGS</a>(<a class="code" href="structoptions.html">options</a>),</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                   es, ctx);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <a class="code" href="env__set_8c.html#a2ee1297d7cd864a08edff8440efa4143">setenv_int</a>(es, <span class="stringliteral">&quot;redirect_gateway&quot;</span>, <a class="code" href="route_8h.html#a44d8acb217b7350899a3bf897bfef0d6">route_did_redirect_default_gateway</a>(<a class="code" href="structroute__list.html">route_list</a>));</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    {</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        <a class="code" href="manage_8c.html#adb0918861aed5720265e9dd4313761d9">management_up_down</a>(<a class="code" href="structmanagement.html">management</a>, <span class="stringliteral">&quot;UP&quot;</span>, es);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="plugin_8c.html#afbccf58e824f3405cd8d088a9c5e4d61">plugin_defined</a>(plugins, <a class="code" href="openvpn-plugin_8h.html#aeb5659c51304475fa68449bc4c4f98fd">OPENVPN_PLUGIN_ROUTE_UP</a>))</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    {</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="plugin_8h.html#aa1988b85df1aa0a7c628e038868e6d39">plugin_call</a>(plugins, <a class="code" href="openvpn-plugin_8h.html#aeb5659c51304475fa68449bc4c4f98fd">OPENVPN_PLUGIN_ROUTE_UP</a>, NULL, NULL, es) != <a class="code" href="openvpn-plugin_8h.html#abc63437901a486826ebe0ba0a84bc7cb">OPENVPN_PLUGIN_FUNC_SUCCESS</a>)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: route-up plugin call failed&quot;</span>);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        }</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    }</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af013c3f8f620bfcf06553f9e0340c6e2">route_script</a>)</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    {</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="keyword">struct </span><a class="code" href="structargv.html">argv</a> <a class="code" href="structargv.html">argv</a> = <a class="code" href="argv_8c.html#ae03da330eccab6d3239253b774a92d4d">argv_new</a>();</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <a class="code" href="env__set_8c.html#a872620e2e324ded9c1bc8af1c253faf9">setenv_str</a>(es, <span class="stringliteral">&quot;script_type&quot;</span>, <span class="stringliteral">&quot;route-up&quot;</span>);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <a class="code" href="argv_8c.html#a774ef043771e6da40b48dde907f1e205">argv_parse_cmd</a>(&amp;<a class="code" href="structargv.html">argv</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af013c3f8f620bfcf06553f9e0340c6e2">route_script</a>);</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        <a class="code" href="run__command_8h.html#a3a933e13c7546d8b3d63042f3feba310">openvpn_run_script</a>(&amp;<a class="code" href="structargv.html">argv</a>, es, 0, <span class="stringliteral">&quot;--route-up&quot;</span>);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        <a class="code" href="argv_8c.html#a8563bed2ee30eda7125eee7bdb9ab4eb">argv_free</a>(&amp;<a class="code" href="structargv.html">argv</a>);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160; </div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a2d370b06b0c83356b68b3459fd69ca80">show_net_up</a>)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <a class="code" href="route_8c.html#a5d725239839720fa55f3921c74098fa3">show_routes</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>|<a class="code" href="openvpn_2error_8h.html#a39772a2bdab0bd56c1b6dd518a65c2c3">M_NOPREFIX</a>);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        <a class="code" href="tun_8c.html#a6f5544632174db40d087aaf55d70f5c6">show_adapters</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>|<a class="code" href="openvpn_2error_8h.html#a39772a2bdab0bd56c1b6dd518a65c2c3">M_NOPREFIX</a>);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="openvpn_2error_8h.html#a7b09cca005dc641923899a6baa0d6e3c">check_debug_level</a>(<a class="code" href="errlevel_8h.html#a220891aee7b9d5495c307445dac672f6">D_SHOW_NET</a>))</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    {</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <a class="code" href="route_8c.html#a5d725239839720fa55f3921c74098fa3">show_routes</a>(<a class="code" href="errlevel_8h.html#a220891aee7b9d5495c307445dac672f6">D_SHOW_NET</a>|<a class="code" href="openvpn_2error_8h.html#a39772a2bdab0bd56c1b6dd518a65c2c3">M_NOPREFIX</a>);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        <a class="code" href="tun_8c.html#a6f5544632174db40d087aaf55d70f5c6">show_adapters</a>(<a class="code" href="errlevel_8h.html#a220891aee7b9d5495c307445dac672f6">D_SHOW_NET</a>|<a class="code" href="openvpn_2error_8h.html#a39772a2bdab0bd56c1b6dd518a65c2c3">M_NOPREFIX</a>);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    }</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;}</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160; </div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment"> * initialize tun/tap device object</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"><a class="line" href="init_8c.html#a26b00bb1c20dc239a7dc415494b3ca0c"> 1752</a></span>&#160;<a class="code" href="init_8c.html#a26b00bb1c20dc239a7dc415494b3ca0c">do_init_tun</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;{</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a> = <a class="code" href="tun_8c.html#a655d665719a4b6b553e2b4c0a421fe17">init_tun</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a>,</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a46085bfaf25d5996f2f21c7553411a65">dev_type</a>,</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a7a75e271f54a80de7c345599e69bcfe9">topology</a>,</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6c5eef6691660bf4aa7618c2a5485558">ifconfig_local</a>,</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ae70b5eee99cad7ca77438a457078d62c">ifconfig_remote_netmask</a>,</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a3d47337cb28fd6bdb4a804a198b0baa7">ifconfig_ipv6_local</a>,</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#afdb01c0cc7766b1e0320f3374123ecc9">ifconfig_ipv6_netbits</a>,</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a128e966186c103e2d5dc456b90647420">ifconfig_ipv6_remote</a>,</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a5a4d9686ebf0ef5a00117de888ac78cf">bind_local</a>,</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a4eb1c90dc35a5fcd2952072cbe8f6c83">remote_list</a>,</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                            !c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a35d738ab294975825e2a299996d55c0e">ifconfig_nowarn</a>,</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>,</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                            &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#a859337e1a4e77338299c25b8563410ed">windows_driver</a> = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#adc91b041f69645c8b89b68857441a126">windows_driver</a>;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <a class="code" href="tun_8c.html#ac81775a8129068d72892557f733bc583">init_tun_post</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>,</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                  &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>,</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                  &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a7464e4dafe3c9f80b09c620c83f22227">tuntap_options</a>);</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; </div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#acae58a5af5e0f65b4963b44c6e9715e5">tuntap_owned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;}</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160; </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="comment"> * Open tun/tap device, ifconfig, call up script, etc.</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"><a class="line" href="init_8c.html#a8578b737da354d6ddd938b9b7d5dd89f"> 1784</a></span>&#160;<a class="code" href="init_8c.html#a8578b737da354d6ddd938b9b7d5dd89f">do_open_tun</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;{</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; </div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="preprocessor">#ifndef TARGET_ANDROID</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>)</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    {</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160; </div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="preprocessor">#ifdef TARGET_ANDROID</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="comment">/* If we emulate persist-tun on android we still have to open a new tun and</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="comment">     * then close the old */</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordtype">int</span> oldtunfd = -1;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>)</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    {</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        oldtunfd = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;fd;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        free(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>);</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a> = NULL;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#acae58a5af5e0f65b4963b44c6e9715e5">tuntap_owned</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="comment">/* initialize (but do not open) tun/tap object */</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <a class="code" href="init_8c.html#a26b00bb1c20dc239a7dc415494b3ca0c">do_init_tun</a>(c);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; </div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="comment">/* store (hide) interactive service handle in tuntap_options */</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#a7efedc501b62607f297aeee8b839c7c8">options</a>.<a class="code" href="structtuntap__options.html#a92da6eddcc33611db8c3ae0aba938f50">msg_channel</a> = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6868bdf829c75b8fe35d389824128480">msg_channel</a>;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ae77ba6635ecf104df3b8afdcb1cae284">D_ROUTE</a>, <span class="stringliteral">&quot;interactive service msg_channel=%&quot;</span> PRIu64, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span>) c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6868bdf829c75b8fe35d389824128480">msg_channel</a>);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160; </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="comment">/* allocate route list structure */</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <a class="code" href="init_8c.html#a55e5b704206c7d367d7f87593b67cde0">do_alloc_route_list</a>(c);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="comment">/* parse and resolve the route option list */</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a599b21d6f45322992703af0b4e12741e">routes</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a5fce2b35dc960bcdc0cab91b278048f7">route_list</a>)</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        <a class="code" href="init_8c.html#a0670147c5b4477a7b449df5dc36d1855">do_init_route_list</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>, c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a5fce2b35dc960bcdc0cab91b278048f7">route_list</a>,</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                           &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>-&gt;<a class="code" href="structlink__socket.html#a4758d694c759a1aab884bc1cc5ab969f">info</a>, c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    }</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ad3572f352bd2aa332207cddfdc607ff4">routes_ipv6</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a987a02f5590d85e75031d36a6dc2fe5c">route_ipv6_list</a>)</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    {</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <a class="code" href="init_8c.html#a2d77fd4177bf5b5b4eb7914038c2d82b">do_init_route_ipv6_list</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>, c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a987a02f5590d85e75031d36a6dc2fe5c">route_ipv6_list</a>,</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;                                &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>-&gt;<a class="code" href="structlink__socket.html#a4758d694c759a1aab884bc1cc5ab969f">info</a>, c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>,</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                                &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="comment">/* do ifconfig */</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#af55d6b16c337f98fa0ec7fe63539ff76">ifconfig_noexec</a></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        &amp;&amp; <a class="code" href="tun_8h.html#a03cab3834cd52344f15e34b2cee7c0ab">ifconfig_order</a>() == <a class="code" href="tun_8h.html#a31febe262c657791a93cfffb413c03c9">IFCONFIG_BEFORE_TUN_OPEN</a>)</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        <span class="comment">/* guess actual tun/tap unit number that will be returned</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment">         * by open_tun */</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *guess = <a class="code" href="tun_8c.html#ac881cca015e20fc2d4290525767642f4">guess_tuntap_dev</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a>,</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                                             c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a46085bfaf25d5996f2f21c7553411a65">dev_type</a>,</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                                             c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ad1e91361004780f9f9c8bf2e8d7180f4">dev_node</a>,</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                                             &amp;gc);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        <a class="code" href="tun_8c.html#a93c06e46676d0c56871eb1a71fc0c58e">do_ifconfig</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>, guess, <a class="code" href="mtu_8h.html#aa50df1134d2b079e09d803110563ad80">TUN_MTU_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>), c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>,</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                    &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>);</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    }</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160; </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="comment">/* possibly add routes */</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="tun_8h.html#ac24715b5227afea94ad3834341bf7b15">route_order</a>() == <a class="code" href="tun_8h.html#af3f646a2f21e22f10b04edbebad104da">ROUTE_BEFORE_TUN</a>)</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        <span class="comment">/* Ignore route_delay, would cause ROUTE_BEFORE_TUN to be ignored */</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        <a class="code" href="init_8c.html#a72b3b82c87f67f0574e741fc3d70a5b6">do_route</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>, c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a5fce2b35dc960bcdc0cab91b278048f7">route_list</a>, c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a987a02f5590d85e75031d36a6dc2fe5c">route_ipv6_list</a>,</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                 c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>, c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>, c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="preprocessor">#ifdef TARGET_ANDROID</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="comment">/* Store the old fd inside the fd so open_tun can use it */</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;fd = oldtunfd;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="comment">/* open the tun device */</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <a class="code" href="tun_8c.html#a8ed81f24edc25b83eba293057754830b">open_tun</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a46085bfaf25d5996f2f21c7553411a65">dev_type</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ad1e91361004780f9f9c8bf2e8d7180f4">dev_node</a>,</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;             c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160; </div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="comment">/* set the hardware address */</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ae774b572dbe4d6eb691db24d6cbd3481">lladdr</a>)</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    {</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <a class="code" href="lladdr_8c.html#acb6e2182e310c1ace3822972beb591bd">set_lladdr</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>, c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#acfb3d1fb2ebdae626785a31156ec8bce">actual_name</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ae774b572dbe4d6eb691db24d6cbd3481">lladdr</a>,</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                   c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    }</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160; </div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="comment">/* do ifconfig */</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#af55d6b16c337f98fa0ec7fe63539ff76">ifconfig_noexec</a></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        &amp;&amp; <a class="code" href="tun_8h.html#a03cab3834cd52344f15e34b2cee7c0ab">ifconfig_order</a>() == <a class="code" href="tun_8h.html#a1cfcb6c219189c667b981d3b3536f501">IFCONFIG_AFTER_TUN_OPEN</a>)</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    {</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        <a class="code" href="tun_8c.html#a93c06e46676d0c56871eb1a71fc0c58e">do_ifconfig</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>, c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#acfb3d1fb2ebdae626785a31156ec8bce">actual_name</a>,</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                    <a class="code" href="mtu_8h.html#aa50df1134d2b079e09d803110563ad80">TUN_MTU_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>), c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160; </div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="comment">/* run the up script */</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <a class="code" href="init_8c.html#a0e4c816db034fa84e7b3dc0917bb58c5">run_up_down</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a4ad9197223f3b828c0caa17c59e311fd">up_script</a>,</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>,</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                <a class="code" href="openvpn-plugin_8h.html#acc526a64338f399a783b2f1b4f599365">OPENVPN_PLUGIN_UP</a>,</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#acfb3d1fb2ebdae626785a31156ec8bce">actual_name</a>,</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;#ifdef _WIN32</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#a48cab9dc4b56bf88d7ffb7f399d63942">adapter_index</a>,</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;#endif</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                <a class="code" href="tun_8c.html#aaeb7d66a96170c82580b2e821110c745">dev_type_string</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a46085bfaf25d5996f2f21c7553411a65">dev_type</a>),</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                <a class="code" href="mtu_8h.html#aa50df1134d2b079e09d803110563ad80">TUN_MTU_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>),</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                <a class="code" href="mtu_8h.html#acffacbc0669bb2e42bdb97650c816db6">EXPANDED_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>),</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#a310bbe962b4610e99c122fc7147bfbd4">local</a>, <a class="code" href="socket_8h.html#a028f76eab5f19b3be8695a451b62aed8">IA_EMPTY_IF_UNDEF</a>, &amp;gc),</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#adfc8cf984637bed412c9718cd8a4b0cb">remote_netmask</a>, <a class="code" href="socket_8h.html#a028f76eab5f19b3be8695a451b62aed8">IA_EMPTY_IF_UNDEF</a>, &amp;gc),</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                <span class="stringliteral">&quot;init&quot;</span>,</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                NULL,</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                <span class="stringliteral">&quot;up&quot;</span>,</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="preprocessor">#if defined(_WIN32)</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6219cb24a270ee88506cee919c504e7f">block_outside_dns</a>)</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a542de1000e6bc3b78b863494e9a033d4">dmsg</a>(<a class="code" href="errlevel_8h.html#ad7eba86279cb00fc16742e45bfcf3187">D_LOW</a>, <span class="stringliteral">&quot;Blocking outside DNS&quot;</span>);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="win32_8c.html#abdad40a6ab180595222dd02c48ab7d5d">win_wfp_block_dns</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#a48cab9dc4b56bf88d7ffb7f399d63942">adapter_index</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6868bdf829c75b8fe35d389824128480">msg_channel</a>))</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        {</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;Blocking DNS failed!&quot;</span>);</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        }</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    }</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160; </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="comment">/* possibly add routes */</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="tun_8h.html#ac24715b5227afea94ad3834341bf7b15">route_order</a>() == <a class="code" href="tun_8h.html#aa8aab56a4e715335738baeac45989d76">ROUTE_AFTER_TUN</a>) &amp;&amp; (!c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a510dc28521e59d0075843b498297a634">route_delay_defined</a>))</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    {</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <a class="code" href="init_8c.html#a72b3b82c87f67f0574e741fc3d70a5b6">do_route</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>, c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a5fce2b35dc960bcdc0cab91b278048f7">route_list</a>, c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a987a02f5590d85e75031d36a6dc2fe5c">route_ipv6_list</a>,</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                 c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>, c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>, c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>);</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    }</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160; </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">     * Did tun/tap driver give us an MTU?</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#ade6ab1d7cbe4e6f64dc453eaf7fc251e">post_open_mtu</a>)</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    {</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        <a class="code" href="mtu_8c.html#a0d975207c7e52a23853613dd18a6eebf">frame_set_mtu_dynamic</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>,</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                              c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#ade6ab1d7cbe4e6f64dc453eaf7fc251e">post_open_mtu</a>,</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                              <a class="code" href="mtu_8h.html#a27a08d441d3894b11f363c86f288cd72">SET_MTU_TUN</a> | <a class="code" href="mtu_8h.html#af353a8e54454b0a1fccc8810d5908fec">SET_MTU_UPPER_BOUND</a>);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    }</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <a class="code" href="init_8c.html#a5726665a3a94e70598b71c22b77c5693">static_context</a> = c;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="preprocessor">#ifndef TARGET_ANDROID</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;}</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="keywordflow">else</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;{</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;Preserving previous TUN/TAP instance: %s&quot;</span>,</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#acfb3d1fb2ebdae626785a31156ec8bce">actual_name</a>);</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="comment">/* explicitly set the ifconfig_* env vars */</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <a class="code" href="tun_8c.html#ad8365278b4f196950c8a29745b361e0a">do_ifconfig_setenv</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>, c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>);</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="comment">/* run the up script if user specified --up-restart */</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ada4714b5025b2e2d0e863de94507d4d5">up_restart</a>)</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    {</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <a class="code" href="init_8c.html#a0e4c816db034fa84e7b3dc0917bb58c5">run_up_down</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a4ad9197223f3b828c0caa17c59e311fd">up_script</a>,</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>,</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                    <a class="code" href="openvpn-plugin_8h.html#acc526a64338f399a783b2f1b4f599365">OPENVPN_PLUGIN_UP</a>,</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#acfb3d1fb2ebdae626785a31156ec8bce">actual_name</a>,</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;#ifdef _WIN32</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#a48cab9dc4b56bf88d7ffb7f399d63942">adapter_index</a>,</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;#endif</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                    <a class="code" href="tun_8c.html#aaeb7d66a96170c82580b2e821110c745">dev_type_string</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">dev</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a46085bfaf25d5996f2f21c7553411a65">dev_type</a>),</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                    <a class="code" href="mtu_8h.html#aa50df1134d2b079e09d803110563ad80">TUN_MTU_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>),</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                    <a class="code" href="mtu_8h.html#acffacbc0669bb2e42bdb97650c816db6">EXPANDED_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>),</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                    <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#a310bbe962b4610e99c122fc7147bfbd4">local</a>, <a class="code" href="socket_8h.html#a028f76eab5f19b3be8695a451b62aed8">IA_EMPTY_IF_UNDEF</a>, &amp;gc),</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;                    <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#adfc8cf984637bed412c9718cd8a4b0cb">remote_netmask</a>, <a class="code" href="socket_8h.html#a028f76eab5f19b3be8695a451b62aed8">IA_EMPTY_IF_UNDEF</a>, &amp;gc),</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                    <span class="stringliteral">&quot;restart&quot;</span>,</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                    NULL,</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                    <span class="stringliteral">&quot;up&quot;</span>,</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    }</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="preprocessor">#if defined(_WIN32)</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6219cb24a270ee88506cee919c504e7f">block_outside_dns</a>)</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    {</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a542de1000e6bc3b78b863494e9a033d4">dmsg</a>(<a class="code" href="errlevel_8h.html#ad7eba86279cb00fc16742e45bfcf3187">D_LOW</a>, <span class="stringliteral">&quot;Blocking outside DNS&quot;</span>);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="win32_8c.html#abdad40a6ab180595222dd02c48ab7d5d">win_wfp_block_dns</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#a48cab9dc4b56bf88d7ffb7f399d63942">adapter_index</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6868bdf829c75b8fe35d389824128480">msg_channel</a>))</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;Blocking DNS failed!&quot;</span>);</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        }</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    }</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;}</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ifndef TARGET_ANDROID */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;}</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160; </div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="comment"> * Close TUN/TAP device</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"><a class="line" href="init_8c.html#ac17bc708447a380fa5284be8888411b0"> 1977</a></span>&#160;<a class="code" href="init_8c.html#ac17bc708447a380fa5284be8888411b0">do_close_tun_simple</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;{</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a4d297c382e0a2017ad37b4f961bec11c">D_CLOSE</a>, <span class="stringliteral">&quot;Closing TUN/TAP interface&quot;</span>);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>)</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        <a class="code" href="tun_8c.html#aa160989ccb62fe8390475d34bda3d2f8">close_tun</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a> = NULL;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#acae58a5af5e0f65b4963b44c6e9715e5">tuntap_owned</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a76d5bfa380ad2afb97f92ded5297e629">pulled_options_digest_save</a>);</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;}</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; </div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"><a class="line" href="init_8c.html#a62d7dcc84da69695748e556fda9833fe"> 1992</a></span>&#160;<a class="code" href="init_8c.html#a62d7dcc84da69695748e556fda9833fe">do_close_tun</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keywordtype">bool</span> force)</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;{</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#acae58a5af5e0f65b4963b44c6e9715e5">tuntap_owned</a>)</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    {</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *tuntap_actual = <a class="code" href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca">string_alloc</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#acfb3d1fb2ebdae626785a31156ec8bce">actual_name</a>, &amp;gc);</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        DWORD adapter_index = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#a48cab9dc4b56bf88d7ffb7f399d63942">adapter_index</a>;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        <span class="keyword">const</span> <a class="code" href="config-msvc_8h.html#a64ca7e440847b0f5d19cbe94f9e114bd">in_addr_t</a> local = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#a310bbe962b4610e99c122fc7147bfbd4">local</a>;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <span class="keyword">const</span> <a class="code" href="config-msvc_8h.html#a64ca7e440847b0f5d19cbe94f9e114bd">in_addr_t</a> remote_netmask = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>-&gt;<a class="code" href="structtuntap.html#adfc8cf984637bed412c9718cd8a4b0cb">remote_netmask</a>;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160; </div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        <span class="keywordflow">if</span> (force || !(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#aa5a53a81882886ed763b33d6db6050e4">persist_tun</a>))</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            <a class="code" href="init_8c.html#a5726665a3a94e70598b71c22b77c5693">static_context</a> = NULL;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;            <span class="comment">/* tell management layer we are about to close the TUN/TAP device */</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;            {</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                <a class="code" href="manage_8c.html#a017795f62ca0bc6c3ebc4a528c3f05aa">management_pre_tunnel_close</a>(<a class="code" href="structmanagement.html">management</a>);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                <a class="code" href="manage_8c.html#adb0918861aed5720265e9dd4313761d9">management_up_down</a>(<a class="code" href="structmanagement.html">management</a>, <span class="stringliteral">&quot;DOWN&quot;</span>, c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;            }</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; </div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;            <span class="comment">/* delete any routes we added */</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;            <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a5fce2b35dc960bcdc0cab91b278048f7">route_list</a> || c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a987a02f5590d85e75031d36a6dc2fe5c">route_ipv6_list</a>)</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;            {</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                <a class="code" href="init_8c.html#a0e4c816db034fa84e7b3dc0917bb58c5">run_up_down</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a9ab2e37abdb87f168a53a0dc73ddcc1a">route_predown_script</a>,</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>,</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                            <a class="code" href="openvpn-plugin_8h.html#a2f1704f3ee94c5cce7507d5df87a828a">OPENVPN_PLUGIN_ROUTE_PREDOWN</a>,</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                            tuntap_actual,</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;#ifdef _WIN32</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                            adapter_index,</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;#endif</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                            NULL,</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                            <a class="code" href="mtu_8h.html#aa50df1134d2b079e09d803110563ad80">TUN_MTU_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>),</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                            <a class="code" href="mtu_8h.html#acffacbc0669bb2e42bdb97650c816db6">EXPANDED_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>),</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                            <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(local, <a class="code" href="socket_8h.html#a028f76eab5f19b3be8695a451b62aed8">IA_EMPTY_IF_UNDEF</a>, &amp;gc),</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                            <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(remote_netmask, <a class="code" href="socket_8h.html#a028f76eab5f19b3be8695a451b62aed8">IA_EMPTY_IF_UNDEF</a>, &amp;gc),</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                            <span class="stringliteral">&quot;init&quot;</span>,</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                            <a class="code" href="sig_8c.html#a9dce4123b9a7da434cc417d0a1e47294">signal_description</a>(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a>,</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                                               c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a>),</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                            <span class="stringliteral">&quot;route-pre-down&quot;</span>,</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>);</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                <a class="code" href="route_8c.html#ad9d57454e8a9b7be1617447068f98e58">delete_routes</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a5fce2b35dc960bcdc0cab91b278048f7">route_list</a>, c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a987a02f5590d85e75031d36a6dc2fe5c">route_ipv6_list</a>,</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                              c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>, <a class="code" href="options_8h.html#acda4e6b8f4a9086033b6f58bbceed617">ROUTE_OPTION_FLAGS</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>),</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                              c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160; </div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;            <span class="comment">/* actually close tun/tap device based on --down-pre flag */</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;            <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#aa4c0435a248abc1b65d922505c89e32c">down_pre</a>)</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;            {</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                <a class="code" href="init_8c.html#ac17bc708447a380fa5284be8888411b0">do_close_tun_simple</a>(c);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;            }</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160; </div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;            <span class="comment">/* Run the down script -- note that it will run at reduced</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">             * privilege if, for example, &quot;--user nobody&quot; was used. */</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;            <a class="code" href="init_8c.html#a0e4c816db034fa84e7b3dc0917bb58c5">run_up_down</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a21be06e306586356c1730387c8294d57">down_script</a>,</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                        c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>,</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                        <a class="code" href="openvpn-plugin_8h.html#a292f4563db5f9561b7825d31af53a990">OPENVPN_PLUGIN_DOWN</a>,</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                        tuntap_actual,</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;#ifdef _WIN32</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                        adapter_index,</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;#endif</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                        NULL,</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                        <a class="code" href="mtu_8h.html#aa50df1134d2b079e09d803110563ad80">TUN_MTU_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>),</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                        <a class="code" href="mtu_8h.html#acffacbc0669bb2e42bdb97650c816db6">EXPANDED_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>),</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                        <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(local, <a class="code" href="socket_8h.html#a028f76eab5f19b3be8695a451b62aed8">IA_EMPTY_IF_UNDEF</a>, &amp;gc),</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                        <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(remote_netmask, <a class="code" href="socket_8h.html#a028f76eab5f19b3be8695a451b62aed8">IA_EMPTY_IF_UNDEF</a>, &amp;gc),</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                        <span class="stringliteral">&quot;init&quot;</span>,</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                        <a class="code" href="sig_8c.html#a9dce4123b9a7da434cc417d0a1e47294">signal_description</a>(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a>,</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                                           c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a>),</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                        <span class="stringliteral">&quot;down&quot;</span>,</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;                        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>);</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160; </div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="preprocessor">#if defined(_WIN32)</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;            <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6219cb24a270ee88506cee919c504e7f">block_outside_dns</a>)</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;            {</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="win32_8c.html#a6960260d6017928cac9fe0ba8e11d9d6">win_wfp_uninit</a>(adapter_index, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6868bdf829c75b8fe35d389824128480">msg_channel</a>))</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                {</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;Uninitialising WFP failed!&quot;</span>);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                }</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;            }</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160; </div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;            <span class="comment">/* actually close tun/tap device based on --down-pre flag */</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;            <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#aa4c0435a248abc1b65d922505c89e32c">down_pre</a>)</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;            {</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                <a class="code" href="init_8c.html#ac17bc708447a380fa5284be8888411b0">do_close_tun_simple</a>(c);</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;            }</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        }</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        {</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            <span class="comment">/* run the down script on this restart if --up-restart was specified */</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ada4714b5025b2e2d0e863de94507d4d5">up_restart</a>)</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;            {</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                <a class="code" href="init_8c.html#a0e4c816db034fa84e7b3dc0917bb58c5">run_up_down</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a21be06e306586356c1730387c8294d57">down_script</a>,</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>,</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                            <a class="code" href="openvpn-plugin_8h.html#a292f4563db5f9561b7825d31af53a990">OPENVPN_PLUGIN_DOWN</a>,</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                            tuntap_actual,</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;#ifdef _WIN32</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                            adapter_index,</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;#endif</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                            NULL,</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                            <a class="code" href="mtu_8h.html#aa50df1134d2b079e09d803110563ad80">TUN_MTU_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>),</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                            <a class="code" href="mtu_8h.html#acffacbc0669bb2e42bdb97650c816db6">EXPANDED_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>),</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                            <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(local, <a class="code" href="socket_8h.html#a028f76eab5f19b3be8695a451b62aed8">IA_EMPTY_IF_UNDEF</a>, &amp;gc),</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                            <a class="code" href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a>(remote_netmask, <a class="code" href="socket_8h.html#a028f76eab5f19b3be8695a451b62aed8">IA_EMPTY_IF_UNDEF</a>, &amp;gc),</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                            <span class="stringliteral">&quot;restart&quot;</span>,</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                            <a class="code" href="sig_8c.html#a9dce4123b9a7da434cc417d0a1e47294">signal_description</a>(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a>,</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                                               c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a>),</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                            <span class="stringliteral">&quot;down&quot;</span>,</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            }</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="preprocessor">#if defined(_WIN32)</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;            <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6219cb24a270ee88506cee919c504e7f">block_outside_dns</a>)</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            {</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="win32_8c.html#a6960260d6017928cac9fe0ba8e11d9d6">win_wfp_uninit</a>(adapter_index, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6868bdf829c75b8fe35d389824128480">msg_channel</a>))</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                {</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;Uninitialising WFP failed!&quot;</span>);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                }</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            }</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        }</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    }</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;}</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"><a class="line" href="init_8h.html#a9c369a8c7bccbba36c31f4690e373c5f"> 2125</a></span>&#160;<a class="code" href="init_8c.html#a9c369a8c7bccbba36c31f4690e373c5f">tun_abort</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;{</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *c = <a class="code" href="init_8c.html#a5726665a3a94e70598b71c22b77c5693">static_context</a>;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="keywordflow">if</span> (c)</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    {</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;        <a class="code" href="init_8c.html#a5726665a3a94e70598b71c22b77c5693">static_context</a> = NULL;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        <a class="code" href="init_8c.html#a62d7dcc84da69695748e556fda9833fe">do_close_tun</a>(c, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    }</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;}</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160; </div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment"> * Handle delayed tun/tap interface bringup due to --up-delay or --pull</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160; </div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"><a class="line" href="init_8c.html#abb643cb703073cd62032ece84ed481f7"> 2145</a></span>&#160;<a class="code" href="init_8c.html#abb643cb703073cd62032ece84ed481f7">options_hash_changed_or_zero</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structsha256__digest.html">sha256_digest</a> *a,</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structsha256__digest.html">sha256_digest</a> *b)</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;{</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structsha256__digest.html">sha256_digest</a> zero = {{0}};</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordflow">return</span> memcmp(a, b, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structsha256__digest.html">sha256_digest</a>))</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;           || !memcmp(a, &amp;zero, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structsha256__digest.html">sha256_digest</a>));</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;}</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* P2MP */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160; </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"><a class="line" href="init_8h.html#a9b053b7a612943b6be1d1be2c25181bf"> 2155</a></span>&#160;<a class="code" href="init_8c.html#a9b053b7a612943b6be1d1be2c25181bf">do_up</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keywordtype">bool</span> pulled_options, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> option_types_found)</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;{</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a267d253d04cc5ef2d91efd6ce4a8f28a">do_up_ran</a>)</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    {</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        <a class="code" href="init_8c.html#a5eea9a05e4580cb48e8b0daad33c59fe">reset_coarse_timers</a>(c);</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        <span class="keywordflow">if</span> (pulled_options)</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        {</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="init_8c.html#af461b176774f98425ec61cc176f0ec7c">do_deferred_options</a>(c, option_types_found))</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;            {</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ab1f5456810dd6e5c6ab78c1b3d35f1c0">D_PUSH_ERRORS</a>, <span class="stringliteral">&quot;ERROR: Failed to apply push options&quot;</span>);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            }</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;        }</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160; </div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        <span class="comment">/* if --up-delay specified, open tun, do ifconfig, and run up script now */</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a38f4b8bb967c7310eaaa3d77239f7780">up_delay</a> || <a class="code" href="options_8h.html#abff23e3641208e00e513e5b240b42d00">PULL_DEFINED</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>))</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        {</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a367a0c4601050fe0e0368ec06c58754b">did_open_tun</a> = <a class="code" href="init_8c.html#a8578b737da354d6ddd938b9b7d5dd89f">do_open_tun</a>(c);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;            <a class="code" href="otime_8h.html#ab47928897d13fd5569f20f0f8d068ce0">update_time</a>();</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160; </div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">             * Was tun interface object persisted from previous restart iteration,</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="comment">             * and if so did pulled options string change from previous iteration?</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;            <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a367a0c4601050fe0e0368ec06c58754b">did_open_tun</a></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                &amp;&amp; <a class="code" href="options_8h.html#abff23e3641208e00e513e5b240b42d00">PULL_DEFINED</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>)</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                &amp;&amp; <a class="code" href="init_8c.html#abb643cb703073cd62032ece84ed481f7">options_hash_changed_or_zero</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a76d5bfa380ad2afb97f92ded5297e629">pulled_options_digest_save</a>,</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                                                &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#adbe7d67b15dc3e5fe37856a3eafcaaa6">pulled_options_digest</a>))</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;            {</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                <span class="comment">/* if so, close tun, delete routes, then reinitialize tun and add routes */</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;NOTE: Pulled options changed on restart, will need to close and reopen TUN/TAP device.&quot;</span>);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                <a class="code" href="init_8c.html#a62d7dcc84da69695748e556fda9833fe">do_close_tun</a>(c, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                <a class="code" href="manage_8c.html#af07a56f96cec84856d0bf97899a4d460">management_sleep</a>(1);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a367a0c4601050fe0e0368ec06c58754b">did_open_tun</a> = <a class="code" href="init_8c.html#a8578b737da354d6ddd938b9b7d5dd89f">do_open_tun</a>(c);</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                <a class="code" href="otime_8h.html#ab47928897d13fd5569f20f0f8d068ce0">update_time</a>();</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            }</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        }</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160; </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a367a0c4601050fe0e0368ec06c58754b">did_open_tun</a>)</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a76d5bfa380ad2afb97f92ded5297e629">pulled_options_digest_save</a> = c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#adbe7d67b15dc3e5fe37856a3eafcaaa6">pulled_options_digest</a>;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160; </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            <span class="comment">/* if --route-delay was specified, start timer */</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="tun_8h.html#ac24715b5227afea94ad3834341bf7b15">route_order</a>() == <a class="code" href="tun_8h.html#aa8aab56a4e715335738baeac45989d76">ROUTE_AFTER_TUN</a>) &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a510dc28521e59d0075843b498297a634">route_delay_defined</a>)</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                <a class="code" href="interval_8h.html#a2a19b468bda9494ddab767cf6a81f201">event_timeout_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ae8340ca648a8ecd965445186cf3a0ec1">route_wakeup</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ad1a7fff9ea0912c167096c44896fedfa">route_delay</a>, <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>);</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                <a class="code" href="interval_8h.html#a2a19b468bda9494ddab767cf6a81f201">event_timeout_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a328c64e187c662be87e6b8ea738a76cb">route_wakeup_expire</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ad1a7fff9ea0912c167096c44896fedfa">route_delay</a> + c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a9f34739ff66477dcf8e5db79a87517e3">route_delay_window</a>, <a class="code" href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a>);</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>)</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                {</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                    <a class="code" href="tun_8c.html#ae4aac9803755917377784cb752dcd6e0">tun_standby_init</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>);</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            }</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                <a class="code" href="init_8c.html#a0efe2bfd4ac02795b81d7aafe116fd25">initialization_sequence_completed</a>(c, 0); <span class="comment">/* client/p2p --route-delay undefined */</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            }</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        }</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8a97f5f530042a7f4321cb97c3983fa1">mode</a> == <a class="code" href="options_8h.html#a028cb4de8f6ee1de18d2b5a65981d9b4">MODE_POINT_TO_POINT</a>)</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        {</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;            <a class="code" href="init_8c.html#a0efe2bfd4ac02795b81d7aafe116fd25">initialization_sequence_completed</a>(c, 0); <span class="comment">/* client/p2p restart with --persist-tun */</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;        }</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a267d253d04cc5ef2d91efd6ce4a8f28a">do_up_ran</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    }</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;}</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160; </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="comment"> * These are the option categories which will be accepted by pull.</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"><a class="line" href="init_8h.html#aded279bc953617852338a38e3d1a256b"> 2232</a></span>&#160;<a class="code" href="init_8c.html#aded279bc953617852338a38e3d1a256b">pull_permission_mask</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;{</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags =</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        <a class="code" href="options_8h.html#a1c591527d4a6d3b5d9bdf8d0e130874d">OPT_P_UP</a></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        | <a class="code" href="options_8h.html#ada005c713e5d684cb6296ba483870c98">OPT_P_ROUTE_EXTRAS</a></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        | <a class="code" href="options_8h.html#a77b419240a9cbc017fce0afa7613943d">OPT_P_SOCKBUF</a></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        | <a class="code" href="options_8h.html#a61b74dea57fdbf122ec9618c50ee8563">OPT_P_SOCKFLAGS</a></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        | <a class="code" href="options_8h.html#a71776ba017cdd19ee6cb174f683873e1">OPT_P_SETENV</a></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        | <a class="code" href="options_8h.html#a597219fb09dfab423bc377b99b01a77c">OPT_P_SHAPER</a></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        | <a class="code" href="options_8h.html#a865468682974ec84df83f29b7666b1bc">OPT_P_TIMER</a></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        | <a class="code" href="options_8h.html#ad6842a000eff2ee8036ad0547e51319b">OPT_P_COMP</a></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        | <a class="code" href="options_8h.html#ab6ec0caa0fc6396f19e56f4deaf2dc86">OPT_P_PERSIST</a></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        | <a class="code" href="options_8h.html#a708675a9e8c44cab01e4e73e1a12449d">OPT_P_MESSAGES</a></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        | <a class="code" href="options_8h.html#a4e021c14d58bfb45e68b6155e68d40f0">OPT_P_EXPLICIT_NOTIFY</a></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        | <a class="code" href="options_8h.html#a294b9a8556238f7d48e63af6ea851806">OPT_P_ECHO</a></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        | <a class="code" href="options_8h.html#a9bbcdd61c5d7af6f9a03509fc609be47">OPT_P_PULL_MODE</a></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        | <a class="code" href="options_8h.html#ae212b662019ae8c66425245463b7781d">OPT_P_PEER_ID</a>;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a05b0630208dd924ada185a3b73adf8c8">route_nopull</a>)</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    {</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        flags |= (<a class="code" href="options_8h.html#ae90e072ed72a51c24ce5be4dc71dcc72">OPT_P_ROUTE</a> | <a class="code" href="options_8h.html#abd79a1754926b76ff0a0e566d126c606">OPT_P_IPWIN32</a>);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160; </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a7c5a04e0f575936f6d77977ca5c5748b">ncp_enabled</a>)</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        flags |= <a class="code" href="options_8h.html#a26a848845f907c37083e983c6d77ba32">OPT_P_NCP</a>;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160; </div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    <span class="keywordflow">return</span> flags;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;}</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160; </div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment"> * Handle non-tun-related pulled options.</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"><a class="line" href="init_8h.html#af461b176774f98425ec61cc176f0ec7c"> 2267</a></span>&#160;<a class="code" href="init_8c.html#af461b176774f98425ec61cc176f0ec7c">do_deferred_options</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> found)</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;{</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#a708675a9e8c44cab01e4e73e1a12449d">OPT_P_MESSAGES</a>)</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    {</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        <a class="code" href="init_8c.html#a164331d37fecc9ad095eae0e8dce53de">init_verb_mute</a>(c, <a class="code" href="init_8h.html#a5066d160ca7be6632e188a5044eeba09">IVM_LEVEL_1</a>|<a class="code" href="init_8h.html#a2fde4b1cea35c1d5ecc1dfcc4ac16a38">IVM_LEVEL_2</a>);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: --verb and/or --mute level changed&quot;</span>);</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    }</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#a865468682974ec84df83f29b7666b1bc">OPT_P_TIMER</a>)</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    {</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        <a class="code" href="init_8c.html#a4ce16743e82e7bcab17fe41d03b3fd44">do_init_timers</a>(c, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: timers and/or timeouts modified&quot;</span>);</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    }</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160; </div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#a4e021c14d58bfb45e68b6155e68d40f0">OPT_P_EXPLICIT_NOTIFY</a>)</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    {</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="socket_8c.html#a86424bdc75e8f05f00a649f30f897110">proto_is_udp</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>) &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a9adab10d5a021e6f453ebc4edc29ecde">explicit_exit_notification</a>)</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        {</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: --explicit-exit-notify can only be used with --proto udp&quot;</span>);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a9adab10d5a021e6f453ebc4edc29ecde">explicit_exit_notification</a> = 0;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        }</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        {</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: explicit notify parm(s) modified&quot;</span>);</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        }</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    }</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="preprocessor">#ifdef USE_COMP</span></div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#ad6842a000eff2ee8036ad0547e51319b">OPT_P_COMP</a>)</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    {</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: compression parms modified&quot;</span>);</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        comp_uninit(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.comp_context);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.comp_context = comp_init(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.comp);</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    }</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#a597219fb09dfab423bc377b99b01a77c">OPT_P_SHAPER</a>)</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    {</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: traffic shaper enabled&quot;</span>);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        <a class="code" href="init_8c.html#a3b4a0a2b9abc79b1a2ea53ecc6125303">do_init_traffic_shaper</a>(c);</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    }</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#a77b419240a9cbc017fce0afa7613943d">OPT_P_SOCKBUF</a>)</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    {</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: --sndbuf/--rcvbuf options modified&quot;</span>);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        <a class="code" href="socket_8c.html#a022b67c8749e8a934063231b2abc5cf6">link_socket_update_buffer_sizes</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a0536fdadf7c9e61bfe97e269172bbf3a">rcvbuf</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#aa177cf2ad8396bfadd40a7b3fb79adeb">sndbuf</a>);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    }</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; </div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#a61b74dea57fdbf122ec9618c50ee8563">OPT_P_SOCKFLAGS</a>)</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    {</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: --socket-flags option modified&quot;</span>);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        <a class="code" href="socket_8c.html#a47f7e875f90faefaede7148a7e5f3347">link_socket_update_flags</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ac8e77b47a812a59d723b57059eede161">sockflags</a>);</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    }</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; </div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#ab6ec0caa0fc6396f19e56f4deaf2dc86">OPT_P_PERSIST</a>)</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    {</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: --persist options modified&quot;</span>);</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    }</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#a1c591527d4a6d3b5d9bdf8d0e130874d">OPT_P_UP</a>)</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    {</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: --ifconfig/up options modified&quot;</span>);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    }</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#ae90e072ed72a51c24ce5be4dc71dcc72">OPT_P_ROUTE</a>)</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    {</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: route options modified&quot;</span>);</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    }</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#ada005c713e5d684cb6296ba483870c98">OPT_P_ROUTE_EXTRAS</a>)</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    {</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: route-related options modified&quot;</span>);</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#abd79a1754926b76ff0a0e566d126c606">OPT_P_IPWIN32</a>)</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    {</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: --ip-win32 and/or --dhcp-option options modified&quot;</span>);</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    }</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#a71776ba017cdd19ee6cb174f683873e1">OPT_P_SETENV</a>)</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    {</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: environment modified&quot;</span>);</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    }</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160; </div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    <span class="keywordflow">if</span> (found &amp; <a class="code" href="options_8h.html#ae212b662019ae8c66425245463b7781d">OPT_P_PEER_ID</a>)</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    {</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: peer-id set&quot;</span>);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#aa1c6b330c9dd68a9f9dd6bf05d454642">use_peer_id</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a93c90f22f9fbbd1898ea9708a49ee1f7">peer_id</a> = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a58306b60489c8093ab83be97174daebb">peer_id</a>;</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        <a class="code" href="mtu_8h.html#a8941b4c07aa4e1ba754104e1256316ff">frame_add_to_extra_frame</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, +3);     <span class="comment">/* peer-id overhead */</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;        <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a12ae06d792bd8aed58475b9976673654">link_mtu_defined</a>)</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;        {</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            <a class="code" href="mtu_8h.html#ac25e2c2e9e0850eef726910ba8c09a26">frame_add_to_link_mtu</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, +3);</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: adjusting link_mtu to %d&quot;</span>,</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                <a class="code" href="mtu_8h.html#acffacbc0669bb2e42bdb97650c816db6">EXPANDED_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>));</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        }</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        {</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;OPTIONS IMPORT: WARNING: peer-id set, but link-mtu&quot;</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                <span class="stringliteral">&quot; fixed by config - reducing tun-mtu to %d, expect&quot;</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                <span class="stringliteral">&quot; MTU problems&quot;</span>, <a class="code" href="mtu_8h.html#aa50df1134d2b079e09d803110563ad80">TUN_MTU_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>) );</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        }</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160; </div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    <span class="comment">/* process (potentially pushed) crypto options */</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">pull</a>)</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    {</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="ssl__ncp_8c.html#a94dd93854cae77ae01971def265a018e">check_pull_client_ncp</a>(c, found))</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;        {</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        }</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        <span class="keyword">struct </span><a class="code" href="structframe.html">frame</a> *frame_fragment = NULL;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="preprocessor">#ifdef ENABLE_FRAGMENT</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#ab003130b974deb481133d4209f74b25c">fragment</a>)</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        {</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;            frame_fragment = &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7cd4fe8da737769bc4b6341c7dcfb2a2">frame_fragment</a>;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        }</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160; </div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;        <span class="keyword">struct </span><a class="code" href="structtls__session.html">tls_session</a> *<a class="code" href="structsession.html">session</a> = &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a74e065e432f819307a830ef38d5be73c">session</a>[<a class="code" href="group__control__processor.html#gad3c70b02a0ca4537fba1d53802e1e429">TM_ACTIVE</a>];</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="ssl_8c.html#a0abbfa06ce57c32f9f1a46c247de29cf">tls_session_update_crypto_params</a>(<a class="code" href="structsession.html">session</a>, &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>,</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                                              frame_fragment))</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        {</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#abb7d158b96cc50c8f88581e7c1d13cdd">D_TLS_ERRORS</a>, <span class="stringliteral">&quot;OPTIONS ERROR: failed to import crypto options&quot;</span>);</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        }</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    }</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160; </div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;}</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; </div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment"> * Possible hold on initialization, holdtime is the</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment"> * time OpenVPN would wait without management</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"><a class="line" href="init_8c.html#a9954eafaec4fc968645107a926f54df6"> 2397</a></span>&#160;<a class="code" href="init_8c.html#a9954eafaec4fc968645107a926f54df6">do_hold</a>(<span class="keywordtype">int</span> holdtime)</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;{</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    {</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        <span class="comment">/* block until management hold is released */</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#a38cbc67664b02f83c28e70a68d492888">management_hold</a>(<a class="code" href="structmanagement.html">management</a>, holdtime))</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        {</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        }</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    }</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;}</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160; </div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="comment"> * Sleep before restart.</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"><a class="line" href="init_8c.html#a70394c62f63e30e1def3847ff1688a2b"> 2416</a></span>&#160;<a class="code" href="init_8c.html#a70394c62f63e30e1def3847ff1688a2b">socket_restart_pause</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;{</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="keywordtype">int</span> sec = 2;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="keywordtype">int</span> backoff = 0;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; </div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <span class="keywordflow">switch</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>)</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    {</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599aeff17f4932089fddd54b29765c8cdbd7">PROTO_TCP_SERVER</a>:</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            sec = 1;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160; </div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599a2b277c40c006345a264777529561bf93">PROTO_UDP</a>:</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599a4f54544a7b77bc839a23e1124f7e9c95">PROTO_TCP_CLIENT</a>:</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;            sec = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a016bad39481a03a9b824e64cf8a41a23">connect_retry_seconds</a>;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    }</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160; </div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="preprocessor">#ifdef ENABLE_DEBUG</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="keywordflow">if</span> (GREMLIN_CONNECTION_FLOOD_LEVEL(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.gremlin))</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    {</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        sec = 0;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    }</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160; </div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="options_8c.html#ade63586867ed9b0f268b4857ac8e7a5f">auth_retry_get</a>() == <a class="code" href="options_8h.html#aa9cc77b228a8b97a2b65e6865b7ae005">AR_NOINTERACT</a>)</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    {</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        sec = 10;</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    }</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160; </div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    <span class="comment">/* Slow down reconnection after 5 retries per remote -- for TCP client or UDP tls-client only */</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a> == <a class="code" href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599a4f54544a7b77bc839a23e1124f7e9c95">PROTO_TCP_CLIENT</a></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        || (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a> == <a class="code" href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599a2b277c40c006345a264777529561bf93">PROTO_UDP</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a92cffd160044d2b84a1085fa3ddb9a2d">tls_client</a>))</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    {</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        backoff = (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6b6701741dc1e5698babf4ce474984f7">unsuccessful_attempts</a> / c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a111f57f3a14727b141dc4d359cc02ea2">connection_list</a>-&gt;<a class="code" href="structconnection__list.html#a7ec9bc2e47f7ac458a6a1ae17d0cf304">len</a>) - 4;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;        <span class="keywordflow">if</span> (backoff &gt; 0)</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        {</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;            <span class="comment">/* sec is less than 2^16; we can left shift it by up to 15 bits without overflow */</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;            sec = <a class="code" href="integer_8h.html#a957926ee375593740a330d12523eddb1">max_int</a>(sec, 1) &lt;&lt; <a class="code" href="integer_8h.html#a5adeb0420c8384151fa65a8d55eb30ab">min_int</a>(backoff, 15);</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;        }</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;        <span class="keywordflow">if</span> (sec &gt; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a1e80ffa27efcd36772df7618004f2ddc">connect_retry_seconds_max</a>)</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;        {</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;            sec = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a1e80ffa27efcd36772df7618004f2ddc">connect_retry_seconds_max</a>;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;        }</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    }</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; </div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#af52fc5d2e241fbee78d2216e9ff7ed72">persist</a>.<a class="code" href="structcontext__persist.html#a737231b5a647b962d502b0379a4d4cc4">restart_sleep_seconds</a> &gt; 0 &amp;&amp; c-&gt;<a class="code" href="structcontext.html#af52fc5d2e241fbee78d2216e9ff7ed72">persist</a>.<a class="code" href="structcontext__persist.html#a737231b5a647b962d502b0379a4d4cc4">restart_sleep_seconds</a> &gt; sec)</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    {</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        sec = c-&gt;<a class="code" href="structcontext.html#af52fc5d2e241fbee78d2216e9ff7ed72">persist</a>.<a class="code" href="structcontext__persist.html#a737231b5a647b962d502b0379a4d4cc4">restart_sleep_seconds</a>;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    }</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#af52fc5d2e241fbee78d2216e9ff7ed72">persist</a>.<a class="code" href="structcontext__persist.html#a737231b5a647b962d502b0379a4d4cc4">restart_sleep_seconds</a> == -1)</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    {</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        sec = 0;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    }</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    c-&gt;<a class="code" href="structcontext.html#af52fc5d2e241fbee78d2216e9ff7ed72">persist</a>.<a class="code" href="structcontext__persist.html#a737231b5a647b962d502b0379a4d4cc4">restart_sleep_seconds</a> = 0;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="comment">/* do management hold on context restart, i.e. second, third, fourth, etc. initialization */</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="init_8c.html#a9954eafaec4fc968645107a926f54df6">do_hold</a>(sec))</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    {</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;        sec = 0;</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    }</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160; </div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <span class="keywordflow">if</span> (sec)</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    {</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a3f8b5429f1fb9bbefad3bef0be32ab80">D_RESTART</a>, <span class="stringliteral">&quot;Restart pause, %d second(s)&quot;</span>, sec);</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;        <a class="code" href="manage_8c.html#af07a56f96cec84856d0bf97899a4d460">management_sleep</a>(sec);</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    }</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;}</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160; </div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="comment"> * Do a possible pause on context_2 initialization.</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"><a class="line" href="init_8c.html#ad6e5429d3088ee255e912f452f78b0ba"> 2491</a></span>&#160;<a class="code" href="init_8c.html#ad6e5429d3088ee255e912f452f78b0ba">do_startup_pause</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;{</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a>)</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    {</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        <a class="code" href="init_8c.html#a70394c62f63e30e1def3847ff1688a2b">socket_restart_pause</a>(c);</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    }</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    {</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        <a class="code" href="init_8c.html#a9954eafaec4fc968645107a926f54df6">do_hold</a>(0); <span class="comment">/* do management hold on first context initialization */</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;}</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160; </div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="comment"> * Finalize MTU parameters based on command line or config file options.</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"><a class="line" href="init_8c.html#ab818bc3b2b7753d2c5a010ad207b5084"> 2507</a></span>&#160;<a class="code" href="init_8c.html#ab818bc3b2b7753d2c5a010ad207b5084">frame_finalize_options</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *o)</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;{</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <span class="keywordflow">if</span> (!o)</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    {</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        o = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    }</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160; </div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="comment">     * Set adjustment factor for buffer alignment when no</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="comment">     * cipher is used.</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="openvpn_8h.html#a52609d7e7380af270a8921703521fd41">CIPHER_ENABLED</a>(c))</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    {</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;        <a class="code" href="mtu_8h.html#a55afab83cd51975ef32f80dfe161182e">frame_align_to_extra_frame</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>);</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        <a class="code" href="mtu_8h.html#a9b846353f7034b285415993fd07b5f1d">frame_or_align_flags</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>,</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                             <a class="code" href="mtu_8h.html#a551c5fa35eafecb8d7451cc643f889a1">FRAME_HEADROOM_MARKER_FRAGMENT</a></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                             |<a class="code" href="mtu_8h.html#a421e9017e7a6714398dc943b4e3a4048">FRAME_HEADROOM_MARKER_READ_LINK</a></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;                             |<a class="code" href="mtu_8h.html#a96b361bbecbb496904fc6bc54b488cec">FRAME_HEADROOM_MARKER_READ_STREAM</a>);</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    }</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160; </div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <a class="code" href="mtu_8h.html#ac3136c647b87a701a1073677ae1d51ae">frame_add_to_extra_buffer</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, <a class="code" href="mtu_8h.html#a78b645ca6006022f942aa869c6ef7d3c">PAYLOAD_ALIGN</a>);</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <a class="code" href="mtu_8c.html#aa4f19c6314a87fa7a3616fec2a3f1d32">frame_finalize</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>,</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;                   o-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a12ae06d792bd8aed58475b9976673654">link_mtu_defined</a>,</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                   o-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a08f0f18740ef4f00f130df8ce3a6c672">link_mtu</a>,</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                   o-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a90482e8f2d1ab61167f705cec826abee">tun_mtu_defined</a>,</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;                   o-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#acd8706781548bd6e51c6a43b9a457155">tun_mtu</a>);</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;}</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160; </div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="comment"> * Free a key schedule, including OpenSSL components.</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"><a class="line" href="init_8c.html#a263724992635e011b111147ec8647500"> 2539</a></span>&#160;<a class="code" href="init_8c.html#a263724992635e011b111147ec8647500">key_schedule_free</a>(<span class="keyword">struct</span> <a class="code" href="structkey__schedule.html">key_schedule</a> *ks, <span class="keywordtype">bool</span> free_ssl_ctx)</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;{</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <a class="code" href="crypto_8c.html#a0605d1e78bd3bf4e23d99e039301f934">free_key_ctx_bi</a>(&amp;ks-&gt;<a class="code" href="structkey__schedule.html#aea2d2038fbffa038ea608eaf923bb2db">static_key</a>);</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ssl__backend_8h.html#a8a8bcdcde91147e4138bc85510f22595">tls_ctx_initialised</a>(&amp;ks-&gt;<a class="code" href="structkey__schedule.html#a5e59f0aab5d757ed334039b15682829a">ssl_ctx</a>) &amp;&amp; free_ssl_ctx)</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    {</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        <a class="code" href="ssl__backend_8h.html#a0ebd940dcf50fa2bb859ac47a2b3490b">tls_ctx_free</a>(&amp;ks-&gt;<a class="code" href="structkey__schedule.html#a5e59f0aab5d757ed334039b15682829a">ssl_ctx</a>);</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        <a class="code" href="crypto_8c.html#af3aee473fd00923f722cc0518add3d7c">free_key_ctx</a>(&amp;ks-&gt;<a class="code" href="structkey__schedule.html#a52c3c5b8bfd7c529453ef8b526944209">auth_token_key</a>);</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    }</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(*ks);</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;}</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"><a class="line" href="init_8c.html#a48a66fea06ba3615248923298b5d8d94"> 2551</a></span>&#160;<a class="code" href="init_8c.html#a48a66fea06ba3615248923298b5d8d94">init_crypto_pre</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags)</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;{</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#acb0e7875a4dcacb855d7b7fac93d9ca8">engine</a>)</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    {</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        <a class="code" href="crypto__backend_8h.html#ac8c96ccbbb4f4a96934b1b1301f152d5">crypto_init_lib_engine</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#acb0e7875a4dcacb855d7b7fac93d9ca8">engine</a>);</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    }</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160; </div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="init_8c.html#a4f3c4044edc3d306325c49f75e18c931">CF_LOAD_PERSISTED_PACKET_ID</a>)</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    {</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        <span class="comment">/* load a persisted packet-id for cross-session replay-protection */</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a5463781f357b5c1c13070e92645c6194">packet_id_file</a>)</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        {</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;            <a class="code" href="packet__id_8c.html#ad4f489a3f0c44154ef52e924a1ef4caa">packet_id_persist_load</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa20a2b143b3a7f2db2cc9a1af3cdf3e2">pid_persist</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a5463781f357b5c1c13070e92645c6194">packet_id_file</a>);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        }</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    }</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160; </div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="preprocessor">#ifdef ENABLE_PREDICTION_RESISTANCE</span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.use_prediction_resistance)</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    {</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        rand_ctx_enable_prediction_resistance();</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    }</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;}</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160; </div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="comment"> * Static Key Mode (using a pre-shared key)</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l02579"></a><span class="lineno"><a class="line" href="init_8c.html#a24ee82204efb10e4948c83b1cb1a4853"> 2579</a></span>&#160;<a class="code" href="init_8c.html#a24ee82204efb10e4948c83b1cb1a4853">do_init_crypto_static</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags)</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;{</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a> = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af4f6ab25d97dd623648d3c2342659e0d">shared_secret_file</a>);</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160; </div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <a class="code" href="init_8c.html#a48a66fea06ba3615248923298b5d8d94">init_crypto_pre</a>(c, flags);</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    <span class="comment">/* Initialize flags */</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6a1327f7d30f878848f4e72211878a88">mute_replay_warnings</a>)</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;    {</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a901a1a0ceb94dbd3e9f758552fa4fbd9">crypto_options</a>.<a class="code" href="structcrypto__options.html#a4f1cebf03b32cf2f3b44e90630079e88">flags</a> |= <a class="code" href="crypto_8h.html#a897fcd411cae93fbed05653515ce480e">CO_MUTE_REPLAY_WARNINGS</a>;</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    }</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160; </div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    <span class="comment">/* Initialize packet ID tracking */</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6ab0ea3447528be930897de097a1a37f">replay</a>)</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    {</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        <a class="code" href="packet__id_8c.html#a2ed0adcc640944fdb68ef1e394fc4f32">packet_id_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a901a1a0ceb94dbd3e9f758552fa4fbd9">crypto_options</a>.<a class="code" href="structcrypto__options.html#ab4b7f20d49e1ac2efb9faf4a13d3701d">packet_id</a>,</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                       <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a408775e6f474f8c25ad492e9c9d2b7b8">replay_window</a>,</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;                       <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a27bd2c7c26f4e5bbb67c57743c785b18">replay_time</a>,</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                       <span class="stringliteral">&quot;STATIC&quot;</span>, 0);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a901a1a0ceb94dbd3e9f758552fa4fbd9">crypto_options</a>.<a class="code" href="structcrypto__options.html#a64268b2eac664d85f5e6133264f937ce">pid_persist</a> = &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa20a2b143b3a7f2db2cc9a1af3cdf3e2">pid_persist</a>;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a901a1a0ceb94dbd3e9f758552fa4fbd9">crypto_options</a>.<a class="code" href="structcrypto__options.html#a4f1cebf03b32cf2f3b44e90630079e88">flags</a> |= <a class="code" href="crypto_8h.html#a10cf731ef4917a647cdca413d507ff81">CO_PACKET_ID_LONG_FORM</a>;</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        <a class="code" href="packet__id_8c.html#a249d12dcab1d0a2bc424990138caa4e5">packet_id_persist_load_obj</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa20a2b143b3a7f2db2cc9a1af3cdf3e2">pid_persist</a>,</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                                   &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a901a1a0ceb94dbd3e9f758552fa4fbd9">crypto_options</a>.<a class="code" href="structcrypto__options.html#ab4b7f20d49e1ac2efb9faf4a13d3701d">packet_id</a>);</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    }</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160; </div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="crypto_8h.html#af3e5e7a3b96977793b215f952186d820">key_ctx_bi_defined</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#aea2d2038fbffa038ea608eaf923bb2db">static_key</a>))</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    {</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        <span class="comment">/* Get cipher &amp; hash algorithms */</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        <a class="code" href="crypto_8c.html#a5657fa40c2ed8eed4ac057b87902100b">init_key_type</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a4a34faf7867d3d6647238e914324a99b">key_type</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7f09235fee401590074265aff177491a">ciphername</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a3b2503d5f5f98a176450b3baf1953a20">authname</a>,</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                      <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ae644c14875e0dd32c008a4685f3ee3e3">keysize</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a38d22a55bf92acf99f3c5d71d3b06b18">test_crypto</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160; </div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;        <span class="comment">/* Read cipher and hmac keys from shared secret file */</span></div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        <a class="code" href="crypto_8c.html#aeed99ce5177c96881467847708e18b0e">crypto_read_openvpn_key</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a4a34faf7867d3d6647238e914324a99b">key_type</a>, &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#aea2d2038fbffa038ea608eaf923bb2db">static_key</a>,</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                                <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af4f6ab25d97dd623648d3c2342659e0d">shared_secret_file</a>,</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                                <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac48b53dbc67f66cf7ce1fe1b874d41a8">shared_secret_file_inline</a>,</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                                <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ad47394d36a22f99461bdb6d749bcb6a1">key_direction</a>, <span class="stringliteral">&quot;Static Key Encryption&quot;</span>,</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                                <span class="stringliteral">&quot;secret&quot;</span>);</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    }</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    {</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;Re-using pre-shared static key&quot;</span>);</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    }</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160; </div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    <span class="comment">/* Get key schedule */</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a901a1a0ceb94dbd3e9f758552fa4fbd9">crypto_options</a>.<a class="code" href="structcrypto__options.html#a6f5aaea8aa6f397a0684d8b0a2879252">key_ctx_bi</a> = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#aea2d2038fbffa038ea608eaf923bb2db">static_key</a>;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160; </div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <span class="comment">/* Compute MTU parameters */</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <a class="code" href="crypto_8c.html#af597e0d765df961d66a200fa33ba4faf">crypto_adjust_frame_parameters</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a4a34faf7867d3d6647238e914324a99b">key_type</a>,</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;                                   <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6ab0ea3447528be930897de097a1a37f">replay</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160; </div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    <span class="comment">/* Sanity check on sequence number, and cipher mode options */</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    <a class="code" href="crypto_8c.html#af0c4bb63e6b4aae63502a87217a36c79">check_replay_consistency</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a4a34faf7867d3d6647238e914324a99b">key_type</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6ab0ea3447528be930897de097a1a37f">replay</a>);</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;}</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160; </div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="comment"> * Initialize the tls-auth/crypt key context</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"><a class="line" href="init_8c.html#a08b482cd93161c760290cc90add5e1dd"> 2638</a></span>&#160;<a class="code" href="init_8c.html#a08b482cd93161c760290cc90add5e1dd">do_init_tls_wrap_key</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;{</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a> = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    <span class="comment">/* TLS handshake authentication (--tls-auth) */</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#ac874d736329eb6f60ab54e86e4f7c4ef">tls_auth_file</a>)</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    {</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        <span class="comment">/* Initialize key_type for tls-auth with auth only */</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a6a3add124db00336ab5c081037ae11fd">tls_auth_key_type</a>);</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="options_8h.html#a4841717e2f45399a58c25188a1247c7a">streq</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a3b2503d5f5f98a176450b3baf1953a20">authname</a>, <span class="stringliteral">&quot;none&quot;</span>))</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        {</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a6a3add124db00336ab5c081037ae11fd">tls_auth_key_type</a>.<a class="code" href="structkey__type.html#a496ad3263017e1eca30ec7f490a8011e">digest</a> = <a class="code" href="crypto__backend_8h.html#a9cbbade2b528fe5d1e6ae65bbaf1e765">md_kt_get</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a3b2503d5f5f98a176450b3baf1953a20">authname</a>);</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a6a3add124db00336ab5c081037ae11fd">tls_auth_key_type</a>.<a class="code" href="structkey__type.html#a0714213fa1e02f00924a2c85deb53caf">hmac_length</a> =</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;                <a class="code" href="crypto__backend_8h.html#aaf03842b74cab3e4304e655aeaf75d2e">md_kt_size</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a6a3add124db00336ab5c081037ae11fd">tls_auth_key_type</a>.<a class="code" href="structkey__type.html#a496ad3263017e1eca30ec7f490a8011e">digest</a>);</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        }</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        {</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;ERROR: tls-auth enabled, but no valid --auth &quot;</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                <span class="stringliteral">&quot;algorithm specified (&#39;%s&#39;)&quot;</span>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a3b2503d5f5f98a176450b3baf1953a20">authname</a>);</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;        }</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160; </div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        <a class="code" href="crypto_8c.html#aeed99ce5177c96881467847708e18b0e">crypto_read_openvpn_key</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a6a3add124db00336ab5c081037ae11fd">tls_auth_key_type</a>,</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                                &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#ad2ce1d97a35d1c487ce7c13f52d900c5">tls_wrap_key</a>,</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                                <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#ac874d736329eb6f60ab54e86e4f7c4ef">tls_auth_file</a>,</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                                <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a880988622eda107123e5c103f2ad16bb">tls_auth_file_inline</a>,</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;                                <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#aef5f00a3b93fe9810bdb00a635ec0098">key_direction</a>,</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;                                <span class="stringliteral">&quot;Control Channel Authentication&quot;</span>, <span class="stringliteral">&quot;tls-auth&quot;</span>);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    }</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160; </div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    <span class="comment">/* TLS handshake encryption+authentication (--tls-crypt) */</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a31750e717d5fad479ca6b5930d7cb1db">tls_crypt_file</a>)</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    {</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        <a class="code" href="group__tls__crypt.html#gad1ffd0865c58c744773e5c95e3084cf3">tls_crypt_init_key</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#ad2ce1d97a35d1c487ce7c13f52d900c5">tls_wrap_key</a>,</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                           <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a31750e717d5fad479ca6b5930d7cb1db">tls_crypt_file</a>,</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                           <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a7644600ad9ecf9e1dfa53760c49077ec">tls_crypt_file_inline</a>,</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                           <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8cc67b442d93909bc5500945a8ac08ff">tls_server</a>);</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    }</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160; </div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <span class="comment">/* tls-crypt with client-specific keys (--tls-crypt-v2) */</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a36ddd27b1acf681234f8d8a07b64e2a2">tls_crypt_v2_file</a>)</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    {</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8cc67b442d93909bc5500945a8ac08ff">tls_server</a>)</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;        {</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;            <a class="code" href="group__tls__crypt.html#ga793fa02bdff7c0df6d31b493c8df32aa">tls_crypt_v2_init_server_key</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#afc58d93e9c900d3bd001a8ee09f0932c">tls_crypt_v2_server_key</a>,</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                                         <span class="keyword">true</span>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a36ddd27b1acf681234f8d8a07b64e2a2">tls_crypt_v2_file</a>,</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;                                         <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#af0e61628eca1c951f2f2265e5ec125c8">tls_crypt_v2_file_inline</a>);</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        }</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        {</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;            <a class="code" href="group__tls__crypt.html#ga5cbcf02978d6d2200ec5fbd645d6646c">tls_crypt_v2_init_client_key</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#ad2ce1d97a35d1c487ce7c13f52d900c5">tls_wrap_key</a>,</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;                                         &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a239e3a613b599e2b9ff2c1a3244c398b">tls_crypt_v2_wkc</a>,</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;                                         <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a36ddd27b1acf681234f8d8a07b64e2a2">tls_crypt_v2_file</a>,</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                                         <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#af0e61628eca1c951f2f2265e5ec125c8">tls_crypt_v2_file_inline</a>);</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;        }</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    }</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160; </div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160; </div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;}</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160; </div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="comment"> * Initialise the auth-token key context</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"><a class="line" href="init_8c.html#a0614ef4b7979dcbd99edf1b4bf6b3226"> 2701</a></span>&#160;<a class="code" href="init_8c.html#a0614ef4b7979dcbd99edf1b4bf6b3226">do_init_auth_token_key</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;{</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a93398bf07c69b890f12b90ca62c0e259">auth_token_generate</a>)</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;    {</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    }</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160; </div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    <a class="code" href="auth__token_8c.html#a4a2164f546ead4f4a07e18b4d15954c2">auth_token_init_secret</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a52c3c5b8bfd7c529453ef8b526944209">auth_token_key</a>,</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                           c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a1af2953c72fe865980a534643c666c7c">auth_token_secret_file</a>,</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                           c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#aae72600b05bd85d54009524b5a2a9a8d">auth_token_secret_file_inline</a>);</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;}</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160; </div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="comment"> * Initialize the persistent component of OpenVPN&#39;s TLS mode,</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;<span class="comment"> * which is preserved across SIGUSR1 resets.</span></div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l02718"></a><span class="lineno"><a class="line" href="init_8c.html#ab260427074ab585e40d538eda5029935"> 2718</a></span>&#160;<a class="code" href="init_8c.html#ab260427074ab585e40d538eda5029935">do_init_crypto_tls_c1</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;{</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a> = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>;</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160; </div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="ssl__backend_8h.html#a8a8bcdcde91147e4138bc85510f22595">tls_ctx_initialised</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a5e59f0aab5d757ed334039b15682829a">ssl_ctx</a>))</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    {</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;<span class="comment">         * Initialize the OpenSSL library&#39;s global</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;<span class="comment">         * SSL context.</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        <a class="code" href="ssl_8c.html#a8ead42ff42559ea4d44fb4cf600a26f1">init_ssl</a>(<a class="code" href="structoptions.html">options</a>, &amp;(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a5e59f0aab5d757ed334039b15682829a">ssl_ctx</a>), c-&gt;<a class="code" href="structcontext.html#a1d0cd1cb672a5fee441bdc504fc0fa93">c0</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#a1d0cd1cb672a5fee441bdc504fc0fa93">c0</a>-&gt;<a class="code" href="structcontext__0.html#adf83164d54c6c56957e5550a45b63338">uid_gid_chroot_set</a>);</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="ssl__backend_8h.html#a8a8bcdcde91147e4138bc85510f22595">tls_ctx_initialised</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a5e59f0aab5d757ed334039b15682829a">ssl_ctx</a>))</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;        {</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="options_8c.html#ade63586867ed9b0f268b4857ac8e7a5f">auth_retry_get</a>())</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;            {</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="options_8h.html#aa4019b2e0b0d1bc21cdb433db9d5507d">AR_NONE</a>:</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;Error: private key password verification failed&quot;</span>);</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160; </div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="options_8h.html#a570ecbd9a01e98df42199d078454f848">AR_INTERACT</a>:</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                    <a class="code" href="ssl_8c.html#a004bfec7a400d6c55a880bde27ff8b23">ssl_purge_auth</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160; </div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="options_8h.html#aa9cc77b228a8b97a2b65e6865b7ae005">AR_NOINTERACT</a>:</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                    c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> = <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>; <span class="comment">/* SOFT-SIGUSR1 -- Password failure error */</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160; </div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(0);</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;            }</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a> = <span class="stringliteral">&quot;private-key-password-failure&quot;</span>;</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="preprocessor">#else  </span><span class="comment">/* if P2MP */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a>, <span class="stringliteral">&quot;Error: private key password verification failed&quot;</span>);</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* if P2MP */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;        }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160; </div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="comment">         * BF-CBC is allowed to be used only when explicitly configured</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="comment">         * as NCP-fallback or when NCP has been disabled or explicitly</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;<span class="comment">         * allowed in the in ncp_ciphers list.</span></div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="comment">         * In all other cases do not attempt to initialize BF-CBC as it</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;<span class="comment">         * may not even be supported by the underlying SSL library.</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="comment">         * Therefore, the key structure has to be initialized when:</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="comment">         * - any non-BF-CBC cipher was selected; or</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="comment">         * - BF-CBC is selected and NCP is disabled (explicit request to</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="comment">         *   use the BF-CBC cipher); or</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="comment">         * - BF-CBC is selected, NCP is enabled and fallback is enabled</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="comment">         *   (BF-CBC will be the fallback).</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="comment">         * - BF-CBC is in data-ciphers and we negotiate to use BF-CBC:</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;<span class="comment">         *   If the negotiated cipher and options-&gt;ciphername are the</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;<span class="comment">         *   same we do not reinit the cipher</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;<span class="comment">         *</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="comment">         * Note that BF-CBC will still be part of the OCC string to retain</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;<span class="comment">         * backwards compatibility with older clients.</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="options_8h.html#a4841717e2f45399a58c25188a1247c7a">streq</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7f09235fee401590074265aff177491a">ciphername</a>, <span class="stringliteral">&quot;BF-CBC&quot;</span>) || !<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c5a04e0f575936f6d77977ca5c5748b">ncp_enabled</a></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;            || (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c5a04e0f575936f6d77977ca5c5748b">ncp_enabled</a> &amp;&amp; <a class="code" href="ssl__ncp_8c.html#a9e8061a56d8a114317b5f829b6cbf19b">tls_item_in_cipher_list</a>(<span class="stringliteral">&quot;BF-CBC&quot;</span>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c186af1daae850bf1f44d5534de11d1">ncp_ciphers</a>))</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;            || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a99e510c2a30b72320d57b21af78636db">enable_ncp_fallback</a>)</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        {</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;            <span class="comment">/* Do not warn if the if the cipher is used only in OCC */</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;            <span class="keywordtype">bool</span> warn = !<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c5a04e0f575936f6d77977ca5c5748b">ncp_enabled</a> || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a99e510c2a30b72320d57b21af78636db">enable_ncp_fallback</a>;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;            <a class="code" href="crypto_8c.html#a5657fa40c2ed8eed4ac057b87902100b">init_key_type</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a4a34faf7867d3d6647238e914324a99b">key_type</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7f09235fee401590074265aff177491a">ciphername</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a3b2503d5f5f98a176450b3baf1953a20">authname</a>,</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                          <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ae644c14875e0dd32c008a4685f3ee3e3">keysize</a>, <span class="keyword">true</span>, warn);</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;        }</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;        <span class="comment">/* Initialize PRNG with config-specified digest */</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;        <a class="code" href="crypto_8c.html#ab99dea190ad93a642a0fc5a429b8f0ed">prng_init</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a67f4cc4bc80fc43da3ca9a24e5fb72b7">prng_hash</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a3d0e034a7cdda86ad66beee637423a74">prng_nonce_secret_len</a>);</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160; </div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        <span class="comment">/* initialize tls-auth/crypt/crypt-v2 key */</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        <a class="code" href="init_8c.html#a08b482cd93161c760290cc90add5e1dd">do_init_tls_wrap_key</a>(c);</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160; </div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        <span class="comment">/* initialise auth-token crypto support */</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        <a class="code" href="init_8c.html#a0614ef4b7979dcbd99edf1b4bf6b3226">do_init_auth_token_key</a>(c);</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160; </div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="preprocessor">#if 0 </span><span class="comment">/* was: #if ENABLE_INLINE_FILES --  Note that enabling this code will break restarts */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a93453dde5c880b6be77c27c7e42e2dc0">priv_key_file_inline</a>)</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        {</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;            <a class="code" href="buffer_8c.html#a41f2a5ee8d893ed30a214b2d70c5d303">string_clear</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a93453dde5c880b6be77c27c7e42e2dc0">priv_key_file_inline</a>);</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a93453dde5c880b6be77c27c7e42e2dc0">priv_key_file_inline</a> = NULL;</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;        }</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    }</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    {</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#aba55050bac6c04df168bb49da677f651">D_INIT_MEDIUM</a>, <span class="stringliteral">&quot;Re-using SSL/TLS context&quot;</span>);</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160; </div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="comment">         * tls-auth/crypt key can be configured per connection block, therefore</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="comment">         * we must reload it as it may have changed</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;        <a class="code" href="init_8c.html#a08b482cd93161c760290cc90add5e1dd">do_init_tls_wrap_key</a>(c);</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    }</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;}</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160; </div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"><a class="line" href="init_8c.html#a6b2bce56f99c5d493e2282b31f950ff0"> 2814</a></span>&#160;<a class="code" href="init_8c.html#a6b2bce56f99c5d493e2282b31f950ff0">do_init_crypto_tls</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags)</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;{</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a> = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>;</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    <span class="keyword">struct </span><a class="code" href="structtls__options.html">tls_options</a> to;</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    <span class="keywordtype">bool</span> packet_id_long_form;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160; </div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8cc67b442d93909bc5500945a8ac08ff">tls_server</a> || <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a92cffd160044d2b84a1085fa3ddb9a2d">tls_client</a>);</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(!<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a38d22a55bf92acf99f3c5d71d3b06b18">test_crypto</a>);</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160; </div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    <a class="code" href="init_8c.html#a48a66fea06ba3615248923298b5d8d94">init_crypto_pre</a>(c, flags);</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160; </div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    <span class="comment">/* Make sure we are either a TLS client or server but not both */</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8cc67b442d93909bc5500945a8ac08ff">tls_server</a> == !<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a92cffd160044d2b84a1085fa3ddb9a2d">tls_client</a>);</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160; </div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    <span class="comment">/* initialize persistent component */</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    <a class="code" href="init_8c.html#ab260427074ab585e40d538eda5029935">do_init_crypto_tls_c1</a>(c);</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(c))</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    {</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    }</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160; </div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    <span class="comment">/* Sanity check on sequence number, and cipher mode options */</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <a class="code" href="crypto_8c.html#af0c4bb63e6b4aae63502a87217a36c79">check_replay_consistency</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a4a34faf7867d3d6647238e914324a99b">key_type</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6ab0ea3447528be930897de097a1a37f">replay</a>);</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160; </div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <span class="comment">/* In short form, unique datagram identifier is 32 bits, in long form 64 bits */</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    packet_id_long_form = <a class="code" href="crypto__backend_8h.html#ac7b89b85b5ca673849476a67325d5e84">cipher_kt_mode_ofb_cfb</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a4a34faf7867d3d6647238e914324a99b">key_type</a>.<a class="code" href="structkey__type.html#aba064fbaa853a46ae2d3afbc3ae98aff">cipher</a>);</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160; </div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <span class="comment">/* Compute MTU parameters (postpone if we push/pull options) */</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">pull</a> || c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8a97f5f530042a7f4321cb97c3983fa1">mode</a> == <a class="code" href="options_8h.html#a3f2e4b6d38cb9fbb3839ed4a478bf39d">MODE_SERVER</a>)</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        <span class="comment">/* Account for worst-case crypto overhead before allocating buffers */</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;        <a class="code" href="mtu_8h.html#a8941b4c07aa4e1ba754104e1256316ff">frame_add_to_extra_frame</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, <a class="code" href="crypto_8c.html#ac2246d073775a03a612d337782cfa1a5">crypto_max_overhead</a>());</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;    }</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    {</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        <a class="code" href="crypto_8c.html#af597e0d765df961d66a200fa33ba4faf">crypto_adjust_frame_parameters</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a4a34faf7867d3d6647238e914324a99b">key_type</a>,</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                                       <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6ab0ea3447528be930897de097a1a37f">replay</a>, packet_id_long_form);</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    <a class="code" href="ssl_8c.html#a9ac546116b6a0717a88e54cf9cd6777c">tls_adjust_frame_parameters</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>);</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160; </div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <span class="comment">/* Set all command-line TLS-related options */</span></div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(to);</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160; </div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6a1327f7d30f878848f4e72211878a88">mute_replay_warnings</a>)</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    {</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        to.<a class="code" href="structtls__options.html#a3a022b710a7ebee3df60d348c58cbd20">crypto_flags</a> |= <a class="code" href="crypto_8h.html#a897fcd411cae93fbed05653515ce480e">CO_MUTE_REPLAY_WARNINGS</a>;</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    }</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160; </div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    to.<a class="code" href="structtls__options.html#a3a022b710a7ebee3df60d348c58cbd20">crypto_flags</a> &amp;= ~(<a class="code" href="crypto_8h.html#a10cf731ef4917a647cdca413d507ff81">CO_PACKET_ID_LONG_FORM</a>);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    <span class="keywordflow">if</span> (packet_id_long_form)</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    {</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        to.<a class="code" href="structtls__options.html#a3a022b710a7ebee3df60d348c58cbd20">crypto_flags</a> |= <a class="code" href="crypto_8h.html#a10cf731ef4917a647cdca413d507ff81">CO_PACKET_ID_LONG_FORM</a>;</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    }</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160; </div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    to.<a class="code" href="structtls__options.html#aba252683ca7cc18c66e8f30762f61ac0">ssl_ctx</a> = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a5e59f0aab5d757ed334039b15682829a">ssl_ctx</a>;</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    to.<a class="code" href="structtls__options.html#accfc424cfd53ef0905546cffc6e462ce">key_type</a> = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a4a34faf7867d3d6647238e914324a99b">key_type</a>;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    to.<a class="code" href="structtls__options.html#a304fb76d1a8c5c3f12f94d66baa51f06">server</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8cc67b442d93909bc5500945a8ac08ff">tls_server</a>;</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    to.<a class="code" href="structtls__options.html#a85250d11ac83ee6a0877ba7a6d193b61">replay</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6ab0ea3447528be930897de097a1a37f">replay</a>;</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    to.<a class="code" href="structtls__options.html#afe554073ee6f5d94c385d43990cc0a0f">replay_window</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a408775e6f474f8c25ad492e9c9d2b7b8">replay_window</a>;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    to.<a class="code" href="structtls__options.html#a56206642b4f35177969bfbe3ffd86714">replay_time</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a27bd2c7c26f4e5bbb67c57743c785b18">replay_time</a>;</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    to.<a class="code" href="structtls__options.html#aacee137fea1151534baef5463687e283">tcp_mode</a> = <a class="code" href="socket_8h.html#afe08e36c8ec910a0039d2fc693c597ec">link_socket_proto_connection_oriented</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>);</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    to.<a class="code" href="structtls__options.html#a961267fe8e3dedb83efee7c83114c641">config_ciphername</a> = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#ad11841ba9d26ef246e5812a7a7db27b6">ciphername</a>;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    to.<a class="code" href="structtls__options.html#aba6a6fa6da4b70ca9842358f9fa74d06">config_ncp_ciphers</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c186af1daae850bf1f44d5534de11d1">ncp_ciphers</a>;</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    to.<a class="code" href="structtls__options.html#ac1a39709cf07e719634a1a6903547414">ncp_enabled</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7c5a04e0f575936f6d77977ca5c5748b">ncp_enabled</a>;</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    to.<a class="code" href="structtls__options.html#a8679088462548aabda1f3921460e3cfe">transition_window</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ae304d9717c86ae466b4749b3ab04b718">transition_window</a>;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    to.<a class="code" href="structtls__options.html#ae0e1be267ee100554d22b027d96191db">handshake_window</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6b960ac0e59bda605e2b6879d024afa2">handshake_window</a>;</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    to.<a class="code" href="structtls__options.html#a3cdc00d65d70c350182145ce7f183fcd">packet_timeout</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a36a0d523e3942a896639cda6abf2e426">tls_timeout</a>;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    to.<a class="code" href="structtls__options.html#ae9ff132a3c7d846e0609b807c86d064a">renegotiate_bytes</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a45bb6bb056b0755eed6445cd8fb07156">renegotiate_bytes</a>;</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    to.<a class="code" href="structtls__options.html#acffc29afc34414d015cee78e2b238ac6">renegotiate_packets</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a56dbf5c1dce17063ea7ae4b351427ef2">renegotiate_packets</a>;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a1a60e506cdd22f1fbf395c90389d1ace">renegotiate_seconds_min</a> &lt; 0)</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    {</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        <span class="comment">/* Add 10% jitter to reneg-sec by default (server side only) */</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        <span class="keywordtype">int</span> auto_jitter = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8a97f5f530042a7f4321cb97c3983fa1">mode</a> != <a class="code" href="options_8h.html#a3f2e4b6d38cb9fbb3839ed4a478bf39d">MODE_SERVER</a> ? 0 :</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                          <a class="code" href="crypto_8c.html#a37fb65e30bd2c33564b14ad76a0c0794">get_random</a>() % <a class="code" href="integer_8h.html#a957926ee375593740a330d12523eddb1">max_int</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac6e1f16b4069b73fef030866606705bb">renegotiate_seconds</a> / 10, 1);</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;        to.<a class="code" href="structtls__options.html#a5884f8429da3da45931f71e4c8c2aca5">renegotiate_seconds</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac6e1f16b4069b73fef030866606705bb">renegotiate_seconds</a> - auto_jitter;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    }</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    {</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        <span class="comment">/* Add user-specified jitter to reneg-sec */</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;        to.<a class="code" href="structtls__options.html#a5884f8429da3da45931f71e4c8c2aca5">renegotiate_seconds</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac6e1f16b4069b73fef030866606705bb">renegotiate_seconds</a></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                                 -(<a class="code" href="crypto_8c.html#a37fb65e30bd2c33564b14ad76a0c0794">get_random</a>() % <a class="code" href="integer_8h.html#a957926ee375593740a330d12523eddb1">max_int</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac6e1f16b4069b73fef030866606705bb">renegotiate_seconds</a></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                                                          - <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a1a60e506cdd22f1fbf395c90389d1ace">renegotiate_seconds_min</a>, 1));</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    }</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    to.<a class="code" href="structtls__options.html#aa165f8c2301d2dc25b72ef200020ccb5">single_session</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a4d6d794acedbb97bff36ed663408f55b">single_session</a>;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;    to.<a class="code" href="structtls__options.html#a077d6739e499c8488515daf582da6021">mode</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8a97f5f530042a7f4321cb97c3983fa1">mode</a>;</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    to.<a class="code" href="structtls__options.html#add28a119d5a28d79dd0d45e6e0df3ab2">pull</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">pull</a>;</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a17009cf5cdc04448103ca126317d5af7">push_peer_info</a>)        <span class="comment">/* all there is */</span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    {</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        to.<a class="code" href="structtls__options.html#ad0558f94c9b567224214fdee59844be6">push_peer_info_detail</a> = 2;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    }</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">pull</a>)             <span class="comment">/* pull clients send some details */</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    {</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;        to.<a class="code" href="structtls__options.html#ad0558f94c9b567224214fdee59844be6">push_peer_info_detail</a> = 1;</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    }</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    <span class="keywordflow">else</span>                                <span class="comment">/* default: no peer-info at all */</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    {</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;        to.<a class="code" href="structtls__options.html#ad0558f94c9b567224214fdee59844be6">push_peer_info_detail</a> = 0;</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    }</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160; </div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    <span class="comment">/* should we not xmit any packets until we get an initial</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;<span class="comment">     * response from client? */</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    <span class="keywordflow">if</span> (to.<a class="code" href="structtls__options.html#a304fb76d1a8c5c3f12f94d66baa51f06">server</a> &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a> == <a class="code" href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599aeff17f4932089fddd54b29765c8cdbd7">PROTO_TCP_SERVER</a>)</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    {</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;        to.<a class="code" href="structtls__options.html#ac267c87257baba5792b12cb984761ded">xmit_hold</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    }</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160; </div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;    to.<a class="code" href="structtls__options.html#a4b1687d7aa7cce6fa57a1e468205647e">disable_occ</a> = !<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af42951e43928baf71be50f6d6680358a">occ</a>;</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160; </div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    to.<a class="code" href="structtls__options.html#a7c8367192cd2005afa4971a0468b31bf">verify_command</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a937ce3e9f18cc533ac9baab101437360">tls_verify</a>;</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    to.<a class="code" href="structtls__options.html#a565a61d1fe9209be7fe0c41940a46126">verify_export_cert</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8f3c7dbd55ca4f5e960020ecdecf032f">tls_export_cert</a>;</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    to.<a class="code" href="structtls__options.html#a9dec6251d97917d104baa69ddf27a5b3">verify_x509_type</a> = (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ab7d414e087194f31b1a0f16dec7bd0f9">verify_x509_type</a> &amp; 0xff);</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    to.<a class="code" href="structtls__options.html#aa2b4275c8e14021d83b15a7e17e939d3">verify_x509_name</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#acdf0fec84661c4ccdf8bbf01430e3729">verify_x509_name</a>;</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    to.<a class="code" href="structtls__options.html#ae03dbf132f7b9a09b54c516361a143da">crl_file</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a9665bb2a81816f56c43a05593b7cf304">crl_file</a>;</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    to.<a class="code" href="structtls__options.html#aa5c2cadf23718676434cf1d684496e0c">crl_file_inline</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a1d84d69d3c4d0be2b7bfabe76c518a03">crl_file_inline</a>;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    to.<a class="code" href="structtls__options.html#ac316f151e832d8d58f7e4601a56d8ec2">ssl_flags</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a3564873509d5272dd6fca9fa283d1560">ssl_flags</a>;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    to.<a class="code" href="structtls__options.html#ad872e320bb7be0b04c535cec5f21195b">ns_cert_type</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a888a84a61b2986b8c433b9a98c8de5ad">ns_cert_type</a>;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;    memmove(to.<a class="code" href="structtls__options.html#a3a5c52df12ac9222ea08cec7753b22b5">remote_cert_ku</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a2f274b709207225b29461a422026c921">remote_cert_ku</a>, <span class="keyword">sizeof</span>(to.<a class="code" href="structtls__options.html#a3a5c52df12ac9222ea08cec7753b22b5">remote_cert_ku</a>));</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;    to.<a class="code" href="structtls__options.html#aefa62cdcb579f4a6bce35311ce9da7a6">remote_cert_eku</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a35efdd07abfdcad8904ed80f823be6b4">remote_cert_eku</a>;</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    to.<a class="code" href="structtls__options.html#ac131aba077a096b47e8b5c32f5da0878">verify_hash</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af331e61067f9d3fa9d071615d6830720">verify_hash</a>;</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;    to.<a class="code" href="structtls__options.html#ada951f04756086139587ecfb2f407b52">verify_hash_algo</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a2243ce90bf5e84bb70fdb979f452669e">verify_hash_algo</a>;</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="preprocessor">#ifdef ENABLE_X509ALTUSERNAME</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    to.<a class="code" href="structtls__options.html#a647ce1910e6a305011105ef5209c4969">x509_username_field</a> = (<span class="keywordtype">char</span> *) <a class="code" href="structoptions.html">options</a>-&gt;x509_username_field;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    to.<a class="code" href="structtls__options.html#a647ce1910e6a305011105ef5209c4969">x509_username_field</a> = <a class="code" href="ssl_8h.html#a4f8dfe6e6f75a82e742d132b0281f201">X509_USERNAME_FIELD_DEFAULT</a>;</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;#endif</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;    to.<a class="code" href="structtls__options.html#a29e88c10288d7ee1207ed626117a4ea4">es</a> = c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>;</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    to.<a class="code" href="structtls__options.html#a4ea8b33ebbb1783522d2f500ea21b6b7">net_ctx</a> = &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>;</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160; </div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;#ifdef <a class="code" href="config_8h.html#a432138093c53d7580af9ec5c5dca387f">ENABLE_DEBUG</a></div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    to.<a class="code" href="structtls__options.html#a2e82573d07cb52d69a675b425a2289b0">gremlin</a> = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.gremlin;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;#endif</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160; </div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    to.<a class="code" href="structtls__options.html#a65cc3bb31f01ba455cf02d05d9278990">plugins</a> = c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>;</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160; </div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;#ifdef MANAGEMENT_DEF_AUTH</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;    to.mda_context = &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.mda_context;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;#endif</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160; </div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    to.<a class="code" href="structtls__options.html#aeb2cd80ce9217819340aa766eaed9144">auth_user_pass_verify_script</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8ccb263f0341f4fd5d62be0b75f755c8">auth_user_pass_verify_script</a>;</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    to.<a class="code" href="structtls__options.html#aba4fa26785baef6cf8f3d2a059c21329">auth_user_pass_verify_script_via_file</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a43abde759eeff1275512f016df43c9c6">auth_user_pass_verify_script_via_file</a>;</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    to.<a class="code" href="structtls__options.html#a5303f93b3bc97cc9244e09c2b5b6f67a">tmp_dir</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a16ceb67810c4fefa8b47b716cac5f835">tmp_dir</a>;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    if (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#abd80805f226deec56890d201bcb74718">ccd_exclusive</a>)</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    {</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        to.<a class="code" href="structtls__options.html#a6c4a92bcce9d3725e64aab48866dff34">client_config_dir_exclusive</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#af9495898a3334684c7af68f647364639">client_config_dir</a>;</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    }</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;    to.<a class="code" href="structtls__options.html#a40a53a0bdb1e513c6c72f86b5d4d0878">auth_user_pass_file</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a80357ca49c6ac35d1ff5c621bd66ac96">auth_user_pass_file</a>;</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    to.<a class="code" href="structtls__options.html#ac372c2391af017e204af37a3e80596b4">auth_token_generate</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a93398bf07c69b890f12b90ca62c0e259">auth_token_generate</a>;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;    to.<a class="code" href="structtls__options.html#a29eb252102c01147ec581ed6195ef810">auth_token_lifetime</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a87af131c4385d6b8a37ef36a6679abfc">auth_token_lifetime</a>;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    to.<a class="code" href="structtls__options.html#addb0301d3ccf314df1b25286f6427ce6">auth_token_call_auth</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7a3a8d6e7b24367c430941b60cbd466a">auth_token_call_auth</a>;</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    to.<a class="code" href="structtls__options.html#a039656e7d5ffb2c9d2baeaa15572e329">auth_token_key</a> = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a52c3c5b8bfd7c529453ef8b526944209">auth_token_key</a>;</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160; </div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    to.<a class="code" href="structtls__options.html#aa89186ad01664f682492681829e7fffa">x509_track</a> = <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#ac34bf3412bfd7f1c7185e08c3e6d212c">x509_track</a>;</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160; </div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    to.<a class="code" href="structtls__options.html#a48cb4feb82596cc68bef7e46bed556c0">sci</a> = &amp;<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a7934e68d00c2cf1aa45ca566ed163d71">sc_info</a>;</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160; </div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;<span class="preprocessor">#ifdef USE_COMP</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    to.comp_options = <a class="code" href="structoptions.html">options</a>-&gt;comp;</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160; </div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;<span class="preprocessor">#ifdef HAVE_EXPORT_KEYING_MATERIAL</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;keying_material_exporter_label)</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;    {</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;        to.<a class="code" href="structtls__options.html#a85a0b7f779720f69cbb54dc8c66a1f28">ekm_size</a> = <a class="code" href="structoptions.html">options</a>-&gt;keying_material_exporter_length;</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;        <span class="keywordflow">if</span> (to.<a class="code" href="structtls__options.html#a85a0b7f779720f69cbb54dc8c66a1f28">ekm_size</a> &lt; 16 || to.<a class="code" href="structtls__options.html#a85a0b7f779720f69cbb54dc8c66a1f28">ekm_size</a> &gt; 4095)</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;        {</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;            to.<a class="code" href="structtls__options.html#a85a0b7f779720f69cbb54dc8c66a1f28">ekm_size</a> = 0;</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        }</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160; </div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        to.<a class="code" href="structtls__options.html#a82f79817c7b40b932af6074ab2ae6248">ekm_label</a> = <a class="code" href="structoptions.html">options</a>-&gt;keying_material_exporter_label;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;        to.<a class="code" href="structtls__options.html#a37f7ed366f2247399784d478243d2ce1">ekm_label_size</a> = strlen(to.<a class="code" href="structtls__options.html#a82f79817c7b40b932af6074ab2ae6248">ekm_label</a>);</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    }</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    {</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        to.<a class="code" href="structtls__options.html#a85a0b7f779720f69cbb54dc8c66a1f28">ekm_size</a> = 0;</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;    }</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_EXPORT_KEYING_MATERIAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160; </div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    <span class="comment">/* TLS handshake authentication (--tls-auth) */</span></div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#ac874d736329eb6f60ab54e86e4f7c4ef">tls_auth_file</a>)</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    {</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;        to.<a class="code" href="structtls__options.html#a339f31e34055b262d5fc4ff59ea08cf5">tls_wrap</a>.<a class="code" href="structtls__wrap__ctx.html#a26648735a6e3a08455ad8191dad8f119">mode</a> = TLS_WRAP_AUTH;</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        to.<a class="code" href="structtls__options.html#a339f31e34055b262d5fc4ff59ea08cf5">tls_wrap</a>.<a class="code" href="structtls__wrap__ctx.html#a610411b7046f8b43a47cc92c0ef9bd6d">opt</a>.<a class="code" href="structcrypto__options.html#a6f5aaea8aa6f397a0684d8b0a2879252">key_ctx_bi</a> = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#ad2ce1d97a35d1c487ce7c13f52d900c5">tls_wrap_key</a>;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;        to.<a class="code" href="structtls__options.html#a339f31e34055b262d5fc4ff59ea08cf5">tls_wrap</a>.<a class="code" href="structtls__wrap__ctx.html#a610411b7046f8b43a47cc92c0ef9bd6d">opt</a>.<a class="code" href="structcrypto__options.html#a64268b2eac664d85f5e6133264f937ce">pid_persist</a> = &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa20a2b143b3a7f2db2cc9a1af3cdf3e2">pid_persist</a>;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;        to.<a class="code" href="structtls__options.html#a339f31e34055b262d5fc4ff59ea08cf5">tls_wrap</a>.<a class="code" href="structtls__wrap__ctx.html#a610411b7046f8b43a47cc92c0ef9bd6d">opt</a>.<a class="code" href="structcrypto__options.html#a4f1cebf03b32cf2f3b44e90630079e88">flags</a> |= <a class="code" href="crypto_8h.html#a10cf731ef4917a647cdca413d507ff81">CO_PACKET_ID_LONG_FORM</a>;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        <a class="code" href="crypto_8c.html#af597e0d765df961d66a200fa33ba4faf">crypto_adjust_frame_parameters</a>(&amp;to.<a class="code" href="structtls__options.html#a5cd706b37fc6ef4c738058cbe63bad78">frame</a>, &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a6a3add124db00336ab5c081037ae11fd">tls_auth_key_type</a>,</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;                                       <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    }</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160; </div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    <span class="comment">/* TLS handshake encryption (--tls-crypt) */</span></div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a31750e717d5fad479ca6b5930d7cb1db">tls_crypt_file</a></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        || (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a36ddd27b1acf681234f8d8a07b64e2a2">tls_crypt_v2_file</a> &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a92cffd160044d2b84a1085fa3ddb9a2d">tls_client</a>))</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    {</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;        to.<a class="code" href="structtls__options.html#a339f31e34055b262d5fc4ff59ea08cf5">tls_wrap</a>.<a class="code" href="structtls__wrap__ctx.html#a26648735a6e3a08455ad8191dad8f119">mode</a> = TLS_WRAP_CRYPT;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;        to.<a class="code" href="structtls__options.html#a339f31e34055b262d5fc4ff59ea08cf5">tls_wrap</a>.<a class="code" href="structtls__wrap__ctx.html#a610411b7046f8b43a47cc92c0ef9bd6d">opt</a>.<a class="code" href="structcrypto__options.html#a6f5aaea8aa6f397a0684d8b0a2879252">key_ctx_bi</a> = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#ad2ce1d97a35d1c487ce7c13f52d900c5">tls_wrap_key</a>;</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;        to.<a class="code" href="structtls__options.html#a339f31e34055b262d5fc4ff59ea08cf5">tls_wrap</a>.<a class="code" href="structtls__wrap__ctx.html#a610411b7046f8b43a47cc92c0ef9bd6d">opt</a>.<a class="code" href="structcrypto__options.html#a64268b2eac664d85f5e6133264f937ce">pid_persist</a> = &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa20a2b143b3a7f2db2cc9a1af3cdf3e2">pid_persist</a>;</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;        to.<a class="code" href="structtls__options.html#a339f31e34055b262d5fc4ff59ea08cf5">tls_wrap</a>.<a class="code" href="structtls__wrap__ctx.html#a610411b7046f8b43a47cc92c0ef9bd6d">opt</a>.<a class="code" href="structcrypto__options.html#a4f1cebf03b32cf2f3b44e90630079e88">flags</a> |= <a class="code" href="crypto_8h.html#a10cf731ef4917a647cdca413d507ff81">CO_PACKET_ID_LONG_FORM</a>;</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;        <a class="code" href="group__tls__crypt.html#ga24b342111241c5ea9c731de4aa66fcb2">tls_crypt_adjust_frame_parameters</a>(&amp;to.<a class="code" href="structtls__options.html#a5cd706b37fc6ef4c738058cbe63bad78">frame</a>);</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160; </div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a36ddd27b1acf681234f8d8a07b64e2a2">tls_crypt_v2_file</a>)</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;        {</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;            to.<a class="code" href="structtls__options.html#a339f31e34055b262d5fc4ff59ea08cf5">tls_wrap</a>.<a class="code" href="structtls__wrap__ctx.html#ad96b76798b05ef4165ae44a0127cf6ca">tls_crypt_v2_wkc</a> = &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a239e3a613b599e2b9ff2c1a3244c398b">tls_crypt_v2_wkc</a>;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        }</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    }</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160; </div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a36ddd27b1acf681234f8d8a07b64e2a2">tls_crypt_v2_file</a>)</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    {</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        to.<a class="code" href="structtls__options.html#a6e288c7eb3ad0ba9ff4631ac05756564">tls_crypt_v2</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a8cc67b442d93909bc5500945a8ac08ff">tls_server</a>)</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        {</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;            to.<a class="code" href="structtls__options.html#a339f31e34055b262d5fc4ff59ea08cf5">tls_wrap</a>.<a class="code" href="structtls__wrap__ctx.html#acc45bce786e0254c135835e42fc4ee94">tls_crypt_v2_server_key</a> = c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#afc58d93e9c900d3bd001a8ee09f0932c">tls_crypt_v2_server_key</a>;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;            to.<a class="code" href="structtls__options.html#ab9ad0cb54448fd1bb2e5c4d1a0271820">tls_crypt_v2_verify_script</a> = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a88bf02c9e8a2a52b01fa9ba34e9f2cc4">tls_crypt_v2_verify_script</a>;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;        }</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    }</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160; </div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    <span class="comment">/* If we are running over TCP, allow for</span></div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;<span class="comment">     * length prefix */</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;    <a class="code" href="socket_8c.html#af4927a4638ad626394e1cc000cfe5466">socket_adjust_frame_parameters</a>(&amp;to.<a class="code" href="structtls__options.html#a5cd706b37fc6ef4c738058cbe63bad78">frame</a>, <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>);</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160; </div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;<span class="comment">     * Initialize OpenVPN&#39;s master TLS-mode object.</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="init_8c.html#a57cbdb902da19e518279d624dd22b5c4">CF_INIT_TLS_MULTI</a>)</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    {</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a> = <a class="code" href="group__control__processor.html#gaf7223d904613a08407ae52dc3831d7a2">tls_multi_init</a>(&amp;to);</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;    }</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160; </div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="init_8c.html#adc52e27fb65137f8ac18a18cd03551f6">CF_INIT_TLS_AUTH_STANDALONE</a>)</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    {</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a5504671bac689290cd35901bf7d031aa">tls_auth_standalone</a> = <a class="code" href="group__control__processor.html#ga03aaa9093737daae72627dc38198dd1d">tls_auth_standalone_init</a>(&amp;to, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ad4aeb5d46c4a32dc490a124af2c0770a">gc</a>);</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    }</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;}</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160; </div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03051"></a><span class="lineno"><a class="line" href="init_8c.html#a3bc4d5a823499472a3bc61b5a263c603"> 3051</a></span>&#160;<a class="code" href="init_8c.html#a3bc4d5a823499472a3bc61b5a263c603">do_init_finalize_tls_frame</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;{</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>)</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;    {</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;        <a class="code" href="group__control__processor.html#gada87c9f2a7755ab7507dd16fa6e22716">tls_multi_init_finalize</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>);</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;        <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(<a class="code" href="mtu_8h.html#acffacbc0669bb2e42bdb97650c816db6">EXPANDED_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a6cd0005716f05da0398d85f6f1693e5d">opt</a>.<a class="code" href="structtls__options.html#a5cd706b37fc6ef4c738058cbe63bad78">frame</a>) &lt;=</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;               <a class="code" href="mtu_8h.html#acffacbc0669bb2e42bdb97650c816db6">EXPANDED_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>));</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        <a class="code" href="mtu_8c.html#a224812036cf5be8e57a95dad7d45067e">frame_print</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#a6cd0005716f05da0398d85f6f1693e5d">opt</a>.<a class="code" href="structtls__options.html#a5cd706b37fc6ef4c738058cbe63bad78">frame</a>, <a class="code" href="errlevel_8h.html#aab9d07562cfecbd96b4c9e1d242d7d15">D_MTU_INFO</a>,</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;                    <span class="stringliteral">&quot;Control Channel MTU parms&quot;</span>);</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    }</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a5504671bac689290cd35901bf7d031aa">tls_auth_standalone</a>)</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    {</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        <a class="code" href="group__control__processor.html#ga85674d980185b3f2923ae9540114289a">tls_auth_standalone_finalize</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a5504671bac689290cd35901bf7d031aa">tls_auth_standalone</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>);</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;        <a class="code" href="mtu_8c.html#a224812036cf5be8e57a95dad7d45067e">frame_print</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a5504671bac689290cd35901bf7d031aa">tls_auth_standalone</a>-&gt;<a class="code" href="structtls__auth__standalone.html#a72cf30b064c14558ff2e61212cc0c33c">frame</a>, <a class="code" href="errlevel_8h.html#aab9d07562cfecbd96b4c9e1d242d7d15">D_MTU_INFO</a>,</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;                    <span class="stringliteral">&quot;TLS-Auth MTU parms&quot;</span>);</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;    }</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;}</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160; </div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="comment"> * No encryption or authentication.</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"><a class="line" href="init_8c.html#a94da6556c2a7e8067e772f2d7a0ac7d6"> 3073</a></span>&#160;<a class="code" href="init_8c.html#a94da6556c2a7e8067e772f2d7a0ac7d6">do_init_crypto_none</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;{</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(!c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a38d22a55bf92acf99f3c5d71d3b06b18">test_crypto</a>);</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>,</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;        <span class="stringliteral">&quot;******* WARNING *******: All encryption and authentication features &quot;</span></div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;        <span class="stringliteral">&quot;disabled -- All data will be tunnelled as clear text and will not be &quot;</span></div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;        <span class="stringliteral">&quot;protected against man-in-the-middle changes. &quot;</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;        <span class="stringliteral">&quot;PLEASE DO RECONSIDER THIS CONFIGURATION!&quot;</span>);</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;}</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160; </div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"><a class="line" href="init_8c.html#a3660e2369c99008cda0efe61b5acfbac"> 3084</a></span>&#160;<a class="code" href="init_8c.html#a3660e2369c99008cda0efe61b5acfbac">do_init_crypto</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags)</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;{</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#af4f6ab25d97dd623648d3c2342659e0d">shared_secret_file</a>)</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    {</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;        <a class="code" href="init_8c.html#a24ee82204efb10e4948c83b1cb1a4853">do_init_crypto_static</a>(c, flags);</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    }</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8cc67b442d93909bc5500945a8ac08ff">tls_server</a> || c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a92cffd160044d2b84a1085fa3ddb9a2d">tls_client</a>)</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    {</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;        <a class="code" href="init_8c.html#a6b2bce56f99c5d493e2282b31f950ff0">do_init_crypto_tls</a>(c, flags);</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    }</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;    <span class="keywordflow">else</span>                        <span class="comment">/* no encryption or authentication. */</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    {</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;        <a class="code" href="init_8c.html#a94da6556c2a7e8067e772f2d7a0ac7d6">do_init_crypto_none</a>(c);</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    }</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;}</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160; </div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"><a class="line" href="init_8c.html#a2e4b08374469d04d9541f64273665582"> 3101</a></span>&#160;<a class="code" href="init_8c.html#a2e4b08374469d04d9541f64273665582">do_init_frame</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;{</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;<span class="preprocessor">#ifdef USE_COMP</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;<span class="comment">     * modify frame parameters if compression is enabled</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <span class="keywordflow">if</span> (comp_enabled(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.comp))</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    {</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;        comp_add_to_extra_frame(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>);</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160; </div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;<span class="preprocessor">#if !defined(ENABLE_LZ4)</span></div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;<span class="comment">         * Compression usage affects buffer alignment when non-swapped algs</span></div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;<span class="comment">         * such as LZO is used.</span></div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;<span class="comment">         * Newer algs like LZ4 and comp-stub with COMP_F_SWAP don&#39;t need</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;<span class="comment">         * any special alignment because of the control-byte swap approach.</span></div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;<span class="comment">         * LZO alignment (on the other hand) is problematic because</span></div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;<span class="comment">         * the presence of the control byte means that either the output of</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;<span class="comment">         * decryption must be written to an unaligned buffer, or the input</span></div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;<span class="comment">         * to compression (or packet dispatch if packet is uncompressed)</span></div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;<span class="comment">         * must be read from an unaligned buffer.</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;<span class="comment">         * This code tries to align the input to compression (or packet</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;<span class="comment">         * dispatch if packet is uncompressed) at the cost of requiring</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;<span class="comment">         * decryption output to be written to an unaligned buffer, so</span></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;<span class="comment">         * it&#39;s more of a tradeoff than an optimal solution and we don&#39;t</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;<span class="comment">         * include it when we are doing a modern build with LZ4.</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;<span class="comment">         * Strictly speaking, on the server it would be better to execute</span></div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;<span class="comment">         * this code for every connection after we decide the compression</span></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;<span class="comment">         * method, but currently the frame code doesn&#39;t appear to be</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;<span class="comment">         * flexible enough for this, since the frame is already established</span></div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;<span class="comment">         * before it is known which compression options will be pushed.</span></div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;        <span class="keywordflow">if</span> (comp_unswapped_prefix(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.comp) &amp;&amp; <a class="code" href="openvpn_8h.html#a52609d7e7380af270a8921703521fd41">CIPHER_ENABLED</a>(c))</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        {</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;            <a class="code" href="mtu_8h.html#a226f42aa4fb3787fef5d19bed986a1b8">frame_add_to_align_adjust</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, COMP_PREFIX_LEN);</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;            <a class="code" href="mtu_8h.html#a9b846353f7034b285415993fd07b5f1d">frame_or_align_flags</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>,</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;                                 <a class="code" href="mtu_8h.html#a551c5fa35eafecb8d7451cc643f889a1">FRAME_HEADROOM_MARKER_FRAGMENT</a></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;                                 |<a class="code" href="mtu_8h.html#a0ff765260d51b14bd581b75a6be7c67c">FRAME_HEADROOM_MARKER_DECRYPT</a>);</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;        }</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160; </div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;<span class="preprocessor">#ifdef ENABLE_FRAGMENT</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;        comp_add_to_extra_frame(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a46b6fb8bbbdf12a965191460c1af9d3f">frame_fragment_omit</a>); <span class="comment">/* omit compression frame delta from final frame_fragment */</span></div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    }</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_COMP */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160; </div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;<span class="comment">     * Adjust frame size for UDP Socks support.</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#aacc02906ca3f2d2be9f28171bcd60452">socks_proxy_server</a>)</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;    {</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;        <a class="code" href="socks_8c.html#ae7e0b35168a8224034b9a8d86e2a9f5e">socks_adjust_frame_parameters</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>);</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;    }</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160; </div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="comment">     * Adjust frame size based on the --tun-mtu-extra parameter.</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a3d3ab06697dbc44a288e6f07b0bdbf3a">tun_mtu_extra_defined</a>)</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;    {</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;        <a class="code" href="tun_8h.html#a0b8986f57529b7f83fb7f610e01c583b">tun_adjust_frame_parameters</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a1bdd5db16d783c90714bcf5c9ae1cdf6">tun_mtu_extra</a>);</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    }</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160; </div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;<span class="comment">     * Adjust frame size based on link socket parameters.</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;<span class="comment">     * (Since TCP is a stream protocol, we need to insert</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;<span class="comment">     * a packet length uint16_t in the buffer.)</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;    <a class="code" href="socket_8c.html#af4927a4638ad626394e1cc000cfe5466">socket_adjust_frame_parameters</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>);</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160; </div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;<span class="comment">     * Fill in the blanks in the frame parameters structure,</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="comment">     * make sure values are rational, etc.</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;    <a class="code" href="init_8c.html#ab818bc3b2b7753d2c5a010ad207b5084">frame_finalize_options</a>(c, NULL);</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160; </div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="preprocessor">#ifdef USE_COMP</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment">     * Modify frame parameters if compression is compiled in.</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="comment">     * Should be called after frame_finalize_options.</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    comp_add_to_extra_buffer(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>);</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="preprocessor">#ifdef ENABLE_FRAGMENT</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    comp_add_to_extra_buffer(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a46b6fb8bbbdf12a965191460c1af9d3f">frame_fragment_omit</a>); <span class="comment">/* omit compression frame delta from final frame_fragment */</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* USE_COMP */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160; </div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;    <span class="comment">/* packets with peer-id (P_DATA_V2) need 3 extra bytes in frame (on client)</span></div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="comment">     * and need link_mtu+3 bytes on socket reception (on server).</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="comment">     * accommodate receive path in f-&gt;extra_link, which has the side effect of</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment">     * also increasing send buffers (BUF_SIZE() macro), which need to be</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="comment">     * allocated big enough before receiving peer-id option from server.</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="comment">     * f-&gt;extra_frame is adjusted when peer-id option is push-received</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    <a class="code" href="mtu_8h.html#ad93de297470fbd9500df2f67db8bd084">frame_add_to_extra_link</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, 3);</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160; </div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="preprocessor">#ifdef ENABLE_FRAGMENT</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;<span class="comment">     * Set frame parameter for fragment code.  This is necessary because</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;<span class="comment">     * the fragmentation code deals with payloads which have already been</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;<span class="comment">     * passed through the compression code.</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7cd4fe8da737769bc4b6341c7dcfb2a2">frame_fragment</a> = c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>;</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    <a class="code" href="mtu_8c.html#a07432f6efa9b2facc2bd910743ec21f3">frame_subtract_extra</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7cd4fe8da737769bc4b6341c7dcfb2a2">frame_fragment</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a46b6fb8bbbdf12a965191460c1af9d3f">frame_fragment_omit</a>);</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ae9fac99a50578f25555d9dfcb3320c98">frame_fragment_initial</a> = c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7cd4fe8da737769bc4b6341c7dcfb2a2">frame_fragment</a>;</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160; </div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;<span class="preprocessor">#if defined(ENABLE_FRAGMENT)</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;<span class="comment">     * MTU advisories</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#ab003130b974deb481133d4209f74b25c">fragment</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ab706c7c232f46620eb6f20e3846c21f6">mtu_test</a>)</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    {</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>,</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;            <span class="stringliteral">&quot;WARNING: using --fragment and --mtu-test together may produce an inaccurate MTU test result&quot;</span>);</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    }</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160; </div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;<span class="preprocessor">#ifdef ENABLE_FRAGMENT</span></div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="keywordflow">if</span> ((c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a27a04bbbad750c17bbdee216e6a0aacd">mssfix</a> || c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#ab003130b974deb481133d4209f74b25c">fragment</a>)</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;        &amp;&amp; <a class="code" href="mtu_8h.html#aa50df1134d2b079e09d803110563ad80">TUN_MTU_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7cd4fe8da737769bc4b6341c7dcfb2a2">frame_fragment</a>) != <a class="code" href="mtu_8h.html#ab885f5e6d550f896304999fb9dccb0c4">ETHERNET_MTU</a>)</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    {</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>,</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;            <span class="stringliteral">&quot;WARNING: normally if you use --mssfix and/or --fragment, you should also set --tun-mtu %d (currently it is %d)&quot;</span>,</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;            <a class="code" href="mtu_8h.html#ab885f5e6d550f896304999fb9dccb0c4">ETHERNET_MTU</a>, <a class="code" href="mtu_8h.html#aa50df1134d2b079e09d803110563ad80">TUN_MTU_SIZE</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7cd4fe8da737769bc4b6341c7dcfb2a2">frame_fragment</a>));</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    }</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;}</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160; </div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03233"></a><span class="lineno"><a class="line" href="init_8c.html#a27a30601d477a9ec64c7b5abb697b5df"> 3233</a></span>&#160;<a class="code" href="init_8c.html#a27a30601d477a9ec64c7b5abb697b5df">do_option_warnings</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;{</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structoptions.html">options</a> *o = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>;</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160; </div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#acee62ed6d25e482506731cada8f1ecaa">ping_send_timeout</a> &amp;&amp; !o-&gt;<a class="code" href="structoptions.html#ac7d983496a189237f68f99e6816708c8">ping_rec_timeout</a>)</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    {</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: --ping should normally be used with --ping-restart or --ping-exit&quot;</span>);</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;    }</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160; </div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a8388094487ff9931a91eb02e7fa8d472">username</a> || o-&gt;<a class="code" href="structoptions.html#add57437239b837341d533dac68982743">groupname</a> || o-&gt;<a class="code" href="structoptions.html#ac37a2848b8a1a91de9dfde7c1c9d8fa5">chroot_dir</a></div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;#ifdef ENABLE_SELINUX</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;        || o-&gt;selinux_context</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;#endif</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;        )</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    {</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;        <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="structoptions.html#aa5a53a81882886ed763b33d6db6050e4">persist_tun</a>)</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        {</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: you are using user/group/chroot/setcon without persist-tun -- this may cause restarts to fail&quot;</span>);</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;        }</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;        <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="structoptions.html#a66101dbc2f00c4ef3e1ac1a492292811">persist_key</a></div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;#ifdef <a class="code" href="config-msvc_8h.html#a85aeb0494fcbd4bab2b193dc6100ca23">ENABLE_PKCS11</a></div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;            &amp;&amp; !o-&gt;pkcs11_id</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;#endif</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;            )</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;        {</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: you are using user/group/chroot/setcon without persist-key -- this may cause restarts to fail&quot;</span>);</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;        }</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;    }</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160; </div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#ac37a2848b8a1a91de9dfde7c1c9d8fa5">chroot_dir</a> &amp;&amp; !(o-&gt;<a class="code" href="structoptions.html#a8388094487ff9931a91eb02e7fa8d472">username</a> &amp;&amp; o-&gt;<a class="code" href="structoptions.html#add57437239b837341d533dac68982743">groupname</a>))</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;    {</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: you are using chroot without specifying user and group -- this may cause the chroot jail to be insecure&quot;</span>);</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    }</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160; </div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">pull</a> &amp;&amp; o-&gt;<a class="code" href="structoptions.html#a6c5eef6691660bf4aa7618c2a5485558">ifconfig_local</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a>)</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    {</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: using --pull/--client and --ifconfig together is probably not what you want&quot;</span>);</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    }</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160; </div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a30cdddc3ea06d8370b311b1d3c6e7329">server_bridge_defined</a> | o-&gt;<a class="code" href="structoptions.html#a39f37911a711f30b88ce4ec88e3284e6">server_bridge_proxy_dhcp</a>)</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    {</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;NOTE: when bridging your LAN adapter with the TAP adapter, note that the new bridge adapter will often take on its own IP address that is different from what the LAN adapter was previously set to&quot;</span>);</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;    }</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160; </div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a8a97f5f530042a7f4321cb97c3983fa1">mode</a> == <a class="code" href="options_8h.html#a3f2e4b6d38cb9fbb3839ed4a478bf39d">MODE_SERVER</a>)</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    {</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;        <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a2a61982b1ebed1f70da93f793efd2489">duplicate_cn</a> &amp;&amp; o-&gt;<a class="code" href="structoptions.html#af9495898a3334684c7af68f647364639">client_config_dir</a>)</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;        {</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: using --duplicate-cn and --client-config-dir together is probably not what you want&quot;</span>);</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;        }</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;        <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a2a61982b1ebed1f70da93f793efd2489">duplicate_cn</a> &amp;&amp; o-&gt;<a class="code" href="structoptions.html#afd4844b98195de154b74ef63211f69ea">ifconfig_pool_persist_filename</a>)</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;        {</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: --ifconfig-pool-persist will not work with --duplicate-cn&quot;</span>);</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;        }</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;        <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="structoptions.html#adad7b538e1a7f315447db983d33bc458">keepalive_ping</a> || !o-&gt;<a class="code" href="structoptions.html#a5b6381333b82e8689f820ae2ecf2ecb1">keepalive_timeout</a>)</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;        {</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: --keepalive option is missing from server config&quot;</span>);</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;        }</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    }</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* if P2MP */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160; </div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;    <span class="keywordflow">if</span> (!o-&gt;<a class="code" href="structoptions.html#a6ab0ea3447528be930897de097a1a37f">replay</a>)</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;    {</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: You have disabled Replay Protection (--no-replay) which may make &quot;</span> <a class="code" href="config-msvc-version_8h.html#a1c0439e4355794c09b64274849eb0279">PACKAGE_NAME</a> <span class="stringliteral">&quot; less secure&quot;</span>);</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;    }</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160; </div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a8cc67b442d93909bc5500945a8ac08ff">tls_server</a>)</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    {</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;        <a class="code" href="tun_8c.html#ab0f91db5420a16a2656811d0749978f4">warn_on_use_of_common_subnets</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>);</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    }</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a92cffd160044d2b84a1085fa3ddb9a2d">tls_client</a></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;        &amp;&amp; !o-&gt;<a class="code" href="structoptions.html#a937ce3e9f18cc533ac9baab101437360">tls_verify</a></div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;        &amp;&amp; o-&gt;<a class="code" href="structoptions.html#ab7d414e087194f31b1a0f16dec7bd0f9">verify_x509_type</a> == <a class="code" href="ssl__verify_8h.html#a5d60c908067b565d7734c3006a3f0bb9">VERIFY_X509_NONE</a></div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;        &amp;&amp; !(o-&gt;<a class="code" href="structoptions.html#a888a84a61b2986b8c433b9a98c8de5ad">ns_cert_type</a> &amp; <a class="code" href="ssl__verify_8h.html#af731ad626c0e9d1650b5f3bd8fb3ef76">NS_CERT_CHECK_SERVER</a>)</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;        &amp;&amp; !o-&gt;<a class="code" href="structoptions.html#a35efdd07abfdcad8904ed80f823be6b4">remote_cert_eku</a>)</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    {</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: No server certificate verification method has been enabled.  See http://openvpn.net/howto.html#mitm for more info.&quot;</span>);</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;    }</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a888a84a61b2986b8c433b9a98c8de5ad">ns_cert_type</a>)</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    {</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: --ns-cert-type is DEPRECATED.  Use --remote-cert-tls instead.&quot;</span>);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    }</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160; </div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    <span class="comment">/* If a script is used, print appropriate warnings */</span></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a7309025b69e21f09e0867970b052d1e2">user_script_used</a>)</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;    {</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="run__command_8c.html#ad171ff25a82c6d1f03d37c1843dc0ad0">script_security</a>() &gt;= <a class="code" href="run__command_8h.html#a3c41fae7f419ada19275d46cd6b55a1d">SSEC_SCRIPTS</a>)</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;        {</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;NOTE: the current --script-security setting may allow this configuration to call user-defined scripts&quot;</span>);</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;        }</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="run__command_8c.html#ad171ff25a82c6d1f03d37c1843dc0ad0">script_security</a>() &gt;= <a class="code" href="run__command_8h.html#a8b0a9c8434191d44e4fef4e00afd60c6">SSEC_PW_ENV</a>)</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;        {</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;WARNING: the current --script-security setting may allow passwords to be passed to scripts via environmental variables&quot;</span>);</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;        }</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;        {</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;NOTE: starting with &quot;</span> <a class="code" href="config-msvc-version_8h.html#a1c0439e4355794c09b64274849eb0279">PACKAGE_NAME</a> <span class="stringliteral">&quot; 2.1, &#39;--script-security 2&#39; or higher is required to call user-defined scripts or executables&quot;</span>);</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;        }</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    }</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;}</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160; </div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03336"></a><span class="lineno"><a class="line" href="init_8c.html#a3709fc7248a2af73c0a60a34594dcee7"> 3336</a></span>&#160;<a class="code" href="init_8c.html#a3709fc7248a2af73c0a60a34594dcee7">do_init_frame_tls</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;{</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;    <a class="code" href="init_8c.html#a3bc4d5a823499472a3bc61b5a263c603">do_init_finalize_tls_frame</a>(c);</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;}</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160; </div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;<span class="keyword">struct </span><a class="code" href="structcontext__buffers.html">context_buffers</a> *</div>
<div class="line"><a name="l03342"></a><span class="lineno"><a class="line" href="init_8h.html#acb1b090f0af0de9a05f235a61b03fc44"> 3342</a></span>&#160;<a class="code" href="init_8c.html#acb1b090f0af0de9a05f235a61b03fc44">init_context_buffers</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structframe.html">frame</a> *<a class="code" href="structframe.html">frame</a>)</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;{</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;    <span class="keyword">struct </span><a class="code" href="structcontext__buffers.html">context_buffers</a> *b;</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160; </div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    <a class="code" href="buffer_8h.html#ad6c5a0d21b979135703d7908a7c3bbb1">ALLOC_OBJ_CLEAR</a>(b, <span class="keyword">struct</span> <a class="code" href="structcontext__buffers.html">context_buffers</a>);</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160; </div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    b-&gt;<a class="code" href="structcontext__buffers.html#a0434309fa3b81366ba6578ee4fe26923">read_link_buf</a> = <a class="code" href="buffer_8c.html#aa6bae12914d41c7aecaa7b64fea1bc51">alloc_buf</a>(<a class="code" href="mtu_8h.html#a6e7d91939116683f61d13ab598ead50b">BUF_SIZE</a>(<a class="code" href="structframe.html">frame</a>));</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    b-&gt;<a class="code" href="structcontext__buffers.html#aa03e7433c540b45f5e427527739d888c">read_tun_buf</a> = <a class="code" href="buffer_8c.html#aa6bae12914d41c7aecaa7b64fea1bc51">alloc_buf</a>(<a class="code" href="mtu_8h.html#a6e7d91939116683f61d13ab598ead50b">BUF_SIZE</a>(<a class="code" href="structframe.html">frame</a>));</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160; </div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    b-&gt;<a class="code" href="structcontext__buffers.html#ad3e2e97af748c92d2c3310f4631393ef">aux_buf</a> = <a class="code" href="buffer_8c.html#aa6bae12914d41c7aecaa7b64fea1bc51">alloc_buf</a>(<a class="code" href="mtu_8h.html#a6e7d91939116683f61d13ab598ead50b">BUF_SIZE</a>(<a class="code" href="structframe.html">frame</a>));</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160; </div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;    b-&gt;<a class="code" href="structcontext__buffers.html#a7030fd4d5442836a9cd3c2a71a1e84e8">encrypt_buf</a> = <a class="code" href="buffer_8c.html#aa6bae12914d41c7aecaa7b64fea1bc51">alloc_buf</a>(<a class="code" href="mtu_8h.html#a6e7d91939116683f61d13ab598ead50b">BUF_SIZE</a>(<a class="code" href="structframe.html">frame</a>));</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;    b-&gt;<a class="code" href="structcontext__buffers.html#ac3ecbcb5ab79601f229b6badf7c09efb">decrypt_buf</a> = <a class="code" href="buffer_8c.html#aa6bae12914d41c7aecaa7b64fea1bc51">alloc_buf</a>(<a class="code" href="mtu_8h.html#a6e7d91939116683f61d13ab598ead50b">BUF_SIZE</a>(<a class="code" href="structframe.html">frame</a>));</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160; </div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;<span class="preprocessor">#ifdef USE_COMP</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;    b-&gt;compress_buf = <a class="code" href="buffer_8c.html#aa6bae12914d41c7aecaa7b64fea1bc51">alloc_buf</a>(<a class="code" href="mtu_8h.html#a6e7d91939116683f61d13ab598ead50b">BUF_SIZE</a>(<a class="code" href="structframe.html">frame</a>));</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;    b-&gt;decompress_buf = <a class="code" href="buffer_8c.html#aa6bae12914d41c7aecaa7b64fea1bc51">alloc_buf</a>(<a class="code" href="mtu_8h.html#a6e7d91939116683f61d13ab598ead50b">BUF_SIZE</a>(<a class="code" href="structframe.html">frame</a>));</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160; </div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;    <span class="keywordflow">return</span> b;</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;}</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160; </div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l03365"></a><span class="lineno"><a class="line" href="init_8h.html#a484dda31020a06c683ee05df4a4d7b5e"> 3365</a></span>&#160;<a class="code" href="init_8c.html#a484dda31020a06c683ee05df4a4d7b5e">free_context_buffers</a>(<span class="keyword">struct</span> <a class="code" href="structcontext__buffers.html">context_buffers</a> *b)</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;{</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;    <span class="keywordflow">if</span> (b)</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;    {</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;        <a class="code" href="buffer_8c.html#a11cd36c0af3073bd1245bbed1cca9590">free_buf</a>(&amp;b-&gt;<a class="code" href="structcontext__buffers.html#a0434309fa3b81366ba6578ee4fe26923">read_link_buf</a>);</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;        <a class="code" href="buffer_8c.html#a11cd36c0af3073bd1245bbed1cca9590">free_buf</a>(&amp;b-&gt;<a class="code" href="structcontext__buffers.html#aa03e7433c540b45f5e427527739d888c">read_tun_buf</a>);</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;        <a class="code" href="buffer_8c.html#a11cd36c0af3073bd1245bbed1cca9590">free_buf</a>(&amp;b-&gt;<a class="code" href="structcontext__buffers.html#ad3e2e97af748c92d2c3310f4631393ef">aux_buf</a>);</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160; </div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;<span class="preprocessor">#ifdef USE_COMP</span></div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;        <a class="code" href="buffer_8c.html#a11cd36c0af3073bd1245bbed1cca9590">free_buf</a>(&amp;b-&gt;compress_buf);</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;        <a class="code" href="buffer_8c.html#a11cd36c0af3073bd1245bbed1cca9590">free_buf</a>(&amp;b-&gt;decompress_buf);</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160; </div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;        <a class="code" href="buffer_8c.html#a11cd36c0af3073bd1245bbed1cca9590">free_buf</a>(&amp;b-&gt;<a class="code" href="structcontext__buffers.html#a7030fd4d5442836a9cd3c2a71a1e84e8">encrypt_buf</a>);</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;        <a class="code" href="buffer_8c.html#a11cd36c0af3073bd1245bbed1cca9590">free_buf</a>(&amp;b-&gt;<a class="code" href="structcontext__buffers.html#ac3ecbcb5ab79601f229b6badf7c09efb">decrypt_buf</a>);</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160; </div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;        free(b);</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    }</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;}</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160; </div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;<span class="comment"> * Now that we know all frame parameters, initialize</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;<span class="comment"> * our buffers.</span></div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"><a class="line" href="init_8c.html#ae5f5cf77443aa964f81ff68fb350d83f"> 3390</a></span>&#160;<a class="code" href="init_8c.html#ae5f5cf77443aa964f81ff68fb350d83f">do_init_buffers</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;{</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ae2e304ff3393a09ee15f7490f50b89d8">buffers</a> = <a class="code" href="init_8c.html#acb1b090f0af0de9a05f235a61b03fc44">init_context_buffers</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>);</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa0413cae96937fb6fca54e18e5b5d3d7">buffers_owned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;}</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160; </div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;<span class="preprocessor">#ifdef ENABLE_FRAGMENT</span></div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;<span class="comment"> * Fragmenting code has buffers to initialize</span></div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;<span class="comment"> * once frame parameters are known.</span></div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03402"></a><span class="lineno"><a class="line" href="init_8c.html#a577bf7b44dff6a8b3380cc96a8a3a1ba"> 3402</a></span>&#160;<a class="code" href="init_8c.html#a577bf7b44dff6a8b3380cc96a8a3a1ba">do_init_fragment</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;{</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#ab003130b974deb481133d4209f74b25c">fragment</a>);</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    <a class="code" href="mtu_8c.html#a0d975207c7e52a23853613dd18a6eebf">frame_set_mtu_dynamic</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7cd4fe8da737769bc4b6341c7dcfb2a2">frame_fragment</a>,</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;                          c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#ab003130b974deb481133d4209f74b25c">fragment</a>, <a class="code" href="mtu_8h.html#af353a8e54454b0a1fccc8810d5908fec">SET_MTU_UPPER_BOUND</a>);</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;    <a class="code" href="group__fragmentation.html#ga78eb641be3402b8db31607baba604e62">fragment_frame_init</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2096e6377ff24432baeafa7864a7483b">fragment</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7cd4fe8da737769bc4b6341c7dcfb2a2">frame_fragment</a>);</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;}</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160; </div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;<span class="comment"> * Allocate our socket object.</span></div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"><a class="line" href="init_8c.html#a5bf221a89c0561061bd91985797fa61c"> 3415</a></span>&#160;<a class="code" href="init_8c.html#a5bf221a89c0561061bd91985797fa61c">do_link_socket_new</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;{</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(!c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>);</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a> = <a class="code" href="socket_8c.html#a41acd6256f92be22c7c94727d2b4bf1e">link_socket_new</a>();</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a666bfe66da6072618edc5a0f5688780f">link_socket_owned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;}</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160; </div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;<span class="comment"> * bind the TCP/UDP socket</span></div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"><a class="line" href="init_8c.html#abab69003e7cb3f0624fd9edf8f9b4037"> 3426</a></span>&#160;<a class="code" href="init_8c.html#abab69003e7cb3f0624fd9edf8f9b4037">do_init_socket_1</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keywordtype">int</span> mode)</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;{</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sockflags = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ac8e77b47a812a59d723b57059eede161">sockflags</a>;</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160; </div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="preprocessor">#if PORT_SHARE</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.port_share_host &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.port_share_port)</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;    {</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;        sockflags |= <a class="code" href="socket_8h.html#ab974ab73acf7192e0bb614429f79f5a1">SF_PORT_SHARE</a>;</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;    }</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160; </div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;    <a class="code" href="socket_8c.html#a9ac24fcba54de82d131f67103be49c62">link_socket_init_phase1</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>,</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#af86e741661abeac7edfdb5258ec4fa5f">local</a>,</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#aecded3865f978a060cb1539fbd394032">local_port</a>,</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a474c4038934a015bdcb5b038b98b35d1">remote</a>,</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#aa399cea883d3a239190c049c004ad793">remote_port</a>,</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa252fa776c920089066ddb7bdb16b24">dns_cache</a>,</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>,</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#ac49b7ba49fbc7efd0d77535d1c66a7d9">af</a>,</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a8ec3ea69d71db89eb5ecd7b4b5ce3f99">bind_ipv6_only</a>,</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                            mode,</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a4cb8c7cbd964e80ede783143a456d44d">accept_from</a>,</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa41670c0d47426f2b7630ecde06d509e">http_proxy</a>,</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#af266db9e924917e0dab9ca0f01259df1">socks_proxy</a>,</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;#ifdef <a class="code" href="config_8h.html#a432138093c53d7580af9ec5c5dca387f">ENABLE_DEBUG</a></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.gremlin,</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;#endif</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a237f0476d7d283fa334b6250559f11d5">bind_local</a>,</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#a909bc65df6db4a88c211558e3b1565f4">remote_float</a>,</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a313ef9730dd723427ca9ab74896109a6">inetd</a>,</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;                            &amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>,</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a7a68302ffa97bdc216d2fcc15cca0bb2">ipchange</a>,</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>,</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a01eeeea7687682a0ac932969c065222f">resolve_retry_seconds</a>,</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#aba4ccef71abd388a80a607ab3da381e4">mtu_discover_type</a>,</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a0536fdadf7c9e61bfe97e269172bbf3a">rcvbuf</a>,</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#aa177cf2ad8396bfadd40a7b3fb79adeb">sndbuf</a>,</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ab21da757cf5ae13f90e852f17e0a4676">mark</a>,</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8d144360526d22d964263e250e8b69ae">bind_dev</a>,</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;                            &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a1aeeedd8cd4780c69f7626bcb81f4b90">server_poll_interval</a>,</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;                            sockflags);</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;}</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160; </div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;<span class="comment"> * finalize the TCP/UDP socket</span></div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"><a class="line" href="init_8c.html#ae73a7779aedce66ab4e13e23bb856587"> 3473</a></span>&#160;<a class="code" href="init_8c.html#ae73a7779aedce66ab4e13e23bb856587">do_init_socket_2</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;{</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    <a class="code" href="socket_8c.html#ad716d81ba4a413dfb1014bc9407ff2fa">link_socket_init_phase2</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>,</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;                            c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>);</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;}</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160; </div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="comment"> * Print MTU INFO</span></div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"><a class="line" href="init_8c.html#a46d6454c2cf71f447451e11c5fa98722"> 3483</a></span>&#160;<a class="code" href="init_8c.html#a46d6454c2cf71f447451e11c5fa98722">do_print_data_channel_mtu_parms</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;{</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;    <a class="code" href="mtu_8c.html#a224812036cf5be8e57a95dad7d45067e">frame_print</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, <a class="code" href="errlevel_8h.html#aab9d07562cfecbd96b4c9e1d242d7d15">D_MTU_INFO</a>, <span class="stringliteral">&quot;Data Channel MTU parms&quot;</span>);</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;<span class="preprocessor">#ifdef ENABLE_FRAGMENT</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2096e6377ff24432baeafa7864a7483b">fragment</a>)</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;    {</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;        <a class="code" href="mtu_8c.html#a224812036cf5be8e57a95dad7d45067e">frame_print</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7cd4fe8da737769bc4b6341c7dcfb2a2">frame_fragment</a>, <a class="code" href="errlevel_8h.html#aab9d07562cfecbd96b4c9e1d242d7d15">D_MTU_INFO</a>,</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;                    <span class="stringliteral">&quot;Fragmentation MTU parms&quot;</span>);</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    }</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;}</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160; </div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;<span class="comment"> * Get local and remote options compatibility strings.</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03499"></a><span class="lineno"><a class="line" href="init_8c.html#a7e221190dbfc1c1cbd88ae2c834434f9"> 3499</a></span>&#160;<a class="code" href="init_8c.html#a7e221190dbfc1c1cbd88ae2c834434f9">do_compute_occ_strings</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;{</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgc__arena.html">gc_arena</a> gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160; </div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a04ff4807150572d100c753bb76b47b1b">options_string_local</a> =</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;        <a class="code" href="options_8c.html#a1641d56ec254cefdfe8f43125d68c145">options_string</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>,</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;                       <span class="keyword">false</span>, &amp;gc);</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2cf3b03b810f97b5ee02e92dd9682589">options_string_remote</a> =</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;        <a class="code" href="options_8c.html#a1641d56ec254cefdfe8f43125d68c145">options_string</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">net_ctx</a>,</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;                       <span class="keyword">true</span>, &amp;gc);</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160; </div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a09c9625c03392860c87ed0460cd475cd">D_SHOW_OCC</a>, <span class="stringliteral">&quot;Local Options String (VER=%s): &#39;%s&#39;&quot;</span>,</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;        <a class="code" href="options_8c.html#a22f5987e3b8567b5f919286ea6c8b582">options_string_version</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a04ff4807150572d100c753bb76b47b1b">options_string_local</a>, &amp;gc),</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a04ff4807150572d100c753bb76b47b1b">options_string_local</a>);</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#a09c9625c03392860c87ed0460cd475cd">D_SHOW_OCC</a>, <span class="stringliteral">&quot;Expected Remote Options String (VER=%s): &#39;%s&#39;&quot;</span>,</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;        <a class="code" href="options_8c.html#a22f5987e3b8567b5f919286ea6c8b582">options_string_version</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2cf3b03b810f97b5ee02e92dd9682589">options_string_remote</a>, &amp;gc),</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2cf3b03b810f97b5ee02e92dd9682589">options_string_remote</a>);</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160; </div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>)</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;    {</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;        <a class="code" href="group__control__processor.html#gafe3228d8a3cae5eb8f159e8230f4cd27">tls_multi_init_set_options</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>,</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;                                   c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a04ff4807150572d100c753bb76b47b1b">options_string_local</a>,</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;                                   c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2cf3b03b810f97b5ee02e92dd9682589">options_string_remote</a>);</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;    }</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160; </div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;    <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;gc);</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;}</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160; </div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="comment"> * These things can only be executed once per program instantiation.</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment"> * Set up for possible UID/GID downgrade, but don&#39;t do it yet.</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;<span class="comment"> * Daemonize if requested.</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03533"></a><span class="lineno"><a class="line" href="init_8c.html#a05df1a443a6eac2dc6faa292fb433f27"> 3533</a></span>&#160;<a class="code" href="init_8c.html#a05df1a443a6eac2dc6faa292fb433f27">do_init_first_time</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;{</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a> &amp;&amp; !c-&gt;<a class="code" href="structcontext.html#a1d0cd1cb672a5fee441bdc504fc0fa93">c0</a>)</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;    {</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;        <span class="keyword">struct </span><a class="code" href="structcontext__0.html">context_0</a> *c0;</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160; </div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;        <a class="code" href="buffer_8h.html#ab4491b7f3124ff7b050e37c38c2e620b">ALLOC_OBJ_CLEAR_GC</a>(c-&gt;<a class="code" href="structcontext.html#a1d0cd1cb672a5fee441bdc504fc0fa93">c0</a>, <span class="keyword">struct</span> <a class="code" href="structcontext__0.html">context_0</a>, &amp;c-&gt;<a class="code" href="structcontext.html#ad2b1fffbd57d0ba779aa9b5ef8a9c78d">gc</a>);</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;        c0 = c-&gt;<a class="code" href="structcontext.html#a1d0cd1cb672a5fee441bdc504fc0fa93">c0</a>;</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160; </div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;        <span class="comment">/* get user and/or group that we want to setuid/setgid to */</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;        c0-&gt;<a class="code" href="structcontext__0.html#af599a649761ec7fd83b5aa3dab4a502e">uid_gid_specified</a> =</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;            <a class="code" href="platform_8c.html#ac9360f2b8017f5885191fd52e3192ddd">platform_group_get</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#add57437239b837341d533dac68982743">groupname</a>, &amp;c0-&gt;<a class="code" href="structcontext__0.html#a2b214a974983a9c9f74e3c80dc1f0161">platform_state_group</a>)</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;            |<a class="code" href="platform_8c.html#a52d59a56eff6b981f01eff915af4fad8">platform_user_get</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8388094487ff9931a91eb02e7fa8d472">username</a>, &amp;c0-&gt;<a class="code" href="structcontext__0.html#a663b5e3cf38a4fc003b34fed87e9555c">platform_state_user</a>);</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160; </div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        <span class="comment">/* perform postponed chdir if --daemon */</span></div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a34ef38cd7f895386a75d592fa0c820d8">did_we_daemonize</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#adda4185edc6728b8ca138902ff9dfe15">cd_dir</a> == NULL)</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        {</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;            <a class="code" href="platform_8c.html#a7dc2e3b7b5be2916dd35a763744e7702">platform_chdir</a>(<span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;        }</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160; </div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;        <span class="comment">/* should we change scheduling priority? */</span></div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;        <a class="code" href="platform_8c.html#a3d70db12180a04ae095a6bfb21951efb">platform_nice</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#adf54ee33312d3e824a9f95a8c74dc03a">nice</a>);</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;    }</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;}</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160; </div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;<span class="comment"> * If xinetd/inetd mode, don&#39;t allow restart.</span></div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03562"></a><span class="lineno"><a class="line" href="init_8c.html#a23ba16c1479ad9ab48de1cd7f655a648"> 3562</a></span>&#160;<a class="code" href="init_8c.html#a23ba16c1479ad9ab48de1cd7f655a648">do_close_check_if_restart_permitted</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;{</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a313ef9730dd723427ca9ab74896109a6">inetd</a></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;        &amp;&amp; (c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a136c64ec2d1306de745e39d6aee362ca">SIGHUP</a></div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;            || c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>))</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    {</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> = <a class="code" href="config-msvc_8h.html#a682182a5e5f38fd61f4311501e9dac5d">SIGTERM</a>;</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>,</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;            <a class="code" href="config-msvc-version_8h.html#a1c0439e4355794c09b64274849eb0279">PACKAGE_NAME</a></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;            <span class="stringliteral">&quot; started by inetd/xinetd cannot restart... Exiting.&quot;</span>);</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;    }</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;}</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160; </div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;<span class="comment"> * free buffers</span></div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"><a class="line" href="init_8c.html#a74ee8a601d15d115c433b90a93ee1301"> 3579</a></span>&#160;<a class="code" href="init_8c.html#a74ee8a601d15d115c433b90a93ee1301">do_close_free_buf</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;{</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa0413cae96937fb6fca54e18e5b5d3d7">buffers_owned</a>)</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;    {</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;        <a class="code" href="init_8c.html#a484dda31020a06c683ee05df4a4d7b5e">free_context_buffers</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ae2e304ff3393a09ee15f7490f50b89d8">buffers</a>);</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ae2e304ff3393a09ee15f7490f50b89d8">buffers</a> = NULL;</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa0413cae96937fb6fca54e18e5b5d3d7">buffers_owned</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;    }</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;}</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160; </div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;<span class="comment"> * close TLS</span></div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"><a class="line" href="init_8c.html#af81e65de77cb7e8ce6e19844ffb749b9"> 3593</a></span>&#160;<a class="code" href="init_8c.html#af81e65de77cb7e8ce6e19844ffb749b9">do_close_tls</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;{</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>)</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    {</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;        <a class="code" href="group__control__processor.html#ga3f6dae3fb4465d1c697a80fdebd50d67">tls_multi_free</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a> = NULL;</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;    }</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160; </div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    <span class="comment">/* free options compatibility strings */</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a04ff4807150572d100c753bb76b47b1b">options_string_local</a>)</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    {</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;        free(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a04ff4807150572d100c753bb76b47b1b">options_string_local</a>);</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;    }</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2cf3b03b810f97b5ee02e92dd9682589">options_string_remote</a>)</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    {</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;        free(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2cf3b03b810f97b5ee02e92dd9682589">options_string_remote</a>);</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;    }</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a04ff4807150572d100c753bb76b47b1b">options_string_local</a> = c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2cf3b03b810f97b5ee02e92dd9682589">options_string_remote</a> = NULL;</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160; </div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">pulled_options_state</a>)</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;    {</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        <a class="code" href="crypto__backend_8h.html#ad92889d868bb18d919c8965fc4b05436">md_ctx_cleanup</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">pulled_options_state</a>);</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;        <a class="code" href="crypto__backend_8h.html#afdb937666eb44c6bbb45860ed209773d">md_ctx_free</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">pulled_options_state</a>);</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;    }</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;}</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160; </div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;<span class="comment"> * Free key schedules</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"><a class="line" href="init_8c.html#a5c3a221406c8c4ed6795c1f3ef9ce7f0"> 3623</a></span>&#160;<a class="code" href="init_8c.html#a5c3a221406c8c4ed6795c1f3ef9ce7f0">do_close_free_key_schedule</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keywordtype">bool</span> free_ssl_ctx)</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;{</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;<span class="comment">     * always free the tls_auth/crypt key. If persist_key is true, the key will</span></div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;<span class="comment">     * be reloaded from memory (pre-cached)</span></div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;    <a class="code" href="crypto_8c.html#af3aee473fd00923f722cc0518add3d7c">free_key_ctx</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#afc58d93e9c900d3bd001a8ee09f0932c">tls_crypt_v2_server_key</a>);</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;    <a class="code" href="crypto_8c.html#a0605d1e78bd3bf4e23d99e039301f934">free_key_ctx_bi</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#ad2ce1d97a35d1c487ce7c13f52d900c5">tls_wrap_key</a>);</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;    <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#ad2ce1d97a35d1c487ce7c13f52d900c5">tls_wrap_key</a>);</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;    <a class="code" href="buffer_8c.html#a1bb5d44eee3543955d61ffbc671d2927">buf_clear</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a239e3a613b599e2b9ff2c1a3244c398b">tls_crypt_v2_wkc</a>);</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;    <a class="code" href="buffer_8c.html#a11cd36c0af3073bd1245bbed1cca9590">free_buf</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a239e3a613b599e2b9ff2c1a3244c398b">tls_crypt_v2_wkc</a>);</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160; </div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;    <span class="keywordflow">if</span> (!(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a66101dbc2f00c4ef3e1ac1a492292811">persist_key</a>))</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;    {</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        <a class="code" href="init_8c.html#a263724992635e011b111147ec8647500">key_schedule_free</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>, free_ssl_ctx);</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;    }</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;}</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160; </div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;<span class="comment"> * Close TCP/UDP connection</span></div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"><a class="line" href="init_8c.html#a1dfcc5395d28064586bb8f94409b86ef"> 3645</a></span>&#160;<a class="code" href="init_8c.html#a1dfcc5395d28064586bb8f94409b86ef">do_close_link_socket</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;{</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a666bfe66da6072618edc5a0f5688780f">link_socket_owned</a>)</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;    {</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;        <a class="code" href="socket_8c.html#a7f6b5654e386c141071a9246f68853e9">link_socket_close</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>);</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a> = NULL;</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    }</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160; </div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160; </div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;    <span class="comment">/* Preserve the resolved list of remote if the user request to or if we want</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;<span class="comment">     * reconnect to the same host again or there are still addresses that need</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;<span class="comment">     * to be tried */</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;    <span class="keywordflow">if</span> (!(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a></div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;          &amp;&amp; ( (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ada37ffb590fc8620f2f5e8f9615defeb">persist_remote_ip</a>)</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;               ||</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;               ( c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#aff345ec3f6a0b37155a2561e9ff7f0b5">source</a> != <a class="code" href="sig_8h.html#acca14239031e4e2583bb69dbed1cd18c">SIG_SOURCE_HARD</a></div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;                 &amp;&amp; ((c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a86eeebfb3c5eee93573fa9b577b12f7a">current_remote</a></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;                      &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a86eeebfb3c5eee93573fa9b577b12f7a">current_remote</a>-&gt;ai_next)</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;                     || c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#adb8ec5e44523e50a40777073262d41a2">no_advance</a>))</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;               )))</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    {</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;        <a class="code" href="init_8c.html#a3e428634830c20841874c8143b46a2e4">clear_remote_addrlist</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>, !c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a055000dd88801bd1be2262bf8b447ec9">resolve_in_advance</a>);</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;    }</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160; </div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    <span class="comment">/* Clear the remote actual address when persist_remote_ip is not in use */</span></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;    <span class="keywordflow">if</span> (!(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#ada37ffb590fc8620f2f5e8f9615defeb">persist_remote_ip</a>))</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;    {</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;        <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a31cf151a4d7544429e7740cbda55193c">actual</a>);</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;    }</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160; </div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;    <span class="keywordflow">if</span> (!(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#afdd8d36525c3ca430f3ae3986d968813">persist_local_ip</a>))</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;    {</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a5a4d9686ebf0ef5a00117de888ac78cf">bind_local</a> &amp;&amp; !c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a055000dd88801bd1be2262bf8b447ec9">resolve_in_advance</a>)</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;        {</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;            freeaddrinfo(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a5a4d9686ebf0ef5a00117de888ac78cf">bind_local</a>);</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;        }</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160; </div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">link_socket_addr</a>.<a class="code" href="structlink__socket__addr.html#a5a4d9686ebf0ef5a00117de888ac78cf">bind_local</a> = NULL;</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;    }</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;}</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160; </div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;<span class="comment"> * Close packet-id persistence file</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"><a class="line" href="init_8c.html#ad60e48d4f954964c89982f7f768cd114"> 3690</a></span>&#160;<a class="code" href="init_8c.html#ad60e48d4f954964c89982f7f768cd114">do_close_packet_id</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;{</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;    <a class="code" href="packet__id_8c.html#a5162087628a8856757b82c93cf4a696b">packet_id_free</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a901a1a0ceb94dbd3e9f758552fa4fbd9">crypto_options</a>.<a class="code" href="structcrypto__options.html#ab4b7f20d49e1ac2efb9faf4a13d3701d">packet_id</a>);</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;    <a class="code" href="packet__id_8c.html#a1a1b4689057b6361657f57fe65bd4f93">packet_id_persist_save</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa20a2b143b3a7f2db2cc9a1af3cdf3e2">pid_persist</a>);</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;    <span class="keywordflow">if</span> (!(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>))</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;    {</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;        <a class="code" href="packet__id_8c.html#a3f6e28af6874fe3665778dc54a8752cb">packet_id_persist_close</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#aa20a2b143b3a7f2db2cc9a1af3cdf3e2">pid_persist</a>);</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    }</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;}</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160; </div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;<span class="preprocessor">#ifdef ENABLE_FRAGMENT</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;<span class="comment"> * Close fragmentation handler.</span></div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03705"></a><span class="lineno"><a class="line" href="init_8c.html#a7ff24c87873c65ffd41f47539bc6b760"> 3705</a></span>&#160;<a class="code" href="init_8c.html#a7ff24c87873c65ffd41f47539bc6b760">do_close_fragment</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;{</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2096e6377ff24432baeafa7864a7483b">fragment</a>)</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    {</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;        <a class="code" href="group__fragmentation.html#gae6f7daf38cb2c0edaa6dbdfeabddb826">fragment_free</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2096e6377ff24432baeafa7864a7483b">fragment</a>);</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2096e6377ff24432baeafa7864a7483b">fragment</a> = NULL;</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;    }</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;}</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160; </div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;<span class="comment"> * Open and close our event objects.</span></div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160; </div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03720"></a><span class="lineno"><a class="line" href="init_8c.html#a5701fecef4d3afde02d2604f1b61f7f3"> 3720</a></span>&#160;<a class="code" href="init_8c.html#a5701fecef4d3afde02d2604f1b61f7f3">do_event_set_init</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c,</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;                  <span class="keywordtype">bool</span> need_us_timeout)</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;{</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags = 0;</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160; </div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ad0ae63ac896195c2b4ae39385262b0c6">event_set_max</a> = <a class="code" href="init_8h.html#a8d3f5374b68c979bf8a7f3726248bc5d">BASE_N_EVENTS</a>;</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160; </div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    flags |= <a class="code" href="event_8h.html#a3cff540d052378462ac3aa42a45ce6da">EVENT_METHOD_FAST</a>;</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160; </div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;    <span class="keywordflow">if</span> (need_us_timeout)</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;    {</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;        flags |= <a class="code" href="event_8h.html#a58154c71aeed1039628d6a15573b6ff9">EVENT_METHOD_US_TIMEOUT</a>;</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;    }</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160; </div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#adc9eee8062fcb8d280910f28fcab8b0b">event_set</a> = <a class="code" href="event_8c.html#a6d9cc59952b108b1894417202689f4ba">event_set_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ad0ae63ac896195c2b4ae39385262b0c6">event_set_max</a>, flags);</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#afe17ff408cef993e5785dbb553851dce">event_set_owned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;}</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160; </div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03739"></a><span class="lineno"><a class="line" href="init_8c.html#a95c0a575a66fd93651241d08fbf7444e"> 3739</a></span>&#160;<a class="code" href="init_8c.html#a95c0a575a66fd93651241d08fbf7444e">do_close_event_set</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;{</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#adc9eee8062fcb8d280910f28fcab8b0b">event_set</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#afe17ff408cef993e5785dbb553851dce">event_set_owned</a>)</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;    {</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;        <a class="code" href="event_8h.html#a5a2c13fc528d1073e5bf6c34e694561e">event_free</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#adc9eee8062fcb8d280910f28fcab8b0b">event_set</a>);</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#adc9eee8062fcb8d280910f28fcab8b0b">event_set</a> = NULL;</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#afe17ff408cef993e5785dbb553851dce">event_set_owned</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    }</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;}</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160; </div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;<span class="comment"> * Open and close --status file</span></div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160; </div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"><a class="line" href="init_8c.html#a71177a52e10b7bb794394d863d3afa3e"> 3754</a></span>&#160;<a class="code" href="init_8c.html#a71177a52e10b7bb794394d863d3afa3e">do_open_status_output</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;{</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a52e54589393f891c6eb5aa5c55de22b1">status_output</a>)</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;    {</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a52e54589393f891c6eb5aa5c55de22b1">status_output</a> = <a class="code" href="status_8c.html#ab196e92cac48e356eab474978232e453">status_open</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a3499def098c5b5d0a40c742770b11aef">status_file</a>,</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;                                          c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#abab76df02281e67b578e568d765cf99c">status_file_update_freq</a>,</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;                                          -1,</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;                                          NULL,</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;                                          <a class="code" href="status_8h.html#a2f6001bad7228f20b8e74d5aace81085">STATUS_OUTPUT_WRITE</a>);</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a8eb1f3e8ba4ab0d8167a7d232dcff498">status_output_owned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;    }</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;}</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160; </div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03768"></a><span class="lineno"><a class="line" href="init_8c.html#a5696f524319366de9d91a26d7290bfbb"> 3768</a></span>&#160;<a class="code" href="init_8c.html#a5696f524319366de9d91a26d7290bfbb">do_close_status_output</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;{</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    <span class="keywordflow">if</span> (!(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>))</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;    {</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a8eb1f3e8ba4ab0d8167a7d232dcff498">status_output_owned</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a52e54589393f891c6eb5aa5c55de22b1">status_output</a>)</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;        {</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;            <a class="code" href="status_8c.html#af524160156e0aa1ba6f4666bddb4bbd9">status_close</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a52e54589393f891c6eb5aa5c55de22b1">status_output</a>);</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a52e54589393f891c6eb5aa5c55de22b1">status_output</a> = NULL;</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a8eb1f3e8ba4ab0d8167a7d232dcff498">status_output_owned</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;        }</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;    }</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;}</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160; </div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="comment"> * Handle ifconfig-pool persistence object.</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03785"></a><span class="lineno"><a class="line" href="init_8c.html#a60549a254336200d6162c9b08081d3f9"> 3785</a></span>&#160;<a class="code" href="init_8c.html#a60549a254336200d6162c9b08081d3f9">do_open_ifconfig_pool_persist</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;{</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a4d49f44e4e2309b3c7dc84c3aeb305c2">ifconfig_pool_persist</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#afd4844b98195de154b74ef63211f69ea">ifconfig_pool_persist_filename</a>)</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;    {</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a4d49f44e4e2309b3c7dc84c3aeb305c2">ifconfig_pool_persist</a> = <a class="code" href="pool_8c.html#a350f1e7495ef028020d65513801516ad">ifconfig_pool_persist_init</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#afd4844b98195de154b74ef63211f69ea">ifconfig_pool_persist_filename</a>,</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;                                                                 c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a47f49634431887f4bedb38a827f0bd5c">ifconfig_pool_persist_refresh_freq</a>);</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;        c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#ad58ae12ff4967c915c884f19800b5920">ifconfig_pool_persist_owned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;    }</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;}</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160; </div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03796"></a><span class="lineno"><a class="line" href="init_8c.html#a61d44367024a0dff3861e2afa6600694"> 3796</a></span>&#160;<a class="code" href="init_8c.html#a61d44367024a0dff3861e2afa6600694">do_close_ifconfig_pool_persist</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;{</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;    <span class="keywordflow">if</span> (!(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>))</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;    {</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a4d49f44e4e2309b3c7dc84c3aeb305c2">ifconfig_pool_persist</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#ad58ae12ff4967c915c884f19800b5920">ifconfig_pool_persist_owned</a>)</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;        {</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;            <a class="code" href="pool_8c.html#a9d5a1ea87964e5b6a9ee98f565336230">ifconfig_pool_persist_close</a>(c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a4d49f44e4e2309b3c7dc84c3aeb305c2">ifconfig_pool_persist</a>);</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a4d49f44e4e2309b3c7dc84c3aeb305c2">ifconfig_pool_persist</a> = NULL;</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;            c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#ad58ae12ff4967c915c884f19800b5920">ifconfig_pool_persist_owned</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;        }</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;    }</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;}</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160; </div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;<span class="comment"> * Inherit environmental variables</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160; </div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"><a class="line" href="init_8c.html#aef96518cac67bd66e99aec9550db581c"> 3814</a></span>&#160;<a class="code" href="init_8c.html#aef96518cac67bd66e99aec9550db581c">do_inherit_env</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structenv__set.html">env_set</a> *src)</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;{</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a> = <a class="code" href="env__set_8c.html#a589b54db89bdd1a4683d80b8132ce577">env_set_create</a>(NULL);</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a43f0201867a96a35bbecb2e52e880e47">es_owned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;    <a class="code" href="env__set_8c.html#aa810d4e0a266484c89a2f8a6b048a33a">env_set_inherit</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>, src);</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;}</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160; </div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"><a class="line" href="init_8c.html#ae4bacd78db91f799756b248946f32887"> 3822</a></span>&#160;<a class="code" href="init_8c.html#ae4bacd78db91f799756b248946f32887">do_env_set_destroy</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;{</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a43f0201867a96a35bbecb2e52e880e47">es_owned</a>)</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;    {</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;        <a class="code" href="env__set_8c.html#a2d1a7f0ea69776000aa9df3eca186f97">env_set_destroy</a>(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>);</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a> = NULL;</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a43f0201867a96a35bbecb2e52e880e47">es_owned</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;    }</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;}</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160; </div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;<span class="comment"> * Fast I/O setup.  Fast I/O is an optimization which only works</span></div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;<span class="comment"> * if all of the following are true:</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;<span class="comment"> * (1) The platform is not Windows</span></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;<span class="comment"> * (2) --proto udp is enabled</span></div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;<span class="comment"> * (3) --shaper is disabled</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03841"></a><span class="lineno"><a class="line" href="init_8c.html#a15253fe4c0e3529e707edc3ef1d3d599"> 3841</a></span>&#160;<a class="code" href="init_8c.html#a15253fe4c0e3529e707edc3ef1d3d599">do_setup_fast_io</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;{</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a5eca9bf5a659b7beaf3d1ed9e1113c3e">fast_io</a>)</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;    {</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;NOTE: --fast-io is disabled since we are running on Windows&quot;</span>);</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="socket_8c.html#a86424bdc75e8f05f00a649f30f897110">proto_is_udp</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>))</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;        {</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;NOTE: --fast-io is disabled since we are not using UDP&quot;</span>);</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;        }</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;        {</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;<span class="preprocessor">#ifdef ENABLE_FEATURE_SHAPER</span></div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;            <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a2bdc0d25499a3e547741c2a3ab06ba97">shaper</a>)</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;            {</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;                <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;NOTE: --fast-io is disabled since we are using --shaper&quot;</span>);</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;            }</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;            {</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;                c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ad8df4843172d7eaa3a83d407756f4d36">fast_io</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;            }</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;        }</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;    }</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;}</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160; </div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03870"></a><span class="lineno"><a class="line" href="init_8c.html#a24097398315c8ac1ececad11e35512fd"> 3870</a></span>&#160;<a class="code" href="init_8c.html#a24097398315c8ac1ececad11e35512fd">do_signal_on_tls_errors</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;{</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a62716987c407e3768a60476bd1b6b908">tls_exit</a>)</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;    {</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aea6f45bc37c7c473a4ba3871d43ea2d5">tls_exit_signal</a> = <a class="code" href="config-msvc_8h.html#a682182a5e5f38fd61f4311501e9dac5d">SIGTERM</a>;</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;    }</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;    {</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aea6f45bc37c7c473a4ba3871d43ea2d5">tls_exit_signal</a> = <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>;</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;    }</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;}</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160; </div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;<span class="preprocessor">#ifdef ENABLE_PLUGIN</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160; </div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l03885"></a><span class="lineno"><a class="line" href="init_8h.html#a47013063feed6a4986c4be5ea7175a06"> 3885</a></span>&#160;<a class="code" href="init_8c.html#a47013063feed6a4986c4be5ea7175a06">init_plugins</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;{</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a87474a6f7dfa4a24c0dbadd08cdf6eb7">plugin_list</a> &amp;&amp; !c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>)</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;    {</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a> = <a class="code" href="plugin_8c.html#ab157c30d4e9bddf8a22f444ceb2bd260">plugin_list_init</a>(c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a87474a6f7dfa4a24c0dbadd08cdf6eb7">plugin_list</a>);</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;        c-&gt;<a class="code" href="structcontext.html#ab86d3cd4769ad44ed77c04c13c5382fb">plugins_owned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;    }</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;}</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160; </div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l03895"></a><span class="lineno"><a class="line" href="init_8h.html#a0f041f00626bbc71b047bcf4c63c4053"> 3895</a></span>&#160;<a class="code" href="init_8c.html#a0f041f00626bbc71b047bcf4c63c4053">open_plugins</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keywordtype">bool</span> import_options, <span class="keywordtype">int</span> init_point)</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;{</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#ab86d3cd4769ad44ed77c04c13c5382fb">plugins_owned</a>)</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    {</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;        <span class="keywordflow">if</span> (import_options)</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;        {</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;            <span class="keyword">struct </span><a class="code" href="structplugin__return.html">plugin_return</a> pr, config;</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;            <a class="code" href="plugin_8h.html#a4a6e36a09c986bdd6e7d06dcdd2f7ca6">plugin_return_init</a>(&amp;pr);</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;            <a class="code" href="plugin_8c.html#afe5fc5a0558b4c8e6f89810560022b58">plugin_list_open</a>(c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a87474a6f7dfa4a24c0dbadd08cdf6eb7">plugin_list</a>, &amp;pr, c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>, init_point);</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;            <a class="code" href="plugin_8c.html#ad1d2682ddeef48fe4dc8aa95e33d2f50">plugin_return_get_column</a>(&amp;pr, &amp;config, <span class="stringliteral">&quot;config&quot;</span>);</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="plugin_8h.html#aa1b46559d3eec192f78948a4d2ee4105">plugin_return_defined</a>(&amp;config))</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;            {</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;                <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;                <span class="keywordflow">for</span> (i = 0; i &lt; config.<a class="code" href="structplugin__return.html#a2c31b3d20cc9722ebc5ac6721f8970c0">n</a>; ++i)</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;                {</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> option_types_found = 0;</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;                    <span class="keywordflow">if</span> (config.<a class="code" href="structplugin__return.html#a95de2b2a666603a9dc4a12e0cab8001a">list</a>[i] &amp;&amp; config.<a class="code" href="structplugin__return.html#a95de2b2a666603a9dc4a12e0cab8001a">list</a>[i]-&gt;<a class="code" href="structopenvpn__plugin__string__list.html#afdc8ce190d20eef63af62c4faa142cc1">value</a>)</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;                    {</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;                        <a class="code" href="options_8c.html#ab8bb8fc94d6ed39a35268deef3f8ce19">options_string_import</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>,</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;                                              config.<a class="code" href="structplugin__return.html#a95de2b2a666603a9dc4a12e0cab8001a">list</a>[i]-&gt;<a class="code" href="structopenvpn__plugin__string__list.html#afdc8ce190d20eef63af62c4faa142cc1">value</a>,</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;                                              <a class="code" href="errlevel_8h.html#a4371249a963e1bdbd3154b399964146f">D_IMPORT_ERRORS</a>|<a class="code" href="openvpn_2error_8h.html#a02fdddb17b95f31a428bf1f989df57f5">M_OPTERR</a>,</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;                                              <a class="code" href="options_8h.html#a91de4a526cf4238b865379311bdc515a">OPT_P_DEFAULT</a> &amp; ~<a class="code" href="options_8h.html#a81f0f0d22999fdf0c0c6fe82c48767ad">OPT_P_PLUGIN</a>,</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;                                              &amp;option_types_found,</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;                                              c-&gt;<a class="code" href="structcontext.html#a9b3f2f6a6281c99c8c1e26598875d5ab">es</a>);</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;                    }</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;                }</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;            }</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;            <a class="code" href="plugin_8c.html#a50c37cf828ed5be882f932207ee74d3d">plugin_return_free</a>(&amp;pr);</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;        }</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;        {</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;            <a class="code" href="plugin_8c.html#afe5fc5a0558b4c8e6f89810560022b58">plugin_list_open</a>(c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>, c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a87474a6f7dfa4a24c0dbadd08cdf6eb7">plugin_list</a>, NULL, c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>, init_point);</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;        }</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;    }</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;}</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160; </div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"><a class="line" href="init_8c.html#aa1b2b0731bba3b1b5621bc0b070f4cf0"> 3932</a></span>&#160;<a class="code" href="init_8c.html#aa1b2b0731bba3b1b5621bc0b070f4cf0">do_close_plugins</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;{</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a> &amp;&amp; c-&gt;<a class="code" href="structcontext.html#ab86d3cd4769ad44ed77c04c13c5382fb">plugins_owned</a> &amp;&amp; !(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>))</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;    {</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;        <a class="code" href="plugin_8c.html#a00747562aa2ff073488786a85055edd2">plugin_list_close</a>(c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>);</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a> = NULL;</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;        c-&gt;<a class="code" href="structcontext.html#ab86d3cd4769ad44ed77c04c13c5382fb">plugins_owned</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;    }</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;}</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160; </div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03943"></a><span class="lineno"><a class="line" href="init_8c.html#ac392bc1c0761f558869ec83c50b0c46b"> 3943</a></span>&#160;<a class="code" href="init_8c.html#ac392bc1c0761f558869ec83c50b0c46b">do_inherit_plugins</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *src)</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;{</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a> &amp;&amp; src-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>)</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;    {</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a> = <a class="code" href="plugin_8c.html#a98055daf2064644886f6e10ad61ea123">plugin_list_inherit</a>(src-&gt;<a class="code" href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">plugins</a>);</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;        c-&gt;<a class="code" href="structcontext.html#ab86d3cd4769ad44ed77c04c13c5382fb">plugins_owned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;    }</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;}</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160; </div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ifdef ENABLE_PLUGIN */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160; </div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160; </div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line"><a name="l03957"></a><span class="lineno"><a class="line" href="init_8c.html#a81e2893159f1bdba261c39b8b9d4409f"> 3957</a></span>&#160;<a class="code" href="init_8c.html#a81e2893159f1bdba261c39b8b9d4409f">management_callback_status_p2p</a>(<span class="keywordtype">void</span> *arg, <span class="keyword">const</span> <span class="keywordtype">int</span> version, <span class="keyword">struct</span> <a class="code" href="structstatus__output.html">status_output</a> *so)</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;{</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;    <span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *c = (<span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *) arg;</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;    <a class="code" href="sig_8c.html#ab24d8ba0a87e34d962d54e377a1f9858">print_status</a>(c, so);</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;}</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160; </div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l03964"></a><span class="lineno"><a class="line" href="init_8h.html#aeb60c5bfb96ec7dae0414d52ed106459"> 3964</a></span>&#160;<a class="code" href="init_8c.html#aeb60c5bfb96ec7dae0414d52ed106459">management_show_net_callback</a>(<span class="keywordtype">void</span> *arg, <span class="keyword">const</span> <span class="keywordtype">int</span> msglevel)</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;{</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;    <a class="code" href="route_8c.html#a5d725239839720fa55f3921c74098fa3">show_routes</a>(msglevel);</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;    <a class="code" href="tun_8c.html#a6f5544632174db40d087aaf55d70f5c6">show_adapters</a>(msglevel);</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(msglevel, <span class="stringliteral">&quot;END&quot;</span>);</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(msglevel, <span class="stringliteral">&quot;ERROR: Sorry, this command is currently only implemented on Windows&quot;</span>);</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;}</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160; </div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;<span class="preprocessor">#ifdef TARGET_ANDROID</span></div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;management_callback_network_change(<span class="keywordtype">void</span> *arg, <span class="keywordtype">bool</span> samenetwork)</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;{</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;    <span class="comment">/* Check if the client should translate the network change to a SIGUSR1 to</span></div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;<span class="comment">     * reestablish the connection or just reprotect the socket</span></div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;<span class="comment">     * At the moment just assume that, for all settings that use pull (not</span></div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;<span class="comment">     * --static) and are not using peer-id reestablishing the connection is</span></div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;<span class="comment">     * required (unless the network is the same)</span></div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;<span class="comment">     * The function returns -1 on invalid fd and -2 if the socket cannot be</span></div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;<span class="comment">     * reused. On the -2 return value the man_network_change function triggers</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;<span class="comment">     * a SIGUSR1 to force a reconnect.</span></div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160; </div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;    <span class="keywordtype">int</span> socketfd = -1;</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;    <span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *c = (<span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *) arg;</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>)</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;    {</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    }</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>-&gt;<a class="code" href="structlink__socket.html#aef0ab7aed42bb525241ae838e98ce8cd">sd</a> == <a class="code" href="syshead_8h.html#a3fa9d20331cf27c4219b58ca00c99fb8">SOCKET_UNDEFINED</a>)</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;    {</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    }</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160; </div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    socketfd = c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>-&gt;<a class="code" href="structlink__socket.html#aef0ab7aed42bb525241ae838e98ce8cd">sd</a>;</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">pull</a> || c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">tls_multi</a>-&gt;<a class="code" href="structtls__multi.html#aa1c6b330c9dd68a9f9dd6bf05d454642">use_peer_id</a> || samenetwork)</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;    {</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;        <span class="keywordflow">return</span> socketfd;</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;    }</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;    {</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;        <span class="keywordflow">return</span> -2;</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;    }</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;}</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ifdef TARGET_ANDROID */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160; </div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ifdef ENABLE_MANAGEMENT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160; </div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04017"></a><span class="lineno"><a class="line" href="init_8h.html#ae773083a33804e90cfcc72aadf5900c2"> 4017</a></span>&#160;<a class="code" href="init_8c.html#ae773083a33804e90cfcc72aadf5900c2">init_management_callback_p2p</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;{</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;    {</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;        <span class="keyword">struct </span><a class="code" href="structmanagement__callback.html">management_callback</a> cb;</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;        <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(cb);</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;        cb.<a class="code" href="structmanagement__callback.html#a51ec17928e49762bb04d06dbd104d87a">arg</a> = c;</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;        cb.<a class="code" href="structmanagement__callback.html#a87986defc12d4c56b0d766488e6f6f6b">status</a> = <a class="code" href="init_8c.html#a81e2893159f1bdba261c39b8b9d4409f">management_callback_status_p2p</a>;</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;        cb.<a class="code" href="structmanagement__callback.html#af23e7074e37435f0def43f98553d20d4">show_net</a> = <a class="code" href="init_8c.html#aeb60c5bfb96ec7dae0414d52ed106459">management_show_net_callback</a>;</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;        cb.<a class="code" href="structmanagement__callback.html#ab6cb29dc8aeb81ebfe6b619930bd78e3">proxy_cmd</a> = <a class="code" href="init_8c.html#a5c4a6e02a7ce255f07b18c8fa91165d1">management_callback_proxy_cmd</a>;</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;        cb.<a class="code" href="structmanagement__callback.html#ad8622b0a8677465b1773e90a456d1e71">remote_cmd</a> = <a class="code" href="init_8c.html#a09027bba2ec659835b859d8b4b54bc58">management_callback_remote_cmd</a>;</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;        cb.<a class="code" href="structmanagement__callback.html#aa4591e95155aadc60395178e82b6f2b8">send_cc_message</a> = <a class="code" href="init_8c.html#aeb934fcc37236813bbde6746b45708f1">management_callback_send_cc_message</a>;</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;<span class="preprocessor">#ifdef TARGET_ANDROID</span></div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;        cb.network_change = management_callback_network_change;</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;        <a class="code" href="manage_8c.html#abf92fcefadaa4a0c6ad478bcd2aa1c1e">management_set_callback</a>(<a class="code" href="structmanagement.html">management</a>, &amp;cb);</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;    }</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;}</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160; </div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160; </div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04041"></a><span class="lineno"><a class="line" href="init_8h.html#a673de72ed4512c8beca87a9a6e048d78"> 4041</a></span>&#160;<a class="code" href="init_8c.html#a673de72ed4512c8beca87a9a6e048d78">init_management</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;{</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;    {</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;        <a class="code" href="structmanagement.html">management</a> = <a class="code" href="manage_8c.html#af404c50872c1c08a98f9908adef8bab8">management_init</a>();</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    }</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;}</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160; </div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l04050"></a><span class="lineno"><a class="line" href="init_8h.html#a0513901da31c7584b524b7993fc03d6b"> 4050</a></span>&#160;<a class="code" href="init_8c.html#a0513901da31c7584b524b7993fc03d6b">open_management</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;{</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    <span class="comment">/* initialize management layer */</span></div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;    {</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#acbad418a811dd1f8a4c5ed4371786c03">management_addr</a>)</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;        {</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structmanagement__callback.html#abd95714952054b7a9f38ea9bd4aad9fa">flags</a> = c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a76c3c06aff137da6cd445b5b30fafe88">management_flags</a>;</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;            <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a8a97f5f530042a7f4321cb97c3983fa1">mode</a> == <a class="code" href="options_8h.html#a3f2e4b6d38cb9fbb3839ed4a478bf39d">MODE_SERVER</a>)</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;            {</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;                <a class="code" href="structmanagement__callback.html#abd95714952054b7a9f38ea9bd4aad9fa">flags</a> |= <a class="code" href="manage_8h.html#ab608fef69cf0640bc6ea6944f2e59e65">MF_SERVER</a>;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;            }</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#a35fb8d8af2aafb178f16acb5f3751ba2">management_open</a>(<a class="code" href="structmanagement.html">management</a>,</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;                                c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#acbad418a811dd1f8a4c5ed4371786c03">management_addr</a>,</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;                                c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a114de9e3d8ed4495e4fa53a771a2d5b4">management_port</a>,</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;                                c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#af251f46ceb2e74a60d1cbae97a244865">management_user_pass</a>,</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;                                c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#abbd5e217964dbfcda76a1a6686157eb6">management_client_user</a>,</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;                                c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#af7407032e284318f3db14785298b4978">management_client_group</a>,</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;                                c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a56a1392631100097bd9dcab7e7f7943f">management_log_history_cache</a>,</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;                                c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a2c4173af5907c061d7b6b24f28ccc61b">management_echo_buffer_size</a>,</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;                                c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a286bfe71ee1acdb5108cab1e1ebd2197">management_state_buffer_size</a>,</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;                                c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a95e6a32fa6d2463934f22f82bdcdd5e9">management_write_peer_info_file</a>,</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;                                c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#aeea9c1239f3809521b0dde3bcc622fc3">remap_sigusr1</a>,</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;                                <a class="code" href="structmanagement__callback.html#abd95714952054b7a9f38ea9bd4aad9fa">flags</a>))</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;            {</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;                <a class="code" href="manage_8c.html#a8ad93473fd4ba6402ecea847d69afae1">management_set_state</a>(<a class="code" href="structmanagement.html">management</a>,</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;                                     <a class="code" href="manage_8h.html#a26400652fda6f483b774ef6771129f9a">OPENVPN_STATE_CONNECTING</a>,</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;                                     NULL,</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;                                     NULL,</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;                                     NULL,</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;                                     NULL,</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;                                     NULL);</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;            }</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160; </div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;            <span class="comment">/* initial management hold, called early, before first context initialization */</span></div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;            <a class="code" href="init_8c.html#a9954eafaec4fc968645107a926f54df6">do_hold</a>(0);</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(c))</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;            {</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;                <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a>, <span class="stringliteral">&quot;Signal received from management interface, exiting&quot;</span>);</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;            }</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;        }</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;        {</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;            <a class="code" href="init_8c.html#af9f473c94277d38beef77e1b1f165b33">close_management</a>();</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;        }</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;    }</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;}</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160; </div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"><a class="line" href="init_8h.html#af9f473c94277d38beef77e1b1f165b33"> 4101</a></span>&#160;<a class="code" href="init_8c.html#af9f473c94277d38beef77e1b1f165b33">close_management</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;{</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;    {</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;        <a class="code" href="manage_8c.html#a876e127f99707c421d4e4be19ac8cbbf">management_close</a>(<a class="code" href="structmanagement.html">management</a>);</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;        <a class="code" href="structmanagement.html">management</a> = NULL;</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;    }</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;}</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160; </div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ifdef ENABLE_MANAGEMENT */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160; </div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160; </div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04114"></a><span class="lineno"><a class="line" href="init_8h.html#a02ceb57bb5de63c8eaedf553219d9793"> 4114</a></span>&#160;<a class="code" href="init_8c.html#a02ceb57bb5de63c8eaedf553219d9793">uninit_management_callback</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;{</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;<span class="preprocessor">#ifdef ENABLE_MANAGEMENT</span></div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    {</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;        <a class="code" href="manage_8c.html#a2f65461787a2f0f9c6d983b497b8c6ce">management_clear_callback</a>(<a class="code" href="structmanagement.html">management</a>);</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;    }</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;}</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160; </div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;<span class="comment"> * Initialize a tunnel instance, handle pre and post-init</span></div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;<span class="comment"> * signal settings.</span></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04129"></a><span class="lineno"><a class="line" href="init_8h.html#a6a1f31e3d9a1f00ef308cd117c540ed4"> 4129</a></span>&#160;<a class="code" href="init_8c.html#a6a1f31e3d9a1f00ef308cd117c540ed4">init_instance_handle_signals</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structenv__set.html">env_set</a> *env, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structmanagement__callback.html#abd95714952054b7a9f38ea9bd4aad9fa">flags</a>)</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;{</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;    <a class="code" href="sig_8c.html#a705ac4a2e18cd9194106e0bed544247f">pre_init_signal_catch</a>();</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;    <a class="code" href="init_8c.html#a2986d81718c6cb5cd19bad612998d56f">init_instance</a>(c, env, <a class="code" href="structmanagement__callback.html#abd95714952054b7a9f38ea9bd4aad9fa">flags</a>);</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;    <a class="code" href="sig_8c.html#a26c2d844baaa9c3c3457b1b8081c7458">post_init_signal_catch</a>();</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160; </div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;<span class="comment">     * This is done so that signals thrown during</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;<span class="comment">     * initialization can bring us back to</span></div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;<span class="comment">     * a management hold.</span></div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(c))</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    {</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;        <a class="code" href="sig_8c.html#a72435bcf3d3d808567a47c639a8fd121">remap_signal</a>(c);</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;        <a class="code" href="init_8c.html#a02ceb57bb5de63c8eaedf553219d9793">uninit_management_callback</a>();</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;    }</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;}</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160; </div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;<span class="comment"> * Initialize a tunnel instance.</span></div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04151"></a><span class="lineno"><a class="line" href="init_8h.html#a2986d81718c6cb5cd19bad612998d56f"> 4151</a></span>&#160;<a class="code" href="init_8c.html#a2986d81718c6cb5cd19bad612998d56f">init_instance</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structenv__set.html">env_set</a> *env, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structmanagement__callback.html#abd95714952054b7a9f38ea9bd4aad9fa">flags</a>)</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;{</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a> = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>;</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> child = (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#ab31447bc2ad9819e323c5795af28e93e">CM_CHILD_TCP</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#ae1e939740ff946b87d7d65c3f533c9b5">CM_CHILD_UDP</a>);</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;    <span class="keywordtype">int</span> link_socket_mode = <a class="code" href="socket_8h.html#a9c4bfc3d8aeda3bb49d8d3897892f3ee">LS_MODE_DEFAULT</a>;</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160; </div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;    <span class="comment">/* init garbage collection level */</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;    <a class="code" href="buffer_8h.html#a5e45126fc0cb0593cf8f0154d78c1c27">gc_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ad4aeb5d46c4a32dc490a124af2c0770a">gc</a>);</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160; </div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    <span class="comment">/* inherit environmental variables */</span></div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;    <span class="keywordflow">if</span> (env)</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    {</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;        <a class="code" href="init_8c.html#aef96518cac67bd66e99aec9550db581c">do_inherit_env</a>(c, env);</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;    }</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160; </div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;    <span class="comment">/* signals caught here will abort */</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> = 0;</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a> = NULL;</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#aff345ec3f6a0b37155a2561e9ff7f0b5">source</a> = <a class="code" href="sig_8h.html#ab8b88b4e662519c9b9a38eda6f0b443c">SIG_SOURCE_SOFT</a>;</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160; </div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a>)</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;    {</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;        <a class="code" href="init_8c.html#ae773083a33804e90cfcc72aadf5900c2">init_management_callback_p2p</a>(c);</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;    }</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160; </div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;    <span class="comment">/* possible sleep or management hold if restart */</span></div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>)</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;    {</div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;        <a class="code" href="init_8c.html#ad6e5429d3088ee255e912f452f78b0ba">do_startup_pause</a>(c);</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(c))</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;        {</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;            <span class="keywordflow">goto</span> sig;</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;        }</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;    }</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160; </div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a055000dd88801bd1be2262bf8b447ec9">resolve_in_advance</a>)</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;    {</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;        <a class="code" href="socket_8c.html#abd7036d683a6339013d79ec69c6f1742">do_preresolve</a>(c);</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(c))</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;        {</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;            <span class="keywordflow">goto</span> sig;</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;        }</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;    }</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160; </div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;    <span class="comment">/* map in current connection entry */</span></div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;    <a class="code" href="init_8c.html#a0c6a92888206f636e794b6d3c9edb343">next_connection_entry</a>(c);</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160; </div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;    <span class="comment">/* link_socket_mode allows CM_CHILD_TCP</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;<span class="comment">     * instances to inherit acceptable fds</span></div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;<span class="comment">     * from a top-level parent */</span></div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a> == <a class="code" href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599aeff17f4932089fddd54b29765c8cdbd7">PROTO_TCP_SERVER</a>)</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;    {</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>)</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;        {</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;            link_socket_mode = <a class="code" href="socket_8h.html#ab2808d3cfa79a16107297dcacf7df779">LS_MODE_TCP_LISTEN</a>;</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;        }</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#ab31447bc2ad9819e323c5795af28e93e">CM_CHILD_TCP</a>)</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;        {</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;            link_socket_mode = <a class="code" href="socket_8h.html#a157c21b8cc55b246867518e68946f43d">LS_MODE_TCP_ACCEPT_FROM</a>;</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;        }</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;    }</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160; </div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    <span class="comment">/* should we disable paging? */</span></div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a> &amp;&amp; <a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#aa016b4614f03c9fc02b643846812bbc7">mlock</a>)</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;    {</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;        <a class="code" href="platform_8c.html#a81c983ed37e32842f86b6677e3b830ba">platform_mlockall</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;    }</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160; </div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;<span class="preprocessor">#if P2MP</span></div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;    <span class="comment">/* get passwords if undefined */</span></div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="options_8c.html#ade63586867ed9b0f268b4857ac8e7a5f">auth_retry_get</a>() == <a class="code" href="options_8h.html#a570ecbd9a01e98df42199d078454f848">AR_INTERACT</a>)</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;    {</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;        <a class="code" href="init_8c.html#a7876e414d4cb824cab1e8ad6b2c7c35c">init_query_passwords</a>(c);</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;    }</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160; </div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    <span class="comment">/* initialize context level 2 --verb/--mute parms */</span></div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;    <a class="code" href="init_8c.html#a164331d37fecc9ad095eae0e8dce53de">init_verb_mute</a>(c, <a class="code" href="init_8h.html#a2fde4b1cea35c1d5ecc1dfcc4ac16a38">IVM_LEVEL_2</a>);</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160; </div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;    <span class="comment">/* set error message delay for non-server modes */</span></div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a>)</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;    {</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a7da87b23868c6efa70ce599f9ecd341b">set_check_status_error_delay</a>(<a class="code" href="errlevel_8h.html#a398b8eecec50c6ca4ad75b9d5a46f17a">P2P_ERROR_DELAY_MS</a>);</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;    }</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160; </div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;    <span class="comment">/* warn about inconsistent options */</span></div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>)</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;    {</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;        <a class="code" href="init_8c.html#a27a30601d477a9ec64c7b5abb697b5df">do_option_warnings</a>(c);</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;    }</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160; </div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;<span class="preprocessor">#ifdef ENABLE_PLUGIN</span></div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;    <span class="comment">/* initialize plugins */</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>)</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;    {</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;        <a class="code" href="init_8c.html#a0f041f00626bbc71b047bcf4c63c4053">open_plugins</a>(c, <span class="keyword">false</span>, <a class="code" href="openvpn-plugin_8h.html#a2633a7eaf3979e6f4c02480284e9f7ad">OPENVPN_PLUGIN_INIT_PRE_DAEMON</a>);</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;    }</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160; </div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;    <span class="comment">/* should we enable fast I/O? */</span></div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>)</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;    {</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;        <a class="code" href="init_8c.html#a15253fe4c0e3529e707edc3ef1d3d599">do_setup_fast_io</a>(c);</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;    }</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160; </div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;    <span class="comment">/* should we throw a signal on TLS errors? */</span></div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;    <a class="code" href="init_8c.html#a24097398315c8ac1ececad11e35512fd">do_signal_on_tls_errors</a>(c);</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160; </div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;    <span class="comment">/* open --status file */</span></div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>)</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    {</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;        <a class="code" href="init_8c.html#a71177a52e10b7bb794394d863d3afa3e">do_open_status_output</a>(c);</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;    }</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160; </div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;    <span class="comment">/* open --ifconfig-pool-persist file */</span></div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>)</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;    {</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;        <a class="code" href="init_8c.html#a60549a254336200d6162c9b08081d3f9">do_open_ifconfig_pool_persist</a>(c);</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;    }</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160; </div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;    <span class="comment">/* reset OCC state */</span></div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || child)</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;    {</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a582d5d0db01357d9bb7fa113ecc16c96">occ_op</a> = <a class="code" href="occ_8h.html#a8e571538d538bcf6cab30d82a0dbabf6">occ_reset_op</a>();</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;    }</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160; </div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;    <span class="comment">/* our wait-for-i/o objects, different for posix vs. win32 */</span></div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a>)</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;    {</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;        <a class="code" href="init_8c.html#a5701fecef4d3afde02d2604f1b61f7f3">do_event_set_init</a>(c, <a class="code" href="options_8h.html#a6a97a9ddb19735be2f51caa66269ba1c">SHAPER_DEFINED</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>));</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;    }</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#ab31447bc2ad9819e323c5795af28e93e">CM_CHILD_TCP</a>)</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;    {</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;        <a class="code" href="init_8c.html#a5701fecef4d3afde02d2604f1b61f7f3">do_event_set_init</a>(c, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;    }</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160; </div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;    <span class="comment">/* initialize HTTP or SOCKS proxy object at scope level 2 */</span></div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;    <a class="code" href="init_8c.html#ae6bf15962c96c4c75cec9baa6a20dc6a">init_proxy</a>(c);</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160; </div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;    <span class="comment">/* allocate our socket object */</span></div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#ab31447bc2ad9819e323c5795af28e93e">CM_CHILD_TCP</a>)</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;    {</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;        <a class="code" href="init_8c.html#a5bf221a89c0561061bd91985797fa61c">do_link_socket_new</a>(c);</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    }</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160; </div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;<span class="preprocessor">#ifdef ENABLE_FRAGMENT</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;    <span class="comment">/* initialize internal fragmentation object */</span></div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#ab003130b974deb481133d4209f74b25c">fragment</a> &amp;&amp; (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || child))</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;    {</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a2096e6377ff24432baeafa7864a7483b">fragment</a> = <a class="code" href="group__fragmentation.html#ga0be982cb04c4e5c3344d8f91323f4d8c">fragment_init</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>);</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;    }</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160; </div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;    <span class="comment">/* init crypto layer */</span></div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;    {</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> crypto_flags = 0;</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>)</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;        {</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;            crypto_flags = <a class="code" href="init_8c.html#adc52e27fb65137f8ac18a18cd03551f6">CF_INIT_TLS_AUTH_STANDALONE</a>;</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;        }</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a>)</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;        {</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;            crypto_flags = <a class="code" href="init_8c.html#a4f3c4044edc3d306325c49f75e18c931">CF_LOAD_PERSISTED_PACKET_ID</a> | <a class="code" href="init_8c.html#a57cbdb902da19e518279d624dd22b5c4">CF_INIT_TLS_MULTI</a>;</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;        }</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child)</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;        {</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;            crypto_flags = <a class="code" href="init_8c.html#a57cbdb902da19e518279d624dd22b5c4">CF_INIT_TLS_MULTI</a>;</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;        }</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;        <a class="code" href="init_8c.html#a3660e2369c99008cda0efe61b5acfbac">do_init_crypto</a>(c, crypto_flags);</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(c) &amp;&amp; !child)</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;        {</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;            <span class="keywordflow">goto</span> sig;</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;        }</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;    }</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160; </div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;<span class="preprocessor">#ifdef USE_COMP</span></div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;    <span class="comment">/* initialize compression library. */</span></div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;    <span class="keywordflow">if</span> (comp_enabled(&amp;<a class="code" href="structoptions.html">options</a>-&gt;comp) &amp;&amp; (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || child))</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;    {</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.comp_context = comp_init(&amp;<a class="code" href="structoptions.html">options</a>-&gt;comp);</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;    }</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160; </div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;    <span class="comment">/* initialize MTU variables */</span></div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    <a class="code" href="init_8c.html#a2e4b08374469d04d9541f64273665582">do_init_frame</a>(c);</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160; </div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;    <span class="comment">/* initialize TLS MTU variables */</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;    <a class="code" href="init_8c.html#a3709fc7248a2af73c0a60a34594dcee7">do_init_frame_tls</a>(c);</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160; </div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;    <span class="comment">/* init workspace buffers whose size is derived from frame size */</span></div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#ab31447bc2ad9819e323c5795af28e93e">CM_CHILD_TCP</a>)</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;    {</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;        <a class="code" href="init_8c.html#ae5f5cf77443aa964f81ff68fb350d83f">do_init_buffers</a>(c);</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;    }</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160; </div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;<span class="preprocessor">#ifdef ENABLE_FRAGMENT</span></div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;    <span class="comment">/* initialize internal fragmentation capability with known frame size */</span></div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#ab003130b974deb481133d4209f74b25c">fragment</a> &amp;&amp; (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || child))</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    {</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;        <a class="code" href="init_8c.html#a577bf7b44dff6a8b3380cc96a8a3a1ba">do_init_fragment</a>(c);</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;    }</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160; </div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;    <span class="comment">/* initialize dynamic MTU variable */</span></div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    <a class="code" href="mtu_8c.html#abf74c37a0e444f337bb18382ff84321b">frame_init_mssfix</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>, &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>);</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160; </div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;    <span class="comment">/* bind the TCP/UDP socket */</span></div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#ab31447bc2ad9819e323c5795af28e93e">CM_CHILD_TCP</a>)</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;    {</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;        <a class="code" href="init_8c.html#abab69003e7cb3f0624fd9edf8f9b4037">do_init_socket_1</a>(c, link_socket_mode);</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;    }</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160; </div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;    <span class="comment">/* initialize tun/tap device object,</span></div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;<span class="comment">     * open tun/tap device, ifconfig, run up script, etc. */</span></div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    <span class="keywordflow">if</span> (!(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a38f4b8bb967c7310eaaa3d77239f7780">up_delay</a> || <a class="code" href="options_8h.html#abff23e3641208e00e513e5b240b42d00">PULL_DEFINED</a>(<a class="code" href="structoptions.html">options</a>)) &amp;&amp; (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>))</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;    {</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a367a0c4601050fe0e0368ec06c58754b">did_open_tun</a> = <a class="code" href="init_8c.html#a8578b737da354d6ddd938b9b7d5dd89f">do_open_tun</a>(c);</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;    }</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160; </div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;    c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a1187d7900d4fcec429d30b7e5370d551">frame_initial</a> = c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>;</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160; </div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;    <span class="comment">/* print MTU info */</span></div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;    <a class="code" href="init_8c.html#a46d6454c2cf71f447451e11c5fa98722">do_print_data_channel_mtu_parms</a>(c);</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160; </div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;    <span class="comment">/* get local and remote options compatibility strings */</span></div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || child)</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;    {</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;        <a class="code" href="init_8c.html#a7e221190dbfc1c1cbd88ae2c834434f9">do_compute_occ_strings</a>(c);</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;    }</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160; </div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;    <span class="comment">/* initialize output speed limiter */</span></div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a>)</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;    {</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;        <a class="code" href="init_8c.html#a3b4a0a2b9abc79b1a2ea53ecc6125303">do_init_traffic_shaper</a>(c);</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;    }</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160; </div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;    <span class="comment">/* do one-time inits, and possibly become a daemon here */</span></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;    <a class="code" href="init_8c.html#a05df1a443a6eac2dc6faa292fb433f27">do_init_first_time</a>(c);</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160; </div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;<span class="preprocessor">#ifdef ENABLE_PLUGIN</span></div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;    <span class="comment">/* initialize plugins */</span></div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>)</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;    {</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;        <a class="code" href="init_8c.html#a0f041f00626bbc71b047bcf4c63c4053">open_plugins</a>(c, <span class="keyword">false</span>, <a class="code" href="openvpn-plugin_8h.html#a15a8b3e16852174753e672fec722dbb3">OPENVPN_PLUGIN_INIT_POST_DAEMON</a>);</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;    }</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160; </div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;    <span class="comment">/* initialise connect timeout timer */</span></div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;    <a class="code" href="init_8c.html#aa178c8a6f722ca1be6e847e1310f3897">do_init_server_poll_timeout</a>(c);</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160; </div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;    <span class="comment">/* finalize the TCP/UDP socket */</span></div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#ab31447bc2ad9819e323c5795af28e93e">CM_CHILD_TCP</a>)</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;    {</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;        <a class="code" href="init_8c.html#ae73a7779aedce66ab4e13e23bb856587">do_init_socket_2</a>(c);</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;    }</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160; </div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;<span class="comment">     * Actually do UID/GID downgrade, and chroot, if requested.</span></div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;<span class="comment">     * May be delayed by --client, --pull, or --up-delay.</span></div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;    <a class="code" href="init_8c.html#a169d584d7f1127019c1aaf17091e3e61">do_uid_gid_chroot</a>(c, c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a367a0c4601050fe0e0368ec06c58754b">did_open_tun</a>);</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160; </div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;    <span class="comment">/* initialize timers */</span></div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || child)</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;    {</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;        <a class="code" href="init_8c.html#a4ce16743e82e7bcab17fe41d03b3fd44">do_init_timers</a>(c, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;    }</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160; </div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;<span class="preprocessor">#ifdef ENABLE_PLUGIN</span></div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;    <span class="comment">/* initialize plugins */</span></div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>)</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;    {</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;        <a class="code" href="init_8c.html#a0f041f00626bbc71b047bcf4c63c4053">open_plugins</a>(c, <span class="keyword">false</span>, <a class="code" href="openvpn-plugin_8h.html#a6008ae962bfc95db877f153582b7aa54">OPENVPN_PLUGIN_INIT_POST_UID_CHANGE</a>);</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;    }</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160; </div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;<span class="preprocessor">#if PORT_SHARE</span></div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;    <span class="comment">/* share OpenVPN port with foreign (such as HTTPS) server */</span></div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a> &amp;&amp; (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>))</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;    {</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;        init_port_share(c);</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;    }</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160; </div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;<span class="preprocessor">#ifdef ENABLE_PF</span></div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;    <span class="keywordflow">if</span> (child)</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;    {</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;        pf_init_context(c);</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;    }</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160; </div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;    <span class="comment">/* Check for signals */</span></div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(c))</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    {</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;        <span class="keywordflow">goto</span> sig;</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;    }</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160; </div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160; </div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;sig:</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;    <span class="keywordflow">if</span> (!c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a>)</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;    {</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a> = <span class="stringliteral">&quot;init_instance&quot;</span>;</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;    }</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;    <a class="code" href="init_8c.html#a8f6bfd35ae93f4eda968d89f76637a98">close_context</a>(c, -1, flags);</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;}</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160; </div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;<span class="comment"> * Close a tunnel instance.</span></div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04463"></a><span class="lineno"><a class="line" href="init_8h.html#a2cddf7b7e6402aa02311c949ec0dd51c"> 4463</a></span>&#160;<a class="code" href="init_8c.html#a2cddf7b7e6402aa02311c949ec0dd51c">close_instance</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c)</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;{</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;    <span class="comment">/* close event objects */</span></div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;    <a class="code" href="init_8c.html#a95c0a575a66fd93651241d08fbf7444e">do_close_event_set</a>(c);</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160; </div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a></div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;        || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#ab31447bc2ad9819e323c5795af28e93e">CM_CHILD_TCP</a></div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;        || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#ae1e939740ff946b87d7d65c3f533c9b5">CM_CHILD_UDP</a></div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;        || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>)</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;    {</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;        <span class="comment">/* if xinetd/inetd mode, don&#39;t allow restart */</span></div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;        <a class="code" href="init_8c.html#a23ba16c1479ad9ab48de1cd7f655a648">do_close_check_if_restart_permitted</a>(c);</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160; </div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;<span class="preprocessor">#ifdef USE_COMP</span></div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;        <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.comp_context)</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;        {</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;            comp_uninit(c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.comp_context);</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.comp_context = NULL;</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;        }</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160; </div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;        <span class="comment">/* free buffers */</span></div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;        <a class="code" href="init_8c.html#a74ee8a601d15d115c433b90a93ee1301">do_close_free_buf</a>(c);</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160; </div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;        <span class="comment">/* close TLS */</span></div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;        <a class="code" href="init_8c.html#af81e65de77cb7e8ce6e19844ffb749b9">do_close_tls</a>(c);</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160; </div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;        <span class="comment">/* free key schedules */</span></div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;        <a class="code" href="init_8c.html#a5c3a221406c8c4ed6795c1f3ef9ce7f0">do_close_free_key_schedule</a>(c, (c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a> || c-&gt;<a class="code" href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">mode</a> == <a class="code" href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a>));</div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160; </div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;        <a class="code" href="init_8c.html#a102f942e503c6a61f394ad6e4c66a5d7">restore_ncp_options</a>(c);</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160; </div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;        <span class="comment">/* close TCP/UDP connection */</span></div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;        <a class="code" href="init_8c.html#a1dfcc5395d28064586bb8f94409b86ef">do_close_link_socket</a>(c);</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160; </div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;        <span class="comment">/* close TUN/TAP device */</span></div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;        <a class="code" href="init_8c.html#a62d7dcc84da69695748e556fda9833fe">do_close_tun</a>(c, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160; </div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;<span class="preprocessor">#ifdef MANAGEMENT_DEF_AUTH</span></div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structmanagement.html">management</a>)</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;        {</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;            management_notify_client_close(<a class="code" href="structmanagement.html">management</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.mda_context, NULL);</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;        }</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160; </div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;<span class="preprocessor">#ifdef ENABLE_PF</span></div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;        pf_destroy_context(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.pf);</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160; </div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;<span class="preprocessor">#ifdef ENABLE_PLUGIN</span></div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;        <span class="comment">/* call plugin close functions and unload */</span></div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;        <a class="code" href="init_8c.html#aa1b2b0731bba3b1b5621bc0b070f4cf0">do_close_plugins</a>(c);</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160; </div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;        <span class="comment">/* close packet-id persistence file */</span></div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;        <a class="code" href="init_8c.html#ad60e48d4f954964c89982f7f768cd114">do_close_packet_id</a>(c);</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160; </div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;        <span class="comment">/* close --status file */</span></div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;        <a class="code" href="init_8c.html#a5696f524319366de9d91a26d7290bfbb">do_close_status_output</a>(c);</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160; </div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;<span class="preprocessor">#ifdef ENABLE_FRAGMENT</span></div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;        <span class="comment">/* close fragmentation handler */</span></div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;        <a class="code" href="init_8c.html#a7ff24c87873c65ffd41f47539bc6b760">do_close_fragment</a>(c);</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160; </div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;        <span class="comment">/* close --ifconfig-pool-persist obj */</span></div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;        <a class="code" href="init_8c.html#a61d44367024a0dff3861e2afa6600694">do_close_ifconfig_pool_persist</a>(c);</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160; </div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;        <span class="comment">/* free up environmental variable store */</span></div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;        <a class="code" href="init_8c.html#ae4bacd78db91f799756b248946f32887">do_env_set_destroy</a>(c);</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160; </div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;        <span class="comment">/* close HTTP or SOCKS proxy */</span></div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;        <a class="code" href="init_8c.html#a04bb98ad987538a3b9a2db4f34e5063e">uninit_proxy</a>(c);</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160; </div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;        <span class="comment">/* garbage collect */</span></div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;        <a class="code" href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ad4aeb5d46c4a32dc490a124af2c0770a">gc</a>);</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;    }</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;}</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160; </div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04543"></a><span class="lineno"><a class="line" href="init_8h.html#a2e3da881a15567d205101e6b0853987a"> 4543</a></span>&#160;<a class="code" href="init_8c.html#a2e3da881a15567d205101e6b0853987a">inherit_context_child</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>,</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;                      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *src)</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;{</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;    <a class="code" href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a>(*<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>);</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160; </div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;    <span class="comment">/* proto_is_dgram will ASSERT(0) if proto is invalid */</span></div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;mode = <a class="code" href="socket_8c.html#adbff197bdb9734118cdf9889650477ae">proto_is_dgram</a>(src-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>) ? <a class="code" href="openvpn_8h.html#ae1e939740ff946b87d7d65c3f533c9b5">CM_CHILD_UDP</a> : <a class="code" href="openvpn_8h.html#ab31447bc2ad9819e323c5795af28e93e">CM_CHILD_TCP</a>;</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160; </div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;gc = <a class="code" href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a>();</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160; </div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;    <a class="code" href="buffer_8h.html#ab4491b7f3124ff7b050e37c38c2e620b">ALLOC_OBJ_CLEAR_GC</a>(<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;sig, <span class="keyword">struct</span> <a class="code" href="structsignal__info.html">signal_info</a>, &amp;<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;gc);</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160; </div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;    <span class="comment">/* c1 init */</span></div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;    <a class="code" href="openvpn_8h.html#a65137f59c4038945b8df98139a6cef77">packet_id_persist_init</a>(&amp;<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.pid_persist);</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160; </div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.ks.key_type = src-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a4a34faf7867d3d6647238e914324a99b">key_type</a>;</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;    <span class="comment">/* inherit SSL context */</span></div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.ks.ssl_ctx = src-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a5e59f0aab5d757ed334039b15682829a">ssl_ctx</a>;</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.ks.tls_wrap_key = src-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#ad2ce1d97a35d1c487ce7c13f52d900c5">tls_wrap_key</a>;</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.ks.tls_auth_key_type = src-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a6a3add124db00336ab5c081037ae11fd">tls_auth_key_type</a>;</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.ks.tls_crypt_v2_server_key = src-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#afc58d93e9c900d3bd001a8ee09f0932c">tls_crypt_v2_server_key</a>;</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;    <span class="comment">/* inherit pre-NCP ciphers */</span></div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.ciphername = src-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#ad11841ba9d26ef246e5812a7a7db27b6">ciphername</a>;</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.authname = src-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#ad9a55fafb79287621cc7dfde3851df49">authname</a>;</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.keysize = src-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a6f12c9d9f20f780524ecd9849e36a574">keysize</a>;</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160; </div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;    <span class="comment">/* inherit auth-token */</span></div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.ks.auth_token_key = src-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>.<a class="code" href="structkey__schedule.html#a52c3c5b8bfd7c529453ef8b526944209">auth_token_key</a>;</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160; </div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;    <span class="comment">/* options */</span></div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;options = src-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>;</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;    <a class="code" href="options_8c.html#aaf33ed424941f850b99c2a26d6f64378">options_detach</a>(&amp;<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;options);</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160; </div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;mode == <a class="code" href="openvpn_8h.html#ab31447bc2ad9819e323c5795af28e93e">CM_CHILD_TCP</a>)</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;    {</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;<span class="comment">         * The CM_TOP context does the socket listen(),</span></div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;<span class="comment">         * and the CM_CHILD_TCP context does the accept().</span></div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;        <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.accept_from = src-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>;</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;    }</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160; </div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;<span class="preprocessor">#ifdef ENABLE_PLUGIN</span></div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;    <span class="comment">/* inherit plugins */</span></div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;    <a class="code" href="init_8c.html#ac392bc1c0761f558869ec83c50b0c46b">do_inherit_plugins</a>(<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>, src);</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160; </div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;    <span class="comment">/* context init */</span></div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;    <a class="code" href="init_8c.html#a2986d81718c6cb5cd19bad612998d56f">init_instance</a>(<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>, src-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">es</a>, <a class="code" href="init_8h.html#ac73c2e030d3db046d8e44288178ff2ae">CC_NO_CLOSE</a> | <a class="code" href="init_8h.html#a88731ead0689d66ac028b4027a66b7a7">CC_USR1_TO_HUP</a>);</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a>(<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>))</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;    {</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;    }</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160; </div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;    <span class="comment">/* inherit tun/tap interface object */</span></div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.tuntap = src-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">tuntap</a>;</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160; </div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;    <span class="comment">/* UDP inherits some extra things which TCP does not */</span></div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;mode == <a class="code" href="openvpn_8h.html#ae1e939740ff946b87d7d65c3f533c9b5">CM_CHILD_UDP</a>)</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;    {</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;        <span class="comment">/* inherit buffers */</span></div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;        <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.buffers = src-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#ae2e304ff3393a09ee15f7490f50b89d8">buffers</a>;</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160; </div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;        <span class="comment">/* inherit parent link_socket and tuntap */</span></div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;        <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.link_socket = src-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>;</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160; </div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;        <a class="code" href="buffer_8h.html#ac3efdeb76b37368ae2658529cdbdcbda">ALLOC_OBJ_GC</a>(<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.link_socket_info, <span class="keyword">struct</span> <a class="code" href="structlink__socket__info.html">link_socket_info</a>, &amp;<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;gc);</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;        *<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.link_socket_info = src-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">link_socket</a>-&gt;<a class="code" href="structlink__socket.html#a4758d694c759a1aab884bc1cc5ab969f">info</a>;</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160; </div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;        <span class="comment">/* locally override some link_socket_info fields */</span></div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;        <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.link_socket_info-&gt;lsa = &amp;<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.link_socket_addr;</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;        <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.link_socket_info-&gt;connection_established = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;    }</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;}</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160; </div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04619"></a><span class="lineno"><a class="line" href="init_8h.html#a3289f2c74fc362ba1131d71552d10bab"> 4619</a></span>&#160;<a class="code" href="init_8c.html#a3289f2c74fc362ba1131d71552d10bab">inherit_context_top</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>,</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;                    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *src)</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;{</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;    <span class="comment">/* copy parent */</span></div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;    *<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a> = *src;</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160; </div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;<span class="comment">     * CM_TOP_CLONE will prevent close_instance from freeing or closing</span></div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;<span class="comment">     * resources owned by the parent.</span></div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;<span class="comment">     *</span></div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;<span class="comment">     * Also note that CM_TOP_CLONE context objects are</span></div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;<span class="comment">     * closed by multi_top_free in multi.c.</span></div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;mode = <a class="code" href="openvpn_8h.html#ab165034158b5eca5e815b14a5d091bbc">CM_TOP_CLONE</a>;</div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160; </div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;first_time = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c0 = NULL;</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160; </div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;    <a class="code" href="options_8c.html#aaf33ed424941f850b99c2a26d6f64378">options_detach</a>(&amp;<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;options);</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;    <a class="code" href="buffer_8h.html#a08d3caef794ca3ee66f22cf29cc29a44">gc_detach</a>(&amp;<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;gc);</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;    <a class="code" href="buffer_8h.html#a08d3caef794ca3ee66f22cf29cc29a44">gc_detach</a>(&amp;<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.gc);</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160; </div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;    <span class="comment">/* detach plugins */</span></div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;plugins_owned = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160; </div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.tls_multi = NULL;</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160; </div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;    <span class="comment">/* detach c1 ownership */</span></div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.tuntap_owned = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.status_output_owned = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c1.ifconfig_pool_persist_owned = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160; </div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;    <span class="comment">/* detach c2 ownership */</span></div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.event_set_owned = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.link_socket_owned = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.buffers_owned = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.es_owned = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160; </div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.event_set = NULL;</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="socket_8c.html#adbff197bdb9734118cdf9889650477ae">proto_is_dgram</a>(src-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>.<a class="code" href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">ce</a>.<a class="code" href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">proto</a>))</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;    {</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;        <a class="code" href="init_8c.html#a5701fecef4d3afde02d2604f1b61f7f3">do_event_set_init</a>(<a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;    }</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160; </div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;<span class="preprocessor">#ifdef USE_COMP</span></div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;    <a class="code" href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a>-&gt;c2.comp_context = NULL;</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;}</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160; </div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04669"></a><span class="lineno"><a class="line" href="init_8h.html#a8f6bfd35ae93f4eda968d89f76637a98"> 4669</a></span>&#160;<a class="code" href="init_8c.html#a8f6bfd35ae93f4eda968d89f76637a98">close_context</a>(<span class="keyword">struct</span> <a class="code" href="structcontext.html">context</a> *c, <span class="keywordtype">int</span> sig, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> flags)</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;{</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(c);</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>);</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160; </div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;    <span class="keywordflow">if</span> (sig &gt;= 0)</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;    {</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;        c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> = sig;</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;    }</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160; </div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;    <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> == <a class="code" href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a>)</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;    {</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;        <span class="keywordflow">if</span> ((flags &amp; <a class="code" href="init_8h.html#a88731ead0689d66ac028b4027a66b7a7">CC_USR1_TO_HUP</a>)</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;            || (c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#aff345ec3f6a0b37155a2561e9ff7f0b5">source</a> == <a class="code" href="sig_8h.html#acca14239031e4e2583bb69dbed1cd18c">SIG_SOURCE_HARD</a> &amp;&amp; (flags &amp; <a class="code" href="init_8h.html#ab01bd34adf6754f57b6966e3820b5444">CC_HARD_USR1_TO_HUP</a>)))</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;        {</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_received</a> = <a class="code" href="config-msvc_8h.html#a136c64ec2d1306de745e39d6aee362ca">SIGHUP</a>;</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;            c-&gt;<a class="code" href="structcontext.html#a4a8aea25993019921e9568f611106773">sig</a>-&gt;<a class="code" href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_text</a> = <span class="stringliteral">&quot;close_context usr1 to hup&quot;</span>;</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;        }</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;    }</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160; </div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;    <span class="keywordflow">if</span> (!(flags &amp; <a class="code" href="init_8h.html#ac73c2e030d3db046d8e44288178ff2ae">CC_NO_CLOSE</a>))</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;    {</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;        <a class="code" href="init_8c.html#a2cddf7b7e6402aa02311c949ec0dd51c">close_instance</a>(c);</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;    }</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160; </div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;    <span class="keywordflow">if</span> (flags &amp; <a class="code" href="init_8h.html#a29e8da303469d142757b3dd754072365">CC_GC_FREE</a>)</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;    {</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;        <a class="code" href="init_8c.html#a6e6b19367c9c40f7c22c5d5addf2f962">context_gc_free</a>(c);</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;    }</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;}</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160; </div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;<span class="comment">/* Write our PID to a file */</span></div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04702"></a><span class="lineno"><a class="line" href="init_8h.html#a6b496053f95faf4d07576c4c56900f37"> 4702</a></span>&#160;<a class="code" href="init_8c.html#a6b496053f95faf4d07576c4c56900f37">write_pid_file</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structoptions.html#ac37a2848b8a1a91de9dfde7c1c9d8fa5">chroot_dir</a>)</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;{</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;    <span class="keywordflow">if</span> (filename)</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;    {</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pid = 0;</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;        FILE *fp = <a class="code" href="platform_8c.html#a7da5056ce6a8a2efd54ccee6b993e0a6">platform_fopen</a>(filename, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;        <span class="keywordflow">if</span> (!fp)</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;        {</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ab5286dbd1378331f3d1c3a0522b6a43f">M_ERR</a>, <span class="stringliteral">&quot;Open error on pid file %s&quot;</span>, filename);</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;        }</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160; </div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;        pid = <a class="code" href="platform_8c.html#a0ed26af4c60fafd6cb3de6759dfb0238">platform_getpid</a>();</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;        fprintf(fp, <span class="stringliteral">&quot;%u\n&quot;</span>, pid);</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;        <span class="keywordflow">if</span> (fclose(fp))</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;        {</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;            <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="openvpn_2error_8h.html#ab5286dbd1378331f3d1c3a0522b6a43f">M_ERR</a>, <span class="stringliteral">&quot;Close error on pid file %s&quot;</span>, filename);</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;        }</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160; </div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;        <span class="comment">/* remember file name so it can be deleted &quot;out of context&quot; later */</span></div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;        <span class="comment">/* (the chroot case is more complex and not handled today) */</span></div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="structoptions.html#ac37a2848b8a1a91de9dfde7c1c9d8fa5">chroot_dir</a>)</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;        {</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;            <a class="code" href="init_8c.html#a162b20591bd0d83be031b7fe1bf7dbef">saved_pid_file_name</a> = strdup(filename);</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;        }</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;    }</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;}</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160; </div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;<span class="comment">/* remove PID file on exit, called from openvpn_exit() */</span></div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l04732"></a><span class="lineno"><a class="line" href="init_8h.html#a8693b9ce4067a8a8eaff5e99c87b872e"> 4732</a></span>&#160;<a class="code" href="init_8c.html#a8693b9ce4067a8a8eaff5e99c87b872e">remove_pid_file</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;{</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="init_8c.html#a162b20591bd0d83be031b7fe1bf7dbef">saved_pid_file_name</a>)</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;    {</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;        <a class="code" href="platform_8c.html#a575a320fe086fd16b99a55ca2b4e511a">platform_unlink</a>(<a class="code" href="init_8c.html#a162b20591bd0d83be031b7fe1bf7dbef">saved_pid_file_name</a>);</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;    }</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;}</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160; </div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160; </div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;<span class="comment"> * Do a loopback test</span></div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;<span class="comment"> * on the crypto subsystem.</span></div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *</div>
<div class="line"><a name="l04746"></a><span class="lineno"><a class="line" href="init_8c.html#a957b67d2e2cd2894508fa50fea589447"> 4746</a></span>&#160;<a class="code" href="init_8c.html#a957b67d2e2cd2894508fa50fea589447">test_crypto_thread</a>(<span class="keywordtype">void</span> *arg)</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;{</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;    <span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *c = (<span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> *) arg;</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structoptions.html">options</a> *<a class="code" href="structoptions.html">options</a> = &amp;c-&gt;<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>;</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160; </div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;    <a class="code" href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a>(<a class="code" href="structoptions.html">options</a>-&gt;<a class="code" href="structoptions.html#a38d22a55bf92acf99f3c5d71d3b06b18">test_crypto</a>);</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;    <a class="code" href="init_8c.html#a164331d37fecc9ad095eae0e8dce53de">init_verb_mute</a>(c, <a class="code" href="init_8h.html#a5066d160ca7be6632e188a5044eeba09">IVM_LEVEL_1</a>);</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;    <a class="code" href="init_8c.html#a58388a630bb35708de3e8bd6ae4b9000">context_init_1</a>(c);</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;    <a class="code" href="init_8c.html#a0c6a92888206f636e794b6d3c9edb343">next_connection_entry</a>(c);</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;    <a class="code" href="init_8c.html#a24ee82204efb10e4948c83b1cb1a4853">do_init_crypto_static</a>(c, 0);</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160; </div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;    <a class="code" href="init_8c.html#ab818bc3b2b7753d2c5a010ad207b5084">frame_finalize_options</a>(c, <a class="code" href="structoptions.html">options</a>);</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160; </div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;    <a class="code" href="crypto_8c.html#adf3eba101a6542db8464e0378d5fd08c">test_crypto</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a901a1a0ceb94dbd3e9f758552fa4fbd9">crypto_options</a>, &amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">frame</a>);</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160; </div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;    <a class="code" href="init_8c.html#a263724992635e011b111147ec8647500">key_schedule_free</a>(&amp;c-&gt;<a class="code" href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">c1</a>.<a class="code" href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">ks</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;    <a class="code" href="packet__id_8c.html#a5162087628a8856757b82c93cf4a696b">packet_id_free</a>(&amp;c-&gt;<a class="code" href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">c2</a>.<a class="code" href="structcontext__2.html#a901a1a0ceb94dbd3e9f758552fa4fbd9">crypto_options</a>.<a class="code" href="structcrypto__options.html#ab4b7f20d49e1ac2efb9faf4a13d3701d">packet_id</a>);</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160; </div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;    <a class="code" href="init_8c.html#a6e6b19367c9c40f7c22c5d5addf2f962">context_gc_free</a>(c);</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;}</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160; </div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l04769"></a><span class="lineno"><a class="line" href="init_8h.html#a45aabc58aa609b9ea41677a3071164c0"> 4769</a></span>&#160;<a class="code" href="init_8c.html#a45aabc58aa609b9ea41677a3071164c0">do_test_crypto</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structoptions.html">options</a> *o)</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;{</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;    <span class="keywordflow">if</span> (o-&gt;<a class="code" href="structoptions.html#a38d22a55bf92acf99f3c5d71d3b06b18">test_crypto</a>)</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;    {</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;        <span class="keyword">struct </span><a class="code" href="structcontext.html">context</a> c;</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160; </div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;        <span class="comment">/* print version number */</span></div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;        <a class="code" href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a>(<a class="code" href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="options_8c.html#ad29b8ce8834ce432aa14dfe842dd7bbd">title_string</a>);</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160; </div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;        <a class="code" href="init_8c.html#a80646beaaf6a2d8fa45e74b125da02d6">context_clear</a>(&amp;c);</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;        c.<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a> = *o;</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;        <a class="code" href="options_8c.html#aaf33ed424941f850b99c2a26d6f64378">options_detach</a>(&amp;c.<a class="code" href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">options</a>);</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;        c.<a class="code" href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">first_time</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;        <a class="code" href="init_8c.html#a957b67d2e2cd2894508fa50fea589447">test_crypto_thread</a>((<span class="keywordtype">void</span> *) &amp;c);</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;    }</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="astructconnection__entry_html_a31750e717d5fad479ca6b5930d7cb1db"><div class="ttname"><a href="structconnection__entry.html#a31750e717d5fad479ca6b5930d7cb1db">connection_entry::tls_crypt_file</a></div><div class="ttdeci">const char * tls_crypt_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00147">options.h:147</a></div></div>
<div class="ttc" id="astatus_8c_html_ab196e92cac48e356eab474978232e453"><div class="ttname"><a href="status_8c.html#ab196e92cac48e356eab474978232e453">status_open</a></div><div class="ttdeci">struct status_output * status_open(const char *filename, const int refresh_freq, const int msglevel, const struct virtual_output *vout, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="status_8c_source.html#l00063">status.c:63</a></div></div>
<div class="ttc" id="astructoptions_html_a5b6381333b82e8689f820ae2ecf2ecb1"><div class="ttname"><a href="structoptions.html#a5b6381333b82e8689f820ae2ecf2ecb1">options::keepalive_timeout</a></div><div class="ttdeci">int keepalive_timeout</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00289">options.h:289</a></div></div>
<div class="ttc" id="amtu_8h_html_ac3136c647b87a701a1073677ae1d51ae"><div class="ttname"><a href="mtu_8h.html#ac3136c647b87a701a1073677ae1d51ae">frame_add_to_extra_buffer</a></div><div class="ttdeci">static void frame_add_to_extra_buffer(struct frame *frame, const int increment)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00298">mtu.h:298</a></div></div>
<div class="ttc" id="astructplugin__return_html_a95de2b2a666603a9dc4a12e0cab8001a"><div class="ttname"><a href="structplugin__return.html#a95de2b2a666603a9dc4a12e0cab8001a">plugin_return::list</a></div><div class="ttdeci">struct openvpn_plugin_string_list * list[MAX_PLUGINS]</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8h_source.html#l00104">plugin.h:104</a></div></div>
<div class="ttc" id="ainit_8c_html_a61d44367024a0dff3861e2afa6600694"><div class="ttname"><a href="init_8c.html#a61d44367024a0dff3861e2afa6600694">do_close_ifconfig_pool_persist</a></div><div class="ttdeci">static void do_close_ifconfig_pool_persist(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03796">init.c:3796</a></div></div>
<div class="ttc" id="ainit_8c_html_aded279bc953617852338a38e3d1a256b"><div class="ttname"><a href="init_8c.html#aded279bc953617852338a38e3d1a256b">pull_permission_mask</a></div><div class="ttdeci">unsigned int pull_permission_mask(const struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02232">init.c:2232</a></div></div>
<div class="ttc" id="astructcontext__2_html_ae8340ca648a8ecd965445186cf3a0ec1"><div class="ttname"><a href="structcontext__2.html#ae8340ca648a8ecd965445186cf3a0ec1">context_2::route_wakeup</a></div><div class="ttdeci">struct event_timeout route_wakeup</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00394">openvpn.h:394</a></div></div>
<div class="ttc" id="atun_8c_html_ae4aac9803755917377784cb752dcd6e0"><div class="ttname"><a href="tun_8c.html#ae4aac9803755917377784cb752dcd6e0">tun_standby_init</a></div><div class="ttdeci">void tun_standby_init(struct tuntap *tt)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l05695">tun.c:5695</a></div></div>
<div class="ttc" id="astructoptions_html_a27bd2c7c26f4e5bbb67c57743c785b18"><div class="ttname"><a href="structoptions.html#a27bd2c7c26f4e5bbb67c57743c785b18">options::replay_time</a></div><div class="ttdeci">int replay_time</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00534">options.h:534</a></div></div>
<div class="ttc" id="aoptions_8h_html_a9c6881e2e86f302489916b1fa05b627aa2abd9ec10d68997a7334d8e0a61e18f0"><div class="ttname"><a href="options_8h.html#a9c6881e2e86f302489916b1fa05b627aa2abd9ec10d68997a7334d8e0a61e18f0">GENKEY_AUTH_TOKEN</a></div><div class="ttdeci">@ GENKEY_AUTH_TOKEN</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00206">options.h:206</a></div></div>
<div class="ttc" id="aplatform_8c_html_a4bfdae25f711f8c20daf740b3fb4e045"><div class="ttname"><a href="platform_8c.html#a4bfdae25f711f8c20daf740b3fb4e045">platform_create_temp_file</a></div><div class="ttdeci">const char * platform_create_temp_file(const char *directory, const char *prefix, struct gc_arena *gc)</div><div class="ttdoc">Create a temporary file in directory, returns the filename of the created file.</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00342">platform.c:342</a></div></div>
<div class="ttc" id="ainit_8c_html_a45aabc58aa609b9ea41677a3071164c0"><div class="ttname"><a href="init_8c.html#a45aabc58aa609b9ea41677a3071164c0">do_test_crypto</a></div><div class="ttdeci">bool do_test_crypto(const struct options *o)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04769">init.c:4769</a></div></div>
<div class="ttc" id="astructcontext__2_html_a5504671bac689290cd35901bf7d031aa"><div class="ttname"><a href="structcontext__2.html#a5504671bac689290cd35901bf7d031aa">context_2::tls_auth_standalone</a></div><div class="ttdeci">struct tls_auth_standalone * tls_auth_standalone</div><div class="ttdoc">TLS state structure required for the initial authentication of a client's connection attempt.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00343">openvpn.h:343</a></div></div>
<div class="ttc" id="astructoptions_html_afa8198209f419fdc2b37c3d11a7d7852"><div class="ttname"><a href="structoptions.html#afa8198209f419fdc2b37c3d11a7d7852">options::genkey_type</a></div><div class="ttdeci">enum genkey_type genkey_type</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00239">options.h:239</a></div></div>
<div class="ttc" id="aplugin_8c_html_ab157c30d4e9bddf8a22f444ceb2bd260"><div class="ttname"><a href="plugin_8c.html#ab157c30d4e9bddf8a22f444ceb2bd260">plugin_list_init</a></div><div class="ttdeci">struct plugin_list * plugin_list_init(const struct plugin_option_list *list)</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8c_source.html#l00778">plugin.c:778</a></div></div>
<div class="ttc" id="amtu_8h_html_a8941b4c07aa4e1ba754104e1256316ff"><div class="ttname"><a href="mtu_8h.html#a8941b4c07aa4e1ba754104e1256316ff">frame_add_to_extra_frame</a></div><div class="ttdeci">static void frame_add_to_extra_frame(struct frame *frame, const unsigned int increment)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00274">mtu.h:274</a></div></div>
<div class="ttc" id="amanage_8c_html_a8ad93473fd4ba6402ecea847d69afae1"><div class="ttname"><a href="manage_8c.html#a8ad93473fd4ba6402ecea847d69afae1">management_set_state</a></div><div class="ttdeci">void management_set_state(struct management *man, const int state, const char *detail, const in_addr_t *tun_local_ip, const struct in6_addr *tun_local_ip6, const struct openvpn_sockaddr *local, const struct openvpn_sockaddr *remote)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l02751">manage.c:2751</a></div></div>
<div class="ttc" id="astructoptions_html_a6627153e6bb2d0952fce58f65ee07329"><div class="ttname"><a href="structoptions.html#a6627153e6bb2d0952fce58f65ee07329">options::show_engines</a></div><div class="ttdeci">bool show_engines</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00235">options.h:235</a></div></div>
<div class="ttc" id="ainit_8c_html_aa1b2b0731bba3b1b5621bc0b070f4cf0"><div class="ttname"><a href="init_8c.html#aa1b2b0731bba3b1b5621bc0b070f4cf0">do_close_plugins</a></div><div class="ttdeci">static void do_close_plugins(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03932">init.c:3932</a></div></div>
<div class="ttc" id="acrypto_8c_html_ae8c523b770f0e2f30d44004797106508"><div class="ttname"><a href="crypto_8c.html#ae8c523b770f0e2f30d44004797106508">prng_uninit</a></div><div class="ttdeci">void prng_uninit(void)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01730">crypto.c:1730</a></div></div>
<div class="ttc" id="acrypto_8c_html_a81c00d1ee124bc52b54b6b3082fba96e"><div class="ttname"><a href="crypto_8c.html#a81c00d1ee124bc52b54b6b3082fba96e">write_key_file</a></div><div class="ttdeci">int write_key_file(const int nkeys, const char *filename)</div><div class="ttdoc">Write nkeys 1024-bits keys to file.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01425">crypto.c:1425</a></div></div>
<div class="ttc" id="amanage_8c_html_a35fb8d8af2aafb178f16acb5f3751ba2"><div class="ttname"><a href="manage_8c.html#a35fb8d8af2aafb178f16acb5f3751ba2">management_open</a></div><div class="ttdeci">bool management_open(struct management *man, const char *addr, const char *port, const char *pass_file, const char *client_user, const char *client_group, const int log_history_cache, const int echo_buffer_size, const int state_buffer_size, const char *write_peer_info_file, const int remap_sigusr1, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l02667">manage.c:2667</a></div></div>
<div class="ttc" id="astructsignal__info_html_a10c4ea0e5a7070d7d802d2e9c7eecb67"><div class="ttname"><a href="structsignal__info.html#a10c4ea0e5a7070d7d802d2e9c7eecb67">signal_info::signal_received</a></div><div class="ttdeci">volatile int signal_received</div><div class="ttdef"><b>Definition:</b> <a href="sig_8h_source.html#l00045">sig.h:45</a></div></div>
<div class="ttc" id="astructoptions_html_a3564873509d5272dd6fca9fa283d1560"><div class="ttname"><a href="structoptions.html#a3564873509d5272dd6fca9fa283d1560">options::ssl_flags</a></div><div class="ttdeci">unsigned int ssl_flags</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00574">options.h:574</a></div></div>
<div class="ttc" id="astructoptions_html_ae86dddeb121da4d534e9705c2fa063fc"><div class="ttname"><a href="structoptions.html#ae86dddeb121da4d534e9705c2fa063fc">options::verbosity</a></div><div class="ttdeci">int verbosity</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00344">options.h:344</a></div></div>
<div class="ttc" id="atun_8c_html_ad8365278b4f196950c8a29745b361e0a"><div class="ttname"><a href="tun_8c.html#ad8365278b4f196950c8a29745b361e0a">do_ifconfig_setenv</a></div><div class="ttdeci">void do_ifconfig_setenv(const struct tuntap *tt, struct env_set *es)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l00692">tun.c:692</a></div></div>
<div class="ttc" id="astructoptions_html_a7c5a04e0f575936f6d77977ca5c5748b"><div class="ttname"><a href="structoptions.html#a7c5a04e0f575936f6d77977ca5c5748b">options::ncp_enabled</a></div><div class="ttdeci">bool ncp_enabled</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00523">options.h:523</a></div></div>
<div class="ttc" id="awin32_8h_html_a4646ba90c8db4e373568cd773cd6f575"><div class="ttname"><a href="win32_8h.html#a4646ba90c8db4e373568cd773cd6f575">WSO_MODE_CONSOLE</a></div><div class="ttdeci">#define WSO_MODE_CONSOLE</div><div class="ttdef"><b>Definition:</b> <a href="win32_8h_source.html#l00152">win32.h:152</a></div></div>
<div class="ttc" id="astructconnection__entry_html_aba4ccef71abd388a80a607ab3da381e4"><div class="ttname"><a href="structconnection__entry.html#aba4ccef71abd388a80a607ab3da381e4">connection_entry::mtu_discover_type</a></div><div class="ttdeci">int mtu_discover_type</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00122">options.h:122</a></div></div>
<div class="ttc" id="ainit_8c_html_aa178c8a6f722ca1be6e847e1310f3897"><div class="ttname"><a href="init_8c.html#aa178c8a6f722ca1be6e847e1310f3897">do_init_server_poll_timeout</a></div><div class="ttdeci">static void do_init_server_poll_timeout(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01393">init.c:1393</a></div></div>
<div class="ttc" id="ainit_8c_html_a0c6a92888206f636e794b6d3c9edb343"><div class="ttname"><a href="init_8c.html#a0c6a92888206f636e794b6d3c9edb343">next_connection_entry</a></div><div class="ttdeci">static void next_connection_entry(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00471">init.c:471</a></div></div>
<div class="ttc" id="aoptions_8h_html_a6f5a418c90b160f847fa7683d0a54a59"><div class="ttname"><a href="options_8h.html#a6f5a418c90b160f847fa7683d0a54a59">CE_MAN_QUERY_REMOTE_MOD</a></div><div class="ttdeci">#define CE_MAN_QUERY_REMOTE_MOD</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00135">options.h:135</a></div></div>
<div class="ttc" id="agroup__control__processor_html_gada87c9f2a7755ab7507dd16fa6e22716"><div class="ttname"><a href="group__control__processor.html#gada87c9f2a7755ab7507dd16fa6e22716">tls_multi_init_finalize</a></div><div class="ttdeci">void tls_multi_init_finalize(struct tls_multi *multi, const struct frame *frame)</div><div class="ttdoc">Finalize initialization of a tls_multi structure.</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l01281">ssl.c:1281</a></div></div>
<div class="ttc" id="aopenvpn-plugin_8h_html_acc526a64338f399a783b2f1b4f599365"><div class="ttname"><a href="openvpn-plugin_8h.html#acc526a64338f399a783b2f1b4f599365">OPENVPN_PLUGIN_UP</a></div><div class="ttdeci">#define OPENVPN_PLUGIN_UP</div><div class="ttdef"><b>Definition:</b> <a href="openvpn-plugin_8h_source.html#l00120">openvpn-plugin.h:120</a></div></div>
<div class="ttc" id="agroup__tls__crypt_html_ga793fa02bdff7c0df6d31b493c8df32aa"><div class="ttname"><a href="group__tls__crypt.html#ga793fa02bdff7c0df6d31b493c8df32aa">tls_crypt_v2_init_server_key</a></div><div class="ttdeci">void tls_crypt_v2_init_server_key(struct key_ctx *key_ctx, bool encrypt, const char *key_file, bool key_inline)</div><div class="ttdoc">Initialize a tls-crypt-v2 server key (used to encrypt/decrypt client keys).</div><div class="ttdef"><b>Definition:</b> <a href="tls__crypt_8c_source.html#l00325">tls_crypt.c:325</a></div></div>
<div class="ttc" id="aroute_8c_html_a482ac780b2d08fc96aa2547a9902b1a8"><div class="ttname"><a href="route_8c.html#a482ac780b2d08fc96aa2547a9902b1a8">get_default_gateway_ipv6</a></div><div class="ttdeci">void get_default_gateway_ipv6(struct route_ipv6_gateway_info *rgi6, const struct in6_addr *dest, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="route_8c_source.html#l02828">route.c:2828</a></div></div>
<div class="ttc" id="astructtls__options_html_aba6a6fa6da4b70ca9842358f9fa74d06"><div class="ttname"><a href="structtls__options.html#aba6a6fa6da4b70ca9842358f9fa74d06">tls_options::config_ncp_ciphers</a></div><div class="ttdeci">const char * config_ncp_ciphers</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00303">ssl_common.h:303</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_ade61794318f1bbcac19df28e2fe83260"><div class="ttname"><a href="errlevel_8h.html#ade61794318f1bbcac19df28e2fe83260">M_INFO</a></div><div class="ttdeci">#define M_INFO</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00055">errlevel.h:55</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a27a04bbbad750c17bbdee216e6a0aacd"><div class="ttname"><a href="structconnection__entry.html#a27a04bbbad750c17bbdee216e6a0aacd">connection_entry::mssfix</a></div><div class="ttdeci">int mssfix</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00125">options.h:125</a></div></div>
<div class="ttc" id="amanage_8c_html_af967391d82b8095326136311cb24d635"><div class="ttname"><a href="manage_8c.html#af967391d82b8095326136311cb24d635">management_post_tunnel_open</a></div><div class="ttdeci">void management_post_tunnel_open(struct management *man, const in_addr_t tun_local_ip)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l03064">manage.c:3064</a></div></div>
<div class="ttc" id="astructoptions_html_a4aa894e058d4e005aa5c533183f86439"><div class="ttname"><a href="structoptions.html#a4aa894e058d4e005aa5c533183f86439">options::show_digests</a></div><div class="ttdeci">bool show_digests</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00234">options.h:234</a></div></div>
<div class="ttc" id="ainit_8c_html_af81e65de77cb7e8ce6e19844ffb749b9"><div class="ttname"><a href="init_8c.html#af81e65de77cb7e8ce6e19844ffb749b9">do_close_tls</a></div><div class="ttdeci">static void do_close_tls(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03593">init.c:3593</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a08f0f18740ef4f00f130df8ce3a6c672"><div class="ttname"><a href="structconnection__entry.html#a08f0f18740ef4f00f130df8ce3a6c672">connection_entry::link_mtu</a></div><div class="ttdeci">int link_mtu</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00118">options.h:118</a></div></div>
<div class="ttc" id="astructroute__ipv6__option__list_html_a04b38996423c8facdac8c843fae37a17"><div class="ttname"><a href="structroute__ipv6__option__list.html#a04b38996423c8facdac8c843fae37a17">route_ipv6_option_list::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00107">route.h:107</a></div></div>
<div class="ttc" id="agroup__fragmentation_html_ga78eb641be3402b8db31607baba604e62"><div class="ttname"><a href="group__fragmentation.html#ga78eb641be3402b8db31607baba604e62">fragment_frame_init</a></div><div class="ttdeci">void fragment_frame_init(struct fragment_master *f, const struct frame *frame)</div><div class="ttdoc">Allocate internal packet buffers for a fragment_master structure.</div><div class="ttdef"><b>Definition:</b> <a href="fragment_8c_source.html#l00127">fragment.c:127</a></div></div>
<div class="ttc" id="astructoptions_html_a95e6a32fa6d2463934f22f82bdcdd5e9"><div class="ttname"><a href="structoptions.html#a95e6a32fa6d2463934f22f82bdcdd5e9">options::management_write_peer_info_file</a></div><div class="ttdeci">const char * management_write_peer_info_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00401">options.h:401</a></div></div>
<div class="ttc" id="aoptions_8c_html_ae678cc28cf97c0517fe75b612f57e28a"><div class="ttname"><a href="options_8c.html#ae678cc28cf97c0517fe75b612f57e28a">notnull</a></div><div class="ttdeci">void notnull(const char *arg, const char *description)</div><div class="ttdef"><b>Definition:</b> <a href="options_8c_source.html#l04444">options.c:4444</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a02fdddb17b95f31a428bf1f989df57f5"><div class="ttname"><a href="openvpn_2error_8h.html#a02fdddb17b95f31a428bf1f989df57f5">M_OPTERR</a></div><div class="ttdeci">#define M_OPTERR</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00102">error.h:102</a></div></div>
<div class="ttc" id="astructtls__options_html_aa2b4275c8e14021d83b15a7e17e939d3"><div class="ttname"><a href="structtls__options.html#aa2b4275c8e14021d83b15a7e17e939d3">tls_options::verify_x509_name</a></div><div class="ttdeci">const char * verify_x509_name</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00281">ssl_common.h:281</a></div></div>
<div class="ttc" id="astructoptions_html_a7934e68d00c2cf1aa45ca566ed163d71"><div class="ttname"><a href="structoptions.html#a7934e68d00c2cf1aa45ca566ed163d71">options::sc_info</a></div><div class="ttdeci">struct static_challenge_info sc_info</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00512">options.h:512</a></div></div>
<div class="ttc" id="aopenvpn-plugin_8h_html_a292f4563db5f9561b7825d31af53a990"><div class="ttname"><a href="openvpn-plugin_8h.html#a292f4563db5f9561b7825d31af53a990">OPENVPN_PLUGIN_DOWN</a></div><div class="ttdeci">#define OPENVPN_PLUGIN_DOWN</div><div class="ttdef"><b>Definition:</b> <a href="openvpn-plugin_8h_source.html#l00121">openvpn-plugin.h:121</a></div></div>
<div class="ttc" id="astructcontext__2_html_a4cb8c7cbd964e80ede783143a456d44d"><div class="ttname"><a href="structcontext__2.html#a4cb8c7cbd964e80ede783143a456d44d">context_2::accept_from</a></div><div class="ttdeci">const struct link_socket * accept_from</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00261">openvpn.h:261</a></div></div>
<div class="ttc" id="astructoptions_html_a99e510c2a30b72320d57b21af78636db"><div class="ttname"><a href="structoptions.html#a99e510c2a30b72320d57b21af78636db">options::enable_ncp_fallback</a></div><div class="ttdeci">bool enable_ncp_fallback</div><div class="ttdoc">If defined fall back to ciphername if NCP fails.</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00521">options.h:521</a></div></div>
<div class="ttc" id="aroute_8c_html_a479e469a922c8a2ca4ddc596840ea9ba"><div class="ttname"><a href="route_8c.html#a479e469a922c8a2ca4ddc596840ea9ba">add_route_ipv6_to_option_list</a></div><div class="ttdeci">void add_route_ipv6_to_option_list(struct route_ipv6_option_list *l, const char *prefix, const char *gateway, const char *metric)</div><div class="ttdef"><b>Definition:</b> <a href="route_8c_source.html#l00511">route.c:511</a></div></div>
<div class="ttc" id="aopenvpn_8h_html_a52609d7e7380af270a8921703521fd41"><div class="ttname"><a href="openvpn_8h.html#a52609d7e7380af270a8921703521fd41">CIPHER_ENABLED</a></div><div class="ttdeci">#define CIPHER_ENABLED(c)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00560">openvpn.h:560</a></div></div>
<div class="ttc" id="abuffer_8h_html_ae55eafba09aa53323a5ce9e85f00f710"><div class="ttname"><a href="buffer_8h.html#ae55eafba09aa53323a5ce9e85f00f710">gc_new</a></div><div class="ttdeci">static struct gc_arena gc_new(void)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l01024">buffer.h:1024</a></div></div>
<div class="ttc" id="aoptions_8h_html_a9c6881e2e86f302489916b1fa05b627aa328347907cf8af2f9404a719acf99fd7"><div class="ttname"><a href="options_8h.html#a9c6881e2e86f302489916b1fa05b627aa328347907cf8af2f9404a719acf99fd7">GENKEY_SECRET</a></div><div class="ttdeci">@ GENKEY_SECRET</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00203">options.h:203</a></div></div>
<div class="ttc" id="agroup__fragmentation_html_ga0be982cb04c4e5c3344d8f91323f4d8c"><div class="ttname"><a href="group__fragmentation.html#ga0be982cb04c4e5c3344d8f91323f4d8c">fragment_init</a></div><div class="ttdeci">struct fragment_master * fragment_init(struct frame *frame)</div><div class="ttdoc">Allocate and initialize a fragment_master structure.</div><div class="ttdef"><b>Definition:</b> <a href="fragment_8c_source.html#l00091">fragment.c:91</a></div></div>
<div class="ttc" id="astructoptions_html_adf54ee33312d3e824a9f95a8c74dc03a"><div class="ttname"><a href="structoptions.html#adf54ee33312d3e824a9f95a8c74dc03a">options::nice</a></div><div class="ttdeci">int nice</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00343">options.h:343</a></div></div>
<div class="ttc" id="atun_8c_html_a93c06e46676d0c56871eb1a71fc0c58e"><div class="ttname"><a href="tun_8c.html#a93c06e46676d0c56871eb1a71fc0c58e">do_ifconfig</a></div><div class="ttdeci">void do_ifconfig(struct tuntap *tt, const char *ifname, int tun_mtu, const struct env_set *es, openvpn_net_ctx_t *ctx)</div><div class="ttdoc">do_ifconfig - configure the tunnel interface</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l01576">tun.c:1576</a></div></div>
<div class="ttc" id="arun__command_8h_html"><div class="ttname"><a href="run__command_8h.html">run_command.h</a></div></div>
<div class="ttc" id="amtu_8h_html_ac25e2c2e9e0850eef726910ba8c09a26"><div class="ttname"><a href="mtu_8h.html#ac25e2c2e9e0850eef726910ba8c09a26">frame_add_to_link_mtu</a></div><div class="ttdeci">static void frame_add_to_link_mtu(struct frame *frame, const int increment)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00268">mtu.h:268</a></div></div>
<div class="ttc" id="aproto_8h_html_a7bd06f1b39bc1fa6f63378e4cf00bac0"><div class="ttname"><a href="proto_8h.html#a7bd06f1b39bc1fa6f63378e4cf00bac0">DEV_TYPE_TUN</a></div><div class="ttdeci">#define DEV_TYPE_TUN</div><div class="ttdef"><b>Definition:</b> <a href="proto_8h_source.html#l00037">proto.h:37</a></div></div>
<div class="ttc" id="aauth__token_8h_html"><div class="ttname"><a href="auth__token_8h.html">auth_token.h</a></div></div>
<div class="ttc" id="astructtls__options_html_a5cd706b37fc6ef4c738058cbe63bad78"><div class="ttname"><a href="structtls__options.html#a5cd706b37fc6ef4c738058cbe63bad78">tls_options::frame</a></div><div class="ttdeci">struct frame frame</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00312">ssl_common.h:312</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a016bad39481a03a9b824e64cf8a41a23"><div class="ttname"><a href="structconnection__entry.html#a016bad39481a03a9b824e64cf8a41a23">connection_entry::connect_retry_seconds</a></div><div class="ttdeci">int connect_retry_seconds</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00106">options.h:106</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a9adab10d5a021e6f453ebc4edc29ecde"><div class="ttname"><a href="structconnection__entry.html#a9adab10d5a021e6f453ebc4edc29ecde">connection_entry::explicit_exit_notification</a></div><div class="ttdeci">int explicit_exit_notification</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00128">options.h:128</a></div></div>
<div class="ttc" id="astructcontext__2_html_a758cf7724377be181e7fab59b7a2a30e"><div class="ttname"><a href="structcontext__2.html#a758cf7724377be181e7fab59b7a2a30e">context_2::tls_multi</a></div><div class="ttdeci">struct tls_multi * tls_multi</div><div class="ttdoc">TLS state structure for this VPN tunnel.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00340">openvpn.h:340</a></div></div>
<div class="ttc" id="astructcontext__2_html_a46b6fb8bbbdf12a965191460c1af9d3f"><div class="ttname"><a href="structcontext__2.html#a46b6fb8bbbdf12a965191460c1af9d3f">context_2::frame_fragment_omit</a></div><div class="ttdeci">struct frame frame_fragment_omit</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00275">openvpn.h:275</a></div></div>
<div class="ttc" id="aforward_8h_html"><div class="ttname"><a href="forward_8h.html">forward.h</a></div></div>
<div class="ttc" id="ainit_8c_html_a0513901da31c7584b524b7993fc03d6b"><div class="ttname"><a href="init_8c.html#a0513901da31c7584b524b7993fc03d6b">open_management</a></div><div class="ttdeci">bool open_management(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04050">init.c:4050</a></div></div>
<div class="ttc" id="astructplugin__return_html"><div class="ttname"><a href="structplugin__return.html">plugin_return</a></div><div class="ttdef"><b>Definition:</b> <a href="plugin_8h_source.html#l00101">plugin.h:101</a></div></div>
<div class="ttc" id="atun_8h_html_af3f646a2f21e22f10b04edbebad104da"><div class="ttname"><a href="tun_8h.html#af3f646a2f21e22f10b04edbebad104da">ROUTE_BEFORE_TUN</a></div><div class="ttdeci">#define ROUTE_BEFORE_TUN</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00359">tun.h:359</a></div></div>
<div class="ttc" id="astructcontext__2_html_a1187d7900d4fcec429d30b7e5370d551"><div class="ttname"><a href="structcontext__2.html#a1187d7900d4fcec429d30b7e5370d551">context_2::frame_initial</a></div><div class="ttdeci">struct frame frame_initial</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00268">openvpn.h:268</a></div></div>
<div class="ttc" id="agroup__fragmentation_html_gae6f7daf38cb2c0edaa6dbdfeabddb826"><div class="ttname"><a href="group__fragmentation.html#gae6f7daf38cb2c0edaa6dbdfeabddb826">fragment_free</a></div><div class="ttdeci">void fragment_free(struct fragment_master *f)</div><div class="ttdoc">Free a fragment_master structure and its internal packet buffers.</div><div class="ttdef"><b>Definition:</b> <a href="fragment_8c_source.html#l00118">fragment.c:118</a></div></div>
<div class="ttc" id="astructtls__wrap__ctx_html_a26648735a6e3a08455ad8191dad8f119"><div class="ttname"><a href="structtls__wrap__ctx.html#a26648735a6e3a08455ad8191dad8f119">tls_wrap_ctx::mode</a></div><div class="ttdeci">enum tls_wrap_ctx::@11 mode</div><div class="ttdoc">Control channel wrapping mode.</div></div>
<div class="ttc" id="acrypto_8h_html_af3e5e7a3b96977793b215f952186d820"><div class="ttname"><a href="crypto_8h.html#af3e5e7a3b96977793b215f952186d820">key_ctx_bi_defined</a></div><div class="ttdeci">static bool key_ctx_bi_defined(const struct key_ctx_bi *key)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00537">crypto.h:537</a></div></div>
<div class="ttc" id="astructsignal__info_html_a0062d540b64b1957a2fdd7155ef9edf9"><div class="ttname"><a href="structsignal__info.html#a0062d540b64b1957a2fdd7155ef9edf9">signal_info::signal_text</a></div><div class="ttdeci">const char * signal_text</div><div class="ttdef"><b>Definition:</b> <a href="sig_8h_source.html#l00047">sig.h:47</a></div></div>
<div class="ttc" id="astructroute__list_html"><div class="ttname"><a href="structroute__list.html">route_list</a></div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00206">route.h:206</a></div></div>
<div class="ttc" id="agremlin_8h_html"><div class="ttname"><a href="gremlin_8h.html">gremlin.h</a></div></div>
<div class="ttc" id="astructcontext__1_html_a8eb1f3e8ba4ab0d8167a7d232dcff498"><div class="ttname"><a href="structcontext__1.html#a8eb1f3e8ba4ab0d8167a7d232dcff498">context_1::status_output_owned</a></div><div class="ttdeci">bool status_output_owned</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00182">openvpn.h:182</a></div></div>
<div class="ttc" id="astructoptions_html_a4ad9197223f3b828c0caa17c59e311fd"><div class="ttname"><a href="structoptions.html#a4ad9197223f3b828c0caa17c59e311fd">options::up_script</a></div><div class="ttdeci">const char * up_script</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00327">options.h:327</a></div></div>
<div class="ttc" id="astructcontext_html_af52fc5d2e241fbee78d2216e9ff7ed72"><div class="ttname"><a href="structcontext.html#af52fc5d2e241fbee78d2216e9ff7ed72">context::persist</a></div><div class="ttdeci">struct context_persist persist</div><div class="ttdoc">Persistent context.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00526">openvpn.h:526</a></div></div>
<div class="ttc" id="astructbuffer_html_ada52eab703a091ff327114b3b3b0140a"><div class="ttname"><a href="structbuffer.html#ada52eab703a091ff327114b3b3b0140a">buffer::len</a></div><div class="ttdeci">int len</div><div class="ttdoc">Length in bytes of the actual content within the allocated memory.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00066">buffer.h:66</a></div></div>
<div class="ttc" id="asig_8c_html_a90955f1d36eb2dbcc7aacb204d5ea523"><div class="ttname"><a href="sig_8c.html#a90955f1d36eb2dbcc7aacb204d5ea523">restore_signal_state</a></div><div class="ttdeci">void restore_signal_state(void)</div><div class="ttdef"><b>Definition:</b> <a href="sig_8c_source.html#l00272">sig.c:272</a></div></div>
<div class="ttc" id="amtu_8c_html_a224812036cf5be8e57a95dad7d45067e"><div class="ttname"><a href="mtu_8c.html#a224812036cf5be8e57a95dad7d45067e">frame_print</a></div><div class="ttdeci">void frame_print(const struct frame *frame, int level, const char *prefix)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8c_source.html#l00139">mtu.c:139</a></div></div>
<div class="ttc" id="aoptions_8h_html_a91de4a526cf4238b865379311bdc515a"><div class="ttname"><a href="options_8h.html#a91de4a526cf4238b865379311bdc515a">OPT_P_DEFAULT</a></div><div class="ttdeci">#define OPT_P_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00705">options.h:705</a></div></div>
<div class="ttc" id="astructoptions_html_adad7b538e1a7f315447db983d33bc458"><div class="ttname"><a href="structoptions.html#adad7b538e1a7f315447db983d33bc458">options::keepalive_ping</a></div><div class="ttdeci">int keepalive_ping</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00288">options.h:288</a></div></div>
<div class="ttc" id="atun_8c_html_a8ed81f24edc25b83eba293057754830b"><div class="ttname"><a href="tun_8c.html#a8ed81f24edc25b83eba293057754830b">open_tun</a></div><div class="ttdeci">void open_tun(const char *dev, const char *dev_type, const char *dev_node, struct tuntap *tt)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l06680">tun.c:6680</a></div></div>
<div class="ttc" id="astructconnection__entry_html_aacc02906ca3f2d2be9f28171bcd60452"><div class="ttname"><a href="structconnection__entry.html#aacc02906ca3f2d2be9f28171bcd60452">connection_entry::socks_proxy_server</a></div><div class="ttdeci">const char * socks_proxy_server</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00110">options.h:110</a></div></div>
<div class="ttc" id="alladdr_8c_html_acb6e2182e310c1ace3822972beb591bd"><div class="ttname"><a href="lladdr_8c.html#acb6e2182e310c1ace3822972beb591bd">set_lladdr</a></div><div class="ttdeci">int set_lladdr(openvpn_net_ctx_t *ctx, const char *ifname, const char *lladdr, const struct env_set *es)</div><div class="ttdef"><b>Definition:</b> <a href="lladdr_8c_source.html#l00019">lladdr.c:19</a></div></div>
<div class="ttc" id="ainit_8c_html_ad0b5dc166d3a7e0d118bdf1771323674"><div class="ttname"><a href="init_8c.html#ad0b5dc166d3a7e0d118bdf1771323674">init_connection_list</a></div><div class="ttdeci">static void init_connection_list(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00431">init.c:431</a></div></div>
<div class="ttc" id="apacket__id_8c_html_a2ed0adcc640944fdb68ef1e394fc4f32"><div class="ttname"><a href="packet__id_8c.html#a2ed0adcc640944fdb68ef1e394fc4f32">packet_id_init</a></div><div class="ttdeci">void packet_id_init(struct packet_id *p, int seq_backtrack, int time_backtrack, const char *name, int unit)</div><div class="ttdef"><b>Definition:</b> <a href="packet__id_8c_source.html#l00078">packet_id.c:78</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_afb139197853f179439ffc6d0ccaf0fdd"><div class="ttname"><a href="errlevel_8h.html#afb139197853f179439ffc6d0ccaf0fdd">D_LINK_ERRORS</a></div><div class="ttdeci">#define D_LINK_ERRORS</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00057">errlevel.h:57</a></div></div>
<div class="ttc" id="amanage_8c_html_a38cbc67664b02f83c28e70a68d492888"><div class="ttname"><a href="manage_8c.html#a38cbc67664b02f83c28e70a68d492888">management_hold</a></div><div class="ttdeci">bool management_hold(struct management *man, int holdtime)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l03829">manage.c:3829</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a65ed7f4ae1be12a19362e90b962d72ac"><div class="ttname"><a href="openvpn_2error_8h.html#a65ed7f4ae1be12a19362e90b962d72ac">M_FATAL</a></div><div class="ttdeci">#define M_FATAL</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00091">error.h:91</a></div></div>
<div class="ttc" id="assl__ncp_8c_html_a9e8061a56d8a114317b5f829b6cbf19b"><div class="ttname"><a href="ssl__ncp_8c.html#a9e8061a56d8a114317b5f829b6cbf19b">tls_item_in_cipher_list</a></div><div class="ttdeci">bool tls_item_in_cipher_list(const char *item, const char *list)</div><div class="ttdoc">Return true iff item is present in the colon-separated zero-terminated cipher list.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__ncp_8c_source.html#l00187">ssl_ncp.c:187</a></div></div>
<div class="ttc" id="ainit_8c_html_a7876e414d4cb824cab1e8ad6b2c7c35c"><div class="ttname"><a href="init_8c.html#a7876e414d4cb824cab1e8ad6b2c7c35c">init_query_passwords</a></div><div class="ttdeci">void init_query_passwords(const struct context *c)</div><div class="ttdoc">Query for private key and auth-user-pass username/passwords.</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00587">init.c:587</a></div></div>
<div class="ttc" id="awin32_8h_html"><div class="ttname"><a href="win32_8h.html">win32.h</a></div></div>
<div class="ttc" id="aenv__set_8c_html_a2d1a7f0ea69776000aa9df3eca186f97"><div class="ttname"><a href="env__set_8c.html#a2d1a7f0ea69776000aa9df3eca186f97">env_set_destroy</a></div><div class="ttdeci">void env_set_destroy(struct env_set *es)</div><div class="ttdef"><b>Definition:</b> <a href="env__set_8c_source.html#l00168">env_set.c:168</a></div></div>
<div class="ttc" id="astructoptions_html_a1af2953c72fe865980a534643c666c7c"><div class="ttname"><a href="structoptions.html#a1af2953c72fe865980a534643c666c7c">options::auth_token_secret_file</a></div><div class="ttdeci">const char * auth_token_secret_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00493">options.h:493</a></div></div>
<div class="ttc" id="aevent_8h_html_a58154c71aeed1039628d6a15573b6ff9"><div class="ttname"><a href="event_8h.html#a58154c71aeed1039628d6a15573b6ff9">EVENT_METHOD_US_TIMEOUT</a></div><div class="ttdeci">#define EVENT_METHOD_US_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="event_8h_source.html#l00041">event.h:41</a></div></div>
<div class="ttc" id="astructtuntap_html_a859337e1a4e77338299c25b8563410ed"><div class="ttname"><a href="structtuntap.html#a859337e1a4e77338299c25b8563410ed">tuntap::windows_driver</a></div><div class="ttdeci">enum windows_driver_type windows_driver</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00195">tun.h:195</a></div></div>
<div class="ttc" id="aoptions_8c_html_a1641d56ec254cefdfe8f43125d68c145"><div class="ttname"><a href="options_8c.html#a1641d56ec254cefdfe8f43125d68c145">options_string</a></div><div class="ttdeci">char * options_string(const struct options *o, const struct frame *frame, struct tuntap *tt, openvpn_net_ctx_t *ctx, bool remote, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="options_8c_source.html#l03762">options.c:3762</a></div></div>
<div class="ttc" id="astructoptions_html_a7a68302ffa97bdc216d2fcc15cca0bb2"><div class="ttname"><a href="structoptions.html#a7a68302ffa97bdc216d2fcc15cca0bb2">options::ipchange</a></div><div class="ttdeci">const char * ipchange</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00261">options.h:261</a></div></div>
<div class="ttc" id="astructcontext__1_html_afa52b84db5bb4e12deeabf2e788f7349"><div class="ttname"><a href="structcontext__1.html#afa52b84db5bb4e12deeabf2e788f7349">context_1::tuntap</a></div><div class="ttdeci">struct tuntap * tuntap</div><div class="ttdoc">Tun/tap virtual network interface.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00168">openvpn.h:168</a></div></div>
<div class="ttc" id="astructroute__gateway__info_html"><div class="ttname"><a href="structroute__gateway__info.html">route_gateway_info</a></div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00146">route.h:146</a></div></div>
<div class="ttc" id="astructoptions_html_a98fc9a0879158d9aaf12696ff8726b35"><div class="ttname"><a href="structoptions.html#a98fc9a0879158d9aaf12696ff8726b35">options::show_ciphers</a></div><div class="ttdeci">bool show_ciphers</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00233">options.h:233</a></div></div>
<div class="ttc" id="aoptions_8h_html_a91dc7e314ac4ab9357585c15de7b48c8"><div class="ttname"><a href="options_8h.html#a91dc7e314ac4ab9357585c15de7b48c8">RH_PORT_LEN</a></div><div class="ttdeci">#define RH_PORT_LEN</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00198">options.h:198</a></div></div>
<div class="ttc" id="aoptions_8h_html_abd79a1754926b76ff0a0e566d126c606"><div class="ttname"><a href="options_8h.html#abd79a1754926b76ff0a0e566d126c606">OPT_P_IPWIN32</a></div><div class="ttdeci">#define OPT_P_IPWIN32</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00677">options.h:677</a></div></div>
<div class="ttc" id="astructargv_html"><div class="ttname"><a href="structargv.html">argv</a></div><div class="ttdef"><b>Definition:</b> <a href="argv_8h_source.html#l00035">argv.h:35</a></div></div>
<div class="ttc" id="astructkey__type_html_a0714213fa1e02f00924a2c85deb53caf"><div class="ttname"><a href="structkey__type.html#a0714213fa1e02f00924a2c85deb53caf">key_type::hmac_length</a></div><div class="ttdeci">uint8_t hmac_length</div><div class="ttdoc">HMAC length, in bytes.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00142">crypto.h:142</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a64ca7e440847b0f5d19cbe94f9e114bd"><div class="ttname"><a href="config-msvc_8h.html#a64ca7e440847b0f5d19cbe94f9e114bd">in_addr_t</a></div><div class="ttdeci">#define in_addr_t</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00144">config-msvc.h:144</a></div></div>
<div class="ttc" id="arun__command_8h_html_a3a933e13c7546d8b3d63042f3feba310"><div class="ttname"><a href="run__command_8h.html#a3a933e13c7546d8b3d63042f3feba310">openvpn_run_script</a></div><div class="ttdeci">static bool openvpn_run_script(const struct argv *a, const struct env_set *es, const unsigned int flags, const char *hook)</div><div class="ttdef"><b>Definition:</b> <a href="run__command_8h_source.html#l00057">run_command.h:57</a></div></div>
<div class="ttc" id="astructcontext__2_html_a43f0201867a96a35bbecb2e52e880e47"><div class="ttname"><a href="structcontext__2.html#a43f0201867a96a35bbecb2e52e880e47">context_2::es_owned</a></div><div class="ttdeci">bool es_owned</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00430">openvpn.h:430</a></div></div>
<div class="ttc" id="astructoptions_html_a2a61982b1ebed1f70da93f793efd2489"><div class="ttname"><a href="structoptions.html#a2a61982b1ebed1f70da93f793efd2489">options::duplicate_cn</a></div><div class="ttdeci">bool duplicate_cn</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00479">options.h:479</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a7644600ad9ecf9e1dfa53760c49077ec"><div class="ttname"><a href="structconnection__entry.html#a7644600ad9ecf9e1dfa53760c49077ec">connection_entry::tls_crypt_file_inline</a></div><div class="ttdeci">bool tls_crypt_file_inline</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00148">options.h:148</a></div></div>
<div class="ttc" id="aoptions_8h_html_a4841717e2f45399a58c25188a1247c7a"><div class="ttname"><a href="options_8h.html#a4841717e2f45399a58c25188a1247c7a">streq</a></div><div class="ttdeci">#define streq(x, y)</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00669">options.h:669</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a7da87b23868c6efa70ce599f9ecd341b"><div class="ttname"><a href="openvpn_2error_8h.html#a7da87b23868c6efa70ce599f9ecd341b">set_check_status_error_delay</a></div><div class="ttdeci">static void set_check_status_error_delay(unsigned int milliseconds)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00308">error.h:308</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a85aeb0494fcbd4bab2b193dc6100ca23"><div class="ttname"><a href="config-msvc_8h.html#a85aeb0494fcbd4bab2b193dc6100ca23">ENABLE_PKCS11</a></div><div class="ttdeci">#define ENABLE_PKCS11</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00015">config-msvc.h:15</a></div></div>
<div class="ttc" id="asocket_8c_html_a6ebb8e0bd35afb3cda6a0392f1479433"><div class="ttname"><a href="socket_8c.html#a6ebb8e0bd35afb3cda6a0392f1479433">proto2ascii</a></div><div class="ttdeci">const char * proto2ascii(int proto, sa_family_t af, bool display_form)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l03252">socket.c:3252</a></div></div>
<div class="ttc" id="apacket__id_8c_html_ad4f489a3f0c44154ef52e924a1ef4caa"><div class="ttname"><a href="packet__id_8c.html#ad4f489a3f0c44154ef52e924a1ef4caa">packet_id_persist_load</a></div><div class="ttdeci">void packet_id_persist_load(struct packet_id_persist *p, const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="packet__id_8c_source.html#l00433">packet_id.c:433</a></div></div>
<div class="ttc" id="aopenvpn_8h_html_a21ce4ae478838de79c2470ff07c22288"><div class="ttname"><a href="openvpn_8h.html#a21ce4ae478838de79c2470ff07c22288">TLS_MODE</a></div><div class="ttdeci">#define TLS_MODE(c)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00552">openvpn.h:552</a></div></div>
<div class="ttc" id="ainit_8c_html_a74ee8a601d15d115c433b90a93ee1301"><div class="ttname"><a href="init_8c.html#a74ee8a601d15d115c433b90a93ee1301">do_close_free_buf</a></div><div class="ttdeci">static void do_close_free_buf(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03579">init.c:3579</a></div></div>
<div class="ttc" id="astructtls__wrap__ctx_html_ad96b76798b05ef4165ae44a0127cf6ca"><div class="ttname"><a href="structtls__wrap__ctx.html#ad96b76798b05ef4165ae44a0127cf6ca">tls_wrap_ctx::tls_crypt_v2_wkc</a></div><div class="ttdeci">const struct buffer * tls_crypt_v2_wkc</div><div class="ttdoc">Wrapped client key, sent to server.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00233">ssl_common.h:233</a></div></div>
<div class="ttc" id="aocc_8h_html_a8e571538d538bcf6cab30d82a0dbabf6"><div class="ttname"><a href="occ_8h.html#a8e571538d538bcf6cab30d82a0dbabf6">occ_reset_op</a></div><div class="ttdeci">static int occ_reset_op(void)</div><div class="ttdef"><b>Definition:</b> <a href="occ_8h_source.html#l00101">occ.h:101</a></div></div>
<div class="ttc" id="astructconnection__entry_html_aa399cea883d3a239190c049c004ad793"><div class="ttname"><a href="structconnection__entry.html#aa399cea883d3a239190c049c004ad793">connection_entry::remote_port</a></div><div class="ttdeci">const char * remote_port</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00099">options.h:99</a></div></div>
<div class="ttc" id="ainit_8c_html_afbe8fb5ea05f1ae656b5d9e86b966451"><div class="ttname"><a href="init_8c.html#afbe8fb5ea05f1ae656b5d9e86b966451">save_ncp_options</a></div><div class="ttdeci">static void save_ncp_options(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00677">init.c:677</a></div></div>
<div class="ttc" id="amanage_8c_html_af07a56f96cec84856d0bf97899a4d460"><div class="ttname"><a href="manage_8c.html#af07a56f96cec84856d0bf97899a4d460">management_sleep</a></div><div class="ttdeci">void management_sleep(const int n)</div><div class="ttdoc">A sleep function that services the management layer for n seconds rather than doing nothing.</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l04128">manage.c:4128</a></div></div>
<div class="ttc" id="astructcontext__1_html_acae58a5af5e0f65b4963b44c6e9715e5"><div class="ttname"><a href="structcontext__1.html#acae58a5af5e0f65b4963b44c6e9715e5">context_1::tuntap_owned</a></div><div class="ttdeci">bool tuntap_owned</div><div class="ttdoc">Whether the tun/tap interface should be cleaned up when this context is cleaned up.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00169">openvpn.h:169</a></div></div>
<div class="ttc" id="atun_8h_html_aa8aab56a4e715335738baeac45989d76"><div class="ttname"><a href="tun_8h.html#aa8aab56a4e715335738baeac45989d76">ROUTE_AFTER_TUN</a></div><div class="ttdeci">#define ROUTE_AFTER_TUN</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00360">tun.h:360</a></div></div>
<div class="ttc" id="alladdr_8h_html"><div class="ttname"><a href="lladdr_8h.html">lladdr.h</a></div></div>
<div class="ttc" id="amtu_8h_html_a421e9017e7a6714398dc943b4e3a4048"><div class="ttname"><a href="mtu_8h.html#a421e9017e7a6714398dc943b4e3a4048">FRAME_HEADROOM_MARKER_READ_LINK</a></div><div class="ttdeci">#define FRAME_HEADROOM_MARKER_READ_LINK</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00131">mtu.h:131</a></div></div>
<div class="ttc" id="ainit_8c_html_a71177a52e10b7bb794394d863d3afa3e"><div class="ttname"><a href="init_8c.html#a71177a52e10b7bb794394d863d3afa3e">do_open_status_output</a></div><div class="ttdeci">static void do_open_status_output(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03754">init.c:3754</a></div></div>
<div class="ttc" id="astructcontext_html"><div class="ttname"><a href="structcontext.html">context</a></div><div class="ttdoc">Contains all state information for one tunnel.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00489">openvpn.h:489</a></div></div>
<div class="ttc" id="ainit_8c_html_a15253fe4c0e3529e707edc3ef1d3d599"><div class="ttname"><a href="init_8c.html#a15253fe4c0e3529e707edc3ef1d3d599">do_setup_fast_io</a></div><div class="ttdeci">static void do_setup_fast_io(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03841">init.c:3841</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_ae77ba6635ecf104df3b8afdcb1cae284"><div class="ttname"><a href="errlevel_8h.html#ae77ba6635ecf104df3b8afdcb1cae284">D_ROUTE</a></div><div class="ttdeci">#define D_ROUTE</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00080">errlevel.h:80</a></div></div>
<div class="ttc" id="astructtls__options_html_a8679088462548aabda1f3921460e3cfe"><div class="ttname"><a href="structtls__options.html#a8679088462548aabda1f3921460e3cfe">tls_options::transition_window</a></div><div class="ttdeci">int transition_window</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00270">ssl_common.h:270</a></div></div>
<div class="ttc" id="astructoptions_html_a05b0630208dd924ada185a3b73adf8c8"><div class="ttname"><a href="structoptions.html#a05b0630208dd924ada185a3b73adf8c8">options::route_nopull</a></div><div class="ttdeci">bool route_nopull</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00386">options.h:386</a></div></div>
<div class="ttc" id="aroute_8c_html_a6a96e2d57770d4096ab35549eaf66258"><div class="ttname"><a href="route_8c.html#a6a96e2d57770d4096ab35549eaf66258">init_route_ipv6_list</a></div><div class="ttdeci">bool init_route_ipv6_list(struct route_ipv6_list *rl6, const struct route_ipv6_option_list *opt6, const char *remote_endpoint, int default_metric, const struct in6_addr *remote_host_ipv6, struct env_set *es, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="route_8c_source.html#l00771">route.c:771</a></div></div>
<div class="ttc" id="astructtls__multi_html_a74e065e432f819307a830ef38d5be73c"><div class="ttname"><a href="structtls__multi.html#a74e065e432f819307a830ef38d5be73c">tls_multi::session</a></div><div class="ttdeci">struct tls_session session[TM_SIZE]</div><div class="ttdoc">Array of tls_session objects representing control channel sessions with the remote peer.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00597">ssl_common.h:597</a></div></div>
<div class="ttc" id="aroute_8h_html_a44d8acb217b7350899a3bf897bfef0d6"><div class="ttname"><a href="route_8h.html#a44d8acb217b7350899a3bf897bfef0d6">route_did_redirect_default_gateway</a></div><div class="ttdeci">static int route_did_redirect_default_gateway(const struct route_list *rl)</div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00404">route.h:404</a></div></div>
<div class="ttc" id="astructcontext__1_html_a6f12c9d9f20f780524ecd9849e36a574"><div class="ttname"><a href="structcontext__1.html#a6f12c9d9f20f780524ecd9849e36a574">context_1::keysize</a></div><div class="ttdeci">int keysize</div><div class="ttdoc">Data channel keysize from config file.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00209">openvpn.h:209</a></div></div>
<div class="ttc" id="ainit_8h_html_a29e8da303469d142757b3dd754072365"><div class="ttname"><a href="init_8h.html#a29e8da303469d142757b3dd754072365">CC_GC_FREE</a></div><div class="ttdeci">#define CC_GC_FREE</div><div class="ttdef"><b>Definition:</b> <a href="init_8h_source.html#l00106">init.h:106</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a90482e8f2d1ab61167f705cec826abee"><div class="ttname"><a href="structconnection__entry.html#a90482e8f2d1ab61167f705cec826abee">connection_entry::tun_mtu_defined</a></div><div class="ttdeci">bool tun_mtu_defined</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00115">options.h:115</a></div></div>
<div class="ttc" id="astructkey__schedule_html_a52c3c5b8bfd7c529453ef8b526944209"><div class="ttname"><a href="structkey__schedule.html#a52c3c5b8bfd7c529453ef8b526944209">key_schedule::auth_token_key</a></div><div class="ttdeci">struct key_ctx auth_token_key</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00071">openvpn.h:71</a></div></div>
<div class="ttc" id="assl_8h_html_aa398f159e1dca57893fbfd67ad24a512"><div class="ttname"><a href="ssl_8h.html#aa398f159e1dca57893fbfd67ad24a512">extract_x509_field_test</a></div><div class="ttdeci">void extract_x509_field_test(void)</div></div>
<div class="ttc" id="astructoptions_html_ad47394d36a22f99461bdb6d749bcb6a1"><div class="ttname"><a href="structoptions.html#ad47394d36a22f99461bdb6d749bcb6a1">options::key_direction</a></div><div class="ttdeci">int key_direction</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00519">options.h:519</a></div></div>
<div class="ttc" id="astructoptions_html_a7a75e271f54a80de7c345599e69bcfe9"><div class="ttname"><a href="structoptions.html#a7a75e271f54a80de7c345599e69bcfe9">options::topology</a></div><div class="ttdeci">int topology</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00266">options.h:266</a></div></div>
<div class="ttc" id="arun__command_8h_html_a3c41fae7f419ada19275d46cd6b55a1d"><div class="ttname"><a href="run__command_8h.html#a3c41fae7f419ada19275d46cd6b55a1d">SSEC_SCRIPTS</a></div><div class="ttdeci">#define SSEC_SCRIPTS</div><div class="ttdef"><b>Definition:</b> <a href="run__command_8h_source.html#l00033">run_command.h:33</a></div></div>
<div class="ttc" id="astructlink__socket__info_html_a3000ece81909a84b167b6e6f1fd54fd5"><div class="ttname"><a href="structlink__socket__info.html#a3000ece81909a84b167b6e6f1fd54fd5">link_socket_info::lsa</a></div><div class="ttdeci">struct link_socket_addr * lsa</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00114">socket.h:114</a></div></div>
<div class="ttc" id="abuffer_8h_html_a34c800967d7b9583cb64236eadab94dd"><div class="ttname"><a href="buffer_8h.html#a34c800967d7b9583cb64236eadab94dd">BSTR</a></div><div class="ttdeci">#define BSTR(buf)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00129">buffer.h:129</a></div></div>
<div class="ttc" id="astructmanagement__callback_html_abd95714952054b7a9f38ea9bd4aad9fa"><div class="ttname"><a href="structmanagement__callback.html#abd95714952054b7a9f38ea9bd4aad9fa">management_callback::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00159">manage.h:159</a></div></div>
<div class="ttc" id="astructoptions_html_a3b2503d5f5f98a176450b3baf1953a20"><div class="ttname"><a href="structoptions.html#a3b2503d5f5f98a176450b3baf1953a20">options::authname</a></div><div class="ttdeci">const char * authname</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00525">options.h:525</a></div></div>
<div class="ttc" id="astructoptions_html_a46085bfaf25d5996f2f21c7553411a65"><div class="ttname"><a href="structoptions.html#a46085bfaf25d5996f2f21c7553411a65">options::dev_type</a></div><div class="ttdeci">const char * dev_type</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00263">options.h:263</a></div></div>
<div class="ttc" id="astructtls__options_html_a039656e7d5ffb2c9d2baeaa15572e329"><div class="ttname"><a href="structtls__options.html#a039656e7d5ffb2c9d2baeaa15572e329">tls_options::auth_token_key</a></div><div class="ttdeci">struct key_ctx auth_token_key</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00326">ssl_common.h:326</a></div></div>
<div class="ttc" id="astructuser__pass_html_afd95ee9ee0c23614ce570b8bca3ad0e9"><div class="ttname"><a href="structuser__pass.html#afd95ee9ee0c23614ce570b8bca3ad0e9">user_pass::username</a></div><div class="ttdeci">char username[USER_PASS_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="misc_8h_source.html#l00078">misc.h:78</a></div></div>
<div class="ttc" id="acrypto_8c_html_a37fb65e30bd2c33564b14ad76a0c0794"><div class="ttname"><a href="crypto_8c.html#a37fb65e30bd2c33564b14ad76a0c0794">get_random</a></div><div class="ttdeci">long int get_random(void)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01771">crypto.c:1771</a></div></div>
<div class="ttc" id="astructcontext__2_html_a5fd70b82d77870b98844a107ce3cf7dd"><div class="ttname"><a href="structcontext__2.html#a5fd70b82d77870b98844a107ce3cf7dd">context_2::tmp_int</a></div><div class="ttdeci">struct interval tmp_int</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00355">openvpn.h:355</a></div></div>
<div class="ttc" id="aoptions_8h_html_aa4019b2e0b0d1bc21cdb433db9d5507d"><div class="ttname"><a href="options_8h.html#aa4019b2e0b0d1bc21cdb433db9d5507d">AR_NONE</a></div><div class="ttdeci">#define AR_NONE</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00851">options.h:851</a></div></div>
<div class="ttc" id="aplatform_8c_html_a0ed26af4c60fafd6cb3de6759dfb0238"><div class="ttname"><a href="platform_8c.html#a0ed26af4c60fafd6cb3de6759dfb0238">platform_getpid</a></div><div class="ttdeci">unsigned int platform_getpid(void)</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00178">platform.c:178</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_aab9d07562cfecbd96b4c9e1d242d7d15"><div class="ttname"><a href="errlevel_8h.html#aab9d07562cfecbd96b4c9e1d242d7d15">D_MTU_INFO</a></div><div class="ttdeci">#define D_MTU_INFO</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00107">errlevel.h:107</a></div></div>
<div class="ttc" id="ainit_8c_html_a46d6454c2cf71f447451e11c5fa98722"><div class="ttname"><a href="init_8c.html#a46d6454c2cf71f447451e11c5fa98722">do_print_data_channel_mtu_parms</a></div><div class="ttdeci">static void do_print_data_channel_mtu_parms(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03483">init.c:3483</a></div></div>
<div class="ttc" id="astructoptions_html_abab76df02281e67b578e568d765cf99c"><div class="ttname"><a href="structoptions.html#abab76df02281e67b578e568d765cf99c">options::status_file_update_freq</a></div><div class="ttdeci">int status_file_update_freq</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00353">options.h:353</a></div></div>
<div class="ttc" id="astructlink__socket__addr_html_a5a4d9686ebf0ef5a00117de888ac78cf"><div class="ttname"><a href="structlink__socket__addr.html#a5a4d9686ebf0ef5a00117de888ac78cf">link_socket_addr::bind_local</a></div><div class="ttdeci">struct addrinfo * bind_local</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00105">socket.h:105</a></div></div>
<div class="ttc" id="aopenvpn_8h_html_ae1e939740ff946b87d7d65c3f533c9b5"><div class="ttname"><a href="openvpn_8h.html#ae1e939740ff946b87d7d65c3f533c9b5">CM_CHILD_UDP</a></div><div class="ttdeci">#define CM_CHILD_UDP</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00501">openvpn.h:501</a></div></div>
<div class="ttc" id="astructcontext_html_a7ebcb36e0e5cab031f1f3721ee39b9d3"><div class="ttname"><a href="structcontext.html#a7ebcb36e0e5cab031f1f3721ee39b9d3">context::plugins</a></div><div class="ttdeci">struct plugin_list * plugins</div><div class="ttdoc">List of plug-ins.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00518">openvpn.h:518</a></div></div>
<div class="ttc" id="aplugin_8h_html_a4a6e36a09c986bdd6e7d06dcdd2f7ca6"><div class="ttname"><a href="plugin_8h.html#a4a6e36a09c986bdd6e7d06dcdd2f7ca6">plugin_return_init</a></div><div class="ttdeci">static void plugin_return_init(struct plugin_return *pr)</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8h_source.html#l00171">plugin.h:171</a></div></div>
<div class="ttc" id="atun_8c_html_ab0f91db5420a16a2656811d0749978f4"><div class="ttname"><a href="tun_8c.html#ab0f91db5420a16a2656811d0749978f4">warn_on_use_of_common_subnets</a></div><div class="ttdeci">void warn_on_use_of_common_subnets(openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l00570">tun.c:570</a></div></div>
<div class="ttc" id="astructoptions_html_a92cffd160044d2b84a1085fa3ddb9a2d"><div class="ttname"><a href="structoptions.html#a92cffd160044d2b84a1085fa3ddb9a2d">options::tls_client</a></div><div class="ttdeci">bool tls_client</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00543">options.h:543</a></div></div>
<div class="ttc" id="astructoptions_html_af4f6ab25d97dd623648d3c2342659e0d"><div class="ttname"><a href="structoptions.html#af4f6ab25d97dd623648d3c2342659e0d">options::shared_secret_file</a></div><div class="ttdeci">const char * shared_secret_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00517">options.h:517</a></div></div>
<div class="ttc" id="astructcontext__2_html_acfe86f2a045249246aeda38971cbceaa"><div class="ttname"><a href="structcontext__2.html#acfe86f2a045249246aeda38971cbceaa">context_2::log_rw</a></div><div class="ttdeci">bool log_rw</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00391">openvpn.h:391</a></div></div>
<div class="ttc" id="astructtls__options_html_a85a0b7f779720f69cbb54dc8c66a1f28"><div class="ttname"><a href="structtls__options.html#a85a0b7f779720f69cbb54dc8c66a1f28">tls_options::ekm_size</a></div><div class="ttdeci">size_t ekm_size</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00371">ssl_common.h:371</a></div></div>
<div class="ttc" id="aargv_8c_html_ad62a50a5c6133eaea0422cee6ba840cf"><div class="ttname"><a href="argv_8c.html#ad62a50a5c6133eaea0422cee6ba840cf">argv_printf_cat</a></div><div class="ttdeci">bool argv_printf_cat(struct argv *argres, const char *format,...)</div><div class="ttdoc">printf() inspired argv concatenation.</div><div class="ttdef"><b>Definition:</b> <a href="argv_8c_source.html#l00466">argv.c:466</a></div></div>
<div class="ttc" id="acompat-lz4_8h_html_aedfbaa502c9c447fc19b72fec8fc48e0"><div class="ttname"><a href="compat-lz4_8h.html#aedfbaa502c9c447fc19b72fec8fc48e0">dest</a></div><div class="ttdeci">char * dest</div><div class="ttdef"><b>Definition:</b> <a href="compat-lz4_8h_source.html#l00686">compat-lz4.h:686</a></div></div>
<div class="ttc" id="abuffer_8c_html_aa35bf7feb6a99bf5d364b2d4eba1195c"><div class="ttname"><a href="buffer_8c.html#aa35bf7feb6a99bf5d364b2d4eba1195c">alloc_buf_gc</a></div><div class="ttdeci">struct buffer alloc_buf_gc(size_t size, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00090">buffer.c:90</a></div></div>
<div class="ttc" id="ainit_8c_html_a8e6926f8074e0ab4b54ff2eb47cca9b7"><div class="ttname"><a href="init_8c.html#a8e6926f8074e0ab4b54ff2eb47cca9b7">print_openssl_info</a></div><div class="ttdeci">bool print_openssl_info(const struct options *options)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01062">init.c:1062</a></div></div>
<div class="ttc" id="amtu_8h_html_a226f42aa4fb3787fef5d19bed986a1b8"><div class="ttname"><a href="mtu_8h.html#a226f42aa4fb3787fef5d19bed986a1b8">frame_add_to_align_adjust</a></div><div class="ttdeci">static void frame_add_to_align_adjust(struct frame *frame, const int increment)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00304">mtu.h:304</a></div></div>
<div class="ttc" id="astructcontext__2_html_a59b42a3c7d754a42ba10acf3c035a1c2"><div class="ttname"><a href="structcontext__2.html#a59b42a3c7d754a42ba10acf3c035a1c2">context_2::es</a></div><div class="ttdeci">struct env_set * es</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00429">openvpn.h:429</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html"><div class="ttname"><a href="config-msvc_8h.html">config-msvc.h</a></div></div>
<div class="ttc" id="agroup__tls__crypt_html_ga7c2e1553c38344d7858a9dcf062f7f54"><div class="ttname"><a href="group__tls__crypt.html#ga7c2e1553c38344d7858a9dcf062f7f54">tls_crypt_v2_write_client_key_file</a></div><div class="ttdeci">void tls_crypt_v2_write_client_key_file(const char *filename, const char *b64_metadata, const char *server_key_file, bool server_key_inline)</div><div class="ttdoc">Generate a tls-crypt-v2 client key, and write to file.</div><div class="ttdef"><b>Definition:</b> <a href="tls__crypt_8c_source.html#l00642">tls_crypt.c:642</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a51429ed22fd30ac08ed94d0df42f46e2"><div class="ttname"><a href="structconnection__entry.html#a51429ed22fd30ac08ed94d0df42f46e2">connection_entry::connect_timeout</a></div><div class="ttdeci">int connect_timeout</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00108">options.h:108</a></div></div>
<div class="ttc" id="aconfig-msvc-version_8h_html_a1c0439e4355794c09b64274849eb0279"><div class="ttname"><a href="config-msvc-version_8h.html#a1c0439e4355794c09b64274849eb0279">PACKAGE_NAME</a></div><div class="ttdeci">#define PACKAGE_NAME</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc-version_8h_source.html#l00001">config-msvc-version.h:1</a></div></div>
<div class="ttc" id="aargv_8c_html_a8563bed2ee30eda7125eee7bdb9ab4eb"><div class="ttname"><a href="argv_8c.html#a8563bed2ee30eda7125eee7bdb9ab4eb">argv_free</a></div><div class="ttdeci">void argv_free(struct argv *a)</div><div class="ttdoc">Frees all memory allocations allocated by the struct argv related functions.</div><div class="ttdef"><b>Definition:</b> <a href="argv_8c_source.html#l00104">argv.c:104</a></div></div>
<div class="ttc" id="assl_8h_html_a4f8dfe6e6f75a82e742d132b0281f201"><div class="ttname"><a href="ssl_8h.html#a4f8dfe6e6f75a82e742d132b0281f201">X509_USERNAME_FIELD_DEFAULT</a></div><div class="ttdeci">#define X509_USERNAME_FIELD_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00120">ssl.h:120</a></div></div>
<div class="ttc" id="astructcontext__1_html_aaac4b2b8b2b667ffe53c32dcfb137144"><div class="ttname"><a href="structcontext__1.html#aaac4b2b8b2b667ffe53c32dcfb137144">context_1::socks_proxy_owned</a></div><div class="ttdeci">bool socks_proxy_owned</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00190">openvpn.h:190</a></div></div>
<div class="ttc" id="asocket_8h_html_afe08e36c8ec910a0039d2fc693c597ec"><div class="ttname"><a href="socket_8h.html#afe08e36c8ec910a0039d2fc693c597ec">link_socket_proto_connection_oriented</a></div><div class="ttdeci">static bool link_socket_proto_connection_oriented(int proto)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00615">socket.h:615</a></div></div>
<div class="ttc" id="astructroute__ipv6__gateway__info_html"><div class="ttname"><a href="structroute__ipv6__gateway__info.html">route_ipv6_gateway_info</a></div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00179">route.h:179</a></div></div>
<div class="ttc" id="aopenvpn_2error_8c_html_af250e34abb4c2f896fcfa37e10aaeebf"><div class="ttname"><a href="openvpn_2error_8c.html#af250e34abb4c2f896fcfa37e10aaeebf">set_debug_level</a></div><div class="ttdeci">bool set_debug_level(const int level, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8c_source.html#l00107">error.c:107</a></div></div>
<div class="ttc" id="astructman__persist_html_af00c1b9b0fcb84e3085c4be10aed542d"><div class="ttname"><a href="structman__persist.html#af00c1b9b0fcb84e3085c4be10aed542d">man_persist::special_state_msg</a></div><div class="ttdeci">const char * special_state_msg</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00222">manage.h:222</a></div></div>
<div class="ttc" id="aplatform_8c_html_a99cf5236d05fa18d32f2b7790c9e7cb4"><div class="ttname"><a href="platform_8c.html#a99cf5236d05fa18d32f2b7790c9e7cb4">platform_user_set</a></div><div class="ttdeci">void platform_user_set(const struct platform_state_user *state)</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00091">platform.c:91</a></div></div>
<div class="ttc" id="ainit_8c_html_a7ff24c87873c65ffd41f47539bc6b760"><div class="ttname"><a href="init_8c.html#a7ff24c87873c65ffd41f47539bc6b760">do_close_fragment</a></div><div class="ttdeci">static void do_close_fragment(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03705">init.c:3705</a></div></div>
<div class="ttc" id="aoptions_8h_html_a9c6881e2e86f302489916b1fa05b627aacb8e8ccf1788376766a166614aba251d"><div class="ttname"><a href="options_8h.html#a9c6881e2e86f302489916b1fa05b627aacb8e8ccf1788376766a166614aba251d">GENKEY_TLS_CRYPTV2_CLIENT</a></div><div class="ttdeci">@ GENKEY_TLS_CRYPTV2_CLIENT</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00204">options.h:204</a></div></div>
<div class="ttc" id="astructtls__options_html_a56206642b4f35177969bfbe3ffd86714"><div class="ttname"><a href="structtls__options.html#a56206642b4f35177969bfbe3ffd86714">tls_options::replay_time</a></div><div class="ttdeci">int replay_time</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00299">ssl_common.h:299</a></div></div>
<div class="ttc" id="aoptions_8h_html_a81f0f0d22999fdf0c0c6fe82c48767ad"><div class="ttname"><a href="options_8h.html#a81f0f0d22999fdf0c0c6fe82c48767ad">OPT_P_PLUGIN</a></div><div class="ttdeci">#define OPT_P_PLUGIN</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00698">options.h:698</a></div></div>
<div class="ttc" id="atun_8c_html_aaeb7d66a96170c82580b2e821110c745"><div class="ttname"><a href="tun_8c.html#aaeb7d66a96170c82580b2e821110c745">dev_type_string</a></div><div class="ttdeci">const char * dev_type_string(const char *dev, const char *dev_type)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l00385">tun.c:385</a></div></div>
<div class="ttc" id="astructoptions_html_abd58a7a4b0ea3e30121218d08ba6c9f9"><div class="ttname"><a href="structoptions.html#abd58a7a4b0ea3e30121218d08ba6c9f9">options::cipher_list</a></div><div class="ttdeci">const char * cipher_list</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00557">options.h:557</a></div></div>
<div class="ttc" id="aplugin_8c_html_afe5fc5a0558b4c8e6f89810560022b58"><div class="ttname"><a href="plugin_8c.html#afe5fc5a0558b4c8e6f89810560022b58">plugin_list_open</a></div><div class="ttdeci">void plugin_list_open(struct plugin_list *pl, const struct plugin_option_list *list, struct plugin_return *pr, const struct env_set *es, const int init_point)</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8c_source.html#l00788">plugin.c:788</a></div></div>
<div class="ttc" id="ainit_8c_html_a2986d81718c6cb5cd19bad612998d56f"><div class="ttname"><a href="init_8c.html#a2986d81718c6cb5cd19bad612998d56f">init_instance</a></div><div class="ttdeci">void init_instance(struct context *c, const struct env_set *env, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04151">init.c:4151</a></div></div>
<div class="ttc" id="astructmanagement__callback_html_ad8622b0a8677465b1773e90a456d1e71"><div class="ttname"><a href="structmanagement__callback.html#ad8622b0a8677465b1773e90a456d1e71">management_callback::remote_cmd</a></div><div class="ttdeci">bool(* remote_cmd)(void *arg, const char **p)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00188">manage.h:188</a></div></div>
<div class="ttc" id="astructtls__options_html_aefa62cdcb579f4a6bce35311ce9da7a6"><div class="ttname"><a href="structtls__options.html#aefa62cdcb579f4a6bce35311ce9da7a6">tls_options::remote_cert_eku</a></div><div class="ttdeci">const char * remote_cert_eku</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00286">ssl_common.h:286</a></div></div>
<div class="ttc" id="astructoptions_html_a8a97f5f530042a7f4321cb97c3983fa1"><div class="ttname"><a href="structoptions.html#a8a97f5f530042a7f4321cb97c3983fa1">options::mode</a></div><div class="ttdeci">int mode</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00221">options.h:221</a></div></div>
<div class="ttc" id="astructtls__options_html_aa165f8c2301d2dc25b72ef200020ccb5"><div class="ttname"><a href="structtls__options.html#aa165f8c2301d2dc25b72ef200020ccb5">tls_options::single_session</a></div><div class="ttdeci">bool single_session</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00265">ssl_common.h:265</a></div></div>
<div class="ttc" id="ainit_8c_html_a5eea9a05e4580cb48e8b0daad33c59fe"><div class="ttname"><a href="init_8c.html#a5eea9a05e4580cb48e8b0daad33c59fe">reset_coarse_timers</a></div><div class="ttdeci">void reset_coarse_timers(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01382">init.c:1382</a></div></div>
<div class="ttc" id="astructroute__ipv6__list_html"><div class="ttname"><a href="structroute__ipv6__list.html">route_ipv6_list</a></div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00219">route.h:219</a></div></div>
<div class="ttc" id="astructoptions_html_a4262860a03a36842bb63d1d3dae60e2d"><div class="ttname"><a href="structoptions.html#a4262860a03a36842bb63d1d3dae60e2d">options::mute</a></div><div class="ttdeci">int mute</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00345">options.h:345</a></div></div>
<div class="ttc" id="aopenvpn_8h_html_a65137f59c4038945b8df98139a6cef77"><div class="ttname"><a href="openvpn_8h.html#a65137f59c4038945b8df98139a6cef77">packet_id_persist_init</a></div><div class="ttdeci">static void packet_id_persist_init(struct packet_id_persist *p)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00084">openvpn.h:84</a></div></div>
<div class="ttc" id="aplatform_8c_html_ac9360f2b8017f5885191fd52e3192ddd"><div class="ttname"><a href="platform_8c.html#ac9360f2b8017f5885191fd52e3192ddd">platform_group_get</a></div><div class="ttdeci">bool platform_group_get(const char *groupname, struct platform_state_group *state)</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00108">platform.c:108</a></div></div>
<div class="ttc" id="astructcontext__2_html_aee3f1b158710abd4c3020369b56b9f7a"><div class="ttname"><a href="structcontext__2.html#aee3f1b158710abd4c3020369b56b9f7a">context_2::inactivity_interval</a></div><div class="ttdeci">struct event_timeout inactivity_interval</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00309">openvpn.h:309</a></div></div>
<div class="ttc" id="arun__command_8h_html_a8b0a9c8434191d44e4fef4e00afd60c6"><div class="ttname"><a href="run__command_8h.html#a8b0a9c8434191d44e4fef4e00afd60c6">SSEC_PW_ENV</a></div><div class="ttdeci">#define SSEC_PW_ENV</div><div class="ttdef"><b>Definition:</b> <a href="run__command_8h_source.html#l00034">run_command.h:34</a></div></div>
<div class="ttc" id="abuffer_8c_html_a1a7d06931a18e800e86ba7c2145f2f12"><div class="ttname"><a href="buffer_8c.html#a1a7d06931a18e800e86ba7c2145f2f12">buffer_list_peek</a></div><div class="ttdeci">struct buffer * buffer_list_peek(struct buffer_list *ol)</div><div class="ttdoc">Retrieve the head buffer.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l01276">buffer.c:1276</a></div></div>
<div class="ttc" id="amanage_8h_html_ab608fef69cf0640bc6ea6944f2e59e65"><div class="ttname"><a href="manage_8h.html#ab608fef69cf0640bc6ea6944f2e59e65">MF_SERVER</a></div><div class="ttdeci">#define MF_SERVER</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00336">manage.h:336</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_a3ec944116f6654d1ca69afb933f4418b"><div class="ttname"><a href="crypto__backend_8h.html#a3ec944116f6654d1ca69afb933f4418b">show_available_ciphers</a></div><div class="ttdeci">void show_available_ciphers(void)</div><div class="ttdef"><b>Definition:</b> <a href="crypto__openssl_8c_source.html#l00316">crypto_openssl.c:316</a></div></div>
<div class="ttc" id="astructremote__host__store_html_a2d542ea8cd04452e39d0d0134f9864d6"><div class="ttname"><a href="structremote__host__store.html#a2d542ea8cd04452e39d0d0134f9864d6">remote_host_store::port</a></div><div class="ttdeci">char port[RH_PORT_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00199">options.h:199</a></div></div>
<div class="ttc" id="aoptions_8h_html_abc112140dccf35b37370da1791c3d8c3"><div class="ttname"><a href="options_8h.html#abc112140dccf35b37370da1791c3d8c3">MAX_PARMS</a></div><div class="ttdeci">#define MAX_PARMS</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00051">options.h:51</a></div></div>
<div class="ttc" id="astructcontext_html_a1d0cd1cb672a5fee441bdc504fc0fa93"><div class="ttname"><a href="structcontext.html#a1d0cd1cb672a5fee441bdc504fc0fa93">context::c0</a></div><div class="ttdeci">struct context_0 * c0</div><div class="ttdoc">Level 0 context.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00528">openvpn.h:528</a></div></div>
<div class="ttc" id="abuffer_8c_html_a1bb5d44eee3543955d61ffbc671d2927"><div class="ttname"><a href="buffer_8c.html#a1bb5d44eee3543955d61ffbc671d2927">buf_clear</a></div><div class="ttdeci">void buf_clear(struct buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00164">buffer.c:164</a></div></div>
<div class="ttc" id="aoptions_8h_html_a6f832667f1cde366f5b88caa08e457fa"><div class="ttname"><a href="options_8h.html#a6f832667f1cde366f5b88caa08e457fa">CE_MAN_QUERY_PROXY</a></div><div class="ttdeci">#define CE_MAN_QUERY_PROXY</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00131">options.h:131</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a12ae06d792bd8aed58475b9976673654"><div class="ttname"><a href="structconnection__entry.html#a12ae06d792bd8aed58475b9976673654">connection_entry::link_mtu_defined</a></div><div class="ttdeci">bool link_mtu_defined</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00119">options.h:119</a></div></div>
<div class="ttc" id="acrypto_8c_html_a1d7c04eddcc6269ed0f1e76fe3f9ce0f"><div class="ttname"><a href="crypto_8c.html#a1d7c04eddcc6269ed0f1e76fe3f9ce0f">prng_bytes</a></div><div class="ttdeci">void prng_bytes(uint8_t *output, int len)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01739">crypto.c:1739</a></div></div>
<div class="ttc" id="ainit_8c_html_a62d7dcc84da69695748e556fda9833fe"><div class="ttname"><a href="init_8c.html#a62d7dcc84da69695748e556fda9833fe">do_close_tun</a></div><div class="ttdeci">static void do_close_tun(struct context *c, bool force)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01992">init.c:1992</a></div></div>
<div class="ttc" id="aotime_8h_html_ace107c9b76ee90e28373c1a313bc11d9"><div class="ttname"><a href="otime_8h.html#ace107c9b76ee90e28373c1a313bc11d9">time_test</a></div><div class="ttdeci">void time_test(void)</div></div>
<div class="ttc" id="acrypto_8c_html_aeed99ce5177c96881467847708e18b0e"><div class="ttname"><a href="crypto_8c.html#aeed99ce5177c96881467847708e18b0e">crypto_read_openvpn_key</a></div><div class="ttdeci">void crypto_read_openvpn_key(const struct key_type *key_type, struct key_ctx_bi *ctx, const char *key_file, bool key_inline, const int key_direction, const char *key_name, const char *opt_name)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01175">crypto.c:1175</a></div></div>
<div class="ttc" id="astructoptions_html_a6f0d2996992b45f52c8f8403e22c51ce"><div class="ttname"><a href="structoptions.html#a6f0d2996992b45f52c8f8403e22c51ce">options::ce</a></div><div class="ttdeci">struct connection_entry ce</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00245">options.h:245</a></div></div>
<div class="ttc" id="astructoptions_html_a6868bdf829c75b8fe35d389824128480"><div class="ttname"><a href="structoptions.html#a6868bdf829c75b8fe35d389824128480">options::msg_channel</a></div><div class="ttdeci">HANDLE msg_channel</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00640">options.h:640</a></div></div>
<div class="ttc" id="astructtls__options_html_aa5c2cadf23718676434cf1d684496e0c"><div class="ttname"><a href="structtls__options.html#aa5c2cadf23718676434cf1d684496e0c">tls_options::crl_file_inline</a></div><div class="ttdeci">bool crl_file_inline</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00283">ssl_common.h:283</a></div></div>
<div class="ttc" id="astructcontext__0_html_adf83164d54c6c56957e5550a45b63338"><div class="ttname"><a href="structcontext__0.html#adf83164d54c6c56957e5550a45b63338">context_0::uid_gid_chroot_set</a></div><div class="ttdeci">bool uid_gid_chroot_set</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00138">openvpn.h:138</a></div></div>
<div class="ttc" id="astructlink__socket__addr_html_a86eeebfb3c5eee93573fa9b577b12f7a"><div class="ttname"><a href="structlink__socket__addr.html#a86eeebfb3c5eee93573fa9b577b12f7a">link_socket_addr::current_remote</a></div><div class="ttdeci">struct addrinfo * current_remote</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00107">socket.h:107</a></div></div>
<div class="ttc" id="astructopenvpn__sockaddr_html"><div class="ttname"><a href="structopenvpn__sockaddr.html">openvpn_sockaddr</a></div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00064">socket.h:64</a></div></div>
<div class="ttc" id="aenv__set_8c_html_aa810d4e0a266484c89a2f8a6b048a33a"><div class="ttname"><a href="env__set_8c.html#aa810d4e0a266484c89a2f8a6b048a33a">env_set_inherit</a></div><div class="ttdeci">void env_set_inherit(struct env_set *es, const struct env_set *src)</div><div class="ttdef"><b>Definition:</b> <a href="env__set_8c_source.html#l00240">env_set.c:240</a></div></div>
<div class="ttc" id="ainit_8c_html_a5c3a221406c8c4ed6795c1f3ef9ce7f0"><div class="ttname"><a href="init_8c.html#a5c3a221406c8c4ed6795c1f3ef9ce7f0">do_close_free_key_schedule</a></div><div class="ttdeci">static void do_close_free_key_schedule(struct context *c, bool free_ssl_ctx)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03623">init.c:3623</a></div></div>
<div class="ttc" id="astructtls__options_html_aacee137fea1151534baef5463687e283"><div class="ttname"><a href="structtls__options.html#aacee137fea1151534baef5463687e283">tls_options::tcp_mode</a></div><div class="ttdeci">bool tcp_mode</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00300">ssl_common.h:300</a></div></div>
<div class="ttc" id="astructtls__options_html_ac131aba077a096b47e8b5c32f5da0878"><div class="ttname"><a href="structtls__options.html#ac131aba077a096b47e8b5c32f5da0878">tls_options::verify_hash</a></div><div class="ttdeci">uint8_t * verify_hash</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00287">ssl_common.h:287</a></div></div>
<div class="ttc" id="astructcontext__2_html_ae2e304ff3393a09ee15f7490f50b89d8"><div class="ttname"><a href="structcontext__2.html#ae2e304ff3393a09ee15f7490f50b89d8">context_2::buffers</a></div><div class="ttdeci">struct context_buffers * buffers</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00378">openvpn.h:378</a></div></div>
<div class="ttc" id="astructoptions_html_a2243ce90bf5e84bb70fdb979f452669e"><div class="ttname"><a href="structoptions.html#a2243ce90bf5e84bb70fdb979f452669e">options::verify_hash_algo</a></div><div class="ttdeci">hash_algo_type verify_hash_algo</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00573">options.h:573</a></div></div>
<div class="ttc" id="ainit_8c_html_a6e6b19367c9c40f7c22c5d5addf2f962"><div class="ttname"><a href="init_8c.html#a6e6b19367c9c40f7c22c5d5addf2f962">context_gc_free</a></div><div class="ttdeci">void context_gc_free(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00743">init.c:743</a></div></div>
<div class="ttc" id="anetworking_8h_html_aff0b513686f6c72428bbca270ce87a77"><div class="ttname"><a href="networking_8h.html#aff0b513686f6c72428bbca270ce87a77">openvpn_net_ctx_t</a></div><div class="ttdeci">void * openvpn_net_ctx_t</div><div class="ttdef"><b>Definition:</b> <a href="networking_8h_source.html#l00026">networking.h:26</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_ad7eba86279cb00fc16742e45bfcf3187"><div class="ttname"><a href="errlevel_8h.html#ad7eba86279cb00fc16742e45bfcf3187">D_LOW</a></div><div class="ttdeci">#define D_LOW</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00098">errlevel.h:98</a></div></div>
<div class="ttc" id="astructcontext__2_html_a367a0c4601050fe0e0368ec06c58754b"><div class="ttname"><a href="structcontext__2.html#a367a0c4601050fe0e0368ec06c58754b">context_2::did_open_tun</a></div><div class="ttdeci">bool did_open_tun</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00398">openvpn.h:398</a></div></div>
<div class="ttc" id="aopenvpn_2error_8c_html_ab76eae70d91e60b44b8c6478c72baae5"><div class="ttname"><a href="openvpn_2error_8c.html#ab76eae70d91e60b44b8c6478c72baae5">set_check_status</a></div><div class="ttdeci">void set_check_status(unsigned int info_level, unsigned int verbose_level)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8c_source.html#l00645">error.c:645</a></div></div>
<div class="ttc" id="astructoptions_html_a084474ef1254a1571f1da2b7c42f4d51"><div class="ttname"><a href="structoptions.html#a084474ef1254a1571f1da2b7c42f4d51">options::genkey_extra_data</a></div><div class="ttdeci">const char * genkey_extra_data</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00241">options.h:241</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a39772a2bdab0bd56c1b6dd518a65c2c3"><div class="ttname"><a href="openvpn_2error_8h.html#a39772a2bdab0bd56c1b6dd518a65c2c3">M_NOPREFIX</a></div><div class="ttdeci">#define M_NOPREFIX</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00099">error.h:99</a></div></div>
<div class="ttc" id="ainit_8c_html_aeb934fcc37236813bbde6746b45708f1"><div class="ttname"><a href="init_8c.html#aeb934fcc37236813bbde6746b45708f1">management_callback_send_cc_message</a></div><div class="ttdeci">static bool management_callback_send_cc_message(void *arg, const char *command, const char *parameters)</div><div class="ttdoc">This method sends a custom control channel message.</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00310">init.c:310</a></div></div>
<div class="ttc" id="ainit_8c_html_acb1b090f0af0de9a05f235a61b03fc44"><div class="ttname"><a href="init_8c.html#acb1b090f0af0de9a05f235a61b03fc44">init_context_buffers</a></div><div class="ttdeci">struct context_buffers * init_context_buffers(const struct frame *frame)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03342">init.c:3342</a></div></div>
<div class="ttc" id="astructcontext__2_html_a328c64e187c662be87e6b8ea738a76cb"><div class="ttname"><a href="structcontext__2.html#a328c64e187c662be87e6b8ea738a76cb">context_2::route_wakeup_expire</a></div><div class="ttdeci">struct event_timeout route_wakeup_expire</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00395">openvpn.h:395</a></div></div>
<div class="ttc" id="astructcontext__buffers_html_ac3ecbcb5ab79601f229b6badf7c09efb"><div class="ttname"><a href="structcontext__buffers.html#ac3ecbcb5ab79601f229b6badf7c09efb">context_buffers::decrypt_buf</a></div><div class="ttdeci">struct buffer decrypt_buf</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00099">openvpn.h:99</a></div></div>
<div class="ttc" id="aargv_8c_html_a774ef043771e6da40b48dde907f1e205"><div class="ttname"><a href="argv_8c.html#a774ef043771e6da40b48dde907f1e205">argv_parse_cmd</a></div><div class="ttdeci">void argv_parse_cmd(struct argv *argres, const char *cmdstr)</div><div class="ttdoc">Parses a command string, tokenizes it and puts each element into a separate struct argv argument slot...</div><div class="ttdef"><b>Definition:</b> <a href="argv_8c_source.html#l00485">argv.c:485</a></div></div>
<div class="ttc" id="ainit_8c_html_abb643cb703073cd62032ece84ed481f7"><div class="ttname"><a href="init_8c.html#abb643cb703073cd62032ece84ed481f7">options_hash_changed_or_zero</a></div><div class="ttdeci">static bool options_hash_changed_or_zero(const struct sha256_digest *a, const struct sha256_digest *b)</div><div class="ttdoc">Helper for do_up().</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02145">init.c:2145</a></div></div>
<div class="ttc" id="astructcontext__2_html_a38783ebd2fe0f390023a14ff23966f6e"><div class="ttname"><a href="structcontext__2.html#a38783ebd2fe0f390023a14ff23966f6e">context_2::pulled_options_state</a></div><div class="ttdeci">md_ctx_t * pulled_options_state</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00456">openvpn.h:456</a></div></div>
<div class="ttc" id="asig_8h_html_acca14239031e4e2583bb69dbed1cd18c"><div class="ttname"><a href="sig_8h.html#acca14239031e4e2583bb69dbed1cd18c">SIG_SOURCE_HARD</a></div><div class="ttdeci">#define SIG_SOURCE_HARD</div><div class="ttdef"><b>Definition:</b> <a href="sig_8h_source.html#l00033">sig.h:33</a></div></div>
<div class="ttc" id="asocks_8c_html_afc9ad215c8de030df0dd7de7969510d1"><div class="ttname"><a href="socks_8c.html#afc9ad215c8de030df0dd7de7969510d1">socks_proxy_close</a></div><div class="ttdeci">void socks_proxy_close(struct socks_proxy_info *sp)</div><div class="ttdef"><b>Definition:</b> <a href="socks_8c_source.html#l00091">socks.c:91</a></div></div>
<div class="ttc" id="astructtls__options_html_a339f31e34055b262d5fc4ff59ea08cf5"><div class="ttname"><a href="structtls__options.html#a339f31e34055b262d5fc4ff59ea08cf5">tls_options::tls_wrap</a></div><div class="ttdeci">struct tls_wrap_ctx tls_wrap</div><div class="ttdoc">TLS handshake wrapping state.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00310">ssl_common.h:310</a></div></div>
<div class="ttc" id="astructtls__options_html_a6e288c7eb3ad0ba9ff4631ac05756564"><div class="ttname"><a href="structtls__options.html#a6e288c7eb3ad0ba9ff4631ac05756564">tls_options::tls_crypt_v2</a></div><div class="ttdeci">bool tls_crypt_v2</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00306">ssl_common.h:306</a></div></div>
<div class="ttc" id="astructtls__options_html_a961267fe8e3dedb83efee7c83114c641"><div class="ttname"><a href="structtls__options.html#a961267fe8e3dedb83efee7c83114c641">tls_options::config_ciphername</a></div><div class="ttdeci">const char * config_ciphername</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00302">ssl_common.h:302</a></div></div>
<div class="ttc" id="astructoptions_html_a2bdc0d25499a3e547741c2a3ab06ba97"><div class="ttname"><a href="structoptions.html#a2bdc0d25499a3e547741c2a3ab06ba97">options::shaper</a></div><div class="ttdeci">int shaper</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00275">options.h:275</a></div></div>
<div class="ttc" id="awin32_8c_html_a38e77ce645f0df53b453d5a6e76acc57"><div class="ttname"><a href="win32_8c.html#a38e77ce645f0df53b453d5a6e76acc57">window_title_save</a></div><div class="ttdeci">void window_title_save(struct window_title *wt)</div><div class="ttdef"><b>Definition:</b> <a href="win32_8c_source.html#l00713">win32.c:713</a></div></div>
<div class="ttc" id="astructwindow__title_html"><div class="ttname"><a href="structwindow__title.html">window_title</a></div><div class="ttdef"><b>Definition:</b> <a href="win32_8h_source.html#l00069">win32.h:69</a></div></div>
<div class="ttc" id="atls__crypt_8h_html"><div class="ttname"><a href="tls__crypt_8h.html">tls_crypt.h</a></div></div>
<div class="ttc" id="ainit_8c_html_ac392bc1c0761f558869ec83c50b0c46b"><div class="ttname"><a href="init_8c.html#ac392bc1c0761f558869ec83c50b0c46b">do_inherit_plugins</a></div><div class="ttdeci">static void do_inherit_plugins(struct context *c, const struct context *src)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03943">init.c:3943</a></div></div>
<div class="ttc" id="ainit_8c_html_ad60e48d4f954964c89982f7f768cd114"><div class="ttname"><a href="init_8c.html#ad60e48d4f954964c89982f7f768cd114">do_close_packet_id</a></div><div class="ttdeci">static void do_close_packet_id(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03690">init.c:3690</a></div></div>
<div class="ttc" id="astructtls__options_html_a5884f8429da3da45931f71e4c8c2aca5"><div class="ttname"><a href="structtls__options.html#a5884f8429da3da45931f71e4c8c2aca5">tls_options::renegotiate_seconds</a></div><div class="ttdeci">interval_t renegotiate_seconds</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00275">ssl_common.h:275</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_ae4c9a74306b42f3348401bf4ede9e9c0"><div class="ttname"><a href="errlevel_8h.html#ae4c9a74306b42f3348401bf4ede9e9c0">D_LOG_RW</a></div><div class="ttdeci">#define D_LOG_RW</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00111">errlevel.h:111</a></div></div>
<div class="ttc" id="astructcontext_html_a05c5cc1b7bab3bf8fc5b1e23b38299f4"><div class="ttname"><a href="structcontext.html#a05c5cc1b7bab3bf8fc5b1e23b38299f4">context::mode</a></div><div class="ttdeci">int mode</div><div class="ttdoc">Role of this context within the OpenVPN process.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00503">openvpn.h:503</a></div></div>
<div class="ttc" id="aopenvpn_2error_8c_html_ac013439368e05d67a8515f9a6295359c"><div class="ttname"><a href="openvpn_2error_8c.html#ac013439368e05d67a8515f9a6295359c">reset_check_status</a></div><div class="ttdeci">void reset_check_status(void)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8c_source.html#l00638">error.c:638</a></div></div>
<div class="ttc" id="ainit_8c_html_a9b053b7a612943b6be1d1be2c25181bf"><div class="ttname"><a href="init_8c.html#a9b053b7a612943b6be1d1be2c25181bf">do_up</a></div><div class="ttdeci">bool do_up(struct context *c, bool pulled_options, unsigned int option_types_found)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02155">init.c:2155</a></div></div>
<div class="ttc" id="astructoptions_html_adda4185edc6728b8ca138902ff9dfe15"><div class="ttname"><a href="structoptions.html#adda4185edc6728b8ca138902ff9dfe15">options::cd_dir</a></div><div class="ttdeci">const char * cd_dir</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00322">options.h:322</a></div></div>
<div class="ttc" id="aoptions_8h_html_a3f2e4b6d38cb9fbb3839ed4a478bf39d"><div class="ttname"><a href="options_8h.html#a3f2e4b6d38cb9fbb3839ed4a478bf39d">MODE_SERVER</a></div><div class="ttdeci">#define MODE_SERVER</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00220">options.h:220</a></div></div>
<div class="ttc" id="aoptions_8h_html_aac0966b4ee4569318eb2fa0c1f2af10c"><div class="ttname"><a href="options_8h.html#aac0966b4ee4569318eb2fa0c1f2af10c">RH_HOST_LEN</a></div><div class="ttdeci">#define RH_HOST_LEN</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00196">options.h:196</a></div></div>
<div class="ttc" id="ainit_8c_html_a9c369a8c7bccbba36c31f4690e373c5f"><div class="ttname"><a href="init_8c.html#a9c369a8c7bccbba36c31f4690e373c5f">tun_abort</a></div><div class="ttdeci">void tun_abort(void)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02125">init.c:2125</a></div></div>
<div class="ttc" id="astatus_8h_html_a2f6001bad7228f20b8e74d5aace81085"><div class="ttname"><a href="status_8h.html#a2f6001bad7228f20b8e74d5aace81085">STATUS_OUTPUT_WRITE</a></div><div class="ttdeci">#define STATUS_OUTPUT_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="status_8h_source.html#l00051">status.h:51</a></div></div>
<div class="ttc" id="astructoptions_html_ad1253168302c07ba9e2c89e1bdff9547"><div class="ttname"><a href="structoptions.html#ad1253168302c07ba9e2c89e1bdff9547">options::remote_random</a></div><div class="ttdeci">bool remote_random</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00260">options.h:260</a></div></div>
<div class="ttc" id="astructoptions_html_af55d6b16c337f98fa0ec7fe63539ff76"><div class="ttname"><a href="structoptions.html#af55d6b16c337f98fa0ec7fe63539ff76">options::ifconfig_noexec</a></div><div class="ttdeci">bool ifconfig_noexec</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00272">options.h:272</a></div></div>
<div class="ttc" id="astructcontext__2_html_ae9fac99a50578f25555d9dfcb3320c98"><div class="ttname"><a href="structcontext__2.html#ae9fac99a50578f25555d9dfcb3320c98">context_2::frame_fragment_initial</a></div><div class="ttdeci">struct frame frame_fragment_initial</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00274">openvpn.h:274</a></div></div>
<div class="ttc" id="astructframe_html"><div class="ttname"><a href="structframe.html">frame</a></div><div class="ttdoc">Packet geometry parameters.</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00093">mtu.h:93</a></div></div>
<div class="ttc" id="atun_8h_html_a1cfcb6c219189c667b981d3b3536f501"><div class="ttname"><a href="tun_8h.html#a1cfcb6c219189c667b981d3b3536f501">IFCONFIG_AFTER_TUN_OPEN</a></div><div class="ttdeci">#define IFCONFIG_AFTER_TUN_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00333">tun.h:333</a></div></div>
<div class="ttc" id="aroute_8c_html_a1da011e5f99e883c8cd3e400ccb7d619"><div class="ttname"><a href="route_8c.html#a1da011e5f99e883c8cd3e400ccb7d619">setenv_routes_ipv6</a></div><div class="ttdeci">void setenv_routes_ipv6(struct env_set *es, const struct route_ipv6_list *rl6)</div><div class="ttdef"><b>Definition:</b> <a href="route_8c_source.html#l01490">route.c:1490</a></div></div>
<div class="ttc" id="astructtls__options_html_a5303f93b3bc97cc9244e09c2b5b6f67a"><div class="ttname"><a href="structtls__options.html#a5303f93b3bc97cc9244e09c2b5b6f67a">tls_options::tmp_dir</a></div><div class="ttdeci">const char * tmp_dir</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00317">ssl_common.h:317</a></div></div>
<div class="ttc" id="agroup__tls__crypt_html_ga5cbcf02978d6d2200ec5fbd645d6646c"><div class="ttname"><a href="group__tls__crypt.html#ga5cbcf02978d6d2200ec5fbd645d6646c">tls_crypt_v2_init_client_key</a></div><div class="ttdeci">void tls_crypt_v2_init_client_key(struct key_ctx_bi *key, struct buffer *wkc_buf, const char *key_file, bool key_inline)</div><div class="ttdoc">Initialize a tls-crypt-v2 client key.</div><div class="ttdef"><b>Definition:</b> <a href="tls__crypt_8c_source.html#l00300">tls_crypt.c:300</a></div></div>
<div class="ttc" id="ainit_8c_html_a263724992635e011b111147ec8647500"><div class="ttname"><a href="init_8c.html#a263724992635e011b111147ec8647500">key_schedule_free</a></div><div class="ttdeci">static void key_schedule_free(struct key_schedule *ks, bool free_ssl_ctx)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02539">init.c:2539</a></div></div>
<div class="ttc" id="asocket_8h_html_a50ea4ad26d16eec29ff9685126f0a599aeff17f4932089fddd54b29765c8cdbd7"><div class="ttname"><a href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599aeff17f4932089fddd54b29765c8cdbd7">PROTO_TCP_SERVER</a></div><div class="ttdeci">@ PROTO_TCP_SERVER</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00576">socket.h:576</a></div></div>
<div class="ttc" id="astructoptions_html_a8cc67b442d93909bc5500945a8ac08ff"><div class="ttname"><a href="structoptions.html#a8cc67b442d93909bc5500945a8ac08ff">options::tls_server</a></div><div class="ttdeci">bool tls_server</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00542">options.h:542</a></div></div>
<div class="ttc" id="aenv__set_8c_html_a2ee1297d7cd864a08edff8440efa4143"><div class="ttname"><a href="env__set_8c.html#a2ee1297d7cd864a08edff8440efa4143">setenv_int</a></div><div class="ttdeci">void setenv_int(struct env_set *es, const char *name, int value)</div><div class="ttdef"><b>Definition:</b> <a href="env__set_8c_source.html#l00269">env_set.c:269</a></div></div>
<div class="ttc" id="ainterval_8c_html_aabf9bc926cf4d0888ea85e6224103c3a"><div class="ttname"><a href="interval_8c.html#aabf9bc926cf4d0888ea85e6224103c3a">interval_init</a></div><div class="ttdeci">void interval_init(struct interval *top, int horizon, int refresh)</div><div class="ttdef"><b>Definition:</b> <a href="interval_8c_source.html#l00037">interval.c:37</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a237f0476d7d283fa334b6250559f11d5"><div class="ttname"><a href="structconnection__entry.html#a237f0476d7d283fa334b6250559f11d5">connection_entry::bind_local</a></div><div class="ttdeci">bool bind_local</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00105">options.h:105</a></div></div>
<div class="ttc" id="ainit_8c_html_aeb60c5bfb96ec7dae0414d52ed106459"><div class="ttname"><a href="init_8c.html#aeb60c5bfb96ec7dae0414d52ed106459">management_show_net_callback</a></div><div class="ttdeci">void management_show_net_callback(void *arg, const int msglevel)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03964">init.c:3964</a></div></div>
<div class="ttc" id="amisc_8h_html_a2918bca6e88a6f6a9908dfb2e4beea43"><div class="ttname"><a href="misc_8h.html#a2918bca6e88a6f6a9908dfb2e4beea43">GET_USER_PASS_MANAGEMENT</a></div><div class="ttdeci">#define GET_USER_PASS_MANAGEMENT</div><div class="ttdef"><b>Definition:</b> <a href="misc_8h_source.html#l00116">misc.h:116</a></div></div>
<div class="ttc" id="asyshead_8h_html_a36b803e0123070cccb24a3fe98994b16"><div class="ttname"><a href="syshead_8h.html#a36b803e0123070cccb24a3fe98994b16">srandom</a></div><div class="ttdeci">#define srandom</div><div class="ttdef"><b>Definition:</b> <a href="syshead_8h_source.html#l00045">syshead.h:45</a></div></div>
<div class="ttc" id="astructopenvpn__sockaddr_html_afcdd41c2aad5907c7041ffdb59ed46aa"><div class="ttname"><a href="structopenvpn__sockaddr.html#afcdd41c2aad5907c7041ffdb59ed46aa">openvpn_sockaddr::in6</a></div><div class="ttdeci">struct sockaddr_in6 in6</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00070">socket.h:70</a></div></div>
<div class="ttc" id="astructconnection__entry_html"><div class="ttname"><a href="structconnection__entry.html">connection_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00093">options.h:93</a></div></div>
<div class="ttc" id="aplatform_8c_html_a9fa1294012cccd23c3d8145837883057"><div class="ttname"><a href="platform_8c.html#a9fa1294012cccd23c3d8145837883057">platform_group_set</a></div><div class="ttdeci">void platform_group_set(const struct platform_state_group *state)</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00130">platform.c:130</a></div></div>
<div class="ttc" id="amtu_8h_html_acffacbc0669bb2e42bdb97650c816db6"><div class="ttname"><a href="mtu_8h.html#acffacbc0669bb2e42bdb97650c816db6">EXPANDED_SIZE</a></div><div class="ttdeci">#define EXPANDED_SIZE(f)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00172">mtu.h:172</a></div></div>
<div class="ttc" id="ainit_8c_html_aef96518cac67bd66e99aec9550db581c"><div class="ttname"><a href="init_8c.html#aef96518cac67bd66e99aec9550db581c">do_inherit_env</a></div><div class="ttdeci">static void do_inherit_env(struct context *c, const struct env_set *src)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03814">init.c:3814</a></div></div>
<div class="ttc" id="amanage_8c_html_aa6413bcc39609b0f51090d792aea0454"><div class="ttname"><a href="manage_8c.html#aa6413bcc39609b0f51090d792aea0454">management_notify_generic</a></div><div class="ttdeci">void management_notify_generic(struct management *man, const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l02908">manage.c:2908</a></div></div>
<div class="ttc" id="asyshead_8h_html_a82b8e21bd452d01ad6d32a0d73fbfdc8"><div class="ttname"><a href="syshead_8h.html#a82b8e21bd452d01ad6d32a0d73fbfdc8">sleep</a></div><div class="ttdeci">#define sleep(x)</div><div class="ttdef"><b>Definition:</b> <a href="syshead_8h_source.html#l00043">syshead.h:43</a></div></div>
<div class="ttc" id="astructoptions_html_ad3572f352bd2aa332207cddfdc607ff4"><div class="ttname"><a href="structoptions.html#ad3572f352bd2aa332207cddfdc607ff4">options::routes_ipv6</a></div><div class="ttdeci">struct route_ipv6_option_list * routes_ipv6</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00384">options.h:384</a></div></div>
<div class="ttc" id="aoptions_8h_html_a71776ba017cdd19ee6cb174f683873e1"><div class="ttname"><a href="options_8h.html#a71776ba017cdd19ee6cb174f683873e1">OPT_P_SETENV</a></div><div class="ttdeci">#define OPT_P_SETENV</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00679">options.h:679</a></div></div>
<div class="ttc" id="atun_8h_html_ac24715b5227afea94ad3834341bf7b15"><div class="ttname"><a href="tun_8h.html#ac24715b5227afea94ad3834341bf7b15">route_order</a></div><div class="ttdeci">static int route_order(void)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00364">tun.h:364</a></div></div>
<div class="ttc" id="ainit_8c_html_a2d77fd4177bf5b5b4eb7914038c2d82b"><div class="ttname"><a href="init_8c.html#a2d77fd4177bf5b5b4eb7914038c2d82b">do_init_route_ipv6_list</a></div><div class="ttdeci">static void do_init_route_ipv6_list(const struct options *options, struct route_ipv6_list *route_ipv6_list, const struct link_socket_info *link_socket_info, struct env_set *es, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01537">init.c:1537</a></div></div>
<div class="ttc" id="astructoptions_html_a62716987c407e3768a60476bd1b6b908"><div class="ttname"><a href="structoptions.html#a62716987c407e3768a60476bd1b6b908">options::tls_exit</a></div><div class="ttdeci">bool tls_exit</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00632">options.h:632</a></div></div>
<div class="ttc" id="assl_8c_html_af75a6085c60ee6926f3000781e2089c3"><div class="ttname"><a href="ssl_8c.html#af75a6085c60ee6926f3000781e2089c3">show_available_tls_ciphers</a></div><div class="ttdeci">void show_available_tls_ciphers(const char *cipher_list, const char *cipher_list_tls13, const char *tls_cert_profile)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l03997">ssl.c:3997</a></div></div>
<div class="ttc" id="astructcontext__2_html_aa60bf2f20efb63adcd121d2d8abebd27"><div class="ttname"><a href="structcontext__2.html#aa60bf2f20efb63adcd121d2d8abebd27">context_2::occ_interval</a></div><div class="ttdeci">struct event_timeout occ_interval</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00318">openvpn.h:318</a></div></div>
<div class="ttc" id="amulti-auth_8c_html_a24e51cc1f9098289e2fe7317b7ab6b27"><div class="ttname"><a href="multi-auth_8c.html#a24e51cc1f9098289e2fe7317b7ab6b27">np</a></div><div class="ttdeci">static const char * np(const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="multi-auth_8c_source.html#l00145">multi-auth.c:145</a></div></div>
<div class="ttc" id="aautomatic_8c_html_a4da53ff46b740844b3dfb4025f6bbd09"><div class="ttname"><a href="automatic_8c.html#a4da53ff46b740844b3dfb4025f6bbd09">status</a></div><div class="ttdeci">static SERVICE_STATUS status</div><div class="ttdef"><b>Definition:</b> <a href="automatic_8c_source.html#l00043">automatic.c:43</a></div></div>
<div class="ttc" id="astructkey__schedule_html_ad2ce1d97a35d1c487ce7c13f52d900c5"><div class="ttname"><a href="structkey__schedule.html#ad2ce1d97a35d1c487ce7c13f52d900c5">key_schedule::tls_wrap_key</a></div><div class="ttdeci">struct key_ctx_bi tls_wrap_key</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00068">openvpn.h:68</a></div></div>
<div class="ttc" id="astructoptions_html_a358bbf5e604ead362690b34e147324e0"><div class="ttname"><a href="structoptions.html#a358bbf5e604ead362690b34e147324e0">options::route_noexec</a></div><div class="ttdeci">bool route_noexec</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00379">options.h:379</a></div></div>
<div class="ttc" id="ainit_8c_html_ae73a7779aedce66ab4e13e23bb856587"><div class="ttname"><a href="init_8c.html#ae73a7779aedce66ab4e13e23bb856587">do_init_socket_2</a></div><div class="ttdeci">static void do_init_socket_2(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03473">init.c:3473</a></div></div>
<div class="ttc" id="astructoptions_html_a74fd79cb23d82f4e47840ea1568aade3"><div class="ttname"><a href="structoptions.html#a74fd79cb23d82f4e47840ea1568aade3">options::tls_cert_profile</a></div><div class="ttdeci">const char * tls_cert_profile</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00560">options.h:560</a></div></div>
<div class="ttc" id="ainit_8c_html_a24ee82204efb10e4948c83b1cb1a4853"><div class="ttname"><a href="init_8c.html#a24ee82204efb10e4948c83b1cb1a4853">do_init_crypto_static</a></div><div class="ttdeci">static void do_init_crypto_static(struct context *c, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02579">init.c:2579</a></div></div>
<div class="ttc" id="aplugin_8h_html_aa1988b85df1aa0a7c628e038868e6d39"><div class="ttname"><a href="plugin_8h.html#aa1988b85df1aa0a7c628e038868e6d39">plugin_call</a></div><div class="ttdeci">static int plugin_call(const struct plugin_list *pl, const int type, const struct argv *av, struct plugin_return *pr, struct env_set *es)</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8h_source.html#l00202">plugin.h:202</a></div></div>
<div class="ttc" id="astructtls__options_html_ac372c2391af017e204af37a3e80596b4"><div class="ttname"><a href="structtls__options.html#ac372c2391af017e204af37a3e80596b4">tls_options::auth_token_generate</a></div><div class="ttdeci">bool auth_token_generate</div><div class="ttdoc">Generate auth-tokens on successful user/pass auth,seet via options-&gt;auth_token_generate.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00320">ssl_common.h:320</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a3f8b5429f1fb9bbefad3bef0be32ab80"><div class="ttname"><a href="errlevel_8h.html#a3f8b5429f1fb9bbefad3bef0be32ab80">D_RESTART</a></div><div class="ttdeci">#define D_RESTART</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00082">errlevel.h:82</a></div></div>
<div class="ttc" id="astructlink__socket_html_aef0ab7aed42bb525241ae838e98ce8cd"><div class="ttname"><a href="structlink__socket.html#aef0ab7aed42bb525241ae838e98ce8cd">link_socket::sd</a></div><div class="ttdeci">socket_descriptor_t sd</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00168">socket.h:168</a></div></div>
<div class="ttc" id="astructcontext__persist_html"><div class="ttname"><a href="structcontext__persist.html">context_persist</a></div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00118">openvpn.h:118</a></div></div>
<div class="ttc" id="astructoptions_html_ac6e1f16b4069b73fef030866606705bb"><div class="ttname"><a href="structoptions.html#ac6e1f16b4069b73fef030866606705bb">options::renegotiate_seconds</a></div><div class="ttdeci">int renegotiate_seconds</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00595">options.h:595</a></div></div>
<div class="ttc" id="amtu_8h_html_a9b846353f7034b285415993fd07b5f1d"><div class="ttname"><a href="mtu_8h.html#a9b846353f7034b285415993fd07b5f1d">frame_or_align_flags</a></div><div class="ttdeci">static void frame_or_align_flags(struct frame *frame, const unsigned int flag_mask)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00316">mtu.h:316</a></div></div>
<div class="ttc" id="astructcontext__0_html"><div class="ttname"><a href="structcontext__0.html">context_0</a></div><div class="ttdoc">Level 0 context containing information related to the OpenVPN process.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00133">openvpn.h:133</a></div></div>
<div class="ttc" id="astructcontext__1_html_a5fce2b35dc960bcdc0cab91b278048f7"><div class="ttname"><a href="structcontext__1.html#a5fce2b35dc960bcdc0cab91b278048f7">context_1::route_list</a></div><div class="ttdeci">struct route_list * route_list</div><div class="ttdoc">List of routing information.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00173">openvpn.h:173</a></div></div>
<div class="ttc" id="aoptions_8h_html_a8e032ec08d6a5385f64a7f57eafd06c0"><div class="ttname"><a href="options_8h.html#a8e032ec08d6a5385f64a7f57eafd06c0">PING_RESTART</a></div><div class="ttdeci">#define PING_RESTART</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00300">options.h:300</a></div></div>
<div class="ttc" id="astructcontext__2_html_a6e148857a12de912aef0d3476a85baea"><div class="ttname"><a href="structcontext__2.html#a6e148857a12de912aef0d3476a85baea">context_2::wait_for_connect</a></div><div class="ttdeci">struct event_timeout wait_for_connect</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00304">openvpn.h:304</a></div></div>
<div class="ttc" id="astructoptions_html_afdd8d36525c3ca430f3ae3986d968813"><div class="ttname"><a href="structoptions.html#afdd8d36525c3ca430f3ae3986d968813">options::persist_local_ip</a></div><div class="ttdeci">bool persist_local_ip</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00304">options.h:304</a></div></div>
<div class="ttc" id="astructtuntap_html_acfb3d1fb2ebdae626785a31156ec8bce"><div class="ttname"><a href="structtuntap.html#acfb3d1fb2ebdae626785a31156ec8bce">tuntap::actual_name</a></div><div class="ttdeci">char * actual_name</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00165">tun.h:165</a></div></div>
<div class="ttc" id="acrypto_8c_html_adf3eba101a6542db8464e0378d5fd08c"><div class="ttname"><a href="crypto_8c.html#adf3eba101a6542db8464e0378d5fd08c">test_crypto</a></div><div class="ttdeci">void test_crypto(struct crypto_options *co, struct frame *frame)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01078">crypto.c:1078</a></div></div>
<div class="ttc" id="aopenvpn_2basic_8h_html_ab0ba4dd6e237b96132c0a66be2fb3bc2"><div class="ttname"><a href="openvpn_2basic_8h.html#ab0ba4dd6e237b96132c0a66be2fb3bc2">CLEAR</a></div><div class="ttdeci">#define CLEAR(x)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2basic_8h_source.html#l00033">basic.h:33</a></div></div>
<div class="ttc" id="astructwin32__signal_html"><div class="ttname"><a href="structwin32__signal.html">win32_signal</a></div><div class="ttdef"><b>Definition:</b> <a href="win32_8h_source.html#l00149">win32.h:149</a></div></div>
<div class="ttc" id="agroup__control__processor_html_ga85674d980185b3f2923ae9540114289a"><div class="ttname"><a href="group__control__processor.html#ga85674d980185b3f2923ae9540114289a">tls_auth_standalone_finalize</a></div><div class="ttdeci">void tls_auth_standalone_finalize(struct tls_auth_standalone *tas, const struct frame *frame)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l01323">ssl.c:1323</a></div></div>
<div class="ttc" id="aoptions_8h_html_a77b419240a9cbc017fce0afa7613943d"><div class="ttname"><a href="options_8h.html#a77b419240a9cbc017fce0afa7613943d">OPT_P_SOCKBUF</a></div><div class="ttdeci">#define OPT_P_SOCKBUF</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00699">options.h:699</a></div></div>
<div class="ttc" id="ainit_8c_html_a05df1a443a6eac2dc6faa292fb433f27"><div class="ttname"><a href="init_8c.html#a05df1a443a6eac2dc6faa292fb433f27">do_init_first_time</a></div><div class="ttdeci">static void do_init_first_time(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03533">init.c:3533</a></div></div>
<div class="ttc" id="agroup__tls__crypt_html_ga24b342111241c5ea9c731de4aa66fcb2"><div class="ttname"><a href="group__tls__crypt.html#ga24b342111241c5ea9c731de4aa66fcb2">tls_crypt_adjust_frame_parameters</a></div><div class="ttdeci">void tls_crypt_adjust_frame_parameters(struct frame *frame)</div><div class="ttdoc">Adjust frame parameters for tls-crypt overhead.</div><div class="ttdef"><b>Definition:</b> <a href="tls__crypt_8c_source.html#l00098">tls_crypt.c:98</a></div></div>
<div class="ttc" id="astructoptions_html_a916e724576aa058a30902dc1c34862e8"><div class="ttname"><a href="structoptions.html#a916e724576aa058a30902dc1c34862e8">options::show_curves</a></div><div class="ttdeci">bool show_curves</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00237">options.h:237</a></div></div>
<div class="ttc" id="astructtls__auth__standalone_html_a72cf30b064c14558ff2e61212cc0c33c"><div class="ttname"><a href="structtls__auth__standalone.html#a72cf30b064c14558ff2e61212cc0c33c">tls_auth_standalone::frame</a></div><div class="ttdeci">struct frame frame</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00139">ssl.h:139</a></div></div>
<div class="ttc" id="astructconnection__list_html_a7ec9bc2e47f7ac458a6a1ae17d0cf304"><div class="ttname"><a href="structconnection__list.html#a7ec9bc2e47f7ac458a6a1ae17d0cf304">connection_list::len</a></div><div class="ttdeci">int len</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00168">options.h:168</a></div></div>
<div class="ttc" id="astructcontext_html_a8d609499dcba303c18f50ef7b648644c"><div class="ttname"><a href="structcontext.html#a8d609499dcba303c18f50ef7b648644c">context::c2</a></div><div class="ttdeci">struct context_2 c2</div><div class="ttdoc">Level 2 context.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00530">openvpn.h:530</a></div></div>
<div class="ttc" id="astructoptions_html_ab89e9276f4be407b43cda6d95b49226e"><div class="ttname"><a href="structoptions.html#ab89e9276f4be407b43cda6d95b49226e">options::cipher_list_tls13</a></div><div class="ttdeci">const char * cipher_list_tls13</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00558">options.h:558</a></div></div>
<div class="ttc" id="apool_8c_html_a350f1e7495ef028020d65513801516ad"><div class="ttname"><a href="pool_8c.html#a350f1e7495ef028020d65513801516ad">ifconfig_pool_persist_init</a></div><div class="ttdeci">struct ifconfig_pool_persist * ifconfig_pool_persist_init(const char *filename, int refresh_freq)</div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00555">pool.c:555</a></div></div>
<div class="ttc" id="acrypto_8c_html_a0605d1e78bd3bf4e23d99e039301f934"><div class="ttname"><a href="crypto_8c.html#a0605d1e78bd3bf4e23d99e039301f934">free_key_ctx_bi</a></div><div class="ttdeci">void free_key_ctx_bi(struct key_ctx_bi *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00908">crypto.c:908</a></div></div>
<div class="ttc" id="ainit_8c_html_ac17bc708447a380fa5284be8888411b0"><div class="ttname"><a href="init_8c.html#ac17bc708447a380fa5284be8888411b0">do_close_tun_simple</a></div><div class="ttdeci">static void do_close_tun_simple(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01977">init.c:1977</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_aab8b5b527fa4e3cdc68897cc57e01dac"><div class="ttname"><a href="errlevel_8h.html#aab8b5b527fa4e3cdc68897cc57e01dac">D_GENKEY</a></div><div class="ttdeci">#define D_GENKEY</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00079">errlevel.h:79</a></div></div>
<div class="ttc" id="astructoptions_html_a38f4b8bb967c7310eaaa3d77239f7780"><div class="ttname"><a href="structoptions.html#a38f4b8bb967c7310eaaa3d77239f7780">options::up_delay</a></div><div class="ttdeci">bool up_delay</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00331">options.h:331</a></div></div>
<div class="ttc" id="acrypto_8c_html_ab99dea190ad93a642a0fc5a429b8f0ed"><div class="ttname"><a href="crypto_8c.html#ab99dea190ad93a642a0fc5a429b8f0ed">prng_init</a></div><div class="ttdeci">void prng_init(const char *md_name, const int nonce_secret_len_parm)</div><div class="ttdoc">Pseudo-random number generator initialisation.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01711">crypto.c:1711</a></div></div>
<div class="ttc" id="agroup__control__processor_html_gad3c70b02a0ca4537fba1d53802e1e429"><div class="ttname"><a href="group__control__processor.html#gad3c70b02a0ca4537fba1d53802e1e429">TM_ACTIVE</a></div><div class="ttdeci">#define TM_ACTIVE</div><div class="ttdoc">Active tls_session.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00462">ssl_common.h:462</a></div></div>
<div class="ttc" id="astructtls__options_html_aba252683ca7cc18c66e8f30762f61ac0"><div class="ttname"><a href="structtls__options.html#aba252683ca7cc18c66e8f30762f61ac0">tls_options::ssl_ctx</a></div><div class="ttdeci">struct tls_root_ctx ssl_ctx</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00247">ssl_common.h:247</a></div></div>
<div class="ttc" id="ainit_8c_html_a0670147c5b4477a7b449df5dc36d1855"><div class="ttname"><a href="init_8c.html#a0670147c5b4477a7b449df5dc36d1855">do_init_route_list</a></div><div class="ttdeci">static void do_init_route_list(const struct options *options, struct route_list *route_list, const struct link_socket_info *link_socket_info, struct env_set *es, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01500">init.c:1500</a></div></div>
<div class="ttc" id="abuffer_8c_html_a06e0220403278399596a7a1b6b601fca"><div class="ttname"><a href="buffer_8c.html#a06e0220403278399596a7a1b6b601fca">string_alloc</a></div><div class="ttdeci">char * string_alloc(const char *str, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00665">buffer.c:665</a></div></div>
<div class="ttc" id="astructcontext__2_html_ad4aeb5d46c4a32dc490a124af2c0770a"><div class="ttname"><a href="structcontext__2.html#ad4aeb5d46c4a32dc490a124af2c0770a">context_2::gc</a></div><div class="ttdeci">struct gc_arena gc</div><div class="ttdoc">Garbage collection arena for allocations done in the level 2 scope of this context_2 structure.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00232">openvpn.h:232</a></div></div>
<div class="ttc" id="ainit_8c_html_a7e221190dbfc1c1cbd88ae2c834434f9"><div class="ttname"><a href="init_8c.html#a7e221190dbfc1c1cbd88ae2c834434f9">do_compute_occ_strings</a></div><div class="ttdeci">static void do_compute_occ_strings(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03499">init.c:3499</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a524bd17937bd36d74874af04eef7f131"><div class="ttname"><a href="structconnection__entry.html#a524bd17937bd36d74874af04eef7f131">connection_entry::socks_proxy_port</a></div><div class="ttdeci">const char * socks_proxy_port</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00111">options.h:111</a></div></div>
<div class="ttc" id="astructoptions_html_a055000dd88801bd1be2262bf8b447ec9"><div class="ttname"><a href="structoptions.html#a055000dd88801bd1be2262bf8b447ec9">options::resolve_in_advance</a></div><div class="ttdeci">bool resolve_in_advance</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00313">options.h:313</a></div></div>
<div class="ttc" id="asocket_8h_html_a9c4bfc3d8aeda3bb49d8d3897892f3ee"><div class="ttname"><a href="socket_8h.html#a9c4bfc3d8aeda3bb49d8d3897892f3ee">LS_MODE_DEFAULT</a></div><div class="ttdeci">#define LS_MODE_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00196">socket.h:196</a></div></div>
<div class="ttc" id="astructtls__wrap__ctx_html_a610411b7046f8b43a47cc92c0ef9bd6d"><div class="ttname"><a href="structtls__wrap__ctx.html#a610411b7046f8b43a47cc92c0ef9bd6d">tls_wrap_ctx::opt</a></div><div class="ttdeci">struct crypto_options opt</div><div class="ttdoc">Crypto state.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00230">ssl_common.h:230</a></div></div>
<div class="ttc" id="assl__verify_8h_html"><div class="ttname"><a href="ssl__verify_8h.html">ssl_verify.h</a></div></div>
<div class="ttc" id="astructoptions_html_a35d738ab294975825e2a299996d55c0e"><div class="ttname"><a href="structoptions.html#a35d738ab294975825e2a299996d55c0e">options::ifconfig_nowarn</a></div><div class="ttdeci">bool ifconfig_nowarn</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00273">options.h:273</a></div></div>
<div class="ttc" id="astructtls__options_html_a37f7ed366f2247399784d478243d2ce1"><div class="ttname"><a href="structtls__options.html#a37f7ed366f2247399784d478243d2ce1">tls_options::ekm_label_size</a></div><div class="ttdeci">size_t ekm_label_size</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00370">ssl_common.h:370</a></div></div>
<div class="ttc" id="astructoptions_html_af6b62b93b093f8c8a8f0aa326c510c11"><div class="ttname"><a href="structoptions.html#af6b62b93b093f8c8a8f0aa326c510c11">options::dev</a></div><div class="ttdeci">const char * dev</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00262">options.h:262</a></div></div>
<div class="ttc" id="astructconnection__list_html_a4c93ccd743bba6ee89f05abc2b3008b0"><div class="ttname"><a href="structconnection__list.html#a4c93ccd743bba6ee89f05abc2b3008b0">connection_list::current</a></div><div class="ttdeci">int current</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00169">options.h:169</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_aca68c0d4ac8df0838e209fb5300f7be3"><div class="ttname"><a href="openvpn_2error_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT</a></div><div class="ttdeci">#define ASSERT(x)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00218">error.h:218</a></div></div>
<div class="ttc" id="aopenvpn-plugin_8h_html_a15a8b3e16852174753e672fec722dbb3"><div class="ttname"><a href="openvpn-plugin_8h.html#a15a8b3e16852174753e672fec722dbb3">OPENVPN_PLUGIN_INIT_POST_DAEMON</a></div><div class="ttdeci">#define OPENVPN_PLUGIN_INIT_POST_DAEMON</div><div class="ttdef"><b>Definition:</b> <a href="openvpn-plugin_8h_source.html#l00845">openvpn-plugin.h:845</a></div></div>
<div class="ttc" id="astructtuntap_html_ab854704d9efd886f25b7a0083b0196c6"><div class="ttname"><a href="structtuntap.html#ab854704d9efd886f25b7a0083b0196c6">tuntap::local_ipv6</a></div><div class="ttdeci">struct in6_addr local_ipv6</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00174">tun.h:174</a></div></div>
<div class="ttc" id="astructoptions_html_a114de9e3d8ed4495e4fa53a771a2d5b4"><div class="ttname"><a href="structoptions.html#a114de9e3d8ed4495e4fa53a771a2d5b4">options::management_port</a></div><div class="ttdeci">const char * management_port</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00396">options.h:396</a></div></div>
<div class="ttc" id="astructtls__wrap__ctx_html_acc45bce786e0254c135835e42fc4ee94"><div class="ttname"><a href="structtls__wrap__ctx.html#acc45bce786e0254c135835e42fc4ee94">tls_wrap_ctx::tls_crypt_v2_server_key</a></div><div class="ttdeci">struct key_ctx tls_crypt_v2_server_key</div><div class="ttdoc">Decrypts client keys.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00232">ssl_common.h:232</a></div></div>
<div class="ttc" id="abuffer_8c_html_a41f2a5ee8d893ed30a214b2d70c5d303"><div class="ttname"><a href="buffer_8c.html#a41f2a5ee8d893ed30a214b2d70c5d303">string_clear</a></div><div class="ttdeci">void string_clear(char *str)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00707">buffer.c:707</a></div></div>
<div class="ttc" id="astructoptions_html_a505d7766d3e0af765edf710f2a69b3a9"><div class="ttname"><a href="structoptions.html#a505d7766d3e0af765edf710f2a69b3a9">options::rh_store</a></div><div class="ttdeci">struct remote_host_store * rh_store</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00258">options.h:258</a></div></div>
<div class="ttc" id="astructoptions_html_add57437239b837341d533dac68982743"><div class="ttname"><a href="structoptions.html#add57437239b837341d533dac68982743">options::groupname</a></div><div class="ttdeci">const char * groupname</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00320">options.h:320</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a09c9625c03392860c87ed0460cd475cd"><div class="ttname"><a href="errlevel_8h.html#a09c9625c03392860c87ed0460cd475cd">D_SHOW_OCC</a></div><div class="ttdeci">#define D_SHOW_OCC</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00097">errlevel.h:97</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a1e80ffa27efcd36772df7618004f2ddc"><div class="ttname"><a href="structconnection__entry.html#a1e80ffa27efcd36772df7618004f2ddc">connection_entry::connect_retry_seconds_max</a></div><div class="ttdeci">int connect_retry_seconds_max</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00107">options.h:107</a></div></div>
<div class="ttc" id="ainit_8c_html_a913cfd7844824eb629dc8d6920a6aef8"><div class="ttname"><a href="init_8c.html#a913cfd7844824eb629dc8d6920a6aef8">ce_management_query_remote</a></div><div class="ttdeci">static bool ce_management_query_remote(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00382">init.c:382</a></div></div>
<div class="ttc" id="asocket_8h_html_a50ea4ad26d16eec29ff9685126f0a599a4f54544a7b77bc839a23e1124f7e9c95"><div class="ttname"><a href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599a4f54544a7b77bc839a23e1124f7e9c95">PROTO_TCP_CLIENT</a></div><div class="ttdeci">@ PROTO_TCP_CLIENT</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00577">socket.h:577</a></div></div>
<div class="ttc" id="astructoptions_html_a4d6d794acedbb97bff36ed663408f55b"><div class="ttname"><a href="structoptions.html#a4d6d794acedbb97bff36ed663408f55b">options::single_session</a></div><div class="ttdeci">bool single_session</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00628">options.h:628</a></div></div>
<div class="ttc" id="astructoptions_html_a80357ca49c6ac35d1ff5c621bd66ac96"><div class="ttname"><a href="structoptions.html#a80357ca49c6ac35d1ff5c621bd66ac96">options::auth_user_pass_file</a></div><div class="ttdeci">const char * auth_user_pass_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00506">options.h:506</a></div></div>
<div class="ttc" id="aoptions_8h_html_abff23e3641208e00e513e5b240b42d00"><div class="ttname"><a href="options_8h.html#abff23e3641208e00e513e5b240b42d00">PULL_DEFINED</a></div><div class="ttdeci">#define PULL_DEFINED(opt)</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00708">options.h:708</a></div></div>
<div class="ttc" id="astructkey__schedule_html_a5e59f0aab5d757ed334039b15682829a"><div class="ttname"><a href="structkey__schedule.html#a5e59f0aab5d757ed334039b15682829a">key_schedule::ssl_ctx</a></div><div class="ttdeci">struct tls_root_ctx ssl_ctx</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00064">openvpn.h:64</a></div></div>
<div class="ttc" id="astructlink__socket__actual_html"><div class="ttname"><a href="structlink__socket__actual.html">link_socket_actual</a></div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00085">socket.h:85</a></div></div>
<div class="ttc" id="astructtls__options_html_a82f79817c7b40b932af6074ab2ae6248"><div class="ttname"><a href="structtls__options.html#a82f79817c7b40b932af6074ab2ae6248">tls_options::ekm_label</a></div><div class="ttdeci">const char * ekm_label</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00369">ssl_common.h:369</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_a9cbbade2b528fe5d1e6ae65bbaf1e765"><div class="ttname"><a href="crypto__backend_8h.html#a9cbbade2b528fe5d1e6ae65bbaf1e765">md_kt_get</a></div><div class="ttdeci">const md_kt_t * md_kt_get(const char *digest)</div><div class="ttdoc">Return message digest parameters, based on the given digest name.</div><div class="ttdef"><b>Definition:</b> <a href="crypto__openssl_8c_source.html#l00952">crypto_openssl.c:952</a></div></div>
<div class="ttc" id="astructtls__options_html_a565a61d1fe9209be7fe0c41940a46126"><div class="ttname"><a href="structtls__options.html#a565a61d1fe9209be7fe0c41940a46126">tls_options::verify_export_cert</a></div><div class="ttdeci">const char * verify_export_cert</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00279">ssl_common.h:279</a></div></div>
<div class="ttc" id="aopenvpn_8h_html_ab31447bc2ad9819e323c5795af28e93e"><div class="ttname"><a href="openvpn_8h.html#ab31447bc2ad9819e323c5795af28e93e">CM_CHILD_TCP</a></div><div class="ttdeci">#define CM_CHILD_TCP</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00502">openvpn.h:502</a></div></div>
<div class="ttc" id="astructkey__schedule_html_afc58d93e9c900d3bd001a8ee09f0932c"><div class="ttname"><a href="structkey__schedule.html#afc58d93e9c900d3bd001a8ee09f0932c">key_schedule::tls_crypt_v2_server_key</a></div><div class="ttdeci">struct key_ctx tls_crypt_v2_server_key</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00069">openvpn.h:69</a></div></div>
<div class="ttc" id="astructconnection__list_html"><div class="ttname"><a href="structconnection__list.html">connection_list</a></div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00166">options.h:166</a></div></div>
<div class="ttc" id="astructcontext_html_ad2b1fffbd57d0ba779aa9b5ef8a9c78d"><div class="ttname"><a href="structcontext.html#ad2b1fffbd57d0ba779aa9b5ef8a9c78d">context::gc</a></div><div class="ttdeci">struct gc_arena gc</div><div class="ttdoc">Garbage collection arena for allocations done in the scope of this context structure.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00508">openvpn.h:508</a></div></div>
<div class="ttc" id="aroute_8h_html_ab07d6bb8e6ac70ec4345c4790b2f7945"><div class="ttname"><a href="route_8h.html#ab07d6bb8e6ac70ec4345c4790b2f7945">RG_REROUTE_GW</a></div><div class="ttdeci">#define RG_REROUTE_GW</div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00089">route.h:89</a></div></div>
<div class="ttc" id="aopenvpn-plugin_8h_html_a2633a7eaf3979e6f4c02480284e9f7ad"><div class="ttname"><a href="openvpn-plugin_8h.html#a2633a7eaf3979e6f4c02480284e9f7ad">OPENVPN_PLUGIN_INIT_PRE_DAEMON</a></div><div class="ttdeci">#define OPENVPN_PLUGIN_INIT_PRE_DAEMON</div><div class="ttdef"><b>Definition:</b> <a href="openvpn-plugin_8h_source.html#l00844">openvpn-plugin.h:844</a></div></div>
<div class="ttc" id="aping_8h_html"><div class="ttname"><a href="ping_8h.html">ping.h</a></div></div>
<div class="ttc" id="astructoptions_html_acee62ed6d25e482506731cada8f1ecaa"><div class="ttname"><a href="structoptions.html#acee62ed6d25e482506731cada8f1ecaa">options::ping_send_timeout</a></div><div class="ttdeci">int ping_send_timeout</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00294">options.h:294</a></div></div>
<div class="ttc" id="astructtls__options_html_a4ea8b33ebbb1783522d2f500ea21b6b7"><div class="ttname"><a href="structtls__options.html#a4ea8b33ebbb1783522d2f500ea21b6b7">tls_options::net_ctx</a></div><div class="ttdeci">openvpn_net_ctx_t * net_ctx</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00333">ssl_common.h:333</a></div></div>
<div class="ttc" id="astructtls__options_html"><div class="ttname"><a href="structtls__options.html">tls_options</a></div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00244">ssl_common.h:244</a></div></div>
<div class="ttc" id="apacket__id_8c_html_a1a1b4689057b6361657f57fe65bd4f93"><div class="ttname"><a href="packet__id_8c.html#a1a1b4689057b6361657f57fe65bd4f93">packet_id_persist_save</a></div><div class="ttdeci">void packet_id_persist_save(struct packet_id_persist *p)</div><div class="ttdef"><b>Definition:</b> <a href="packet__id_8c_source.html#l00482">packet_id.c:482</a></div></div>
<div class="ttc" id="astructcontext__2_html_ad0ae63ac896195c2b4ae39385262b0c6"><div class="ttname"><a href="structcontext__2.html#ad0ae63ac896195c2b4ae39385262b0c6">context_2::event_set_max</a></div><div class="ttdeci">int event_set_max</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00238">openvpn.h:238</a></div></div>
<div class="ttc" id="astructtls__options_html_aa89186ad01664f682492681829e7fffa"><div class="ttname"><a href="structtls__options.html#aa89186ad01664f682492681829e7fffa">tls_options::x509_track</a></div><div class="ttdeci">const struct x509_track * x509_track</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00359">ssl_common.h:359</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a542de1000e6bc3b78b863494e9a033d4"><div class="ttname"><a href="openvpn_2error_8h.html#a542de1000e6bc3b78b863494e9a033d4">dmsg</a></div><div class="ttdeci">#define dmsg</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00171">error.h:171</a></div></div>
<div class="ttc" id="aoptions_8h_html_a54e37a6d99074717a43aa65d8b1b2e83"><div class="ttname"><a href="options_8h.html#a54e37a6d99074717a43aa65d8b1b2e83">CE_MAN_QUERY_REMOTE_SKIP</a></div><div class="ttdeci">#define CE_MAN_QUERY_REMOTE_SKIP</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00136">options.h:136</a></div></div>
<div class="ttc" id="astructoptions_html_ac34bf3412bfd7f1c7185e08c3e6d212c"><div class="ttname"><a href="structoptions.html#ac34bf3412bfd7f1c7185e08c3e6d212c">options::x509_track</a></div><div class="ttdeci">const struct x509_track * x509_track</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00634">options.h:634</a></div></div>
<div class="ttc" id="astructoptions_html_adc91b041f69645c8b89b68857441a126"><div class="ttname"><a href="structoptions.html#adc91b041f69645c8b89b68857441a126">options::windows_driver</a></div><div class="ttdeci">enum windows_driver_type windows_driver</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00646">options.h:646</a></div></div>
<div class="ttc" id="asocket_8c_html_a86424bdc75e8f05f00a649f30f897110"><div class="ttname"><a href="socket_8c.html#a86424bdc75e8f05f00a649f30f897110">proto_is_udp</a></div><div class="ttdeci">bool proto_is_udp(int proto)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l03204">socket.c:3204</a></div></div>
<div class="ttc" id="ainit_8c_html_a0614ef4b7979dcbd99edf1b4bf6b3226"><div class="ttname"><a href="init_8c.html#a0614ef4b7979dcbd99edf1b4bf6b3226">do_init_auth_token_key</a></div><div class="ttdeci">static void do_init_auth_token_key(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02701">init.c:2701</a></div></div>
<div class="ttc" id="astructcontext__1_html_a3f08fbd0447517dc9fefa3e1a30fa26f"><div class="ttname"><a href="structcontext__1.html#a3f08fbd0447517dc9fefa3e1a30fa26f">context_1::link_socket_addr</a></div><div class="ttdeci">struct link_socket_addr link_socket_addr</div><div class="ttdoc">Local and remote addresses on the external network.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00155">openvpn.h:155</a></div></div>
<div class="ttc" id="astructhttp__proxy__options_html_ab231c657d09bf5f0842af2d408dc3135"><div class="ttname"><a href="structhttp__proxy__options.html#ab231c657d09bf5f0842af2d408dc3135">http_proxy_options::auth_retry</a></div><div class="ttdeci">int auth_retry</div><div class="ttdef"><b>Definition:</b> <a href="proxy_8h_source.html#l00051">proxy.h:51</a></div></div>
<div class="ttc" id="astructoptions_html_ac48b53dbc67f66cf7ce1fe1b874d41a8"><div class="ttname"><a href="structoptions.html#ac48b53dbc67f66cf7ce1fe1b874d41a8">options::shared_secret_file_inline</a></div><div class="ttdeci">bool shared_secret_file_inline</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00518">options.h:518</a></div></div>
<div class="ttc" id="ainit_8c_html_ae6bf15962c96c4c75cec9baa6a20dc6a"><div class="ttname"><a href="init_8c.html#ae6bf15962c96c4c75cec9baa6a20dc6a">init_proxy</a></div><div class="ttdeci">static void init_proxy(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00661">init.c:661</a></div></div>
<div class="ttc" id="astructoptions_html_af7407032e284318f3db14785298b4978"><div class="ttname"><a href="structoptions.html#af7407032e284318f3db14785298b4978">options::management_client_group</a></div><div class="ttdeci">const char * management_client_group</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00404">options.h:404</a></div></div>
<div class="ttc" id="ainit_8c_html_a5bf221a89c0561061bd91985797fa61c"><div class="ttname"><a href="init_8c.html#a5bf221a89c0561061bd91985797fa61c">do_link_socket_new</a></div><div class="ttdeci">static void do_link_socket_new(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03415">init.c:3415</a></div></div>
<div class="ttc" id="astructopenvpn__sockaddr_html_abc5254db5ef7e60854146a476054abe1"><div class="ttname"><a href="structopenvpn__sockaddr.html#abc5254db5ef7e60854146a476054abe1">openvpn_sockaddr::sa</a></div><div class="ttdeci">struct sockaddr sa</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00068">socket.h:68</a></div></div>
<div class="ttc" id="astructkey__schedule_html_a6a3add124db00336ab5c081037ae11fd"><div class="ttname"><a href="structkey__schedule.html#a6a3add124db00336ab5c081037ae11fd">key_schedule::tls_auth_key_type</a></div><div class="ttdeci">struct key_type tls_auth_key_type</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00067">openvpn.h:67</a></div></div>
<div class="ttc" id="aroute_8c_html_ad9d57454e8a9b7be1617447068f98e58"><div class="ttname"><a href="route_8c.html#ad9d57454e8a9b7be1617447068f98e58">delete_routes</a></div><div class="ttdeci">void delete_routes(struct route_list *rl, struct route_ipv6_list *rl6, const struct tuntap *tt, unsigned int flags, const struct env_set *es, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="route_8c_source.html#l01257">route.c:1257</a></div></div>
<div class="ttc" id="astructcontext_html_ab86d3cd4769ad44ed77c04c13c5382fb"><div class="ttname"><a href="structcontext.html#ab86d3cd4769ad44ed77c04c13c5382fb">context::plugins_owned</a></div><div class="ttdeci">bool plugins_owned</div><div class="ttdoc">Whether the plug-ins should be cleaned up when this context is cleaned up.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00519">openvpn.h:519</a></div></div>
<div class="ttc" id="astructoptions_html_a38d22a55bf92acf99f3c5d71d3b06b18"><div class="ttname"><a href="structoptions.html#a38d22a55bf92acf99f3c5d71d3b06b18">options::test_crypto</a></div><div class="ttdeci">bool test_crypto</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00536">options.h:536</a></div></div>
<div class="ttc" id="ainit_8c_html_a0f041f00626bbc71b047bcf4c63c4053"><div class="ttname"><a href="init_8c.html#a0f041f00626bbc71b047bcf4c63c4053">open_plugins</a></div><div class="ttdeci">void open_plugins(struct context *c, const bool import_options, int init_point)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03895">init.c:3895</a></div></div>
<div class="ttc" id="astructoptions_html_a6219cb24a270ee88506cee919c504e7f"><div class="ttname"><a href="structoptions.html#a6219cb24a270ee88506cee919c504e7f">options::block_outside_dns</a></div><div class="ttdeci">bool block_outside_dns</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00645">options.h:645</a></div></div>
<div class="ttc" id="astructtls__options_html_a647ce1910e6a305011105ef5209c4969"><div class="ttname"><a href="structtls__options.html#a647ce1910e6a305011105ef5209c4969">tls_options::x509_username_field</a></div><div class="ttdeci">char * x509_username_field</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00289">ssl_common.h:289</a></div></div>
<div class="ttc" id="astructkey__schedule_html"><div class="ttname"><a href="structkey__schedule.html">key_schedule</a></div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00055">openvpn.h:55</a></div></div>
<div class="ttc" id="astructcontext__1_html_af266db9e924917e0dab9ca0f01259df1"><div class="ttname"><a href="structcontext__1.html#af266db9e924917e0dab9ca0f01259df1">context_1::socks_proxy</a></div><div class="ttdeci">struct socks_proxy_info * socks_proxy</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00189">openvpn.h:189</a></div></div>
<div class="ttc" id="aoptions_8h_html_a708675a9e8c44cab01e4e73e1a12449d"><div class="ttname"><a href="options_8h.html#a708675a9e8c44cab01e4e73e1a12449d">OPT_P_MESSAGES</a></div><div class="ttdeci">#define OPT_P_MESSAGES</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00685">options.h:685</a></div></div>
<div class="ttc" id="amtu_8h_html_a96b361bbecbb496904fc6bc54b488cec"><div class="ttname"><a href="mtu_8h.html#a96b361bbecbb496904fc6bc54b488cec">FRAME_HEADROOM_MARKER_READ_STREAM</a></div><div class="ttdeci">#define FRAME_HEADROOM_MARKER_READ_STREAM</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00132">mtu.h:132</a></div></div>
<div class="ttc" id="astructoptions_html_afdb01c0cc7766b1e0320f3374123ecc9"><div class="ttname"><a href="structoptions.html#afdb01c0cc7766b1e0320f3374123ecc9">options::ifconfig_ipv6_netbits</a></div><div class="ttdeci">int ifconfig_ipv6_netbits</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00270">options.h:270</a></div></div>
<div class="ttc" id="astructoptions_html_a7c186af1daae850bf1f44d5534de11d1"><div class="ttname"><a href="structoptions.html#a7c186af1daae850bf1f44d5534de11d1">options::ncp_ciphers</a></div><div class="ttdeci">const char * ncp_ciphers</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00524">options.h:524</a></div></div>
<div class="ttc" id="astructkey__schedule_html_a4a34faf7867d3d6647238e914324a99b"><div class="ttname"><a href="structkey__schedule.html#a4a34faf7867d3d6647238e914324a99b">key_schedule::key_type</a></div><div class="ttdeci">struct key_type key_type</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00058">openvpn.h:58</a></div></div>
<div class="ttc" id="aoptions_8h_html_a9bbcdd61c5d7af6f9a03509fc609be47"><div class="ttname"><a href="options_8h.html#a9bbcdd61c5d7af6f9a03509fc609be47">OPT_P_PULL_MODE</a></div><div class="ttdeci">#define OPT_P_PULL_MODE</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00697">options.h:697</a></div></div>
<div class="ttc" id="astructoptions_html_a0fa2c5ba57c9ffb4a898bafc3725e88f"><div class="ttname"><a href="structoptions.html#a0fa2c5ba57c9ffb4a898bafc3725e88f">options::persist_config</a></div><div class="ttdeci">bool persist_config</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00229">options.h:229</a></div></div>
<div class="ttc" id="assl_8c_html_abe608677ee7a8169f4d3402444fa1cd0"><div class="ttname"><a href="ssl_8c.html#abe608677ee7a8169f4d3402444fa1cd0">init_ssl_lib</a></div><div class="ttdeci">void init_ssl_lib(void)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l00338">ssl.c:338</a></div></div>
<div class="ttc" id="astructoptions_html_a87af131c4385d6b8a37ef36a6679abfc"><div class="ttname"><a href="structoptions.html#a87af131c4385d6b8a37ef36a6679abfc">options::auth_token_lifetime</a></div><div class="ttdeci">int auth_token_lifetime</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00492">options.h:492</a></div></div>
<div class="ttc" id="aoptions_8h_html_a26a848845f907c37083e983c6d77ba32"><div class="ttname"><a href="options_8h.html#a26a848845f907c37083e983c6d77ba32">OPT_P_NCP</a></div><div class="ttdeci">#define OPT_P_NCP</div><div class="ttdoc">Negotiable crypto parameters.</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00686">options.h:686</a></div></div>
<div class="ttc" id="astructtls__options_html_aba4fa26785baef6cf8f3d2a059c21329"><div class="ttname"><a href="structtls__options.html#aba4fa26785baef6cf8f3d2a059c21329">tls_options::auth_user_pass_verify_script_via_file</a></div><div class="ttdeci">bool auth_user_pass_verify_script_via_file</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00316">ssl_common.h:316</a></div></div>
<div class="ttc" id="astructopenvpn__sockaddr_html_ae8fa2e6454c8c93b86eda19abca112b3"><div class="ttname"><a href="structopenvpn__sockaddr.html#ae8fa2e6454c8c93b86eda19abca112b3">openvpn_sockaddr::in4</a></div><div class="ttdeci">struct sockaddr_in in4</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00069">socket.h:69</a></div></div>
<div class="ttc" id="aplugin_8c_html_a00747562aa2ff073488786a85055edd2"><div class="ttname"><a href="plugin_8c.html#a00747562aa2ff073488786a85055edd2">plugin_list_close</a></div><div class="ttdeci">void plugin_list_close(struct plugin_list *pl)</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8c_source.html#l00905">plugin.c:905</a></div></div>
<div class="ttc" id="aotime_8h_html_ab47928897d13fd5569f20f0f8d068ce0"><div class="ttname"><a href="otime_8h.html#ab47928897d13fd5569f20f0f8d068ce0">update_time</a></div><div class="ttdeci">static void update_time(void)</div><div class="ttdef"><b>Definition:</b> <a href="otime_8h_source.html#l00094">otime.h:94</a></div></div>
<div class="ttc" id="astructoptions_html_a17009cf5cdc04448103ca126317d5af7"><div class="ttname"><a href="structoptions.html#a17009cf5cdc04448103ca126317d5af7">options::push_peer_info</a></div><div class="ttdeci">bool push_peer_info</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00630">options.h:630</a></div></div>
<div class="ttc" id="awin32_8c_html_abdad40a6ab180595222dd02c48ab7d5d"><div class="ttname"><a href="win32_8c.html#abdad40a6ab180595222dd02c48ab7d5d">win_wfp_block_dns</a></div><div class="ttdeci">bool win_wfp_block_dns(const NET_IFINDEX index, const HANDLE msg_channel)</div><div class="ttdef"><b>Definition:</b> <a href="win32_8c_source.html#l01330">win32.c:1330</a></div></div>
<div class="ttc" id="astructcontext__buffers_html"><div class="ttname"><a href="structcontext__buffers.html">context_buffers</a></div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00092">openvpn.h:92</a></div></div>
<div class="ttc" id="ainit_8c_html_a8578b737da354d6ddd938b9b7d5dd89f"><div class="ttname"><a href="init_8c.html#a8578b737da354d6ddd938b9b7d5dd89f">do_open_tun</a></div><div class="ttdeci">static bool do_open_tun(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01784">init.c:1784</a></div></div>
<div class="ttc" id="astructtuntap_html_a7efedc501b62607f297aeee8b839c7c8"><div class="ttname"><a href="structtuntap.html#a7efedc501b62607f297aeee8b839c7c8">tuntap::options</a></div><div class="ttdeci">struct tuntap_options options</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00163">tun.h:163</a></div></div>
<div class="ttc" id="amtu_8h_html_a551c5fa35eafecb8d7451cc643f889a1"><div class="ttname"><a href="mtu_8h.html#a551c5fa35eafecb8d7451cc643f889a1">FRAME_HEADROOM_MARKER_FRAGMENT</a></div><div class="ttdeci">#define FRAME_HEADROOM_MARKER_FRAGMENT</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00130">mtu.h:130</a></div></div>
<div class="ttc" id="astructtls__options_html_ad0558f94c9b567224214fdee59844be6"><div class="ttname"><a href="structtls__options.html#ad0558f94c9b567224214fdee59844be6">tls_options::push_peer_info_detail</a></div><div class="ttdeci">int push_peer_info_detail</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00269">ssl_common.h:269</a></div></div>
<div class="ttc" id="assl__backend_8h_html_a8a8bcdcde91147e4138bc85510f22595"><div class="ttname"><a href="ssl__backend_8h.html#a8a8bcdcde91147e4138bc85510f22595">tls_ctx_initialised</a></div><div class="ttdeci">bool tls_ctx_initialised(struct tls_root_ctx *ctx)</div><div class="ttdoc">Checks whether the given TLS context is initialised.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__openssl_8c_source.html#l00179">ssl_openssl.c:179</a></div></div>
<div class="ttc" id="astructtls__options_html_ac316f151e832d8d58f7e4601a56d8ec2"><div class="ttname"><a href="structtls__options.html#ac316f151e832d8d58f7e4601a56d8ec2">tls_options::ssl_flags</a></div><div class="ttdeci">unsigned int ssl_flags</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00353">ssl_common.h:353</a></div></div>
<div class="ttc" id="astructtls__multi_html_a6cd0005716f05da0398d85f6f1693e5d"><div class="ttname"><a href="structtls__multi.html#a6cd0005716f05da0398d85f6f1693e5d">tls_multi::opt</a></div><div class="ttdeci">struct tls_options opt</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00516">ssl_common.h:516</a></div></div>
<div class="ttc" id="astructoptions_html_a55380b90dad74714c58db877537238ee"><div class="ttname"><a href="structoptions.html#a55380b90dad74714c58db877537238ee">options::tls_crypt_v2_file</a></div><div class="ttdeci">const char * tls_crypt_v2_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00620">options.h:620</a></div></div>
<div class="ttc" id="ainit_8h_html"><div class="ttname"><a href="init_8h.html">init.h</a></div></div>
<div class="ttc" id="astructcontext_html_a4562924ba33d42c7c84399bc61e5634b"><div class="ttname"><a href="structcontext.html#a4562924ba33d42c7c84399bc61e5634b">context::first_time</a></div><div class="ttdeci">bool first_time</div><div class="ttdoc">True on the first iteration of OpenVPN's main loop.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00494">openvpn.h:494</a></div></div>
<div class="ttc" id="aplugin_8c_html_a50c37cf828ed5be882f932207ee74d3d"><div class="ttname"><a href="plugin_8c.html#a50c37cf828ed5be882f932207ee74d3d">plugin_return_free</a></div><div class="ttdeci">void plugin_return_free(struct plugin_return *pr)</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8c_source.html#l01023">plugin.c:1023</a></div></div>
<div class="ttc" id="abuffer_8c_html_ad797dd5e6257e3f4f4b4e7394dc2dfa9"><div class="ttname"><a href="buffer_8c.html#ad797dd5e6257e3f4f4b4e7394dc2dfa9">buffer_list_push</a></div><div class="ttdeci">void buffer_list_push(struct buffer_list *ol, const char *str)</div><div class="ttdoc">Allocates and appends a new buffer containing str as data to ol.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l01235">buffer.c:1235</a></div></div>
<div class="ttc" id="astructcontext__2_html_a6ff63ee9b82d8fa423db071e6fa0fa7e"><div class="ttname"><a href="structcontext__2.html#a6ff63ee9b82d8fa423db071e6fa0fa7e">context_2::shaper</a></div><div class="ttdeci">struct shaper shaper</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00282">openvpn.h:282</a></div></div>
<div class="ttc" id="ainit_8c_html_ae773083a33804e90cfcc72aadf5900c2"><div class="ttname"><a href="init_8c.html#ae773083a33804e90cfcc72aadf5900c2">init_management_callback_p2p</a></div><div class="ttdeci">void init_management_callback_p2p(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04017">init.c:4017</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_ad92889d868bb18d919c8965fc4b05436"><div class="ttname"><a href="crypto__backend_8h.html#ad92889d868bb18d919c8965fc4b05436">md_ctx_cleanup</a></div><div class="ttdeci">void md_ctx_cleanup(md_ctx_t *ctx)</div></div>
<div class="ttc" id="astructoptions_html_a286bfe71ee1acdb5108cab1e1ebd2197"><div class="ttname"><a href="structoptions.html#a286bfe71ee1acdb5108cab1e1ebd2197">options::management_state_buffer_size</a></div><div class="ttdeci">int management_state_buffer_size</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00400">options.h:400</a></div></div>
<div class="ttc" id="aoptions_8h_html_a7d9b7e8d8f0f60e0bbe4b2dbd2cf6dfa"><div class="ttname"><a href="options_8h.html#a7d9b7e8d8f0f60e0bbe4b2dbd2cf6dfa">CE_MAN_QUERY_REMOTE_MASK</a></div><div class="ttdeci">#define CE_MAN_QUERY_REMOTE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00137">options.h:137</a></div></div>
<div class="ttc" id="astructremote__host__store_html_ab6854214ebc227e7b7bb7c326e20b8ea"><div class="ttname"><a href="structremote__host__store.html#ab6854214ebc227e7b7bb7c326e20b8ea">remote_host_store::host</a></div><div class="ttdeci">char host[RH_HOST_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00197">options.h:197</a></div></div>
<div class="ttc" id="aoptions_8h_html_abdb8e8245d2cc5900fb064c5f371a5e9"><div class="ttname"><a href="options_8h.html#abdb8e8245d2cc5900fb064c5f371a5e9">CE_MAN_QUERY_REMOTE_ACCEPT</a></div><div class="ttdeci">#define CE_MAN_QUERY_REMOTE_ACCEPT</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00134">options.h:134</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_ad17a45f62ba6f3c0949d434a66ccb20a"><div class="ttname"><a href="openvpn_2error_8h.html#ad17a45f62ba6f3c0949d434a66ccb20a">M_WARN</a></div><div class="ttdeci">#define M_WARN</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00093">error.h:93</a></div></div>
<div class="ttc" id="astructplugin__return_html_a2c31b3d20cc9722ebc5ac6721f8970c0"><div class="ttname"><a href="structplugin__return.html#a2c31b3d20cc9722ebc5ac6721f8970c0">plugin_return::n</a></div><div class="ttdeci">int n</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8h_source.html#l00103">plugin.h:103</a></div></div>
<div class="ttc" id="ainit_8c_html_a2cddf7b7e6402aa02311c949ec0dd51c"><div class="ttname"><a href="init_8c.html#a2cddf7b7e6402aa02311c949ec0dd51c">close_instance</a></div><div class="ttdeci">void close_instance(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04463">init.c:4463</a></div></div>
<div class="ttc" id="astructoptions_html_aa5a53a81882886ed763b33d6db6050e4"><div class="ttname"><a href="structoptions.html#aa5a53a81882886ed763b33d6db6050e4">options::persist_tun</a></div><div class="ttdeci">bool persist_tun</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00303">options.h:303</a></div></div>
<div class="ttc" id="aplugin_8c_html_a98055daf2064644886f6e10ad61ea123"><div class="ttname"><a href="plugin_8c.html#a98055daf2064644886f6e10ad61ea123">plugin_list_inherit</a></div><div class="ttdeci">struct plugin_list * plugin_list_inherit(const struct plugin_list *src)</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8c_source.html#l00697">plugin.c:697</a></div></div>
<div class="ttc" id="astructconnection__entry_html_ac874d736329eb6f60ab54e86e4f7c4ef"><div class="ttname"><a href="structconnection__entry.html#ac874d736329eb6f60ab54e86e4f7c4ef">connection_entry::tls_auth_file</a></div><div class="ttdeci">const char * tls_auth_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00142">options.h:142</a></div></div>
<div class="ttc" id="ainit_8c_html_a09027bba2ec659835b859d8b4b54bc58"><div class="ttname"><a href="init_8c.html#a09027bba2ec659835b859d8b4b54bc58">management_callback_remote_cmd</a></div><div class="ttdeci">static bool management_callback_remote_cmd(void *arg, const char **p)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00335">init.c:335</a></div></div>
<div class="ttc" id="aoptions_8h_html_a597219fb09dfab423bc377b99b01a77c"><div class="ttname"><a href="options_8h.html#a597219fb09dfab423bc377b99b01a77c">OPT_P_SHAPER</a></div><div class="ttdeci">#define OPT_P_SHAPER</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00680">options.h:680</a></div></div>
<div class="ttc" id="astructoptions_html_add35f7d415b4722cb856774cc959dc52"><div class="ttname"><a href="structoptions.html#add35f7d415b4722cb856774cc959dc52">options::tls_crypt_v2_file_inline</a></div><div class="ttdeci">bool tls_crypt_v2_file_inline</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00621">options.h:621</a></div></div>
<div class="ttc" id="abuffer_8h_html_ab4491b7f3124ff7b050e37c38c2e620b"><div class="ttname"><a href="buffer_8h.html#ab4491b7f3124ff7b050e37c38c2e620b">ALLOC_OBJ_CLEAR_GC</a></div><div class="ttdeci">#define ALLOC_OBJ_CLEAR_GC(dptr, type, gc)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l01096">buffer.h:1096</a></div></div>
<div class="ttc" id="ainit_8c_html_a164331d37fecc9ad095eae0e8dce53de"><div class="ttname"><a href="init_8c.html#a164331d37fecc9ad095eae0e8dce53de">init_verb_mute</a></div><div class="ttdeci">void init_verb_mute(struct context *c, unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01029">init.c:1029</a></div></div>
<div class="ttc" id="amanage_8c_html_af404c50872c1c08a98f9908adef8bab8"><div class="ttname"><a href="manage_8c.html#af404c50872c1c08a98f9908adef8bab8">management_init</a></div><div class="ttdeci">struct management * management_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l02651">manage.c:2651</a></div></div>
<div class="ttc" id="astructtuntap_html_a48cab9dc4b56bf88d7ffb7f399d63942"><div class="ttname"><a href="structtuntap.html#a48cab9dc4b56bf88d7ffb7f399d63942">tuntap::adapter_index</a></div><div class="ttdeci">DWORD adapter_index</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00193">tun.h:193</a></div></div>
<div class="ttc" id="aopenvpn-plugin_8h_html_aeb5659c51304475fa68449bc4c4f98fd"><div class="ttname"><a href="openvpn-plugin_8h.html#aeb5659c51304475fa68449bc4c4f98fd">OPENVPN_PLUGIN_ROUTE_UP</a></div><div class="ttdeci">#define OPENVPN_PLUGIN_ROUTE_UP</div><div class="ttdef"><b>Definition:</b> <a href="openvpn-plugin_8h_source.html#l00122">openvpn-plugin.h:122</a></div></div>
<div class="ttc" id="asocket_8h_html_a157c21b8cc55b246867518e68946f43d"><div class="ttname"><a href="socket_8h.html#a157c21b8cc55b246867518e68946f43d">LS_MODE_TCP_ACCEPT_FROM</a></div><div class="ttdeci">#define LS_MODE_TCP_ACCEPT_FROM</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00198">socket.h:198</a></div></div>
<div class="ttc" id="astructcontext_html_aa9a5e593e669fc88b8b1c7a9d69c5df1"><div class="ttname"><a href="structcontext.html#aa9a5e593e669fc88b8b1c7a9d69c5df1">context::options</a></div><div class="ttdeci">struct options options</div><div class="ttdoc">Options loaded from command line or configuration file.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00491">openvpn.h:491</a></div></div>
<div class="ttc" id="astructcontext__1_html_a987a02f5590d85e75031d36a6dc2fe5c"><div class="ttname"><a href="structcontext__1.html#a987a02f5590d85e75031d36a6dc2fe5c">context_1::route_ipv6_list</a></div><div class="ttdeci">struct route_ipv6_list * route_ipv6_list</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00178">openvpn.h:178</a></div></div>
<div class="ttc" id="astructconnection__entry_html_af0e61628eca1c951f2f2265e5ec125c8"><div class="ttname"><a href="structconnection__entry.html#af0e61628eca1c951f2f2265e5ec125c8">connection_entry::tls_crypt_v2_file_inline</a></div><div class="ttdeci">bool tls_crypt_v2_file_inline</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00153">options.h:153</a></div></div>
<div class="ttc" id="astructoptions_html_a9ab2e37abdb87f168a53a0dc73ddcc1a"><div class="ttname"><a href="structoptions.html#a9ab2e37abdb87f168a53a0dc73ddcc1a">options::route_predown_script</a></div><div class="ttdeci">const char * route_predown_script</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00375">options.h:375</a></div></div>
<div class="ttc" id="assl_8c_html_a9ac546116b6a0717a88e54cf9cd6777c"><div class="ttname"><a href="ssl_8c.html#a9ac546116b6a0717a88e54cf9cd6777c">tls_adjust_frame_parameters</a></div><div class="ttdeci">void tls_adjust_frame_parameters(struct frame *frame)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l00305">ssl.c:305</a></div></div>
<div class="ttc" id="ainit_8c_html_af461b176774f98425ec61cc176f0ec7c"><div class="ttname"><a href="init_8c.html#af461b176774f98425ec61cc176f0ec7c">do_deferred_options</a></div><div class="ttdeci">bool do_deferred_options(struct context *c, const unsigned int found)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02267">init.c:2267</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a880988622eda107123e5c103f2ad16bb"><div class="ttname"><a href="structconnection__entry.html#a880988622eda107123e5c103f2ad16bb">connection_entry::tls_auth_file_inline</a></div><div class="ttdeci">bool tls_auth_file_inline</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00143">options.h:143</a></div></div>
<div class="ttc" id="astructoptions_html_aae72600b05bd85d54009524b5a2a9a8d"><div class="ttname"><a href="structoptions.html#aae72600b05bd85d54009524b5a2a9a8d">options::auth_token_secret_file_inline</a></div><div class="ttdeci">bool auth_token_secret_file_inline</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00494">options.h:494</a></div></div>
<div class="ttc" id="astructcontext__2_html_a32c2fe431b3437e963b149780188174f"><div class="ttname"><a href="structcontext__2.html#a32c2fe431b3437e963b149780188174f">context_2::ping_send_interval</a></div><div class="ttdeci">struct event_timeout ping_send_interval</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00305">openvpn.h:305</a></div></div>
<div class="ttc" id="amtu_8h_html_aa50df1134d2b079e09d803110563ad80"><div class="ttname"><a href="mtu_8h.html#aa50df1134d2b079e09d803110563ad80">TUN_MTU_SIZE</a></div><div class="ttdeci">#define TUN_MTU_SIZE(f)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00156">mtu.h:156</a></div></div>
<div class="ttc" id="amtu_8h_html_a0ff765260d51b14bd581b75a6be7c67c"><div class="ttname"><a href="mtu_8h.html#a0ff765260d51b14bd581b75a6be7c67c">FRAME_HEADROOM_MARKER_DECRYPT</a></div><div class="ttdeci">#define FRAME_HEADROOM_MARKER_DECRYPT</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00129">mtu.h:129</a></div></div>
<div class="ttc" id="astatus_8c_html_a8d855058c1a32820d55c92ecee2289cd"><div class="ttname"><a href="status_8c.html#a8d855058c1a32820d55c92ecee2289cd">status_printf</a></div><div class="ttdeci">void status_printf(struct status_output *so, const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="status_8c_source.html#l00226">status.c:226</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a36ddd27b1acf681234f8d8a07b64e2a2"><div class="ttname"><a href="structconnection__entry.html#a36ddd27b1acf681234f8d8a07b64e2a2">connection_entry::tls_crypt_v2_file</a></div><div class="ttdeci">const char * tls_crypt_v2_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00152">options.h:152</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_aaf03842b74cab3e4304e655aeaf75d2e"><div class="ttname"><a href="crypto__backend_8h.html#aaf03842b74cab3e4304e655aeaf75d2e">md_kt_size</a></div><div class="ttdeci">unsigned char md_kt_size(const md_kt_t *kt)</div><div class="ttdoc">Returns the size of the message digest, in bytes.</div></div>
<div class="ttc" id="acrypto_8h_html_a897fcd411cae93fbed05653515ce480e"><div class="ttname"><a href="crypto_8h.html#a897fcd411cae93fbed05653515ce480e">CO_MUTE_REPLAY_WARNINGS</a></div><div class="ttdeci">#define CO_MUTE_REPLAY_WARNINGS</div><div class="ttdoc">Bit-flag indicating not to display replay warnings.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00254">crypto.h:254</a></div></div>
<div class="ttc" id="asocket_8c_html_a9ac24fcba54de82d131f67103be49c62"><div class="ttname"><a href="socket_8c.html#a9ac24fcba54de82d131f67103be49c62">link_socket_init_phase1</a></div><div class="ttdeci">void link_socket_init_phase1(struct link_socket *sock, const char *local_host, const char *local_port, const char *remote_host, const char *remote_port, struct cached_dns_entry *dns_cache, int proto, sa_family_t af, bool bind_ipv6_only, int mode, const struct link_socket *accept_from, struct http_proxy_info *http_proxy, struct socks_proxy_info *socks_proxy, bool bind_local, bool remote_float, int inetd, struct link_socket_addr *lsa, const char *ipchange_command, const struct plugin_list *plugins, int resolve_retry_seconds, int mtu_discover_type, int rcvbuf, int sndbuf, int mark, const char *bind_dev, struct event_timeout *server_poll_timeout, unsigned int sockflags)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l01879">socket.c:1879</a></div></div>
<div class="ttc" id="amanage_8h_html_a26400652fda6f483b774ef6771129f9a"><div class="ttname"><a href="manage_8h.html#a26400652fda6f483b774ef6771129f9a">OPENVPN_STATE_CONNECTING</a></div><div class="ttdeci">#define OPENVPN_STATE_CONNECTING</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00495">manage.h:495</a></div></div>
<div class="ttc" id="atun_8h_html_a31febe262c657791a93cfffb413c03c9"><div class="ttname"><a href="tun_8h.html#a31febe262c657791a93cfffb413c03c9">IFCONFIG_BEFORE_TUN_OPEN</a></div><div class="ttdeci">#define IFCONFIG_BEFORE_TUN_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00332">tun.h:332</a></div></div>
<div class="ttc" id="astructhttp__proxy__options_html_a5eec9078cb40b9e5839f7322a9f25b8b"><div class="ttname"><a href="structhttp__proxy__options.html#a5eec9078cb40b9e5839f7322a9f25b8b">http_proxy_options::port</a></div><div class="ttdeci">const char * port</div><div class="ttdef"><b>Definition:</b> <a href="proxy_8h_source.html#l00046">proxy.h:46</a></div></div>
<div class="ttc" id="astructoptions_html_ab7d414e087194f31b1a0f16dec7bd0f9"><div class="ttname"><a href="structoptions.html#ab7d414e087194f31b1a0f16dec7bd0f9">options::verify_x509_type</a></div><div class="ttdeci">int verify_x509_type</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00563">options.h:563</a></div></div>
<div class="ttc" id="astructcontext__0_html_af599a649761ec7fd83b5aa3dab4a502e"><div class="ttname"><a href="structcontext__0.html#af599a649761ec7fd83b5aa3dab4a502e">context_0::uid_gid_specified</a></div><div class="ttdeci">bool uid_gid_specified</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00136">openvpn.h:136</a></div></div>
<div class="ttc" id="astructoptions_html"><div class="ttname"><a href="structoptions.html">options</a></div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00210">options.h:210</a></div></div>
<div class="ttc" id="apool_8h_html"><div class="ttname"><a href="pool_8h.html">pool.h</a></div></div>
<div class="ttc" id="aroute_8c_html_af448f9859b34521c0ec218327676eaf0"><div class="ttname"><a href="route_8c.html#af448f9859b34521c0ec218327676eaf0">add_routes</a></div><div class="ttdeci">void add_routes(struct route_list *rl, struct route_ipv6_list *rl6, const struct tuntap *tt, unsigned int flags, const struct env_set *es, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="route_8c_source.html#l01191">route.c:1191</a></div></div>
<div class="ttc" id="astructconnection__entry_html_aef5f00a3b93fe9810bdb00a635ec0098"><div class="ttname"><a href="structconnection__entry.html#aef5f00a3b93fe9810bdb00a635ec0098">connection_entry::key_direction</a></div><div class="ttdeci">int key_direction</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00144">options.h:144</a></div></div>
<div class="ttc" id="ainit_8c_html_ab818bc3b2b7753d2c5a010ad207b5084"><div class="ttname"><a href="init_8c.html#ab818bc3b2b7753d2c5a010ad207b5084">frame_finalize_options</a></div><div class="ttdeci">static void frame_finalize_options(struct context *c, const struct options *o)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02507">init.c:2507</a></div></div>
<div class="ttc" id="assl__backend_8h_html_a0ebd940dcf50fa2bb859ac47a2b3490b"><div class="ttname"><a href="ssl__backend_8h.html#a0ebd940dcf50fa2bb859ac47a2b3490b">tls_ctx_free</a></div><div class="ttdeci">void tls_ctx_free(struct tls_root_ctx *ctx)</div><div class="ttdoc">Frees the library-specific TLSv1 context.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__openssl_8c_source.html#l00168">ssl_openssl.c:168</a></div></div>
<div class="ttc" id="astructoptions_html_ac409c0cbee0a011db8215dc8c9bf6a9d"><div class="ttname"><a href="structoptions.html#ac409c0cbee0a011db8215dc8c9bf6a9d">options::log</a></div><div class="ttdeci">bool log</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00340">options.h:340</a></div></div>
<div class="ttc" id="astructtls__options_html_ae0e1be267ee100554d22b027d96191db"><div class="ttname"><a href="structtls__options.html#ae0e1be267ee100554d22b027d96191db">tls_options::handshake_window</a></div><div class="ttdeci">int handshake_window</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00271">ssl_common.h:271</a></div></div>
<div class="ttc" id="astructoptions_html_aa397848a05d2511b2aaf320f5edb65d2"><div class="ttname"><a href="structoptions.html#aa397848a05d2511b2aaf320f5edb65d2">options::gc</a></div><div class="ttdeci">struct gc_arena gc</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00212">options.h:212</a></div></div>
<div class="ttc" id="aoptions_8h_html_ad6842a000eff2ee8036ad0547e51319b"><div class="ttname"><a href="options_8h.html#ad6842a000eff2ee8036ad0547e51319b">OPT_P_COMP</a></div><div class="ttdeci">#define OPT_P_COMP</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00684">options.h:684</a></div></div>
<div class="ttc" id="ainit_8c_html_ae4bacd78db91f799756b248946f32887"><div class="ttname"><a href="init_8c.html#ae4bacd78db91f799756b248946f32887">do_env_set_destroy</a></div><div class="ttdeci">static void do_env_set_destroy(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03822">init.c:3822</a></div></div>
<div class="ttc" id="aoptions_8c_html_ab8bb8fc94d6ed39a35268deef3f8ce19"><div class="ttname"><a href="options_8c.html#ab8bb8fc94d6ed39a35268deef3f8ce19">options_string_import</a></div><div class="ttdeci">void options_string_import(struct options *options, const char *config, const int msglevel, const unsigned int permission_mask, unsigned int *option_types_found, struct env_set *es)</div><div class="ttdef"><b>Definition:</b> <a href="options_8c_source.html#l05084">options.c:5084</a></div></div>
<div class="ttc" id="astructoptions_html_aa016b4614f03c9fc02b643846812bbc7"><div class="ttname"><a href="structoptions.html#aa016b4614f03c9fc02b643846812bbc7">options::mlock</a></div><div class="ttdeci">bool mlock</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00286">options.h:286</a></div></div>
<div class="ttc" id="astructtls__options_html_a85250d11ac83ee6a0877ba7a6d193b61"><div class="ttname"><a href="structtls__options.html#a85250d11ac83ee6a0877ba7a6d193b61">tls_options::replay</a></div><div class="ttdeci">bool replay</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00264">ssl_common.h:264</a></div></div>
<div class="ttc" id="astructtls__options_html_a7c8367192cd2005afa4971a0468b31bf"><div class="ttname"><a href="structtls__options.html#a7c8367192cd2005afa4971a0468b31bf">tls_options::verify_command</a></div><div class="ttdeci">const char * verify_command</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00278">ssl_common.h:278</a></div></div>
<div class="ttc" id="astructoptions_html_a36a0d523e3942a896639cda6abf2e426"><div class="ttname"><a href="structoptions.html#a36a0d523e3942a896639cda6abf2e426">options::tls_timeout</a></div><div class="ttdeci">int tls_timeout</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00590">options.h:590</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_ab5286dbd1378331f3d1c3a0522b6a43f"><div class="ttname"><a href="openvpn_2error_8h.html#ab5286dbd1378331f3d1c3a0522b6a43f">M_ERR</a></div><div class="ttdeci">#define M_ERR</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00107">error.h:107</a></div></div>
<div class="ttc" id="astructoptions_html_acbad418a811dd1f8a4c5ed4371786c03"><div class="ttname"><a href="structoptions.html#acbad418a811dd1f8a4c5ed4371786c03">options::management_addr</a></div><div class="ttdeci">const char * management_addr</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00395">options.h:395</a></div></div>
<div class="ttc" id="amtu_8h_html_a27a08d441d3894b11f363c86f288cd72"><div class="ttname"><a href="mtu_8h.html#a27a08d441d3894b11f363c86f288cd72">SET_MTU_TUN</a></div><div class="ttdeci">#define SET_MTU_TUN</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00220">mtu.h:220</a></div></div>
<div class="ttc" id="astructoptions_html_a937ce3e9f18cc533ac9baab101437360"><div class="ttname"><a href="structoptions.html#a937ce3e9f18cc533ac9baab101437360">options::tls_verify</a></div><div class="ttdeci">const char * tls_verify</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00562">options.h:562</a></div></div>
<div class="ttc" id="astructoptions_html_a21be06e306586356c1730387c8294d57"><div class="ttname"><a href="structoptions.html#a21be06e306586356c1730387c8294d57">options::down_script</a></div><div class="ttdeci">const char * down_script</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00328">options.h:328</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a1bdd5db16d783c90714bcf5c9ae1cdf6"><div class="ttname"><a href="structconnection__entry.html#a1bdd5db16d783c90714bcf5c9ae1cdf6">connection_entry::tun_mtu_extra</a></div><div class="ttdeci">int tun_mtu_extra</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00116">options.h:116</a></div></div>
<div class="ttc" id="astructtls__options_html_ab9ad0cb54448fd1bb2e5c4d1a0271820"><div class="ttname"><a href="structtls__options.html#ab9ad0cb54448fd1bb2e5c4d1a0271820">tls_options::tls_crypt_v2_verify_script</a></div><div class="ttdeci">const char * tls_crypt_v2_verify_script</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00307">ssl_common.h:307</a></div></div>
<div class="ttc" id="aping_8h_html_a2f702ad5cbd6fd7490f79350cd3d0b37"><div class="ttname"><a href="ping_8h.html#a2f702ad5cbd6fd7490f79350cd3d0b37">PRE_PULL_INITIAL_PING_RESTART</a></div><div class="ttdeci">#define PRE_PULL_INITIAL_PING_RESTART</div><div class="ttdef"><b>Definition:</b> <a href="ping_8h_source.html#l00033">ping.h:33</a></div></div>
<div class="ttc" id="astructstatus__output_html"><div class="ttname"><a href="structstatus__output.html">status_output</a></div><div class="ttdef"><b>Definition:</b> <a href="status_8h_source.html#l00048">status.h:48</a></div></div>
<div class="ttc" id="ainit_8c_html_a57cbdb902da19e518279d624dd22b5c4"><div class="ttname"><a href="init_8c.html#a57cbdb902da19e518279d624dd22b5c4">CF_INIT_TLS_MULTI</a></div><div class="ttdeci">#define CF_INIT_TLS_MULTI</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00067">init.c:67</a></div></div>
<div class="ttc" id="ainit_8c_html_a6b496053f95faf4d07576c4c56900f37"><div class="ttname"><a href="init_8c.html#a6b496053f95faf4d07576c4c56900f37">write_pid_file</a></div><div class="ttdeci">void write_pid_file(const char *filename, const char *chroot_dir)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04702">init.c:4702</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a2e211f58831bf4b3ebe6e33d35d02b05"><div class="ttname"><a href="openvpn_2error_8h.html#a2e211f58831bf4b3ebe6e33d35d02b05">SDL_CONSTRAIN</a></div><div class="ttdeci">#define SDL_CONSTRAIN</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00200">error.h:200</a></div></div>
<div class="ttc" id="aocc_8h_html_a0f99ca3b587db5d145244969973521e8"><div class="ttname"><a href="occ_8h.html#a0f99ca3b587db5d145244969973521e8">OCC_MTU_LOAD_INTERVAL_SECONDS</a></div><div class="ttdeci">#define OCC_MTU_LOAD_INTERVAL_SECONDS</div><div class="ttdef"><b>Definition:</b> <a href="occ_8h_source.html#l00061">occ.h:61</a></div></div>
<div class="ttc" id="astructoptions_html_adb8ec5e44523e50a40777073262d41a2"><div class="ttname"><a href="structoptions.html#adb8ec5e44523e50a40777073262d41a2">options::no_advance</a></div><div class="ttdeci">bool no_advance</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00250">options.h:250</a></div></div>
<div class="ttc" id="astructsignal__info_html_aff345ec3f6a0b37155a2561e9ff7f0b5"><div class="ttname"><a href="structsignal__info.html#aff345ec3f6a0b37155a2561e9ff7f0b5">signal_info::source</a></div><div class="ttdeci">volatile int source</div><div class="ttdef"><b>Definition:</b> <a href="sig_8h_source.html#l00046">sig.h:46</a></div></div>
<div class="ttc" id="astructcontext__0_html_a2b214a974983a9c9f74e3c80dc1f0161"><div class="ttname"><a href="structcontext__0.html#a2b214a974983a9c9f74e3c80dc1f0161">context_0::platform_state_group</a></div><div class="ttdeci">struct platform_state_group platform_state_group</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00140">openvpn.h:140</a></div></div>
<div class="ttc" id="aopenvpn-plugin_8h_html_a6008ae962bfc95db877f153582b7aa54"><div class="ttname"><a href="openvpn-plugin_8h.html#a6008ae962bfc95db877f153582b7aa54">OPENVPN_PLUGIN_INIT_POST_UID_CHANGE</a></div><div class="ttdeci">#define OPENVPN_PLUGIN_INIT_POST_UID_CHANGE</div><div class="ttdef"><b>Definition:</b> <a href="openvpn-plugin_8h_source.html#l00846">openvpn-plugin.h:846</a></div></div>
<div class="ttc" id="assl_8c_html_adf693b365b24d141b0d30053e3f25afa"><div class="ttname"><a href="ssl_8c.html#adf693b365b24d141b0d30053e3f25afa">auth_user_pass_setup</a></div><div class="ttdeci">void auth_user_pass_setup(const char *auth_file, const struct static_challenge_info *sci)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l00404">ssl.c:404</a></div></div>
<div class="ttc" id="amisc_8h_html_ad06b994f06c422312b8612eadad51f50"><div class="ttname"><a href="misc_8h.html#ad06b994f06c422312b8612eadad51f50">get_user_pass</a></div><div class="ttdeci">static bool get_user_pass(struct user_pass *up, const char *auth_file, const char *prefix, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="misc_8h_source.html#l00137">misc.h:137</a></div></div>
<div class="ttc" id="astructmanagement__callback_html_af23e7074e37435f0def43f98553d20d4"><div class="ttname"><a href="structmanagement__callback.html#af23e7074e37435f0def43f98553d20d4">management_callback::show_net</a></div><div class="ttdeci">void(* show_net)(void *arg, const int msglevel)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00162">manage.h:162</a></div></div>
<div class="ttc" id="abuffer_8h_html_a08d3caef794ca3ee66f22cf29cc29a44"><div class="ttname"><a href="buffer_8h.html#a08d3caef794ca3ee66f22cf29cc29a44">gc_detach</a></div><div class="ttdeci">static void gc_detach(struct gc_arena *a)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l01018">buffer.h:1018</a></div></div>
<div class="ttc" id="astructmanagement__callback_html_a51ec17928e49762bb04d06dbd104d87a"><div class="ttname"><a href="structmanagement__callback.html#a51ec17928e49762bb04d06dbd104d87a">management_callback::arg</a></div><div class="ttdeci">void * arg</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00156">manage.h:156</a></div></div>
<div class="ttc" id="ainit_8h_html_a5066d160ca7be6632e188a5044eeba09"><div class="ttname"><a href="init_8h.html#a5066d160ca7be6632e188a5044eeba09">IVM_LEVEL_1</a></div><div class="ttdeci">#define IVM_LEVEL_1</div><div class="ttdef"><b>Definition:</b> <a href="init_8h_source.html#l00049">init.h:49</a></div></div>
<div class="ttc" id="atun_8c_html_ac881cca015e20fc2d4290525767642f4"><div class="ttname"><a href="tun_8c.html#ac881cca015e20fc2d4290525767642f4">guess_tuntap_dev</a></div><div class="ttdeci">const char * guess_tuntap_dev(const char *dev, const char *dev_type, const char *dev_node, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l00408">tun.c:408</a></div></div>
<div class="ttc" id="aoptions_8c_html_ade63586867ed9b0f268b4857ac8e7a5f"><div class="ttname"><a href="options_8c.html#ade63586867ed9b0f268b4857ac8e7a5f">auth_retry_get</a></div><div class="ttdeci">int auth_retry_get(void)</div><div class="ttdef"><b>Definition:</b> <a href="options_8c_source.html#l04306">options.c:4306</a></div></div>
<div class="ttc" id="astructtls__options_html_ae9ff132a3c7d846e0609b807c86d064a"><div class="ttname"><a href="structtls__options.html#ae9ff132a3c7d846e0609b807c86d064a">tls_options::renegotiate_bytes</a></div><div class="ttdeci">int renegotiate_bytes</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00273">ssl_common.h:273</a></div></div>
<div class="ttc" id="ainit_8c_html_ad6e5429d3088ee255e912f452f78b0ba"><div class="ttname"><a href="init_8c.html#ad6e5429d3088ee255e912f452f78b0ba">do_startup_pause</a></div><div class="ttdeci">static void do_startup_pause(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02491">init.c:2491</a></div></div>
<div class="ttc" id="asocket_8c_html_afb62f9fc3adfae5d11fcc9e57650d3ad"><div class="ttname"><a href="socket_8c.html#afb62f9fc3adfae5d11fcc9e57650d3ad">link_socket_current_remote_ipv6</a></div><div class="ttdeci">const struct in6_addr * link_socket_current_remote_ipv6(const struct link_socket_info *info)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l02590">socket.c:2590</a></div></div>
<div class="ttc" id="astructcontext__2_html_a7cd4fe8da737769bc4b6341c7dcfb2a2"><div class="ttname"><a href="structcontext__2.html#a7cd4fe8da737769bc4b6341c7dcfb2a2">context_2::frame_fragment</a></div><div class="ttdeci">struct frame frame_fragment</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00273">openvpn.h:273</a></div></div>
<div class="ttc" id="astructcontext_html_a34ef38cd7f895386a75d592fa0c820d8"><div class="ttname"><a href="structcontext.html#a34ef38cd7f895386a75d592fa0c820d8">context::did_we_daemonize</a></div><div class="ttdeci">bool did_we_daemonize</div><div class="ttdoc">Whether demonization has already taken place.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00523">openvpn.h:523</a></div></div>
<div class="ttc" id="astructoptions_html_a73c23de77b777cbd7a59bea56f1ee366"><div class="ttname"><a href="structoptions.html#a73c23de77b777cbd7a59bea56f1ee366">options::show_tls_ciphers</a></div><div class="ttdeci">bool show_tls_ciphers</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00236">options.h:236</a></div></div>
<div class="ttc" id="aoptions_8h_html_a294b9a8556238f7d48e63af6ea851806"><div class="ttname"><a href="options_8h.html#a294b9a8556238f7d48e63af6ea851806">OPT_P_ECHO</a></div><div class="ttdeci">#define OPT_P_ECHO</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00694">options.h:694</a></div></div>
<div class="ttc" id="astructoptions_html_a1a60e506cdd22f1fbf395c90389d1ace"><div class="ttname"><a href="structoptions.html#a1a60e506cdd22f1fbf395c90389d1ace">options::renegotiate_seconds_min</a></div><div class="ttdeci">int renegotiate_seconds_min</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00596">options.h:596</a></div></div>
<div class="ttc" id="ainit_8c_html_a2ba15f7443831872eb1200f9b945d158"><div class="ttname"><a href="init_8c.html#a2ba15f7443831872eb1200f9b945d158">format_common_name</a></div><div class="ttdeci">const char * format_common_name(struct context *c, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01343">init.c:1343</a></div></div>
<div class="ttc" id="astructoptions_html_ada37ffb590fc8620f2f5e8f9615defeb"><div class="ttname"><a href="structoptions.html#ada37ffb590fc8620f2f5e8f9615defeb">options::persist_remote_ip</a></div><div class="ttdeci">bool persist_remote_ip</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00305">options.h:305</a></div></div>
<div class="ttc" id="astructoptions_html_a3d0e034a7cdda86ad66beee637423a74"><div class="ttname"><a href="structoptions.html#a3d0e034a7cdda86ad66beee637423a74">options::prng_nonce_secret_len</a></div><div class="ttdeci">int prng_nonce_secret_len</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00528">options.h:528</a></div></div>
<div class="ttc" id="astructoptions_html_abd80805f226deec56890d201bcb74718"><div class="ttname"><a href="structoptions.html#abd80805f226deec56890d201bcb74718">options::ccd_exclusive</a></div><div class="ttdeci">bool ccd_exclusive</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00459">options.h:459</a></div></div>
<div class="ttc" id="amanage_8c_html_adb0918861aed5720265e9dd4313761d9"><div class="ttname"><a href="manage_8c.html#adb0918861aed5720265e9dd4313761d9">management_up_down</a></div><div class="ttdeci">void management_up_down(struct management *man, const char *updown, const struct env_set *es)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l02892">manage.c:2892</a></div></div>
<div class="ttc" id="astructoptions_html_ac7d983496a189237f68f99e6816708c8"><div class="ttname"><a href="structoptions.html#ac7d983496a189237f68f99e6816708c8">options::ping_rec_timeout</a></div><div class="ttdeci">int ping_rec_timeout</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00295">options.h:295</a></div></div>
<div class="ttc" id="aforward_8h_html_a75a6c09ea9647b5fc1829683c4483bd2"><div class="ttname"><a href="forward_8h.html#a75a6c09ea9647b5fc1829683c4483bd2">get_link_socket_info</a></div><div class="ttdeci">static struct link_socket_info * get_link_socket_info(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="forward_8h_source.html#l00336">forward.h:336</a></div></div>
<div class="ttc" id="aoptions_8h_html_a957713f97d301a5952ff94dfbec12f85"><div class="ttname"><a href="options_8h.html#a957713f97d301a5952ff94dfbec12f85">CE_MAN_QUERY_REMOTE_SHIFT</a></div><div class="ttdeci">#define CE_MAN_QUERY_REMOTE_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00138">options.h:138</a></div></div>
<div class="ttc" id="aauth__token_8c_html_a4a2164f546ead4f4a07e18b4d15954c2"><div class="ttname"><a href="auth__token_8c.html#a4a2164f546ead4f4a07e18b4d15954c2">auth_token_init_secret</a></div><div class="ttdeci">void auth_token_init_secret(struct key_ctx *key_ctx, const char *key_file, bool key_inline)</div><div class="ttdoc">Loads an HMAC secret from a file or if no file is present generates a epheremal secret for the run ti...</div><div class="ttdef"><b>Definition:</b> <a href="auth__token_8c_source.html#l00139">auth_token.c:139</a></div></div>
<div class="ttc" id="aopenvpn_2basic_8h_html_afd2537d19a3cb6556b0f727580ec6ee7"><div class="ttname"><a href="openvpn_2basic_8h.html#afd2537d19a3cb6556b0f727580ec6ee7">SIZE</a></div><div class="ttdeci">#define SIZE(x)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2basic_8h_source.html#l00030">basic.h:30</a></div></div>
<div class="ttc" id="astructbuffer_html"><div class="ttname"><a href="structbuffer.html">buffer</a></div><div class="ttdoc">Wrapper structure for dynamically allocated memory.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00060">buffer.h:60</a></div></div>
<div class="ttc" id="astructcontext__2_html_aa0413cae96937fb6fca54e18e5b5d3d7"><div class="ttname"><a href="structcontext__2.html#aa0413cae96937fb6fca54e18e5b5d3d7">context_2::buffers_owned</a></div><div class="ttdeci">bool buffers_owned</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00379">openvpn.h:379</a></div></div>
<div class="ttc" id="aoptions_8h_html_a9c6881e2e86f302489916b1fa05b627aaa3fe6359df3225108eb498611fe2dbe2"><div class="ttname"><a href="options_8h.html#a9c6881e2e86f302489916b1fa05b627aaa3fe6359df3225108eb498611fe2dbe2">GENKEY_TLS_CRYPTV2_SERVER</a></div><div class="ttdeci">@ GENKEY_TLS_CRYPTV2_SERVER</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00205">options.h:205</a></div></div>
<div class="ttc" id="ainit_8c_html_a59a07bcc9f2a989620749a9742d5330b"><div class="ttname"><a href="init_8c.html#a59a07bcc9f2a989620749a9742d5330b">pre_setup</a></div><div class="ttdeci">void pre_setup(const struct options *options)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01354">init.c:1354</a></div></div>
<div class="ttc" id="assl_8h_html_aa72b1d36bfe00e33ecb2656035cbd718"><div class="ttname"><a href="ssl_8h.html#aa72b1d36bfe00e33ecb2656035cbd718">TLS_MULTI_HORIZON</a></div><div class="ttdeci">#define TLS_MULTI_HORIZON</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00091">ssl.h:91</a></div></div>
<div class="ttc" id="astructoptions_html_a7c99b66271ee7577a665de983a3d6346"><div class="ttname"><a href="structoptions.html#a7c99b66271ee7577a665de983a3d6346">options::genkey</a></div><div class="ttdeci">bool genkey</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00238">options.h:238</a></div></div>
<div class="ttc" id="astructoptions_html_acdf0fec84661c4ccdf8bbf01430e3729"><div class="ttname"><a href="structoptions.html#acdf0fec84661c4ccdf8bbf01430e3729">options::verify_x509_name</a></div><div class="ttdeci">const char * verify_x509_name</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00564">options.h:564</a></div></div>
<div class="ttc" id="astructargv_html_ae844a7fbae650ec7e67a8edcea262169"><div class="ttname"><a href="structargv.html#ae844a7fbae650ec7e67a8edcea262169">argv::gc</a></div><div class="ttdeci">struct gc_arena gc</div><div class="ttdef"><b>Definition:</b> <a href="argv_8h_source.html#l00036">argv.h:36</a></div></div>
<div class="ttc" id="astructoptions_html_a408775e6f474f8c25ad492e9c9d2b7b8"><div class="ttname"><a href="structoptions.html#a408775e6f474f8c25ad492e9c9d2b7b8">options::replay_window</a></div><div class="ttdeci">int replay_window</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00533">options.h:533</a></div></div>
<div class="ttc" id="ainit_8c_html_a5726665a3a94e70598b71c22b77c5693"><div class="ttname"><a href="init_8c.html#a5726665a3a94e70598b71c22b77c5693">static_context</a></div><div class="ttdeci">static struct context * static_context</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00060">init.c:60</a></div></div>
<div class="ttc" id="aproxy_8h_html_afd3fed7388af2b44a47465369b992731"><div class="ttname"><a href="proxy_8h.html#afd3fed7388af2b44a47465369b992731">PAR_ALL</a></div><div class="ttdeci">#define PAR_ALL</div><div class="ttdef"><b>Definition:</b> <a href="proxy_8h_source.html#l00049">proxy.h:49</a></div></div>
<div class="ttc" id="asig_8c_html_ab24d8ba0a87e34d962d54e377a1f9858"><div class="ttname"><a href="sig_8c.html#ab24d8ba0a87e34d962d54e377a1f9858">print_status</a></div><div class="ttdeci">void print_status(const struct context *c, struct status_output *so)</div><div class="ttdef"><b>Definition:</b> <a href="sig_8c_source.html#l00292">sig.c:292</a></div></div>
<div class="ttc" id="astructtls__options_html_a2e82573d07cb52d69a675b425a2289b0"><div class="ttname"><a href="structtls__options.html#a2e82573d07cb52d69a675b425a2289b0">tls_options::gremlin</a></div><div class="ttdeci">int gremlin</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00366">ssl_common.h:366</a></div></div>
<div class="ttc" id="ainit_8c_html_a5696f524319366de9d91a26d7290bfbb"><div class="ttname"><a href="init_8c.html#a5696f524319366de9d91a26d7290bfbb">do_close_status_output</a></div><div class="ttdeci">static void do_close_status_output(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03768">init.c:3768</a></div></div>
<div class="ttc" id="ainit_8c_html_a3e428634830c20841874c8143b46a2e4"><div class="ttname"><a href="init_8c.html#a3e428634830c20841874c8143b46a2e4">clear_remote_addrlist</a></div><div class="ttdeci">static void clear_remote_addrlist(struct link_socket_addr *lsa, bool free)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00457">init.c:457</a></div></div>
<div class="ttc" id="astructcontext__1_html_ad9a55fafb79287621cc7dfde3851df49"><div class="ttname"><a href="structcontext__1.html#ad9a55fafb79287621cc7dfde3851df49">context_1::authname</a></div><div class="ttdeci">const char * authname</div><div class="ttdoc">Data channel auth from config file.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00208">openvpn.h:208</a></div></div>
<div class="ttc" id="astructoptions_html_a9252a0ebe6f96e66e7c7cb947cf16645"><div class="ttname"><a href="structoptions.html#a9252a0ebe6f96e66e7c7cb947cf16645">options::route_ipv6_default_gateway</a></div><div class="ttdeci">const char * route_ipv6_default_gateway</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00377">options.h:377</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_ab1f5456810dd6e5c6ab78c1b3d35f1c0"><div class="ttname"><a href="errlevel_8h.html#ab1f5456810dd6e5c6ab78c1b3d35f1c0">D_PUSH_ERRORS</a></div><div class="ttdeci">#define D_PUSH_ERRORS</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00067">errlevel.h:67</a></div></div>
<div class="ttc" id="astructhttp__proxy__options_html_afa4d014cd5174ce3cc82947c54be8a54"><div class="ttname"><a href="structhttp__proxy__options.html#afa4d014cd5174ce3cc82947c54be8a54">http_proxy_options::server</a></div><div class="ttdeci">const char * server</div><div class="ttdef"><b>Definition:</b> <a href="proxy_8h_source.html#l00045">proxy.h:45</a></div></div>
<div class="ttc" id="asocket_8h_html_ab2808d3cfa79a16107297dcacf7df779"><div class="ttname"><a href="socket_8h.html#ab2808d3cfa79a16107297dcacf7df779">LS_MODE_TCP_LISTEN</a></div><div class="ttdeci">#define LS_MODE_TCP_LISTEN</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00197">socket.h:197</a></div></div>
<div class="ttc" id="astructopenvpn__plugin__string__list_html_afdc8ce190d20eef63af62c4faa142cc1"><div class="ttname"><a href="structopenvpn__plugin__string__list.html#afdc8ce190d20eef63af62c4faa142cc1">openvpn_plugin_string_list::value</a></div><div class="ttdeci">char * value</div><div class="ttdef"><b>Definition:</b> <a href="openvpn-plugin_8h_source.html#l00197">openvpn-plugin.h:197</a></div></div>
<div class="ttc" id="awin32_8h_html_aa266d0aadfd92744f1737efd29dcb9c5"><div class="ttname"><a href="win32_8h.html#aa266d0aadfd92744f1737efd29dcb9c5">WSO_FORCE_CONSOLE</a></div><div class="ttdeci">#define WSO_FORCE_CONSOLE</div><div class="ttdef"><b>Definition:</b> <a href="win32_8h_source.html#l00167">win32.h:167</a></div></div>
<div class="ttc" id="astructoptions_html_a3bebca31ab113909af281557e2854820"><div class="ttname"><a href="structoptions.html#a3bebca31ab113909af281557e2854820">options::exit_event_name</a></div><div class="ttdeci">const char * exit_event_name</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00641">options.h:641</a></div></div>
<div class="ttc" id="astructopenvpn__sockaddr_html_ad1adf8548f410507490b0bf17f93e3ea"><div class="ttname"><a href="structopenvpn__sockaddr.html#ad1adf8548f410507490b0bf17f93e3ea">openvpn_sockaddr::addr</a></div><div class="ttdeci">union openvpn_sockaddr::@10 addr</div></div>
<div class="ttc" id="astructcontext__2_html_a2cf3b03b810f97b5ee02e92dd9682589"><div class="ttname"><a href="structcontext__2.html#a2cf3b03b810f97b5ee02e92dd9682589">context_2::options_string_remote</a></div><div class="ttdeci">char * options_string_remote</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00314">openvpn.h:314</a></div></div>
<div class="ttc" id="aplatform_8c_html_a3d70db12180a04ae095a6bfb21951efb"><div class="ttname"><a href="platform_8c.html#a3d70db12180a04ae095a6bfb21951efb">platform_nice</a></div><div class="ttdeci">void platform_nice(int niceval)</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00156">platform.c:156</a></div></div>
<div class="ttc" id="aplatform_8c_html_a82c8419a350edc0a41c53bb0d495235f"><div class="ttname"><a href="platform_8c.html#a82c8419a350edc0a41c53bb0d495235f">platform_chroot</a></div><div class="ttdeci">void platform_chroot(const char *path)</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00045">platform.c:45</a></div></div>
<div class="ttc" id="ainit_8h_html_ab2740fb90ab4f2983813d8cb9351de8e"><div class="ttname"><a href="init_8h.html#ab2740fb90ab4f2983813d8cb9351de8e">ISC_SERVER</a></div><div class="ttdeci">#define ISC_SERVER</div><div class="ttdef"><b>Definition:</b> <a href="init_8h_source.html#l00118">init.h:118</a></div></div>
<div class="ttc" id="aplugin_8h_html_aa1b46559d3eec192f78948a4d2ee4105"><div class="ttname"><a href="plugin_8h.html#aa1b46559d3eec192f78948a4d2ee4105">plugin_return_defined</a></div><div class="ttdeci">static bool plugin_return_defined(const struct plugin_return *pr)</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8h_source.html#l00165">plugin.h:165</a></div></div>
<div class="ttc" id="ainit_8c_html_abab69003e7cb3f0624fd9edf8f9b4037"><div class="ttname"><a href="init_8c.html#abab69003e7cb3f0624fd9edf8f9b4037">do_init_socket_1</a></div><div class="ttdeci">static void do_init_socket_1(struct context *c, const int mode)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03426">init.c:3426</a></div></div>
<div class="ttc" id="atun_8c_html_aa160989ccb62fe8390475d34bda3d2f8"><div class="ttname"><a href="tun_8c.html#aa160989ccb62fe8390475d34bda3d2f8">close_tun</a></div><div class="ttdeci">void close_tun(struct tuntap *tt, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l06804">tun.c:6804</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_a8a19f717f5824ff4455b6925af81299c"><div class="ttname"><a href="crypto__backend_8h.html#a8a19f717f5824ff4455b6925af81299c">rand_bytes</a></div><div class="ttdeci">int rand_bytes(uint8_t *output, int len)</div><div class="ttdoc">Wrapper for secure random number generator.</div><div class="ttdef"><b>Definition:</b> <a href="crypto__openssl_8c_source.html#l00532">crypto_openssl.c:532</a></div></div>
<div class="ttc" id="acrypto_8c_html_af0c4bb63e6b4aae63502a87217a36c79"><div class="ttname"><a href="crypto_8c.html#af0c4bb63e6b4aae63502a87217a36c79">check_replay_consistency</a></div><div class="ttdeci">void check_replay_consistency(const struct key_type *kt, bool packet_id)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l01003">crypto.c:1003</a></div></div>
<div class="ttc" id="astructtuntap__options_html_a92da6eddcc33611db8c3ae0aba938f50"><div class="ttname"><a href="structtuntap__options.html#a92da6eddcc33611db8c3ae0aba938f50">tuntap_options::msg_channel</a></div><div class="ttdeci">HANDLE msg_channel</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00075">tun.h:75</a></div></div>
<div class="ttc" id="aopenvpn_2error_8c_html_aa24606a2ec1cb6e454a387c4fd709545"><div class="ttname"><a href="openvpn_2error_8c.html#aa24606a2ec1cb6e454a387c4fd709545">set_mute_cutoff</a></div><div class="ttdeci">bool set_mute_cutoff(const int cutoff)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8c_source.html#l00125">error.c:125</a></div></div>
<div class="ttc" id="awin32_8c_html_a2265f1473daf634b6c54a12ed1d1fda1"><div class="ttname"><a href="win32_8c.html#a2265f1473daf634b6c54a12ed1d1fda1">window_title_generate</a></div><div class="ttdeci">void window_title_generate(const char *title)</div><div class="ttdef"><b>Definition:</b> <a href="win32_8c_source.html#l00739">win32.c:739</a></div></div>
<div class="ttc" id="astructtls__options_html_a9dec6251d97917d104baa69ddf27a5b3"><div class="ttname"><a href="structtls__options.html#a9dec6251d97917d104baa69ddf27a5b3">tls_options::verify_x509_type</a></div><div class="ttdeci">int verify_x509_type</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00280">ssl_common.h:280</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_abb7d158b96cc50c8f88581e7c1d13cdd"><div class="ttname"><a href="errlevel_8h.html#abb7d158b96cc50c8f88581e7c1d13cdd">D_TLS_ERRORS</a></div><div class="ttdeci">#define D_TLS_ERRORS</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00059">errlevel.h:59</a></div></div>
<div class="ttc" id="astructlink__socket_html_a4758d694c759a1aab884bc1cc5ab969f"><div class="ttname"><a href="structlink__socket.html#a4758d694c759a1aab884bc1cc5ab969f">link_socket::info</a></div><div class="ttdeci">struct link_socket_info info</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00166">socket.h:166</a></div></div>
<div class="ttc" id="astructoptions_html_a510dc28521e59d0075843b498297a634"><div class="ttname"><a href="structoptions.html#a510dc28521e59d0075843b498297a634">options::route_delay_defined</a></div><div class="ttdeci">bool route_delay_defined</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00382">options.h:382</a></div></div>
<div class="ttc" id="asocket_8c_html_a2741d6007f1e5a670409883f4304da61"><div class="ttname"><a href="socket_8c.html#a2741d6007f1e5a670409883f4304da61">print_in_addr_t</a></div><div class="ttdeci">const char * print_in_addr_t(in_addr_t addr, unsigned int flags, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l03001">socket.c:3001</a></div></div>
<div class="ttc" id="astructoptions_html_a6b960ac0e59bda605e2b6879d024afa2"><div class="ttname"><a href="structoptions.html#a6b960ac0e59bda605e2b6879d024afa2">options::handshake_window</a></div><div class="ttdeci">int handshake_window</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00600">options.h:600</a></div></div>
<div class="ttc" id="astructoptions_html_a2f274b709207225b29461a422026c921"><div class="ttname"><a href="structoptions.html#a2f274b709207225b29461a422026c921">options::remote_cert_ku</a></div><div class="ttdeci">unsigned remote_cert_ku[MAX_PARMS]</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00570">options.h:570</a></div></div>
<div class="ttc" id="ainit_8c_html_a169d584d7f1127019c1aaf17091e3e61"><div class="ttname"><a href="init_8c.html#a169d584d7f1127019c1aaf17091e3e61">do_uid_gid_chroot</a></div><div class="ttdeci">static void do_uid_gid_chroot(struct context *c, bool no_delay)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01260">init.c:1260</a></div></div>
<div class="ttc" id="ainit_8c_html_a673de72ed4512c8beca87a9a6e048d78"><div class="ttname"><a href="init_8c.html#a673de72ed4512c8beca87a9a6e048d78">init_management</a></div><div class="ttdeci">void init_management(void)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04041">init.c:4041</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_a194e1ecb3b8a6267eaedd2d885114b39"><div class="ttname"><a href="crypto__backend_8h.html#a194e1ecb3b8a6267eaedd2d885114b39">show_available_engines</a></div><div class="ttdeci">void show_available_engines(void)</div><div class="ttdef"><b>Definition:</b> <a href="crypto__openssl_8c_source.html#l00417">crypto_openssl.c:417</a></div></div>
<div class="ttc" id="astructoptions_html_a1d84d69d3c4d0be2b7bfabe76c518a03"><div class="ttname"><a href="structoptions.html#a1d84d69d3c4d0be2b7bfabe76c518a03">options::crl_file_inline</a></div><div class="ttdeci">bool crl_file_inline</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00567">options.h:567</a></div></div>
<div class="ttc" id="astructlink__socket__addr_html_a31cf151a4d7544429e7740cbda55193c"><div class="ttname"><a href="structlink__socket__addr.html#a31cf151a4d7544429e7740cbda55193c">link_socket_addr::actual</a></div><div class="ttdeci">struct link_socket_actual actual</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00109">socket.h:109</a></div></div>
<div class="ttc" id="asig_8c_html_a705ac4a2e18cd9194106e0bed544247f"><div class="ttname"><a href="sig_8c.html#a705ac4a2e18cd9194106e0bed544247f">pre_init_signal_catch</a></div><div class="ttdeci">void pre_init_signal_catch(void)</div><div class="ttdef"><b>Definition:</b> <a href="sig_8c_source.html#l00239">sig.c:239</a></div></div>
<div class="ttc" id="aps_8h_html"><div class="ttname"><a href="ps_8h.html">ps.h</a></div></div>
<div class="ttc" id="aauth__token_8c_html_a3c1f33bc014ff76d54a50720ef0f8711"><div class="ttname"><a href="auth__token_8c.html#a3c1f33bc014ff76d54a50720ef0f8711">auth_token_write_server_key_file</a></div><div class="ttdeci">void auth_token_write_server_key_file(const char *filename)</div><div class="ttdoc">Generate a auth-token server secret key, and write to file.</div><div class="ttdef"><b>Definition:</b> <a href="auth__token_8c_source.html#l00133">auth_token.c:133</a></div></div>
<div class="ttc" id="astructoptions_html_a1853e40c6a50fe479d6f0cb8e0a97216"><div class="ttname"><a href="structoptions.html#a1853e40c6a50fe479d6f0cb8e0a97216">options::route_default_metric</a></div><div class="ttdeci">int route_default_metric</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00378">options.h:378</a></div></div>
<div class="ttc" id="astructcontext__2_html_adc9eee8062fcb8d280910f28fcab8b0b"><div class="ttname"><a href="structcontext__2.html#adc9eee8062fcb8d280910f28fcab8b0b">context_2::event_set</a></div><div class="ttdeci">struct event_set * event_set</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00237">openvpn.h:237</a></div></div>
<div class="ttc" id="aplatform_8c_html_a575a320fe086fd16b99a55ca2b4e511a"><div class="ttname"><a href="platform_8c.html#a575a320fe086fd16b99a55ca2b4e511a">platform_unlink</a></div><div class="ttdeci">bool platform_unlink(const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00287">platform.c:287</a></div></div>
<div class="ttc" id="ainit_8c_html_aaf57aca5b6d652ab6f00af4b9a746c38"><div class="ttname"><a href="init_8c.html#aaf57aca5b6d652ab6f00af4b9a746c38">init_static</a></div><div class="ttdeci">bool init_static(void)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00782">init.c:782</a></div></div>
<div class="ttc" id="asocket_8c_html_a47f7e875f90faefaede7148a7e5f3347"><div class="ttname"><a href="socket_8c.html#a47f7e875f90faefaede7148a7e5f3347">link_socket_update_flags</a></div><div class="ttdeci">bool link_socket_update_flags(struct link_socket *ls, unsigned int sockflags)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l00981">socket.c:981</a></div></div>
<div class="ttc" id="astructcontext__buffers_html_a0434309fa3b81366ba6578ee4fe26923"><div class="ttname"><a href="structcontext__buffers.html#a0434309fa3b81366ba6578ee4fe26923">context_buffers::read_link_buf</a></div><div class="ttdeci">struct buffer read_link_buf</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00111">openvpn.h:111</a></div></div>
<div class="ttc" id="astructlink__socket__info_html"><div class="ttname"><a href="structlink__socket__info.html">link_socket_info</a></div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00112">socket.h:112</a></div></div>
<div class="ttc" id="astructtls__options_html_ad872e320bb7be0b04c535cec5f21195b"><div class="ttname"><a href="structtls__options.html#ad872e320bb7be0b04c535cec5f21195b">tls_options::ns_cert_type</a></div><div class="ttdeci">int ns_cert_type</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00284">ssl_common.h:284</a></div></div>
<div class="ttc" id="astructcontext__buffers_html_ad3e2e97af748c92d2c3310f4631393ef"><div class="ttname"><a href="structcontext__buffers.html#ad3e2e97af748c92d2c3310f4631393ef">context_buffers::aux_buf</a></div><div class="ttdeci">struct buffer aux_buf</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00095">openvpn.h:95</a></div></div>
<div class="ttc" id="assl__verify_8h_html_a5d60c908067b565d7734c3006a3f0bb9"><div class="ttname"><a href="ssl__verify_8h.html#a5d60c908067b565d7734c3006a3f0bb9">VERIFY_X509_NONE</a></div><div class="ttdeci">#define VERIFY_X509_NONE</div><div class="ttdef"><b>Definition:</b> <a href="ssl__verify_8h_source.html#l00063">ssl_verify.h:63</a></div></div>
<div class="ttc" id="aoptions_8h_html_ab6ec0caa0fc6396f19e56f4deaf2dc86"><div class="ttname"><a href="options_8h.html#ab6ec0caa0fc6396f19e56f4deaf2dc86">OPT_P_PERSIST</a></div><div class="ttdeci">#define OPT_P_PERSIST</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00682">options.h:682</a></div></div>
<div class="ttc" id="astructtls__session_html"><div class="ttname"><a href="structtls__session.html">tls_session</a></div><div class="ttdoc">Security parameter state of a single session within a VPN tunnel.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00404">ssl_common.h:404</a></div></div>
<div class="ttc" id="aenv__set_8c_html_a589b54db89bdd1a4683d80b8132ce577"><div class="ttname"><a href="env__set_8c.html#a589b54db89bdd1a4683d80b8132ce577">env_set_create</a></div><div class="ttdeci">struct env_set * env_set_create(struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="env__set_8c_source.html#l00158">env_set.c:158</a></div></div>
<div class="ttc" id="agroup__tls__crypt_html_gad1ffd0865c58c744773e5c95e3084cf3"><div class="ttname"><a href="group__tls__crypt.html#gad1ffd0865c58c744773e5c95e3084cf3">tls_crypt_init_key</a></div><div class="ttdeci">void tls_crypt_init_key(struct key_ctx_bi *key, const char *key_file, bool key_inline, bool tls_server)</div><div class="ttdoc">Initialize a key_ctx_bi structure for use with tls-crypt.</div><div class="ttdef"><b>Definition:</b> <a href="tls__crypt_8c_source.html#l00083">tls_crypt.c:83</a></div></div>
<div class="ttc" id="astructmanagement__callback_html_a87986defc12d4c56b0d766488e6f6f6b"><div class="ttname"><a href="structmanagement__callback.html#a87986defc12d4c56b0d766488e6f6f6b">management_callback::status</a></div><div class="ttdeci">void(* status)(void *arg, const int version, struct status_output *so)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00161">manage.h:161</a></div></div>
<div class="ttc" id="aevent_8h_html_a3cff540d052378462ac3aa42a45ce6da"><div class="ttname"><a href="event_8h.html#a3cff540d052378462ac3aa42a45ce6da">EVENT_METHOD_FAST</a></div><div class="ttdeci">#define EVENT_METHOD_FAST</div><div class="ttdef"><b>Definition:</b> <a href="event_8h_source.html#l00042">event.h:42</a></div></div>
<div class="ttc" id="astructoptions_html_aa177cf2ad8396bfadd40a7b3fb79adeb"><div class="ttname"><a href="structoptions.html#aa177cf2ad8396bfadd40a7b3fb79adeb">options::sndbuf</a></div><div class="ttdeci">int sndbuf</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00364">options.h:364</a></div></div>
<div class="ttc" id="amanage_8c_html_a83332dbcb123df4f813115349c276888"><div class="ttname"><a href="manage_8c.html#a83332dbcb123df4f813115349c276888">management_event_loop_n_seconds</a></div><div class="ttdeci">void management_event_loop_n_seconds(struct management *man, int sec)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l03446">manage.c:3446</a></div></div>
<div class="ttc" id="aproxy_8c_html_afe1f244314792f7cb0addf0d2a9e795f"><div class="ttname"><a href="proxy_8c.html#afe1f244314792f7cb0addf0d2a9e795f">init_http_proxy_options_once</a></div><div class="ttdeci">struct http_proxy_options * init_http_proxy_options_once(struct http_proxy_options **hpo, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="proxy_8c_source.html#l00048">proxy.c:48</a></div></div>
<div class="ttc" id="atun_8c_html_a6f5544632174db40d087aaf55d70f5c6"><div class="ttname"><a href="tun_8c.html#a6f5544632174db40d087aaf55d70f5c6">show_adapters</a></div><div class="ttdeci">void show_adapters(int msglev)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l04975">tun.c:4975</a></div></div>
<div class="ttc" id="acrypto_8c_html_a5657fa40c2ed8eed4ac057b87902100b"><div class="ttname"><a href="crypto_8c.html#a5657fa40c2ed8eed4ac057b87902100b">init_key_type</a></div><div class="ttdeci">void init_key_type(struct key_type *kt, const char *ciphername, const char *authname, int keysize, bool tls_mode, bool warn)</div><div class="ttdoc">Initialize a key_type structure with.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00741">crypto.c:741</a></div></div>
<div class="ttc" id="astatus_8c_html_af524160156e0aa1ba6f4666bddb4bbd9"><div class="ttname"><a href="status_8c.html#af524160156e0aa1ba6f4666bddb4bbd9">status_close</a></div><div class="ttdeci">bool status_close(struct status_output *so)</div><div class="ttdef"><b>Definition:</b> <a href="status_8c_source.html#l00190">status.c:190</a></div></div>
<div class="ttc" id="astructcontext__2_html_a7bdb348860c0854ba0d834af8322c7d8"><div class="ttname"><a href="structcontext__2.html#a7bdb348860c0854ba0d834af8322c7d8">context_2::frame</a></div><div class="ttdeci">struct frame frame</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00267">openvpn.h:267</a></div></div>
<div class="ttc" id="astructcontext__2_html_aa779ad60c8e594706edf92faa2feda4f"><div class="ttname"><a href="structcontext__2.html#aa779ad60c8e594706edf92faa2feda4f">context_2::link_socket</a></div><div class="ttdeci">struct link_socket * link_socket</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00258">openvpn.h:258</a></div></div>
<div class="ttc" id="assl_8c_html_adeddfd12301fff7f7d0233e0d3875a83"><div class="ttname"><a href="ssl_8c.html#adeddfd12301fff7f7d0233e0d3875a83">enable_auth_user_pass</a></div><div class="ttdeci">void enable_auth_user_pass()</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l00398">ssl.c:398</a></div></div>
<div class="ttc" id="ainit_8c_html_a48a66fea06ba3615248923298b5d8d94"><div class="ttname"><a href="init_8c.html#a48a66fea06ba3615248923298b5d8d94">init_crypto_pre</a></div><div class="ttdeci">static void init_crypto_pre(struct context *c, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02551">init.c:2551</a></div></div>
<div class="ttc" id="astructoptions_html_a5eca9bf5a659b7beaf3d1ed9e1113c3e"><div class="ttname"><a href="structoptions.html#a5eca9bf5a659b7beaf3d1ed9e1113c3e">options::fast_io</a></div><div class="ttdeci">bool fast_io</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00356">options.h:356</a></div></div>
<div class="ttc" id="astructoptions_html_a39f37911a711f30b88ce4ec88e3284e6"><div class="ttname"><a href="structoptions.html#a39f37911a711f30b88ce4ec88e3284e6">options::server_bridge_proxy_dhcp</a></div><div class="ttdeci">bool server_bridge_proxy_dhcp</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00433">options.h:433</a></div></div>
<div class="ttc" id="ainit_8c_html_a577bf7b44dff6a8b3380cc96a8a3a1ba"><div class="ttname"><a href="init_8c.html#a577bf7b44dff6a8b3380cc96a8a3a1ba">do_init_fragment</a></div><div class="ttdeci">static void do_init_fragment(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03402">init.c:3402</a></div></div>
<div class="ttc" id="astructtls__options_html_a48cb4feb82596cc68bef7e46bed556c0"><div class="ttname"><a href="structtls__options.html#a48cb4feb82596cc68bef7e46bed556c0">tls_options::sci</a></div><div class="ttdeci">const struct static_challenge_info * sci</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00362">ssl_common.h:362</a></div></div>
<div class="ttc" id="ainit_8c_html_a2e4b08374469d04d9541f64273665582"><div class="ttname"><a href="init_8c.html#a2e4b08374469d04d9541f64273665582">do_init_frame</a></div><div class="ttdeci">static void do_init_frame(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03101">init.c:3101</a></div></div>
<div class="ttc" id="asyshead_8h_html"><div class="ttname"><a href="syshead_8h.html">syshead.h</a></div></div>
<div class="ttc" id="aplatform_8c_html_a7da5056ce6a8a2efd54ccee6b993e0a6"><div class="ttname"><a href="platform_8c.html#a7da5056ce6a8a2efd54ccee6b993e0a6">platform_fopen</a></div><div class="ttdeci">FILE * platform_fopen(const char *path, const char *mode)</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00302">platform.c:302</a></div></div>
<div class="ttc" id="apkcs11_8h_html"><div class="ttname"><a href="pkcs11_8h.html">pkcs11.h</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a682182a5e5f38fd61f4311501e9dac5d"><div class="ttname"><a href="config-msvc_8h.html#a682182a5e5f38fd61f4311501e9dac5d">SIGTERM</a></div><div class="ttdeci">#define SIGTERM</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00159">config-msvc.h:159</a></div></div>
<div class="ttc" id="astructcontext__persist_html_a737231b5a647b962d502b0379a4d4cc4"><div class="ttname"><a href="structcontext__persist.html#a737231b5a647b962d502b0379a4d4cc4">context_persist::restart_sleep_seconds</a></div><div class="ttdeci">int restart_sleep_seconds</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00120">openvpn.h:120</a></div></div>
<div class="ttc" id="astructoptions_html_a76c3c06aff137da6cd445b5b30fafe88"><div class="ttname"><a href="structoptions.html#a76c3c06aff137da6cd445b5b30fafe88">options::management_flags</a></div><div class="ttdeci">unsigned int management_flags</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00407">options.h:407</a></div></div>
<div class="ttc" id="assl_8c_html_a0abbfa06ce57c32f9f1a46c247de29cf"><div class="ttname"><a href="ssl_8c.html#a0abbfa06ce57c32f9f1a46c247de29cf">tls_session_update_crypto_params</a></div><div class="ttdeci">bool tls_session_update_crypto_params(struct tls_session *session, struct options *options, struct frame *frame, struct frame *frame_fragment)</div><div class="ttdoc">Update TLS session crypto parameters (cipher and auth) and derive data channel keys based on the supp...</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l01946">ssl.c:1946</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_af252e66e3834a956ab00264d7aa3e282"><div class="ttname"><a href="crypto__backend_8h.html#af252e66e3834a956ab00264d7aa3e282">show_available_digests</a></div><div class="ttdeci">void show_available_digests(void)</div><div class="ttdef"><b>Definition:</b> <a href="crypto__openssl_8c_source.html#l00387">crypto_openssl.c:387</a></div></div>
<div class="ttc" id="astructoptions_html_a2c4173af5907c061d7b6b24f28ccc61b"><div class="ttname"><a href="structoptions.html#a2c4173af5907c061d7b6b24f28ccc61b">options::management_echo_buffer_size</a></div><div class="ttdeci">int management_echo_buffer_size</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00399">options.h:399</a></div></div>
<div class="ttc" id="astructoptions_html_a6b6701741dc1e5698babf4ce474984f7"><div class="ttname"><a href="structoptions.html#a6b6701741dc1e5698babf4ce474984f7">options::unsuccessful_attempts</a></div><div class="ttdeci">unsigned int unsuccessful_attempts</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00252">options.h:252</a></div></div>
<div class="ttc" id="ainit_8c_html_a2e3da881a15567d205101e6b0853987a"><div class="ttname"><a href="init_8c.html#a2e3da881a15567d205101e6b0853987a">inherit_context_child</a></div><div class="ttdeci">void inherit_context_child(struct context *dest, const struct context *src)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04543">init.c:4543</a></div></div>
<div class="ttc" id="aoptions_8h_html_ae90e072ed72a51c24ce5be4dc71dcc72"><div class="ttname"><a href="options_8h.html#ae90e072ed72a51c24ce5be4dc71dcc72">OPT_P_ROUTE</a></div><div class="ttdeci">#define OPT_P_ROUTE</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00676">options.h:676</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a18d60aad51f694ab7a74361c1e20de63"><div class="ttname"><a href="errlevel_8h.html#a18d60aad51f694ab7a74361c1e20de63">D_PUSH</a></div><div class="ttdeci">#define D_PUSH</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00083">errlevel.h:83</a></div></div>
<div class="ttc" id="aroute_8c_html_a5d725239839720fa55f3921c74098fa3"><div class="ttname"><a href="route_8c.html#a5d725239839720fa55f3921c74098fa3">show_routes</a></div><div class="ttdeci">void show_routes(int msglev)</div><div class="ttdef"><b>Definition:</b> <a href="route_8c_source.html#l03169">route.c:3169</a></div></div>
<div class="ttc" id="asocket_8h_html_ab974ab73acf7192e0bb614429f79f5a1"><div class="ttname"><a href="socket_8h.html#ab974ab73acf7192e0bb614429f79f5a1">SF_PORT_SHARE</a></div><div class="ttdeci">#define SF_PORT_SHARE</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00210">socket.h:210</a></div></div>
<div class="ttc" id="ainit_8h_html_ac73c2e030d3db046d8e44288178ff2ae"><div class="ttname"><a href="init_8h.html#ac73c2e030d3db046d8e44288178ff2ae">CC_NO_CLOSE</a></div><div class="ttdeci">#define CC_NO_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="init_8h_source.html#l00109">init.h:109</a></div></div>
<div class="ttc" id="astructtls__options_html_a40a53a0bdb1e513c6c72f86b5d4d0878"><div class="ttname"><a href="structtls__options.html#a40a53a0bdb1e513c6c72f86b5d4d0878">tls_options::auth_user_pass_file</a></div><div class="ttdeci">const char * auth_user_pass_file</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00318">ssl_common.h:318</a></div></div>
<div class="ttc" id="astructcontext__1_html_ad58ae12ff4967c915c884f19800b5920"><div class="ttname"><a href="structcontext__1.html#ad58ae12ff4967c915c884f19800b5920">context_1::ifconfig_pool_persist_owned</a></div><div class="ttdeci">bool ifconfig_pool_persist_owned</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00195">openvpn.h:195</a></div></div>
<div class="ttc" id="amtu_8c_html_abf74c37a0e444f337bb18382ff84321b"><div class="ttname"><a href="mtu_8c.html#abf74c37a0e444f337bb18382ff84321b">frame_init_mssfix</a></div><div class="ttdeci">void frame_init_mssfix(struct frame *frame, const struct options *options)</div><div class="ttdoc">Set the mssfix option.</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8c_source.html#l00130">mtu.c:130</a></div></div>
<div class="ttc" id="astructtls__options_html_ada951f04756086139587ecfb2f407b52"><div class="ttname"><a href="structtls__options.html#ada951f04756086139587ecfb2f407b52">tls_options::verify_hash_algo</a></div><div class="ttdeci">hash_algo_type verify_hash_algo</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00288">ssl_common.h:288</a></div></div>
<div class="ttc" id="astructoptions_html_af9495898a3334684c7af68f647364639"><div class="ttname"><a href="structoptions.html#af9495898a3334684c7af68f647364639">options::client_config_dir</a></div><div class="ttdeci">const char * client_config_dir</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00458">options.h:458</a></div></div>
<div class="ttc" id="astructcontext__1_html_aa41670c0d47426f2b7630ecde06d509e"><div class="ttname"><a href="structcontext__1.html#aa41670c0d47426f2b7630ecde06d509e">context_1::http_proxy</a></div><div class="ttdeci">struct http_proxy_info * http_proxy</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00185">openvpn.h:185</a></div></div>
<div class="ttc" id="astructgc__arena_html"><div class="ttname"><a href="structgc__arena.html">gc_arena</a></div><div class="ttdoc">Garbage collection arena used to keep track of dynamically allocated memory.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00116">buffer.h:116</a></div></div>
<div class="ttc" id="astructoptions_html_a3499def098c5b5d0a40c742770b11aef"><div class="ttname"><a href="structoptions.html#a3499def098c5b5d0a40c742770b11aef">options::status_file</a></div><div class="ttdeci">const char * status_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00351">options.h:351</a></div></div>
<div class="ttc" id="ainit_8c_html_a69da0027cf5c712abfc06b7e4f41a7b3"><div class="ttname"><a href="init_8c.html#a69da0027cf5c712abfc06b7e4f41a7b3">uninit_static</a></div><div class="ttdeci">void uninit_static(void)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01011">init.c:1011</a></div></div>
<div class="ttc" id="astructoptions_html_ac1cc609fa36b2e22998af855c8c12e97"><div class="ttname"><a href="structoptions.html#ac1cc609fa36b2e22998af855c8c12e97">options::genkey_filename</a></div><div class="ttdeci">const char * genkey_filename</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00240">options.h:240</a></div></div>
<div class="ttc" id="astructtls__options_html_aeb2cd80ce9217819340aa766eaed9144"><div class="ttname"><a href="structtls__options.html#aeb2cd80ce9217819340aa766eaed9144">tls_options::auth_user_pass_verify_script</a></div><div class="ttdeci">const char * auth_user_pass_verify_script</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00315">ssl_common.h:315</a></div></div>
<div class="ttc" id="aocc_8h_html"><div class="ttname"><a href="occ_8h.html">occ.h</a></div></div>
<div class="ttc" id="astructlink__socket__addr_html"><div class="ttname"><a href="structlink__socket__addr.html">link_socket_addr</a></div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00103">socket.h:103</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a3ac39702968675a6552a43d7c68bf7f9"><div class="ttname"><a href="openvpn_2error_8h.html#a3ac39702968675a6552a43d7c68bf7f9">msg</a></div><div class="ttdeci">#define msg</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00170">error.h:170</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a944a8250e34bfd7991123abd3436d8c0"><div class="ttname"><a href="config-msvc_8h.html#a944a8250e34bfd7991123abd3436d8c0">SIGUSR1</a></div><div class="ttdeci">#define SIGUSR1</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00157">config-msvc.h:157</a></div></div>
<div class="ttc" id="astructcontext_html_a4a8aea25993019921e9568f611106773"><div class="ttname"><a href="structcontext.html#a4a8aea25993019921e9568f611106773">context::sig</a></div><div class="ttdeci">struct signal_info * sig</div><div class="ttdoc">Internal error signaling object.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00516">openvpn.h:516</a></div></div>
<div class="ttc" id="ainit_8c_html_a7e2affa0cea0aa844a58b3185222a3c9"><div class="ttname"><a href="init_8c.html#a7e2affa0cea0aa844a58b3185222a3c9">context_clear_2</a></div><div class="ttdeci">void context_clear_2(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00085">init.c:85</a></div></div>
<div class="ttc" id="aenv__set_8c_html_a872620e2e324ded9c1bc8af1c253faf9"><div class="ttname"><a href="env__set_8c.html#a872620e2e324ded9c1bc8af1c253faf9">setenv_str</a></div><div class="ttdeci">void setenv_str(struct env_set *es, const char *name, const char *value)</div><div class="ttdef"><b>Definition:</b> <a href="env__set_8c_source.html#l00285">env_set.c:285</a></div></div>
<div class="ttc" id="aoptions_8h_html_a028cb4de8f6ee1de18d2b5a65981d9b4"><div class="ttname"><a href="options_8h.html#a028cb4de8f6ee1de18d2b5a65981d9b4">MODE_POINT_TO_POINT</a></div><div class="ttdeci">#define MODE_POINT_TO_POINT</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00219">options.h:219</a></div></div>
<div class="ttc" id="ainit_8h_html_a88731ead0689d66ac028b4027a66b7a7"><div class="ttname"><a href="init_8h.html#a88731ead0689d66ac028b4027a66b7a7">CC_USR1_TO_HUP</a></div><div class="ttdeci">#define CC_USR1_TO_HUP</div><div class="ttdef"><b>Definition:</b> <a href="init_8h_source.html#l00107">init.h:107</a></div></div>
<div class="ttc" id="astructkey__schedule_html_a239e3a613b599e2b9ff2c1a3244c398b"><div class="ttname"><a href="structkey__schedule.html#a239e3a613b599e2b9ff2c1a3244c398b">key_schedule::tls_crypt_v2_wkc</a></div><div class="ttdeci">struct buffer tls_crypt_v2_wkc</div><div class="ttdoc">Wrapped client key.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00070">openvpn.h:70</a></div></div>
<div class="ttc" id="astructremote__host__store_html"><div class="ttname"><a href="structremote__host__store.html">remote_host_store</a></div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00194">options.h:194</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_abe74dee3b7a9490bbbf2e9ce72f3718a"><div class="ttname"><a href="errlevel_8h.html#abe74dee3b7a9490bbbf2e9ce72f3718a">D_READ_WRITE</a></div><div class="ttdeci">#define D_READ_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00165">errlevel.h:165</a></div></div>
<div class="ttc" id="astructkey__type_html_a496ad3263017e1eca30ec7f490a8011e"><div class="ttname"><a href="structkey__type.html#a496ad3263017e1eca30ec7f490a8011e">key_type::digest</a></div><div class="ttdeci">const md_kt_t * digest</div><div class="ttdoc">Message digest static parameters.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00144">crypto.h:144</a></div></div>
<div class="ttc" id="atun_8c_html_a18e98c6a82bdccea18fe3d6c3475ed43"><div class="ttname"><a href="tun_8c.html#a18e98c6a82bdccea18fe3d6c3475ed43">fork_register_dns_action</a></div><div class="ttdeci">void fork_register_dns_action(struct tuntap *tt)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l06008">tun.c:6008</a></div></div>
<div class="ttc" id="ainit_8c_html_a095a721e463c315c4dbdebd50358abd0"><div class="ttname"><a href="init_8c.html#a095a721e463c315c4dbdebd50358abd0">do_genkey</a></div><div class="ttdeci">bool do_genkey(const struct options *options)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01101">init.c:1101</a></div></div>
<div class="ttc" id="acompat-daemon_8c_html_af298996def620cbda4cd529988218cb0"><div class="ttname"><a href="compat-daemon_8c.html#af298996def620cbda4cd529988218cb0">daemon</a></div><div class="ttdeci">int daemon(int nochdir, int noclose)</div><div class="ttdef"><b>Definition:</b> <a href="compat-daemon_8c_source.html#l00057">compat-daemon.c:57</a></div></div>
<div class="ttc" id="aoptions_8h_html_abcdaecd776459d0a5d76b05a0054cd18"><div class="ttname"><a href="options_8h.html#abcdaecd776459d0a5d76b05a0054cd18">PING_UNDEF</a></div><div class="ttdeci">#define PING_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00298">options.h:298</a></div></div>
<div class="ttc" id="ainterval_8h_html_a2a19b468bda9494ddab767cf6a81f201"><div class="ttname"><a href="interval_8h.html#a2a19b468bda9494ddab767cf6a81f201">event_timeout_init</a></div><div class="ttdeci">static void event_timeout_init(struct event_timeout *et, interval_t n, const time_t local_now)</div><div class="ttdef"><b>Definition:</b> <a href="interval_8h_source.html#l00166">interval.h:166</a></div></div>
<div class="ttc" id="astructoptions_html_a7a3a8d6e7b24367c430941b60cbd466a"><div class="ttname"><a href="structoptions.html#a7a3a8d6e7b24367c430941b60cbd466a">options::auth_token_call_auth</a></div><div class="ttdeci">bool auth_token_call_auth</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00491">options.h:491</a></div></div>
<div class="ttc" id="ainit_8c_html_acd4b5343f4f2c63b813a3f67d2c3ef46"><div class="ttname"><a href="init_8c.html#acd4b5343f4f2c63b813a3f67d2c3ef46">possibly_become_daemon</a></div><div class="ttdeci">bool possibly_become_daemon(const struct options *options)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01225">init.c:1225</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a398b8eecec50c6ca4ad75b9d5a46f17a"><div class="ttname"><a href="errlevel_8h.html#a398b8eecec50c6ca4ad75b9d5a46f17a">P2P_ERROR_DELAY_MS</a></div><div class="ttdeci">#define P2P_ERROR_DELAY_MS</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00041">errlevel.h:41</a></div></div>
<div class="ttc" id="astructoptions_html_a01eeeea7687682a0ac932969c065222f"><div class="ttname"><a href="structoptions.html#a01eeeea7687682a0ac932969c065222f">options::resolve_retry_seconds</a></div><div class="ttdeci">int resolve_retry_seconds</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00312">options.h:312</a></div></div>
<div class="ttc" id="asyshead_8h_html_a3fa9d20331cf27c4219b58ca00c99fb8"><div class="ttname"><a href="syshead_8h.html#a3fa9d20331cf27c4219b58ca00c99fb8">SOCKET_UNDEFINED</a></div><div class="ttdeci">#define SOCKET_UNDEFINED</div><div class="ttdef"><b>Definition:</b> <a href="syshead_8h_source.html#l00488">syshead.h:488</a></div></div>
<div class="ttc" id="assl_8c_html_abdf2bf9dc07fb2b93c112d29b2441659"><div class="ttname"><a href="ssl_8c.html#abdf2bf9dc07fb2b93c112d29b2441659">pem_password_setup</a></div><div class="ttdeci">void pem_password_setup(const char *auth_file)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l00362">ssl.c:362</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a70c458a2aee1a9b085b2bc05281722e6"><div class="ttname"><a href="structconnection__entry.html#a70c458a2aee1a9b085b2bc05281722e6">connection_entry::http_proxy_options</a></div><div class="ttdeci">struct http_proxy_options * http_proxy_options</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00109">options.h:109</a></div></div>
<div class="ttc" id="atun_8c_html_ac81775a8129068d72892557f733bc583"><div class="ttname"><a href="tun_8c.html#ac81775a8129068d72892557f733bc583">init_tun_post</a></div><div class="ttdeci">void init_tun_post(struct tuntap *tt, const struct frame *frame, const struct tuntap_options *options)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l00891">tun.c:891</a></div></div>
<div class="ttc" id="agroup__control__processor_html_ga03aaa9093737daae72627dc38198dd1d"><div class="ttname"><a href="group__control__processor.html#ga03aaa9093737daae72627dc38198dd1d">tls_auth_standalone_init</a></div><div class="ttdeci">struct tls_auth_standalone * tls_auth_standalone_init(struct tls_options *tls_options, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l01300">ssl.c:1300</a></div></div>
<div class="ttc" id="abuffer_8h_html_acf5c0f0d704fd5b44b4d066044efb52c"><div class="ttname"><a href="buffer_8h.html#acf5c0f0d704fd5b44b4d066044efb52c">strncpynt</a></div><div class="ttdeci">static void strncpynt(char *dest, const char *src, size_t maxlen)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00348">buffer.h:348</a></div></div>
<div class="ttc" id="ainit_8h_html_a8d3f5374b68c979bf8a7f3726248bc5d"><div class="ttname"><a href="init_8h.html#a8d3f5374b68c979bf8a7f3726248bc5d">BASE_N_EVENTS</a></div><div class="ttdeci">#define BASE_N_EVENTS</div><div class="ttdef"><b>Definition:</b> <a href="init_8h_source.html#l00033">init.h:33</a></div></div>
<div class="ttc" id="astructoptions_html_ae644c14875e0dd32c008a4685f3ee3e3"><div class="ttname"><a href="structoptions.html#ae644c14875e0dd32c008a4685f3ee3e3">options::keysize</a></div><div class="ttdeci">int keysize</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00526">options.h:526</a></div></div>
<div class="ttc" id="astructenv__set_html"><div class="ttname"><a href="structenv__set.html">env_set</a></div><div class="ttdef"><b>Definition:</b> <a href="env__set_8h_source.html#l00042">env_set.h:42</a></div></div>
<div class="ttc" id="atun_8c_html_a655d665719a4b6b553e2b4c0a421fe17"><div class="ttname"><a href="tun_8c.html#a655d665719a4b6b553e2b4c0a421fe17">init_tun</a></div><div class="ttdeci">struct tuntap * init_tun(const char *dev, const char *dev_type, int topology, const char *ifconfig_local_parm, const char *ifconfig_remote_netmask_parm, const char *ifconfig_ipv6_local_parm, int ifconfig_ipv6_netbits_parm, const char *ifconfig_ipv6_remote_parm, struct addrinfo *local_public, struct addrinfo *remote_public, const bool strict_warn, struct env_set *es, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l00736">tun.c:736</a></div></div>
<div class="ttc" id="atun_8h_html_a0b8986f57529b7f83fb7f610e01c583b"><div class="ttname"><a href="tun_8h.html#a0b8986f57529b7f83fb7f610e01c583b">tun_adjust_frame_parameters</a></div><div class="ttdeci">static void tun_adjust_frame_parameters(struct frame *frame, int size)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00322">tun.h:322</a></div></div>
<div class="ttc" id="aroute_8c_html_a79f572aab37f656876a0ea96120aa320"><div class="ttname"><a href="route_8c.html#a79f572aab37f656876a0ea96120aa320">get_default_gateway</a></div><div class="ttdeci">void get_default_gateway(struct route_gateway_info *rgi, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="route_8c_source.html#l02742">route.c:2742</a></div></div>
<div class="ttc" id="agroup__control__processor_html_ga3f6dae3fb4465d1c697a80fdebd50d67"><div class="ttname"><a href="group__control__processor.html#ga3f6dae3fb4465d1c697a80fdebd50d67">tls_multi_free</a></div><div class="ttdeci">void tls_multi_free(struct tls_multi *multi, bool clear)</div><div class="ttdoc">Cleanup a tls_multi structure and free associated memory allocations.</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l01348">ssl.c:1348</a></div></div>
<div class="ttc" id="astructcontext__2_html_a1ae023240723f91c19a2376e890c302e"><div class="ttname"><a href="structcontext__2.html#a1ae023240723f91c19a2376e890c302e">context_2::occ_mtu_load_test_interval</a></div><div class="ttdeci">struct event_timeout occ_mtu_load_test_interval</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00334">openvpn.h:334</a></div></div>
<div class="ttc" id="amtu_8h_html_a7f2c5e48f4bac08cafc93ad2d906221b"><div class="ttname"><a href="mtu_8h.html#a7f2c5e48f4bac08cafc93ad2d906221b">MAX_RW_SIZE_LINK</a></div><div class="ttdeci">#define MAX_RW_SIZE_LINK(f)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00181">mtu.h:181</a></div></div>
<div class="ttc" id="ainit_8c_html_a02ceb57bb5de63c8eaedf553219d9793"><div class="ttname"><a href="init_8c.html#a02ceb57bb5de63c8eaedf553219d9793">uninit_management_callback</a></div><div class="ttdeci">void uninit_management_callback(void)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04114">init.c:4114</a></div></div>
<div class="ttc" id="aoptions_8h_html_a865468682974ec84df83f29b7666b1bc"><div class="ttname"><a href="options_8h.html#a865468682974ec84df83f29b7666b1bc">OPT_P_TIMER</a></div><div class="ttdeci">#define OPT_P_TIMER</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00681">options.h:681</a></div></div>
<div class="ttc" id="asocket_8c_html_af4927a4638ad626394e1cc000cfe5466"><div class="ttname"><a href="socket_8c.html#af4927a4638ad626394e1cc000cfe5466">socket_adjust_frame_parameters</a></div><div class="ttdeci">void socket_adjust_frame_parameters(struct frame *frame, int proto)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l02438">socket.c:2438</a></div></div>
<div class="ttc" id="astructoptions_html_a6ab0ea3447528be930897de097a1a37f"><div class="ttname"><a href="structoptions.html#a6ab0ea3447528be930897de097a1a37f">options::replay</a></div><div class="ttdeci">bool replay</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00531">options.h:531</a></div></div>
<div class="ttc" id="ainit_8c_html_a55e5b704206c7d367d7f87593b67cde0"><div class="ttname"><a href="init_8c.html#a55e5b704206c7d367d7f87593b67cde0">do_alloc_route_list</a></div><div class="ttdeci">static void do_alloc_route_list(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01482">init.c:1482</a></div></div>
<div class="ttc" id="apool_8c_html_a9d5a1ea87964e5b6a9ee98f565336230"><div class="ttname"><a href="pool_8c.html#a9d5a1ea87964e5b6a9ee98f565336230">ifconfig_pool_persist_close</a></div><div class="ttdeci">void ifconfig_pool_persist_close(struct ifconfig_pool_persist *persist)</div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00576">pool.c:576</a></div></div>
<div class="ttc" id="astructtls__options_html_a29eb252102c01147ec581ed6195ef810"><div class="ttname"><a href="structtls__options.html#a29eb252102c01147ec581ed6195ef810">tls_options::auth_token_lifetime</a></div><div class="ttdeci">unsigned int auth_token_lifetime</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00324">ssl_common.h:324</a></div></div>
<div class="ttc" id="astructoptions_html_ab10b9cdcad048c3ef63cdae7ffd09444"><div class="ttname"><a href="structoptions.html#ab10b9cdcad048c3ef63cdae7ffd09444">options::config</a></div><div class="ttdeci">const char * config</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00216">options.h:216</a></div></div>
<div class="ttc" id="aoptions_8h_html_a1cc6b9295cead6f264ec42e35bb786fc"><div class="ttname"><a href="options_8h.html#a1cc6b9295cead6f264ec42e35bb786fc">CE_MAN_QUERY_REMOTE_QUERY</a></div><div class="ttdeci">#define CE_MAN_QUERY_REMOTE_QUERY</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00133">options.h:133</a></div></div>
<div class="ttc" id="astructplugin__list_html"><div class="ttname"><a href="structplugin__list.html">plugin_list</a></div><div class="ttdef"><b>Definition:</b> <a href="plugin_8h_source.html#l00094">plugin.h:94</a></div></div>
<div class="ttc" id="astructoptions_html_a87474a6f7dfa4a24c0dbadd08cdf6eb7"><div class="ttname"><a href="structoptions.html#a87474a6f7dfa4a24c0dbadd08cdf6eb7">options::plugin_list</a></div><div class="ttdeci">struct plugin_option_list * plugin_list</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00412">options.h:412</a></div></div>
<div class="ttc" id="aargv_8c_html_ae03da330eccab6d3239253b774a92d4d"><div class="ttname"><a href="argv_8c.html#ae03da330eccab6d3239253b774a92d4d">argv_new</a></div><div class="ttdeci">struct argv argv_new(void)</div><div class="ttdoc">Allocates a new struct argv and ensures it is initialised.</div><div class="ttdef"><b>Definition:</b> <a href="argv_8c_source.html#l00090">argv.c:90</a></div></div>
<div class="ttc" id="ainit_8c_html_a3289f2c74fc362ba1131d71552d10bab"><div class="ttname"><a href="init_8c.html#a3289f2c74fc362ba1131d71552d10bab">inherit_context_top</a></div><div class="ttdeci">void inherit_context_top(struct context *dest, const struct context *src)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04619">init.c:4619</a></div></div>
<div class="ttc" id="astructoptions_html_a93453dde5c880b6be77c27c7e42e2dc0"><div class="ttname"><a href="structoptions.html#a93453dde5c880b6be77c27c7e42e2dc0">options::priv_key_file_inline</a></div><div class="ttdeci">bool priv_key_file_inline</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00554">options.h:554</a></div></div>
<div class="ttc" id="ainit_8c_html_a484dda31020a06c683ee05df4a4d7b5e"><div class="ttname"><a href="init_8c.html#a484dda31020a06c683ee05df4a4d7b5e">free_context_buffers</a></div><div class="ttdeci">void free_context_buffers(struct context_buffers *b)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03365">init.c:3365</a></div></div>
<div class="ttc" id="ainit_8c_html_a806d01fa4ef5f524a58ace959090142d"><div class="ttname"><a href="init_8c.html#a806d01fa4ef5f524a58ace959090142d">update_options_ce_post</a></div><div class="ttdeci">static void update_options_ce_post(struct options *options)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00193">init.c:193</a></div></div>
<div class="ttc" id="aproto_8h_html_ac294ee23be7863f7b64a51ad6971bfc5"><div class="ttname"><a href="proto_8h.html#ac294ee23be7863f7b64a51ad6971bfc5">TOP_P2P</a></div><div class="ttdeci">#define TOP_P2P</div><div class="ttdef"><b>Definition:</b> <a href="proto_8h_source.html#l00044">proto.h:44</a></div></div>
<div class="ttc" id="aargv_8c_html_acb8c504c4703e6e88c52463da877c8a8"><div class="ttname"><a href="argv_8c.html#acb8c504c4703e6e88c52463da877c8a8">argv_printf</a></div><div class="ttdeci">bool argv_printf(struct argv *argres, const char *format,...)</div><div class="ttdoc">printf() variant which populates a struct argv.</div><div class="ttdef"><b>Definition:</b> <a href="argv_8c_source.html#l00442">argv.c:442</a></div></div>
<div class="ttc" id="abuffer_8c_html_a11cd36c0af3073bd1245bbed1cca9590"><div class="ttname"><a href="buffer_8c.html#a11cd36c0af3073bd1245bbed1cca9590">free_buf</a></div><div class="ttdeci">void free_buf(struct buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00185">buffer.c:185</a></div></div>
<div class="ttc" id="ainit_8c_html_a94da6556c2a7e8067e772f2d7a0ac7d6"><div class="ttname"><a href="init_8c.html#a94da6556c2a7e8067e772f2d7a0ac7d6">do_init_crypto_none</a></div><div class="ttdeci">static void do_init_crypto_none(const struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03073">init.c:3073</a></div></div>
<div class="ttc" id="astructconnection__entry_html_afba71f06b2a1c865bb1f142a8dbdbb2d"><div class="ttname"><a href="structconnection__entry.html#afba71f06b2a1c865bb1f142a8dbdbb2d">connection_entry::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00139">options.h:139</a></div></div>
<div class="ttc" id="acrypto_8c_html_af3aee473fd00923f722cc0518add3d7c"><div class="ttname"><a href="crypto_8c.html#af3aee473fd00923f722cc0518add3d7c">free_key_ctx</a></div><div class="ttdeci">void free_key_ctx(struct key_ctx *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00891">crypto.c:891</a></div></div>
<div class="ttc" id="astructtls__options_html_a6c4a92bcce9d3725e64aab48866dff34"><div class="ttname"><a href="structtls__options.html#a6c4a92bcce9d3725e64aab48866dff34">tls_options::client_config_dir_exclusive</a></div><div class="ttdeci">const char * client_config_dir_exclusive</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00329">ssl_common.h:329</a></div></div>
<div class="ttc" id="astructoptions_html_a8cf8cffcea3a27764644702bc382d35c"><div class="ttname"><a href="structoptions.html#a8cf8cffcea3a27764644702bc382d35c">options::connect_retry_max</a></div><div class="ttdeci">int connect_retry_max</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00244">options.h:244</a></div></div>
<div class="ttc" id="acrypto_8c_html_ac2246d073775a03a612d337782cfa1a5"><div class="ttname"><a href="crypto_8c.html#ac2246d073775a03a612d337782cfa1a5">crypto_max_overhead</a></div><div class="ttdeci">unsigned int crypto_max_overhead(void)</div><div class="ttdoc">Return the worst-case OpenVPN crypto overhead (in bytes)</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00716">crypto.c:716</a></div></div>
<div class="ttc" id="ainit_8c_html_ab260427074ab585e40d538eda5029935"><div class="ttname"><a href="init_8c.html#ab260427074ab585e40d538eda5029935">do_init_crypto_tls_c1</a></div><div class="ttdeci">static void do_init_crypto_tls_c1(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02718">init.c:2718</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a7b09cca005dc641923899a6baa0d6e3c"><div class="ttname"><a href="openvpn_2error_8h.html#a7b09cca005dc641923899a6baa0d6e3c">check_debug_level</a></div><div class="ttdeci">static bool check_debug_level(unsigned int level)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00242">error.h:242</a></div></div>
<div class="ttc" id="astructcontext_html_a9b3f2f6a6281c99c8c1e26598875d5ab"><div class="ttname"><a href="structcontext.html#a9b3f2f6a6281c99c8c1e26598875d5ab">context::es</a></div><div class="ttdeci">struct env_set * es</div><div class="ttdoc">Set of environment variables.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00512">openvpn.h:512</a></div></div>
<div class="ttc" id="astructtls__multi_html_aa1c6b330c9dd68a9f9dd6bf05d454642"><div class="ttname"><a href="structtls__multi.html#aa1c6b330c9dd68a9f9dd6bf05d454642">tls_multi::use_peer_id</a></div><div class="ttdeci">bool use_peer_id</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00590">ssl_common.h:590</a></div></div>
<div class="ttc" id="aplugin_8c_html_ad1d2682ddeef48fe4dc8aa95e33d2f50"><div class="ttname"><a href="plugin_8c.html#ad1d2682ddeef48fe4dc8aa95e33d2f50">plugin_return_get_column</a></div><div class="ttdeci">void plugin_return_get_column(const struct plugin_return *src, struct plugin_return *dest, const char *colname)</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8c_source.html#l01008">plugin.c:1008</a></div></div>
<div class="ttc" id="aopenvpn_2error_8c_html_a0b40f361c449800d74f89d1c14dfa3cc"><div class="ttname"><a href="openvpn_2error_8c.html#a0b40f361c449800d74f89d1c14dfa3cc">error_reset</a></div><div class="ttdeci">void error_reset(void)</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8c_source.html#l00163">error.c:163</a></div></div>
<div class="ttc" id="astructoptions_html_a56a1392631100097bd9dcab7e7f7943f"><div class="ttname"><a href="structoptions.html#a56a1392631100097bd9dcab7e7f7943f">options::management_log_history_cache</a></div><div class="ttdeci">int management_log_history_cache</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00398">options.h:398</a></div></div>
<div class="ttc" id="aoptions_8c_html_aaf33ed424941f850b99c2a26d6f64378"><div class="ttname"><a href="options_8c.html#aaf33ed424941f850b99c2a26d6f64378">options_detach</a></div><div class="ttdeci">void options_detach(struct options *o)</div><div class="ttdef"><b>Definition:</b> <a href="options_8c_source.html#l01411">options.c:1411</a></div></div>
<div class="ttc" id="ainit_8h_html_ab01bd34adf6754f57b6966e3820b5444"><div class="ttname"><a href="init_8h.html#ab01bd34adf6754f57b6966e3820b5444">CC_HARD_USR1_TO_HUP</a></div><div class="ttdeci">#define CC_HARD_USR1_TO_HUP</div><div class="ttdef"><b>Definition:</b> <a href="init_8h_source.html#l00108">init.h:108</a></div></div>
<div class="ttc" id="ashaper_8c_html_a78b8c75f51364fbf22082f54c6e2bcf0"><div class="ttname"><a href="shaper_8c.html#a78b8c75f51364fbf22082f54c6e2bcf0">shaper_msg</a></div><div class="ttdeci">void shaper_msg(struct shaper *s)</div><div class="ttdef"><b>Definition:</b> <a href="shaper_8c_source.html#l00092">shaper.c:92</a></div></div>
<div class="ttc" id="astructoptions_html_a17176de9689460974a9eb1e7df7fb020"><div class="ttname"><a href="structoptions.html#a17176de9689460974a9eb1e7df7fb020">options::daemon</a></div><div class="ttdeci">bool daemon</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00333">options.h:333</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a9f38a4424c365c8c9cb23f12f1b74806"><div class="ttname"><a href="structconnection__entry.html#a9f38a4424c365c8c9cb23f12f1b74806">connection_entry::socks_proxy_authfile</a></div><div class="ttdeci">const char * socks_proxy_authfile</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00112">options.h:112</a></div></div>
<div class="ttc" id="amanage_8c_html_a017795f62ca0bc6c3ebc4a528c3f05aa"><div class="ttname"><a href="manage_8c.html#a017795f62ca0bc6c3ebc4a528c3f05aa">management_pre_tunnel_close</a></div><div class="ttdeci">void management_pre_tunnel_close(struct management *man)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l03087">manage.c:3087</a></div></div>
<div class="ttc" id="aevent_8h_html_a5a2c13fc528d1073e5bf6c34e694561e"><div class="ttname"><a href="event_8h.html#a5a2c13fc528d1073e5bf6c34e694561e">event_free</a></div><div class="ttdeci">static void event_free(struct event_set *es)</div><div class="ttdef"><b>Definition:</b> <a href="event_8h_source.html#l00098">event.h:98</a></div></div>
<div class="ttc" id="astructcontext__2_html_ab43cb5718dec488e16b44b0646d12a83"><div class="ttname"><a href="structcontext__2.html#ab43cb5718dec488e16b44b0646d12a83">context_2::packet_id_persist_interval</a></div><div class="ttdeci">struct event_timeout packet_id_persist_interval</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00366">openvpn.h:366</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a136c64ec2d1306de745e39d6aee362ca"><div class="ttname"><a href="config-msvc_8h.html#a136c64ec2d1306de745e39d6aee362ca">SIGHUP</a></div><div class="ttdeci">#define SIGHUP</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00155">config-msvc.h:155</a></div></div>
<div class="ttc" id="astructmanagement__callback_html_aa4591e95155aadc60395178e82b6f2b8"><div class="ttname"><a href="structmanagement__callback.html#aa4591e95155aadc60395178e82b6f2b8">management_callback::send_cc_message</a></div><div class="ttdeci">bool(* send_cc_message)(void *arg, const char *message, const char *parameter)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00167">manage.h:167</a></div></div>
<div class="ttc" id="amanage_8h_html_a3aad2fe946f1e8a079e442fc92b3e7a7"><div class="ttname"><a href="manage_8h.html#a3aad2fe946f1e8a079e442fc92b3e7a7">management_query_proxy_enabled</a></div><div class="ttdeci">static bool management_query_proxy_enabled(const struct management *man)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00468">manage.h:468</a></div></div>
<div class="ttc" id="astructtls__options_html_add28a119d5a28d79dd0d45e6e0df3ab2"><div class="ttname"><a href="structtls__options.html#add28a119d5a28d79dd0d45e6e0df3ab2">tls_options::pull</a></div><div class="ttdeci">bool pull</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00268">ssl_common.h:268</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_afdb937666eb44c6bbb45860ed209773d"><div class="ttname"><a href="crypto__backend_8h.html#afdb937666eb44c6bbb45860ed209773d">md_ctx_free</a></div><div class="ttdeci">void md_ctx_free(md_ctx_t *ctx)</div></div>
<div class="ttc" id="aconfig_8h_html_a432138093c53d7580af9ec5c5dca387f"><div class="ttname"><a href="config_8h.html#a432138093c53d7580af9ec5c5dca387f">ENABLE_DEBUG</a></div><div class="ttdeci">#define ENABLE_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00035">config.h:35</a></div></div>
<div class="ttc" id="astructoptions_html_a0536fdadf7c9e61bfe97e269172bbf3a"><div class="ttname"><a href="structoptions.html#a0536fdadf7c9e61bfe97e269172bbf3a">options::rcvbuf</a></div><div class="ttdeci">int rcvbuf</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00363">options.h:363</a></div></div>
<div class="ttc" id="agroup__control__processor_html_gaf7223d904613a08407ae52dc3831d7a2"><div class="ttname"><a href="group__control__processor.html#gaf7223d904613a08407ae52dc3831d7a2">tls_multi_init</a></div><div class="ttdeci">struct tls_multi * tls_multi_init(struct tls_options *tls_options)</div><div class="ttdoc">Allocate and initialize a tls_multi structure.</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l01259">ssl.c:1259</a></div></div>
<div class="ttc" id="astructtls__options_html_ac1a39709cf07e719634a1a6903547414"><div class="ttname"><a href="structtls__options.html#ac1a39709cf07e719634a1a6903547414">tls_options::ncp_enabled</a></div><div class="ttdeci">bool ncp_enabled</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00304">ssl_common.h:304</a></div></div>
<div class="ttc" id="ainit_8c_html_a957b67d2e2cd2894508fa50fea589447"><div class="ttname"><a href="init_8c.html#a957b67d2e2cd2894508fa50fea589447">test_crypto_thread</a></div><div class="ttdeci">static void * test_crypto_thread(void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04746">init.c:4746</a></div></div>
<div class="ttc" id="astructoptions_html_aeea9c1239f3809521b0dde3bcc622fc3"><div class="ttname"><a href="structoptions.html#aeea9c1239f3809521b0dde3bcc622fc3">options::remap_sigusr1</a></div><div class="ttdeci">int remap_sigusr1</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00335">options.h:335</a></div></div>
<div class="ttc" id="astructoptions_html_a78da4b42325fb1037a4e3e0f07a76c99"><div class="ttname"><a href="structoptions.html#a78da4b42325fb1037a4e3e0f07a76c99">options::exit_event_initial_state</a></div><div class="ttdeci">bool exit_event_initial_state</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00642">options.h:642</a></div></div>
<div class="ttc" id="ainit_8c_html_a60549a254336200d6162c9b08081d3f9"><div class="ttname"><a href="init_8c.html#a60549a254336200d6162c9b08081d3f9">do_open_ifconfig_pool_persist</a></div><div class="ttdeci">static void do_open_ifconfig_pool_persist(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03785">init.c:3785</a></div></div>
<div class="ttc" id="ainit_8c_html_adc52e27fb65137f8ac18a18cd03551f6"><div class="ttname"><a href="init_8c.html#adc52e27fb65137f8ac18a18cd03551f6">CF_INIT_TLS_AUTH_STANDALONE</a></div><div class="ttdeci">#define CF_INIT_TLS_AUTH_STANDALONE</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00068">init.c:68</a></div></div>
<div class="ttc" id="astructtuntap_html_a310bbe962b4610e99c122fc7147bfbd4"><div class="ttname"><a href="structtuntap.html#a310bbe962b4610e99c122fc7147bfbd4">tuntap::local</a></div><div class="ttdeci">in_addr_t local</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00171">tun.h:171</a></div></div>
<div class="ttc" id="amtu_8h_html_a78b645ca6006022f942aa869c6ef7d3c"><div class="ttname"><a href="mtu_8h.html#a78b645ca6006022f942aa869c6ef7d3c">PAYLOAD_ALIGN</a></div><div class="ttdeci">#define PAYLOAD_ALIGN</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00086">mtu.h:86</a></div></div>
<div class="ttc" id="amstats_8h_html"><div class="ttname"><a href="mstats_8h.html">mstats.h</a></div></div>
<div class="ttc" id="ainit_8c_html_a04bb98ad987538a3b9a2db4f34e5063e"><div class="ttname"><a href="init_8c.html#a04bb98ad987538a3b9a2db4f34e5063e">uninit_proxy</a></div><div class="ttdeci">static void uninit_proxy(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00667">init.c:667</a></div></div>
<div class="ttc" id="asig_8h_html_a7ddcf3d19f5ec5d3e50cead33281c8b2"><div class="ttname"><a href="sig_8h.html#a7ddcf3d19f5ec5d3e50cead33281c8b2">IS_SIG</a></div><div class="ttdeci">#define IS_SIG(c)</div><div class="ttdef"><b>Definition:</b> <a href="sig_8h_source.html#l00050">sig.h:50</a></div></div>
<div class="ttc" id="astructoptions_html_a58306b60489c8093ab83be97174daebb"><div class="ttname"><a href="structoptions.html#a58306b60489c8093ab83be97174daebb">options::peer_id</a></div><div class="ttdeci">uint32_t peer_id</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00650">options.h:650</a></div></div>
<div class="ttc" id="amisc_8c_html_a6e7deed7d2affb7c6a734ec2aea7951d"><div class="ttname"><a href="misc_8c.html#a6e7deed7d2affb7c6a734ec2aea7951d">set_std_files_to_null</a></div><div class="ttdeci">void set_std_files_to_null(bool stdin_only)</div><div class="ttdef"><b>Definition:</b> <a href="misc_8c_source.html#l00058">misc.c:58</a></div></div>
<div class="ttc" id="asocket_8h_html_ab06be2882f62f51cd0212029a84aba09"><div class="ttname"><a href="socket_8h.html#ab06be2882f62f51cd0212029a84aba09">addr_defined</a></div><div class="ttdeci">static bool addr_defined(const struct openvpn_sockaddr *addr)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00634">socket.h:634</a></div></div>
<div class="ttc" id="ainit_8c_html_a6a1f31e3d9a1f00ef308cd117c540ed4"><div class="ttname"><a href="init_8c.html#a6a1f31e3d9a1f00ef308cd117c540ed4">init_instance_handle_signals</a></div><div class="ttdeci">void init_instance_handle_signals(struct context *c, const struct env_set *env, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04129">init.c:4129</a></div></div>
<div class="ttc" id="astructmanagement__callback_html_ab6cb29dc8aeb81ebfe6b619930bd78e3"><div class="ttname"><a href="structmanagement__callback.html#ab6cb29dc8aeb81ebfe6b619930bd78e3">management_callback::proxy_cmd</a></div><div class="ttdeci">bool(* proxy_cmd)(void *arg, const char **p)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00187">manage.h:187</a></div></div>
<div class="ttc" id="astructconnection__list_html_a57ecc9c713fcb3c347253dd3d86308b5"><div class="ttname"><a href="structconnection__list.html#a57ecc9c713fcb3c347253dd3d86308b5">connection_list::array</a></div><div class="ttdeci">struct connection_entry * array[CONNECTION_LIST_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00170">options.h:170</a></div></div>
<div class="ttc" id="abuffer_8c_html_a110fbabcea4a371d6408ac164af94367"><div class="ttname"><a href="buffer_8c.html#a110fbabcea4a371d6408ac164af94367">buffer_list_advance</a></div><div class="ttdeci">void buffer_list_advance(struct buffer_list *ol, int n)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l01358">buffer.c:1358</a></div></div>
<div class="ttc" id="aoptions_8h_html_acda4e6b8f4a9086033b6f58bbceed617"><div class="ttname"><a href="options_8h.html#acda4e6b8f4a9086033b6f58bbceed617">ROUTE_OPTION_FLAGS</a></div><div class="ttdeci">#define ROUTE_OPTION_FLAGS(o)</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00721">options.h:721</a></div></div>
<div class="ttc" id="astructcontext__2_html_a2096e6377ff24432baeafa7864a7483b"><div class="ttname"><a href="structcontext__2.html#a2096e6377ff24432baeafa7864a7483b">context_2::fragment</a></div><div class="ttdeci">struct fragment_master * fragment</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00272">openvpn.h:272</a></div></div>
<div class="ttc" id="astructtls__options_html_ae03dbf132f7b9a09b54c516361a143da"><div class="ttname"><a href="structtls__options.html#ae03dbf132f7b9a09b54c516361a143da">tls_options::crl_file</a></div><div class="ttdeci">const char * crl_file</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00282">ssl_common.h:282</a></div></div>
<div class="ttc" id="astructkey__type_html_aba064fbaa853a46ae2d3afbc3ae98aff"><div class="ttname"><a href="structkey__type.html#aba064fbaa853a46ae2d3afbc3ae98aff">key_type::cipher</a></div><div class="ttdeci">const cipher_kt_t * cipher</div><div class="ttdoc">Cipher static parameters.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00143">crypto.h:143</a></div></div>
<div class="ttc" id="ainteger_8h_html_a957926ee375593740a330d12523eddb1"><div class="ttname"><a href="integer_8h.html#a957926ee375593740a330d12523eddb1">max_int</a></div><div class="ttdeci">static int max_int(int x, int y)</div><div class="ttdef"><b>Definition:</b> <a href="integer_8h_source.html#l00044">integer.h:44</a></div></div>
<div class="ttc" id="aotime_8h_html"><div class="ttname"><a href="otime_8h.html">otime.h</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a909bc65df6db4a88c211558e3b1565f4"><div class="ttname"><a href="structconnection__entry.html#a909bc65df6db4a88c211558e3b1565f4">connection_entry::remote_float</a></div><div class="ttdeci">bool remote_float</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00102">options.h:102</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a474c4038934a015bdcb5b038b98b35d1"><div class="ttname"><a href="structconnection__entry.html#a474c4038934a015bdcb5b038b98b35d1">connection_entry::remote</a></div><div class="ttdeci">const char * remote</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00101">options.h:101</a></div></div>
<div class="ttc" id="ainit_8c_html_ab9fa9b1c374767a587500f8b351548af"><div class="ttname"><a href="init_8c.html#ab9fa9b1c374767a587500f8b351548af">uninit_proxy_dowork</a></div><div class="ttdeci">static void uninit_proxy_dowork(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00614">init.c:614</a></div></div>
<div class="ttc" id="assl_8c_html_a004bfec7a400d6c55a880bde27ff8b23"><div class="ttname"><a href="ssl_8c.html#a004bfec7a400d6c55a880bde27ff8b23">ssl_purge_auth</a></div><div class="ttdeci">void ssl_purge_auth(const bool auth_user_pass_only)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l00476">ssl.c:476</a></div></div>
<div class="ttc" id="ainit_8c_html_a3660e2369c99008cda0efe61b5acfbac"><div class="ttname"><a href="init_8c.html#a3660e2369c99008cda0efe61b5acfbac">do_init_crypto</a></div><div class="ttdeci">static void do_init_crypto(struct context *c, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03084">init.c:3084</a></div></div>
<div class="ttc" id="astructsignal__info_html"><div class="ttname"><a href="structsignal__info.html">signal_info</a></div><div class="ttdef"><b>Definition:</b> <a href="sig_8h_source.html#l00043">sig.h:43</a></div></div>
<div class="ttc" id="ainit_8c_html_a71d85953b4bd00f0071015c2ecce3dc3"><div class="ttname"><a href="init_8c.html#a71d85953b4bd00f0071015c2ecce3dc3">init_options_dev</a></div><div class="ttdeci">void init_options_dev(struct options *options)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01052">init.c:1052</a></div></div>
<div class="ttc" id="astructcontext__1_html_a2add75182e7da9d1d466d37c72e1c276"><div class="ttname"><a href="structcontext__1.html#a2add75182e7da9d1d466d37c72e1c276">context_1::ks</a></div><div class="ttdeci">struct key_schedule ks</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00160">openvpn.h:160</a></div></div>
<div class="ttc" id="astructoptions_html_a88bf02c9e8a2a52b01fa9ba34e9f2cc4"><div class="ttname"><a href="structoptions.html#a88bf02c9e8a2a52b01fa9ba34e9f2cc4">options::tls_crypt_v2_verify_script</a></div><div class="ttdeci">const char * tls_crypt_v2_verify_script</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00625">options.h:625</a></div></div>
<div class="ttc" id="astructoptions_html_a69bd45d624f2701927f2d71589f402ee"><div class="ttname"><a href="structoptions.html#a69bd45d624f2701927f2d71589f402ee">options::key_pass_file</a></div><div class="ttdeci">const char * key_pass_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00232">options.h:232</a></div></div>
<div class="ttc" id="astructoptions_html_a313ef9730dd723427ca9ab74896109a6"><div class="ttname"><a href="structoptions.html#a313ef9730dd723427ca9ab74896109a6">options::inetd</a></div><div class="ttdeci">int inetd</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00338">options.h:338</a></div></div>
<div class="ttc" id="aopenvpn_8h_html_afb4e2528db3a885cdebc615977a34c71"><div class="ttname"><a href="openvpn_8h.html#afb4e2528db3a885cdebc615977a34c71">CM_TOP</a></div><div class="ttdeci">#define CM_TOP</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00499">openvpn.h:499</a></div></div>
<div class="ttc" id="aoptions_8h_html_a61b74dea57fdbf122ec9618c50ee8563"><div class="ttname"><a href="options_8h.html#a61b74dea57fdbf122ec9618c50ee8563">OPT_P_SOCKFLAGS</a></div><div class="ttdeci">#define OPT_P_SOCKFLAGS</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00700">options.h:700</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a3d3ab06697dbc44a288e6f07b0bdbf3a"><div class="ttname"><a href="structconnection__entry.html#a3d3ab06697dbc44a288e6f07b0bdbf3a">connection_entry::tun_mtu_extra_defined</a></div><div class="ttdeci">bool tun_mtu_extra_defined</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00117">options.h:117</a></div></div>
<div class="ttc" id="astructoptions_html_a888a84a61b2986b8c433b9a98c8de5ad"><div class="ttname"><a href="structoptions.html#a888a84a61b2986b8c433b9a98c8de5ad">options::ns_cert_type</a></div><div class="ttdeci">int ns_cert_type</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00569">options.h:569</a></div></div>
<div class="ttc" id="amtu_8h_html_ad93de297470fbd9500df2f67db8bd084"><div class="ttname"><a href="mtu_8h.html#ad93de297470fbd9500df2f67db8bd084">frame_add_to_extra_link</a></div><div class="ttdeci">static void frame_add_to_extra_link(struct frame *frame, const int increment)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00292">mtu.h:292</a></div></div>
<div class="ttc" id="amanage_8h_html_a5ebe89a25083180eb735c308c265a477"><div class="ttname"><a href="manage_8h.html#a5ebe89a25083180eb735c308c265a477">OPENVPN_STATE_CONNECTED</a></div><div class="ttdeci">#define OPENVPN_STATE_CONNECTED</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00498">manage.h:498</a></div></div>
<div class="ttc" id="astructoptions_html_a5463781f357b5c1c13070e92645c6194"><div class="ttname"><a href="structoptions.html#a5463781f357b5c1c13070e92645c6194">options::packet_id_file</a></div><div class="ttdeci">const char * packet_id_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00535">options.h:535</a></div></div>
<div class="ttc" id="acrypto_8h_html_a10cf731ef4917a647cdca413d507ff81"><div class="ttname"><a href="crypto_8h.html#a10cf731ef4917a647cdca413d507ff81">CO_PACKET_ID_LONG_FORM</a></div><div class="ttdeci">#define CO_PACKET_ID_LONG_FORM</div><div class="ttdoc">Bit-flag indicating whether to use OpenVPN's long packet ID format.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00245">crypto.h:245</a></div></div>
<div class="ttc" id="apacket__id_8c_html_a249d12dcab1d0a2bc424990138caa4e5"><div class="ttname"><a href="packet__id_8c.html#a249d12dcab1d0a2bc424990138caa4e5">packet_id_persist_load_obj</a></div><div class="ttdeci">void packet_id_persist_load_obj(const struct packet_id_persist *p, struct packet_id *pid)</div><div class="ttdef"><b>Definition:</b> <a href="packet__id_8c_source.html#l00524">packet_id.c:524</a></div></div>
<div class="ttc" id="astructmanagement_html"><div class="ttname"><a href="structmanagement.html">management</a></div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00322">manage.h:322</a></div></div>
<div class="ttc" id="ainteger_8h_html_a5adeb0420c8384151fa65a8d55eb30ab"><div class="ttname"><a href="integer_8h.html#a5adeb0420c8384151fa65a8d55eb30ab">min_int</a></div><div class="ttdeci">static int min_int(int x, int y)</div><div class="ttdef"><b>Definition:</b> <a href="integer_8h_source.html#l00057">integer.h:57</a></div></div>
<div class="ttc" id="abuffer_8h_html_ad1a8ee23a868bbed76d1a4e396290e9b"><div class="ttname"><a href="buffer_8h.html#ad1a8ee23a868bbed76d1a4e396290e9b">gc_free</a></div><div class="ttdeci">static void gc_free(struct gc_arena *a)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l01032">buffer.h:1032</a></div></div>
<div class="ttc" id="astructtls__options_html_accfc424cfd53ef0905546cffc6e462ce"><div class="ttname"><a href="structtls__options.html#accfc424cfd53ef0905546cffc6e462ce">tls_options::key_type</a></div><div class="ttdeci">struct key_type key_type</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00250">ssl_common.h:250</a></div></div>
<div class="ttc" id="astructtls__options_html_a304fb76d1a8c5c3f12f94d66baa51f06"><div class="ttname"><a href="structtls__options.html#a304fb76d1a8c5c3f12f94d66baa51f06">tls_options::server</a></div><div class="ttdeci">bool server</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00253">ssl_common.h:253</a></div></div>
<div class="ttc" id="aevent_8c_html_a6d9cc59952b108b1894417202689f4ba"><div class="ttname"><a href="event_8c.html#a6d9cc59952b108b1894417202689f4ba">event_set_init</a></div><div class="ttdeci">struct event_set * event_set_init(int *maxevents, unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="event_8c_source.html#l01180">event.c:1180</a></div></div>
<div class="ttc" id="awin32_8h_html_a85379b8442b837a6cb5638874f0eeb05"><div class="ttname"><a href="win32_8h.html#a85379b8442b837a6cb5638874f0eeb05">WSO_FORCE_SERVICE</a></div><div class="ttdeci">#define WSO_FORCE_SERVICE</div><div class="ttdef"><b>Definition:</b> <a href="win32_8h_source.html#l00166">win32.h:166</a></div></div>
<div class="ttc" id="ainit_8c_html_a162b20591bd0d83be031b7fe1bf7dbef"><div class="ttname"><a href="init_8c.html#a162b20591bd0d83be031b7fe1bf7dbef">saved_pid_file_name</a></div><div class="ttdeci">static const char * saved_pid_file_name</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00061">init.c:61</a></div></div>
<div class="ttc" id="amtu_8h_html_a6e7d91939116683f61d13ab598ead50b"><div class="ttname"><a href="mtu_8h.html#a6e7d91939116683f61d13ab598ead50b">BUF_SIZE</a></div><div class="ttdeci">#define BUF_SIZE(f)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00194">mtu.h:194</a></div></div>
<div class="ttc" id="astructoptions_html_a56dbf5c1dce17063ea7ae4b351427ef2"><div class="ttname"><a href="structoptions.html#a56dbf5c1dce17063ea7ae4b351427ef2">options::renegotiate_packets</a></div><div class="ttdeci">int renegotiate_packets</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00594">options.h:594</a></div></div>
<div class="ttc" id="astructtuntap_html_adfc8cf984637bed412c9718cd8a4b0cb"><div class="ttname"><a href="structtuntap.html#adfc8cf984637bed412c9718cd8a4b0cb">tuntap::remote_netmask</a></div><div class="ttdeci">in_addr_t remote_netmask</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00172">tun.h:172</a></div></div>
<div class="ttc" id="ainit_8c_html_a1dfcc5395d28064586bb8f94409b86ef"><div class="ttname"><a href="init_8c.html#a1dfcc5395d28064586bb8f94409b86ef">do_close_link_socket</a></div><div class="ttdeci">static void do_close_link_socket(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03645">init.c:3645</a></div></div>
<div class="ttc" id="assl__ncp_8c_html_a94dd93854cae77ae01971def265a018e"><div class="ttname"><a href="ssl__ncp_8c.html#a94dd93854cae77ae01971def265a018e">check_pull_client_ncp</a></div><div class="ttdeci">bool check_pull_client_ncp(struct context *c, const int found)</div><div class="ttdoc">Checks whether the cipher negotiation is in an acceptable state and we continue to connect or should ...</div><div class="ttdef"><b>Definition:</b> <a href="ssl__ncp_8c_source.html#l00308">ssl_ncp.c:308</a></div></div>
<div class="ttc" id="ainit_8h_html_a2fde4b1cea35c1d5ecc1dfcc4ac16a38"><div class="ttname"><a href="init_8h.html#a2fde4b1cea35c1d5ecc1dfcc4ac16a38">IVM_LEVEL_2</a></div><div class="ttdeci">#define IVM_LEVEL_2</div><div class="ttdef"><b>Definition:</b> <a href="init_8h_source.html#l00050">init.h:50</a></div></div>
<div class="ttc" id="amtu_8h_html_a55afab83cd51975ef32f80dfe161182e"><div class="ttname"><a href="mtu_8h.html#a55afab83cd51975ef32f80dfe161182e">frame_align_to_extra_frame</a></div><div class="ttdeci">static void frame_align_to_extra_frame(struct frame *frame)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00310">mtu.h:310</a></div></div>
<div class="ttc" id="astructoptions_html_a111f57f3a14727b141dc4d359cc02ea2"><div class="ttname"><a href="structoptions.html#a111f57f3a14727b141dc4d359cc02ea2">options::connection_list</a></div><div class="ttdeci">struct connection_list * connection_list</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00246">options.h:246</a></div></div>
<div class="ttc" id="asocks_8c_html_adcc6f9ee8bd4825a6ffe8d9a8bc54dab"><div class="ttname"><a href="socks_8c.html#adcc6f9ee8bd4825a6ffe8d9a8bc54dab">socks_proxy_new</a></div><div class="ttdeci">struct socks_proxy_info * socks_proxy_new(const char *server, const char *port, const char *authfile)</div><div class="ttdef"><b>Definition:</b> <a href="socks_8c_source.html#l00062">socks.c:62</a></div></div>
<div class="ttc" id="ainit_8c_html_a24097398315c8ac1ececad11e35512fd"><div class="ttname"><a href="init_8c.html#a24097398315c8ac1ececad11e35512fd">do_signal_on_tls_errors</a></div><div class="ttdeci">static void do_signal_on_tls_errors(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03870">init.c:3870</a></div></div>
<div class="ttc" id="astructoptions_html_ae70b5eee99cad7ca77438a457078d62c"><div class="ttname"><a href="structoptions.html#ae70b5eee99cad7ca77438a457078d62c">options::ifconfig_remote_netmask</a></div><div class="ttdeci">const char * ifconfig_remote_netmask</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00268">options.h:268</a></div></div>
<div class="ttc" id="astructtls__options_html_afe554073ee6f5d94c385d43990cc0a0f"><div class="ttname"><a href="structtls__options.html#afe554073ee6f5d94c385d43990cc0a0f">tls_options::replay_window</a></div><div class="ttdeci">int replay_window</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00298">ssl_common.h:298</a></div></div>
<div class="ttc" id="assl__backend_8h_html_a4c6eeb6ed5aa07f2f93d28d88c77dfb8"><div class="ttname"><a href="ssl__backend_8h.html#a4c6eeb6ed5aa07f2f93d28d88c77dfb8">show_available_curves</a></div><div class="ttdeci">void show_available_curves(void)</div><div class="ttdef"><b>Definition:</b> <a href="ssl__openssl_8c_source.html#l02299">ssl_openssl.c:2299</a></div></div>
<div class="ttc" id="ainit_8c_html_a0e4c816db034fa84e7b3dc0917bb58c5"><div class="ttname"><a href="init_8c.html#a0e4c816db034fa84e7b3dc0917bb58c5">run_up_down</a></div><div class="ttdeci">static void run_up_down(const char *command, const struct plugin_list *plugins, int plugin_type, const char *arg, DWORD adapter_index, const char *dev_type, int tun_mtu, int link_mtu, const char *ifconfig_local, const char *ifconfig_remote, const char *context, const char *signal_text, const char *script_type, struct env_set *es)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00105">init.c:105</a></div></div>
<div class="ttc" id="ainit_8c_html_a23ba16c1479ad9ab48de1cd7f655a648"><div class="ttname"><a href="init_8c.html#a23ba16c1479ad9ab48de1cd7f655a648">do_close_check_if_restart_permitted</a></div><div class="ttdeci">static void do_close_check_if_restart_permitted(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03562">init.c:3562</a></div></div>
<div class="ttc" id="astructoptions_html_a599b21d6f45322992703af0b4e12741e"><div class="ttname"><a href="structoptions.html#a599b21d6f45322992703af0b4e12741e">options::routes</a></div><div class="ttdeci">struct route_option_list * routes</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00383">options.h:383</a></div></div>
<div class="ttc" id="astructoptions_html_ac37a2848b8a1a91de9dfde7c1c9d8fa5"><div class="ttname"><a href="structoptions.html#ac37a2848b8a1a91de9dfde7c1c9d8fa5">options::chroot_dir</a></div><div class="ttdeci">const char * chroot_dir</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00321">options.h:321</a></div></div>
<div class="ttc" id="amisc_8h_html_aa3b9382e904cb704e27839af86ec6019"><div class="ttname"><a href="misc_8h.html#aa3b9382e904cb704e27839af86ec6019">GET_USER_PASS_NEED_OK</a></div><div class="ttdeci">#define GET_USER_PASS_NEED_OK</div><div class="ttdef"><b>Definition:</b> <a href="misc_8h_source.html#l00119">misc.h:119</a></div></div>
<div class="ttc" id="astructoptions_html_aa4c0435a248abc1b65d922505c89e32c"><div class="ttname"><a href="structoptions.html#aa4c0435a248abc1b65d922505c89e32c">options::down_pre</a></div><div class="ttdeci">bool down_pre</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00330">options.h:330</a></div></div>
<div class="ttc" id="astructtuntap_html"><div class="ttname"><a href="structtuntap.html">tuntap</a></div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00150">tun.h:150</a></div></div>
<div class="ttc" id="ainit_8c_html_ad13e5c0bc1a51c802468a92b3ae66aa6"><div class="ttname"><a href="init_8c.html#ad13e5c0bc1a51c802468a92b3ae66aa6">init_proxy_dowork</a></div><div class="ttdeci">static void init_proxy_dowork(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00631">init.c:631</a></div></div>
<div class="ttc" id="amtu_8h_html_ab885f5e6d550f896304999fb9dccb0c4"><div class="ttname"><a href="mtu_8h.html#ab885f5e6d550f896304999fb9dccb0c4">ETHERNET_MTU</a></div><div class="ttdeci">#define ETHERNET_MTU</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00054">mtu.h:54</a></div></div>
<div class="ttc" id="amanage_8c_html_a876e127f99707c421d4e4be19ac8cbbf"><div class="ttname"><a href="manage_8c.html#a876e127f99707c421d4e4be19ac8cbbf">management_close</a></div><div class="ttdeci">void management_close(struct management *man)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l02724">manage.c:2724</a></div></div>
<div class="ttc" id="amtu_8c_html_a07432f6efa9b2facc2bd910743ec21f3"><div class="ttname"><a href="mtu_8c.html#a07432f6efa9b2facc2bd910743ec21f3">frame_subtract_extra</a></div><div class="ttdeci">void frame_subtract_extra(struct frame *frame, const struct frame *src)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8c_source.html#l00123">mtu.c:123</a></div></div>
<div class="ttc" id="astructcontext__2_html_a901a1a0ceb94dbd3e9f758552fa4fbd9"><div class="ttname"><a href="structcontext__2.html#a901a1a0ceb94dbd3e9f758552fa4fbd9">context_2::crypto_options</a></div><div class="ttdeci">struct crypto_options crypto_options</div><div class="ttdoc">Security parameters and crypto state used by the Data Channel Crypto module to process data channel p...</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00360">openvpn.h:360</a></div></div>
<div class="ttc" id="astructoptions_html_ab21da757cf5ae13f90e852f17e0a4676"><div class="ttname"><a href="structoptions.html#ab21da757cf5ae13f90e852f17e0a4676">options::mark</a></div><div class="ttdeci">int mark</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00367">options.h:367</a></div></div>
<div class="ttc" id="astructtls__options_html_a077d6739e499c8488515daf582da6021"><div class="ttname"><a href="structtls__options.html#a077d6739e499c8488515daf582da6021">tls_options::mode</a></div><div class="ttdeci">int mode</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00267">ssl_common.h:267</a></div></div>
<div class="ttc" id="aopenvpn_8h_html_ab165034158b5eca5e815b14a5d091bbc"><div class="ttname"><a href="openvpn_8h.html#ab165034158b5eca5e815b14a5d091bbc">CM_TOP_CLONE</a></div><div class="ttdeci">#define CM_TOP_CLONE</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00500">openvpn.h:500</a></div></div>
<div class="ttc" id="awin32_8c_html_a8f32d3babe165d21d5e2d5fb9877e3a5"><div class="ttname"><a href="win32_8c.html#a8f32d3babe165d21d5e2d5fb9877e3a5">init_win32</a></div><div class="ttdeci">void init_win32(void)</div><div class="ttdef"><b>Definition:</b> <a href="win32_8c_source.html#l00111">win32.c:111</a></div></div>
<div class="ttc" id="abuffer_8h_html_ad6c5a0d21b979135703d7908a7c3bbb1"><div class="ttname"><a href="buffer_8h.html#ad6c5a0d21b979135703d7908a7c3bbb1">ALLOC_OBJ_CLEAR</a></div><div class="ttdeci">#define ALLOC_OBJ_CLEAR(dptr, type)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l01059">buffer.h:1059</a></div></div>
<div class="ttc" id="asocket_8c_html_a41acd6256f92be22c7c94727d2b4bf1e"><div class="ttname"><a href="socket_8c.html#a41acd6256f92be22c7c94727d2b4bf1e">link_socket_new</a></div><div class="ttdeci">struct link_socket * link_socket_new(void)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l01868">socket.c:1868</a></div></div>
<div class="ttc" id="astructcrypto__options_html_a6f5aaea8aa6f397a0684d8b0a2879252"><div class="ttname"><a href="structcrypto__options.html#a6f5aaea8aa6f397a0684d8b0a2879252">crypto_options::key_ctx_bi</a></div><div class="ttdeci">struct key_ctx_bi key_ctx_bi</div><div class="ttdoc">OpenSSL cipher and HMAC contexts for both sending and receiving directions.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00234">crypto.h:234</a></div></div>
<div class="ttc" id="astructcontext__2_html_adbe7d67b15dc3e5fe37856a3eafcaaa6"><div class="ttname"><a href="structcontext__2.html#adbe7d67b15dc3e5fe37856a3eafcaaa6">context_2::pulled_options_digest</a></div><div class="ttdeci">struct sha256_digest pulled_options_digest</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00457">openvpn.h:457</a></div></div>
<div class="ttc" id="astructcontext__1_html_a76d5bfa380ad2afb97f92ded5297e629"><div class="ttname"><a href="structcontext__1.html#a76d5bfa380ad2afb97f92ded5297e629">context_1::pulled_options_digest_save</a></div><div class="ttdeci">struct sha256_digest pulled_options_digest_save</div><div class="ttdoc">Hash of option strings received from the remote OpenVPN server.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00198">openvpn.h:198</a></div></div>
<div class="ttc" id="assl_8c_html_ac19d79dce177648026a5a8abf27f521d"><div class="ttname"><a href="ssl_8c.html#ac19d79dce177648026a5a8abf27f521d">free_ssl_lib</a></div><div class="ttdeci">void free_ssl_lib(void)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l00346">ssl.c:346</a></div></div>
<div class="ttc" id="aotime_8c_html_a3c3ca8cc859a31aec6578f0dcf1b32a5"><div class="ttname"><a href="otime_8c.html#a3c3ca8cc859a31aec6578f0dcf1b32a5">now</a></div><div class="ttdeci">time_t now</div><div class="ttdef"><b>Definition:</b> <a href="otime_8c_source.html#l00036">otime.c:36</a></div></div>
<div class="ttc" id="asocket_8c_html_ad716d81ba4a413dfb1014bc9407ff2fa"><div class="ttname"><a href="socket_8c.html#ad716d81ba4a413dfb1014bc9407ff2fa">link_socket_init_phase2</a></div><div class="ttdeci">void link_socket_init_phase2(struct link_socket *sock, const struct frame *frame, struct signal_info *sig_info)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l02261">socket.c:2261</a></div></div>
<div class="ttc" id="astructcontext__buffers_html_a7030fd4d5442836a9cd3c2a71a1e84e8"><div class="ttname"><a href="structcontext__buffers.html#a7030fd4d5442836a9cd3c2a71a1e84e8">context_buffers::encrypt_buf</a></div><div class="ttdeci">struct buffer encrypt_buf</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00098">openvpn.h:98</a></div></div>
<div class="ttc" id="astructtls__options_html_acffc29afc34414d015cee78e2b238ac6"><div class="ttname"><a href="structtls__options.html#acffc29afc34414d015cee78e2b238ac6">tls_options::renegotiate_packets</a></div><div class="ttdeci">int renegotiate_packets</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00274">ssl_common.h:274</a></div></div>
<div class="ttc" id="astructtls__options_html_a4b1687d7aa7cce6fa57a1e468205647e"><div class="ttname"><a href="structtls__options.html#a4b1687d7aa7cce6fa57a1e468205647e">tls_options::disable_occ</a></div><div class="ttdeci">bool disable_occ</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00266">ssl_common.h:266</a></div></div>
<div class="ttc" id="astructoptions_html_ac8e77b47a812a59d723b57059eede161"><div class="ttname"><a href="structoptions.html#ac8e77b47a812a59d723b57059eede161">options::sockflags</a></div><div class="ttdeci">unsigned int sockflags</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00371">options.h:371</a></div></div>
<div class="ttc" id="astructoptions_html_a8388094487ff9931a91eb02e7fa8d472"><div class="ttname"><a href="structoptions.html#a8388094487ff9931a91eb02e7fa8d472">options::username</a></div><div class="ttdeci">const char * username</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00319">options.h:319</a></div></div>
<div class="ttc" id="aargv_8c_html_a4d63823a8aeddf605a2e4a4a420e1dd4"><div class="ttname"><a href="argv_8c.html#a4d63823a8aeddf605a2e4a4a420e1dd4">argv_msg</a></div><div class="ttdeci">void argv_msg(const int msglev, const struct argv *a)</div><div class="ttdoc">Write the arguments stored in a struct argv via the msg() command.</div><div class="ttdef"><b>Definition:</b> <a href="argv_8c_source.html#l00245">argv.c:245</a></div></div>
<div class="ttc" id="aoptions_8h_html_a6a97a9ddb19735be2f51caa66269ba1c"><div class="ttname"><a href="options_8h.html#a6a97a9ddb19735be2f51caa66269ba1c">SHAPER_DEFINED</a></div><div class="ttdeci">#define SHAPER_DEFINED(opt)</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00727">options.h:727</a></div></div>
<div class="ttc" id="astructconnection__entry_html_af86e741661abeac7edfdb5258ec4fa5f"><div class="ttname"><a href="structconnection__entry.html#af86e741661abeac7edfdb5258ec4fa5f">connection_entry::local</a></div><div class="ttdeci">const char * local</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00100">options.h:100</a></div></div>
<div class="ttc" id="aplatform_8c_html_a7dc2e3b7b5be2916dd35a763744e7702"><div class="ttname"><a href="platform_8c.html#a7dc2e3b7b5be2916dd35a763744e7702">platform_chdir</a></div><div class="ttdeci">int platform_chdir(const char *dir)</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00213">platform.c:213</a></div></div>
<div class="ttc" id="astructcontext__0_html_a663b5e3cf38a4fc003b34fed87e9555c"><div class="ttname"><a href="structcontext__0.html#a663b5e3cf38a4fc003b34fed87e9555c">context_0::platform_state_user</a></div><div class="ttdeci">struct platform_state_user platform_state_user</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00139">openvpn.h:139</a></div></div>
<div class="ttc" id="aoptions_8h_html_a570ecbd9a01e98df42199d078454f848"><div class="ttname"><a href="options_8h.html#a570ecbd9a01e98df42199d078454f848">AR_INTERACT</a></div><div class="ttdeci">#define AR_INTERACT</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00852">options.h:852</a></div></div>
<div class="ttc" id="astructcontext__1_html_a52e54589393f891c6eb5aa5c55de22b1"><div class="ttname"><a href="structcontext__1.html#a52e54589393f891c6eb5aa5c55de22b1">context_1::status_output</a></div><div class="ttdeci">struct status_output * status_output</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00181">openvpn.h:181</a></div></div>
<div class="ttc" id="aproto_8h_html_a5432683e30ddc0abd4deb132f20477df"><div class="ttname"><a href="proto_8h.html#a5432683e30ddc0abd4deb132f20477df">TOP_NET30</a></div><div class="ttdeci">#define TOP_NET30</div><div class="ttdef"><b>Definition:</b> <a href="proto_8h_source.html#l00043">proto.h:43</a></div></div>
<div class="ttc" id="aopenvpn-plugin_8h_html_abc63437901a486826ebe0ba0a84bc7cb"><div class="ttname"><a href="openvpn-plugin_8h.html#abc63437901a486826ebe0ba0a84bc7cb">OPENVPN_PLUGIN_FUNC_SUCCESS</a></div><div class="ttdeci">#define OPENVPN_PLUGIN_FUNC_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="openvpn-plugin_8h_source.html#l00151">openvpn-plugin.h:151</a></div></div>
<div class="ttc" id="aconfig_8h_html"><div class="ttname"><a href="config_8h.html">config.h</a></div></div>
<div class="ttc" id="ainit_8c_html_a08b482cd93161c760290cc90add5e1dd"><div class="ttname"><a href="init_8c.html#a08b482cd93161c760290cc90add5e1dd">do_init_tls_wrap_key</a></div><div class="ttdeci">static void do_init_tls_wrap_key(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02638">init.c:2638</a></div></div>
<div class="ttc" id="asocket_8c_html_abd7036d683a6339013d79ec69c6f1742"><div class="ttname"><a href="socket_8c.html#abd7036d683a6339013d79ec69c6f1742">do_preresolve</a></div><div class="ttdeci">void do_preresolve(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l00341">socket.c:341</a></div></div>
<div class="ttc" id="astructhttp__proxy__options_html"><div class="ttname"><a href="structhttp__proxy__options.html">http_proxy_options</a></div><div class="ttdef"><b>Definition:</b> <a href="proxy_8h_source.html#l00044">proxy.h:44</a></div></div>
<div class="ttc" id="acrypto_8c_html_af597e0d765df961d66a200fa33ba4faf"><div class="ttname"><a href="crypto_8c.html#af597e0d765df961d66a200fa33ba4faf">crypto_adjust_frame_parameters</a></div><div class="ttdeci">void crypto_adjust_frame_parameters(struct frame *frame, const struct key_type *kt, bool packet_id, bool packet_id_long_form)</div><div class="ttdoc">Calculate crypto overhead and adjust frame to account for that.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8c_source.html#l00682">crypto.c:682</a></div></div>
<div class="ttc" id="assl__ncp_8h_html"><div class="ttname"><a href="ssl__ncp_8h.html">ssl_ncp.h</a></div></div>
<div class="ttc" id="ainit_8c_html_a47013063feed6a4986c4be5ea7175a06"><div class="ttname"><a href="init_8c.html#a47013063feed6a4986c4be5ea7175a06">init_plugins</a></div><div class="ttdeci">void init_plugins(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03885">init.c:3885</a></div></div>
<div class="ttc" id="astructconnection__entry_html_a8ec3ea69d71db89eb5ecd7b4b5ce3f99"><div class="ttname"><a href="structconnection__entry.html#a8ec3ea69d71db89eb5ecd7b4b5ce3f99">connection_entry::bind_ipv6_only</a></div><div class="ttdeci">bool bind_ipv6_only</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00104">options.h:104</a></div></div>
<div class="ttc" id="astructconnection__entry_html_ab003130b974deb481133d4209f74b25c"><div class="ttname"><a href="structconnection__entry.html#ab003130b974deb481133d4209f74b25c">connection_entry::fragment</a></div><div class="ttdeci">int fragment</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00124">options.h:124</a></div></div>
<div class="ttc" id="awin32_8c_html_a6960260d6017928cac9fe0ba8e11d9d6"><div class="ttname"><a href="win32_8c.html#a6960260d6017928cac9fe0ba8e11d9d6">win_wfp_uninit</a></div><div class="ttdeci">bool win_wfp_uninit(const NET_IFINDEX index, const HANDLE msg_channel)</div><div class="ttdef"><b>Definition:</b> <a href="win32_8c_source.html#l01380">win32.c:1380</a></div></div>
<div class="ttc" id="atun_8h_html_a03cab3834cd52344f15e34b2cee7c0ab"><div class="ttname"><a href="tun_8h.html#a03cab3834cd52344f15e34b2cee7c0ab">ifconfig_order</a></div><div class="ttdeci">static int ifconfig_order(void)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00338">tun.h:338</a></div></div>
<div class="ttc" id="astructcontext__1_html_a4d49f44e4e2309b3c7dc84c3aeb305c2"><div class="ttname"><a href="structcontext__1.html#a4d49f44e4e2309b3c7dc84c3aeb305c2">context_1::ifconfig_pool_persist</a></div><div class="ttdeci">struct ifconfig_pool_persist * ifconfig_pool_persist</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00194">openvpn.h:194</a></div></div>
<div class="ttc" id="astructoptions_html_ada4714b5025b2e2d0e863de94507d4d5"><div class="ttname"><a href="structoptions.html#ada4714b5025b2e2d0e863de94507d4d5">options::up_restart</a></div><div class="ttdeci">bool up_restart</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00332">options.h:332</a></div></div>
<div class="ttc" id="astructtls__options_html_ac267c87257baba5792b12cb984761ded"><div class="ttname"><a href="structtls__options.html#ac267c87257baba5792b12cb984761ded">tls_options::xmit_hold</a></div><div class="ttdeci">bool xmit_hold</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00256">ssl_common.h:256</a></div></div>
<div class="ttc" id="astructtls__options_html_a3a022b710a7ebee3df60d348c58cbd20"><div class="ttname"><a href="structtls__options.html#a3a022b710a7ebee3df60d348c58cbd20">tls_options::crypto_flags</a></div><div class="ttdeci">unsigned int crypto_flags</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00296">ssl_common.h:296</a></div></div>
<div class="ttc" id="abuffer_8c_html_a83e3bf61c9804dc763bbe7ac9fdd08b0"><div class="ttname"><a href="buffer_8c.html#a83e3bf61c9804dc763bbe7ac9fdd08b0">buffer_list_free</a></div><div class="ttdeci">void buffer_list_free(struct buffer_list *ol)</div><div class="ttdoc">Frees a buffer list and all the buffers in it.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l01204">buffer.c:1204</a></div></div>
<div class="ttc" id="aplatform_8c_html_a52d59a56eff6b981f01eff915af4fad8"><div class="ttname"><a href="platform_8c.html#a52d59a56eff6b981f01eff915af4fad8">platform_user_get</a></div><div class="ttdeci">bool platform_user_get(const char *username, struct platform_state_user *state)</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00069">platform.c:69</a></div></div>
<div class="ttc" id="abuffer_8h_html_a5e45126fc0cb0593cf8f0154d78c1c27"><div class="ttname"><a href="buffer_8h.html#a5e45126fc0cb0593cf8f0154d78c1c27">gc_init</a></div><div class="ttdeci">static void gc_init(struct gc_arena *a)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l01011">buffer.h:1011</a></div></div>
<div class="ttc" id="arun__command_8h_html_a2a6d02b9ff0a76e78bf5c76834a29d89"><div class="ttname"><a href="run__command_8h.html#a2a6d02b9ff0a76e78bf5c76834a29d89">S_FATAL</a></div><div class="ttdeci">#define S_FATAL</div><div class="ttdef"><b>Definition:</b> <a href="run__command_8h_source.html#l00046">run_command.h:46</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_ac7b89b85b5ca673849476a67325d5e84"><div class="ttname"><a href="crypto__backend_8h.html#ac7b89b85b5ca673849476a67325d5e84">cipher_kt_mode_ofb_cfb</a></div><div class="ttdeci">bool cipher_kt_mode_ofb_cfb(const cipher_kt_t *cipher)</div><div class="ttdoc">Check if the supplied cipher is a supported OFB or CFB mode cipher.</div><div class="ttdef"><b>Definition:</b> <a href="crypto__openssl_8c_source.html#l00781">crypto_openssl.c:781</a></div></div>
<div class="ttc" id="amtu_8c_html_aa4f19c6314a87fa7a3616fec2a3f1d32"><div class="ttname"><a href="mtu_8c.html#aa4f19c6314a87fa7a3616fec2a3f1d32">frame_finalize</a></div><div class="ttdeci">void frame_finalize(struct frame *frame, bool link_mtu_defined, int link_mtu, bool tun_mtu_defined, int tun_mtu)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8c_source.html#l00056">mtu.c:56</a></div></div>
<div class="ttc" id="abuffer_8c_html_a2269d0f9d34d67a509c29c505e44ee2b"><div class="ttname"><a href="buffer_8c.html#a2269d0f9d34d67a509c29c505e44ee2b">buffer_list_aggregate</a></div><div class="ttdeci">void buffer_list_aggregate(struct buffer_list *bl, const size_t max)</div><div class="ttdoc">Aggregates as many buffers as possible from bl in a new buffer of maximum length max_len .</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l01335">buffer.c:1335</a></div></div>
<div class="ttc" id="astructoptions_html_afd4844b98195de154b74ef63211f69ea"><div class="ttname"><a href="structoptions.html#afd4844b98195de154b74ef63211f69ea">options::ifconfig_pool_persist_filename</a></div><div class="ttdeci">const char * ifconfig_pool_persist_filename</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00446">options.h:446</a></div></div>
<div class="ttc" id="aocc_8h_html_ade72809df06131abb19efa249b48ae42"><div class="ttname"><a href="occ_8h.html#ade72809df06131abb19efa249b48ae42">OCC_INTERVAL_SECONDS</a></div><div class="ttdeci">#define OCC_INTERVAL_SECONDS</div><div class="ttdef"><b>Definition:</b> <a href="occ_8h_source.html#l00046">occ.h:46</a></div></div>
<div class="ttc" id="astructtls__multi_html_a93c90f22f9fbbd1898ea9708a49ee1f7"><div class="ttname"><a href="structtls__multi.html#a93c90f22f9fbbd1898ea9708a49ee1f7">tls_multi::peer_id</a></div><div class="ttdeci">uint32_t peer_id</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00589">ssl_common.h:589</a></div></div>
<div class="ttc" id="astructtuntap_html_ade6ab1d7cbe4e6f64dc453eaf7fc251e"><div class="ttname"><a href="structtuntap.html#ade6ab1d7cbe4e6f64dc453eaf7fc251e">tuntap::post_open_mtu</a></div><div class="ttdeci">int post_open_mtu</div><div class="ttdef"><b>Definition:</b> <a href="tun_8h_source.html#l00218">tun.h:218</a></div></div>
<div class="ttc" id="ainit_8c_html_a102f942e503c6a61f394ad6e4c66a5d7"><div class="ttname"><a href="init_8c.html#a102f942e503c6a61f394ad6e4c66a5d7">restore_ncp_options</a></div><div class="ttdeci">static void restore_ncp_options(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00686">init.c:686</a></div></div>
<div class="ttc" id="astructoptions_html_a43abde759eeff1275512f016df43c9c6"><div class="ttname"><a href="structoptions.html#a43abde759eeff1275512f016df43c9c6">options::auth_user_pass_verify_script_via_file</a></div><div class="ttdeci">bool auth_user_pass_verify_script_via_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00488">options.h:488</a></div></div>
<div class="ttc" id="astructcontext__1_html_aa20a2b143b3a7f2db2cc9a1af3cdf3e2"><div class="ttname"><a href="structcontext__1.html#aa20a2b143b3a7f2db2cc9a1af3cdf3e2">context_1::pid_persist</a></div><div class="ttdeci">struct packet_id_persist pid_persist</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00166">openvpn.h:166</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a220891aee7b9d5495c307445dac672f6"><div class="ttname"><a href="errlevel_8h.html#a220891aee7b9d5495c307445dac672f6">D_SHOW_NET</a></div><div class="ttdeci">#define D_SHOW_NET</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00130">errlevel.h:130</a></div></div>
<div class="ttc" id="astructoptions_html_ae304d9717c86ae466b4749b3ab04b718"><div class="ttname"><a href="structoptions.html#ae304d9717c86ae466b4749b3ab04b718">options::transition_window</a></div><div class="ttdeci">int transition_window</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00608">options.h:608</a></div></div>
<div class="ttc" id="ainit_8c_html_a80646beaaf6a2d8fa45e74b125da02d6"><div class="ttname"><a href="init_8c.html#a80646beaaf6a2d8fa45e74b125da02d6">context_clear</a></div><div class="ttdeci">void context_clear(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00073">init.c:73</a></div></div>
<div class="ttc" id="aplatform_8c_html_a81c983ed37e32842f86b6677e3b830ba"><div class="ttname"><a href="platform_8c.html#a81c983ed37e32842f86b6677e3b830ba">platform_mlockall</a></div><div class="ttdeci">void platform_mlockall(bool print_msg)</div><div class="ttdef"><b>Definition:</b> <a href="platform_8c_source.html#l00193">platform.c:193</a></div></div>
<div class="ttc" id="astructcontext__2_html_aea6f45bc37c7c473a4ba3871d43ea2d5"><div class="ttname"><a href="structcontext__2.html#aea6f45bc37c7c473a4ba3871d43ea2d5">context_2::tls_exit_signal</a></div><div class="ttdeci">int tls_exit_signal</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00358">openvpn.h:358</a></div></div>
<div class="ttc" id="ainit_8c_html_a70394c62f63e30e1def3847ff1688a2b"><div class="ttname"><a href="init_8c.html#a70394c62f63e30e1def3847ff1688a2b">socket_restart_pause</a></div><div class="ttdeci">static void socket_restart_pause(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02416">init.c:2416</a></div></div>
<div class="ttc" id="aoptions_8c_html_a22f5987e3b8567b5f919286ea6c8b582"><div class="ttname"><a href="options_8c.html#a22f5987e3b8567b5f919286ea6c8b582">options_string_version</a></div><div class="ttdeci">const char * options_string_version(const char *s, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="options_8c_source.html#l04147">options.c:4147</a></div></div>
<div class="ttc" id="astructconnection__entry_html_abadee88250492bc36663259ebd1a7de7"><div class="ttname"><a href="structconnection__entry.html#abadee88250492bc36663259ebd1a7de7">connection_entry::proto</a></div><div class="ttdeci">int proto</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00095">options.h:95</a></div></div>
<div class="ttc" id="abuffer_8h_html_ae3916f38b92823f35c1a1bea1aac378e"><div class="ttname"><a href="buffer_8h.html#ae3916f38b92823f35c1a1bea1aac378e">format_hex</a></div><div class="ttdeci">static char * format_hex(const uint8_t *data, int size, int maxoutput, struct gc_arena *gc)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00510">buffer.h:510</a></div></div>
<div class="ttc" id="amanage_8c_html_abf92fcefadaa4a0c6ad478bcd2aa1c1e"><div class="ttname"><a href="manage_8c.html#abf92fcefadaa4a0c6ad478bcd2aa1c1e">management_set_callback</a></div><div class="ttdeci">void management_set_callback(struct management *man, const struct management_callback *cb)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l02734">manage.c:2734</a></div></div>
<div class="ttc" id="astructoptions_html_a6a1327f7d30f878848f4e72211878a88"><div class="ttname"><a href="structoptions.html#a6a1327f7d30f878848f4e72211878a88">options::mute_replay_warnings</a></div><div class="ttdeci">bool mute_replay_warnings</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00532">options.h:532</a></div></div>
<div class="ttc" id="astructoptions_html_a8f3c7dbd55ca4f5e960020ecdecf032f"><div class="ttname"><a href="structoptions.html#a8f3c7dbd55ca4f5e960020ecdecf032f">options::tls_export_cert</a></div><div class="ttdeci">const char * tls_export_cert</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00565">options.h:565</a></div></div>
<div class="ttc" id="amanage_8c_html_a2f65461787a2f0f9c6d983b497b8c6ce"><div class="ttname"><a href="manage_8c.html#a2f65461787a2f0f9c6d983b497b8c6ce">management_clear_callback</a></div><div class="ttdeci">void management_clear_callback(struct management *man)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8c_source.html#l02742">manage.c:2742</a></div></div>
<div class="ttc" id="asocket_8h_html_a028f76eab5f19b3be8695a451b62aed8"><div class="ttname"><a href="socket_8h.html#a028f76eab5f19b3be8695a451b62aed8">IA_EMPTY_IF_UNDEF</a></div><div class="ttdeci">#define IA_EMPTY_IF_UNDEF</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00397">socket.h:397</a></div></div>
<div class="ttc" id="asocket_8c_html_aac12ee565b36579ed3bd5dc9377e35b2"><div class="ttname"><a href="socket_8c.html#aac12ee565b36579ed3bd5dc9377e35b2">link_socket_current_remote</a></div><div class="ttdeci">in_addr_t link_socket_current_remote(const struct link_socket_info *info)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l02555">socket.c:2555</a></div></div>
<div class="ttc" id="astructtls__options_html_a3cdc00d65d70c350182145ce7f183fcd"><div class="ttname"><a href="structtls__options.html#a3cdc00d65d70c350182145ce7f183fcd">tls_options::packet_timeout</a></div><div class="ttdeci">interval_t packet_timeout</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00272">ssl_common.h:272</a></div></div>
<div class="ttc" id="ainit_8c_html_ae5f5cf77443aa964f81ff68fb350d83f"><div class="ttname"><a href="init_8c.html#ae5f5cf77443aa964f81ff68fb350d83f">do_init_buffers</a></div><div class="ttdeci">static void do_init_buffers(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03390">init.c:3390</a></div></div>
<div class="ttc" id="astructtls__options_html_a3a5c52df12ac9222ea08cec7753b22b5"><div class="ttname"><a href="structtls__options.html#a3a5c52df12ac9222ea08cec7753b22b5">tls_options::remote_cert_ku</a></div><div class="ttdeci">unsigned remote_cert_ku[MAX_PARMS]</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00285">ssl_common.h:285</a></div></div>
<div class="ttc" id="astructoptions_html_a93398bf07c69b890f12b90ca62c0e259"><div class="ttname"><a href="structoptions.html#a93398bf07c69b890f12b90ca62c0e259">options::auth_token_generate</a></div><div class="ttdeci">bool auth_token_generate</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00489">options.h:489</a></div></div>
<div class="ttc" id="aopenvpn-plugin_8h_html_a2f1704f3ee94c5cce7507d5df87a828a"><div class="ttname"><a href="openvpn-plugin_8h.html#a2f1704f3ee94c5cce7507d5df87a828a">OPENVPN_PLUGIN_ROUTE_PREDOWN</a></div><div class="ttdeci">#define OPENVPN_PLUGIN_ROUTE_PREDOWN</div><div class="ttdef"><b>Definition:</b> <a href="openvpn-plugin_8h_source.html#l00132">openvpn-plugin.h:132</a></div></div>
<div class="ttc" id="astructoptions_html_a3d47337cb28fd6bdb4a804a198b0baa7"><div class="ttname"><a href="structoptions.html#a3d47337cb28fd6bdb4a804a198b0baa7">options::ifconfig_ipv6_local</a></div><div class="ttdeci">const char * ifconfig_ipv6_local</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00269">options.h:269</a></div></div>
<div class="ttc" id="astructoptions_html_a66101dbc2f00c4ef3e1ac1a492292811"><div class="ttname"><a href="structoptions.html#a66101dbc2f00c4ef3e1ac1a492292811">options::persist_key</a></div><div class="ttdeci">bool persist_key</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00306">options.h:306</a></div></div>
<div class="ttc" id="asocket_8c_html_a022b67c8749e8a934063231b2abc5cf6"><div class="ttname"><a href="socket_8c.html#a022b67c8749e8a934063231b2abc5cf6">link_socket_update_buffer_sizes</a></div><div class="ttdeci">void link_socket_update_buffer_sizes(struct link_socket *ls, int rcvbuf, int sndbuf)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l00994">socket.c:994</a></div></div>
<div class="ttc" id="astructuser__pass_html_adccfd3c88600d76b99aa88926f3fb131"><div class="ttname"><a href="structuser__pass.html#adccfd3c88600d76b99aa88926f3fb131">user_pass::password</a></div><div class="ttdeci">char password[USER_PASS_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="misc_8h_source.html#l00079">misc.h:79</a></div></div>
<div class="ttc" id="astructoptions_html_acb0e7875a4dcacb855d7b7fac93d9ca8"><div class="ttname"><a href="structoptions.html#acb0e7875a4dcacb855d7b7fac93d9ca8">options::engine</a></div><div class="ttdeci">const char * engine</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00529">options.h:529</a></div></div>
<div class="ttc" id="astructcontext__2_html_a1aeeedd8cd4780c69f7626bcb81f4b90"><div class="ttname"><a href="structcontext__2.html#a1aeeedd8cd4780c69f7626bcb81f4b90">context_2::server_poll_interval</a></div><div class="ttdeci">struct event_timeout server_poll_interval</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00417">openvpn.h:417</a></div></div>
<div class="ttc" id="aoptions_8h_html_aa9cc77b228a8b97a2b65e6865b7ae005"><div class="ttname"><a href="options_8h.html#aa9cc77b228a8b97a2b65e6865b7ae005">AR_NOINTERACT</a></div><div class="ttdeci">#define AR_NOINTERACT</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00853">options.h:853</a></div></div>
<div class="ttc" id="aoptions_8h_html_a1c591527d4a6d3b5d9bdf8d0e130874d"><div class="ttname"><a href="options_8h.html#a1c591527d4a6d3b5d9bdf8d0e130874d">OPT_P_UP</a></div><div class="ttdeci">#define OPT_P_UP</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00675">options.h:675</a></div></div>
<div class="ttc" id="acommon_8h_html_acffcd4cb515881c936f8b7092f235f3e"><div class="ttname"><a href="common_8h.html#acffcd4cb515881c936f8b7092f235f3e">PUSH_BUNDLE_SIZE</a></div><div class="ttdeci">#define PUSH_BUNDLE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00084">common.h:84</a></div></div>
<div class="ttc" id="ainit_8c_html_a3b4a0a2b9abc79b1a2ea53ecc6125303"><div class="ttname"><a href="init_8c.html#a3b4a0a2b9abc79b1a2ea53ecc6125303">do_init_traffic_shaper</a></div><div class="ttdeci">static void do_init_traffic_shaper(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01464">init.c:1464</a></div></div>
<div class="ttc" id="astructsession_html"><div class="ttname"><a href="structsession.html">session</a></div><div class="ttdef"><b>Definition:</b> <a href="keyingmaterialexporter_8c_source.html#l00056">keyingmaterialexporter.c:56</a></div></div>
<div class="ttc" id="astructoptions_html_a2d370b06b0c83356b68b3459fd69ca80"><div class="ttname"><a href="structoptions.html#a2d370b06b0c83356b68b3459fd69ca80">options::show_net_up</a></div><div class="ttdeci">bool show_net_up</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00643">options.h:643</a></div></div>
<div class="ttc" id="abuffer_8h_html_ab7b6746dd30a4cfaf4a9218f42c6dabe"><div class="ttname"><a href="buffer_8h.html#ab7b6746dd30a4cfaf4a9218f42c6dabe">buf_read_u8</a></div><div class="ttdeci">static int buf_read_u8(struct buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00796">buffer.h:796</a></div></div>
<div class="ttc" id="aplugin_8c_html_afbccf58e824f3405cd8d088a9c5e4d61"><div class="ttname"><a href="plugin_8c.html#afbccf58e824f3405cd8d088a9c5e4d61">plugin_defined</a></div><div class="ttdeci">bool plugin_defined(const struct plugin_list *pl, const int type)</div><div class="ttdef"><b>Definition:</b> <a href="plugin_8c_source.html#l00940">plugin.c:940</a></div></div>
<div class="ttc" id="astructcontext__1_html_ad11841ba9d26ef246e5812a7a7db27b6"><div class="ttname"><a href="structcontext__1.html#ad11841ba9d26ef246e5812a7a7db27b6">context_1::ciphername</a></div><div class="ttdeci">const char * ciphername</div><div class="ttdoc">Data channel cipher from config file.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00207">openvpn.h:207</a></div></div>
<div class="ttc" id="ainit_8c_html_a3bc4d5a823499472a3bc61b5a263c603"><div class="ttname"><a href="init_8c.html#a3bc4d5a823499472a3bc61b5a263c603">do_init_finalize_tls_frame</a></div><div class="ttdeci">static void do_init_finalize_tls_frame(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03051">init.c:3051</a></div></div>
<div class="ttc" id="astructsha256__digest_html"><div class="ttname"><a href="structsha256__digest.html">sha256_digest</a></div><div class="ttdoc">Wrapper struct to pass around SHA256 digests.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00132">crypto.h:132</a></div></div>
<div class="ttc" id="astructoptions_html_a16ceb67810c4fefa8b47b716cac5f835"><div class="ttname"><a href="structoptions.html#a16ceb67810c4fefa8b47b716cac5f835">options::tmp_dir</a></div><div class="ttdeci">const char * tmp_dir</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00420">options.h:420</a></div></div>
<div class="ttc" id="alist_8h_html"><div class="ttname"><a href="list_8h.html">list.h</a></div></div>
<div class="ttc" id="astructwin32__signal_html_ae1315d34c8036d2abf42b59d943ab1d0"><div class="ttname"><a href="structwin32__signal.html#ae1315d34c8036d2abf42b59d943ab1d0">win32_signal::mode</a></div><div class="ttdeci">int mode</div><div class="ttdef"><b>Definition:</b> <a href="win32_8h_source.html#l00153">win32.h:153</a></div></div>
<div class="ttc" id="astructoptions_html_a9665bb2a81816f56c43a05593b7cf304"><div class="ttname"><a href="structoptions.html#a9665bb2a81816f56c43a05593b7cf304">options::crl_file</a></div><div class="ttdeci">const char * crl_file</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00566">options.h:566</a></div></div>
<div class="ttc" id="astructcrypto__options_html_ab4b7f20d49e1ac2efb9faf4a13d3701d"><div class="ttname"><a href="structcrypto__options.html#ab4b7f20d49e1ac2efb9faf4a13d3701d">crypto_options::packet_id</a></div><div class="ttdeci">struct packet_id packet_id</div><div class="ttdoc">Current packet ID state for both sending and receiving directions.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00238">crypto.h:238</a></div></div>
<div class="ttc" id="astructcontext__2_html_a04ff4807150572d100c753bb76b47b1b"><div class="ttname"><a href="structcontext__2.html#a04ff4807150572d100c753bb76b47b1b">context_2::options_string_local</a></div><div class="ttdeci">char * options_string_local</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00313">openvpn.h:313</a></div></div>
<div class="ttc" id="atun_8h_html_afef2adbc3d7467cec1a651e1d513f227"><div class="ttname"><a href="tun_8h.html#afef2adbc3d7467cec1a651e1d513f227">tuncfg</a></div><div class="ttdeci">void tuncfg(const char *dev, const char *dev_type, const char *dev_node, int persist_mode, const char *username, const char *groupname, const struct tuntap_options *options, openvpn_net_ctx_t *ctx)</div></div>
<div class="ttc" id="asig_8h_html"><div class="ttname"><a href="sig_8h.html">sig.h</a></div></div>
<div class="ttc" id="asig_8h_html_ab8b88b4e662519c9b9a38eda6f0b443c"><div class="ttname"><a href="sig_8h.html#ab8b88b4e662519c9b9a38eda6f0b443c">SIG_SOURCE_SOFT</a></div><div class="ttdeci">#define SIG_SOURCE_SOFT</div><div class="ttdef"><b>Definition:</b> <a href="sig_8h_source.html#l00032">sig.h:32</a></div></div>
<div class="ttc" id="ainit_8c_html_a4f3c4044edc3d306325c49f75e18c931"><div class="ttname"><a href="init_8c.html#a4f3c4044edc3d306325c49f75e18c931">CF_LOAD_PERSISTED_PACKET_ID</a></div><div class="ttdeci">#define CF_LOAD_PERSISTED_PACKET_ID</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00066">init.c:66</a></div></div>
<div class="ttc" id="ainit_8c_html_a5c4a6e02a7ce255f07b18c8fa91165d1"><div class="ttname"><a href="init_8c.html#a5c4a6e02a7ce255f07b18c8fa91165d1">management_callback_proxy_cmd</a></div><div class="ttdeci">static bool management_callback_proxy_cmd(void *arg, const char **p)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00214">init.c:214</a></div></div>
<div class="ttc" id="astructoptions_html_a9f34739ff66477dcf8e5db79a87517e3"><div class="ttname"><a href="structoptions.html#a9f34739ff66477dcf8e5db79a87517e3">options::route_delay_window</a></div><div class="ttdeci">int route_delay_window</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00381">options.h:381</a></div></div>
<div class="ttc" id="aproxy_8h_html_a1c6ead53828182f53154be4dad1a9974"><div class="ttname"><a href="proxy_8h.html#a1c6ead53828182f53154be4dad1a9974">PAR_NCT</a></div><div class="ttdeci">#define PAR_NCT</div><div class="ttdef"><b>Definition:</b> <a href="proxy_8h_source.html#l00050">proxy.h:50</a></div></div>
<div class="ttc" id="awin32_8c_html_a1d275db1b13e814e051e72d0572a437c"><div class="ttname"><a href="win32_8c.html#a1d275db1b13e814e051e72d0572a437c">win32_signal_open</a></div><div class="ttdeci">void win32_signal_open(struct win32_signal *ws, int force, const char *exit_event_name, bool exit_event_initial_state)</div><div class="ttdef"><b>Definition:</b> <a href="win32_8c_source.html#l00456">win32.c:456</a></div></div>
<div class="ttc" id="aoptions_8h_html_ada005c713e5d684cb6296ba483870c98"><div class="ttname"><a href="options_8h.html#ada005c713e5d684cb6296ba483870c98">OPT_P_ROUTE_EXTRAS</a></div><div class="ttdeci">#define OPT_P_ROUTE_EXTRAS</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00696">options.h:696</a></div></div>
<div class="ttc" id="astructlink__socket__actual_html_abf5bf8e6a58e0af01a0ca0675e2a2a5c"><div class="ttname"><a href="structlink__socket__actual.html#abf5bf8e6a58e0af01a0ca0675e2a2a5c">link_socket_actual::dest</a></div><div class="ttdeci">struct openvpn_sockaddr dest</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00089">socket.h:89</a></div></div>
<div class="ttc" id="aoptions_8h_html_afcee9aa7bf8251da70176204a05d9f9b"><div class="ttname"><a href="options_8h.html#afcee9aa7bf8251da70176204a05d9f9b">CE_DISABLED</a></div><div class="ttdeci">#define CE_DISABLED</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00130">options.h:130</a></div></div>
<div class="ttc" id="astructoptions_html_af42951e43928baf71be50f6d6680358a"><div class="ttname"><a href="structoptions.html#af42951e43928baf71be50f6d6680358a">options::occ</a></div><div class="ttdeci">bool occ</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00392">options.h:392</a></div></div>
<div class="ttc" id="astructoptions_html_a46e9ecdbdf449d7298f3fe42d587b5f4"><div class="ttname"><a href="structoptions.html#a46e9ecdbdf449d7298f3fe42d587b5f4">options::persist_mode</a></div><div class="ttdeci">int persist_mode</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00230">options.h:230</a></div></div>
<div class="ttc" id="asig_8c_html_a72435bcf3d3d808567a47c639a8fd121"><div class="ttname"><a href="sig_8c.html#a72435bcf3d3d808567a47c639a8fd121">remap_signal</a></div><div class="ttdeci">void remap_signal(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="sig_8c_source.html#l00375">sig.c:375</a></div></div>
<div class="ttc" id="astructcontext__2_html_a666bfe66da6072618edc5a0f5688780f"><div class="ttname"><a href="structcontext__2.html#a666bfe66da6072618edc5a0f5688780f">context_2::link_socket_owned</a></div><div class="ttdeci">bool link_socket_owned</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00259">openvpn.h:259</a></div></div>
<div class="ttc" id="ainit_8c_html_a72b3b82c87f67f0574e741fc3d70a5b6"><div class="ttname"><a href="init_8c.html#a72b3b82c87f67f0574e741fc3d70a5b6">do_route</a></div><div class="ttdeci">void do_route(const struct options *options, struct route_list *route_list, struct route_ipv6_list *route_ipv6_list, const struct tuntap *tt, const struct plugin_list *plugins, struct env_set *es, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01696">init.c:1696</a></div></div>
<div class="ttc" id="ainit_8c_html_a26b00bb1c20dc239a7dc415494b3ca0c"><div class="ttname"><a href="init_8c.html#a26b00bb1c20dc239a7dc415494b3ca0c">do_init_tun</a></div><div class="ttdeci">static void do_init_tun(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01752">init.c:1752</a></div></div>
<div class="ttc" id="abuffer_8c_html_a802172b567a3ac89a544452fe02a45bf"><div class="ttname"><a href="buffer_8c.html#a802172b567a3ac89a544452fe02a45bf">buffer_list_new</a></div><div class="ttdeci">struct buffer_list * buffer_list_new(const int max_size)</div><div class="ttdoc">Allocate an empty buffer list of capacity max_size.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l01194">buffer.c:1194</a></div></div>
<div class="ttc" id="astructconnection__entry_html_ac49b7ba49fbc7efd0d77535d1c66a7d9"><div class="ttname"><a href="structconnection__entry.html#ac49b7ba49fbc7efd0d77535d1c66a7d9">connection_entry::af</a></div><div class="ttdeci">sa_family_t af</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00096">options.h:96</a></div></div>
<div class="ttc" id="acrypto__backend_8h_html_ac8c96ccbbb4f4a96934b1b1301f152d5"><div class="ttname"><a href="crypto__backend_8h.html#ac8c96ccbbb4f4a96934b1b1301f152d5">crypto_init_lib_engine</a></div><div class="ttdeci">void crypto_init_lib_engine(const char *engine_name)</div><div class="ttdef"><b>Definition:</b> <a href="crypto__openssl_8c_source.html#l00137">crypto_openssl.c:137</a></div></div>
<div class="ttc" id="astructcrypto__options_html_a4f1cebf03b32cf2f3b44e90630079e88"><div class="ttname"><a href="structcrypto__options.html#a4f1cebf03b32cf2f3b44e90630079e88">crypto_options::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdoc">Bit-flags determining behavior of security operation functions.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00257">crypto.h:257</a></div></div>
<div class="ttc" id="agroup__control__processor_html_gafe3228d8a3cae5eb8f159e8230f4cd27"><div class="ttname"><a href="group__control__processor.html#gafe3228d8a3cae5eb8f159e8230f4cd27">tls_multi_init_set_options</a></div><div class="ttdeci">void tls_multi_init_set_options(struct tls_multi *multi, const char *local, const char *remote)</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l01335">ssl.c:1335</a></div></div>
<div class="ttc" id="astructuser__pass_html"><div class="ttname"><a href="structuser__pass.html">user_pass</a></div><div class="ttdef"><b>Definition:</b> <a href="misc_8h_source.html#l00063">misc.h:63</a></div></div>
<div class="ttc" id="astructcontext__buffers_html_aa03e7433c540b45f5e427527739d888c"><div class="ttname"><a href="structcontext__buffers.html#aa03e7433c540b45f5e427527739d888c">context_buffers::read_tun_buf</a></div><div class="ttdeci">struct buffer read_tun_buf</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00112">openvpn.h:112</a></div></div>
<div class="ttc" id="astructoptions_html_af013c3f8f620bfcf06553f9e0340c6e2"><div class="ttname"><a href="structoptions.html#af013c3f8f620bfcf06553f9e0340c6e2">options::route_script</a></div><div class="ttdeci">const char * route_script</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00374">options.h:374</a></div></div>
<div class="ttc" id="ainit_8c_html_a9954eafaec4fc968645107a926f54df6"><div class="ttname"><a href="init_8c.html#a9954eafaec4fc968645107a926f54df6">do_hold</a></div><div class="ttdeci">static bool do_hold(int holdtime)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02397">init.c:2397</a></div></div>
<div class="ttc" id="astructoptions_html_a7464e4dafe3c9f80b09c620c83f22227"><div class="ttname"><a href="structoptions.html#a7464e4dafe3c9f80b09c620c83f22227">options::tuntap_options</a></div><div class="ttdeci">struct tuntap_options tuntap_options</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00316">options.h:316</a></div></div>
<div class="ttc" id="ainit_8c_html_a3333f41a29ff31266dce5dc83396ee5b"><div class="ttname"><a href="init_8c.html#a3333f41a29ff31266dce5dc83396ee5b">context_clear_1</a></div><div class="ttdeci">void context_clear_1(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00079">init.c:79</a></div></div>
<div class="ttc" id="asig_8c_html_a26c2d844baaa9c3c3457b1b8081c7458"><div class="ttname"><a href="sig_8c.html#a26c2d844baaa9c3c3457b1b8081c7458">post_init_signal_catch</a></div><div class="ttdeci">void post_init_signal_catch(void)</div><div class="ttdef"><b>Definition:</b> <a href="sig_8c_source.html#l00255">sig.c:255</a></div></div>
<div class="ttc" id="ainit_8c_html_a5701fecef4d3afde02d2604f1b61f7f3"><div class="ttname"><a href="init_8c.html#a5701fecef4d3afde02d2604f1b61f7f3">do_event_set_init</a></div><div class="ttdeci">static void do_event_set_init(struct context *c, bool need_us_timeout)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03720">init.c:3720</a></div></div>
<div class="ttc" id="abuffer_8c_html_aa6bae12914d41c7aecaa7b64fea1bc51"><div class="ttname"><a href="buffer_8c.html#aa6bae12914d41c7aecaa7b64fea1bc51">alloc_buf</a></div><div class="ttdeci">struct buffer alloc_buf(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00064">buffer.c:64</a></div></div>
<div class="ttc" id="astructcrypto__options_html_a64268b2eac664d85f5e6133264f937ce"><div class="ttname"><a href="structcrypto__options.html#a64268b2eac664d85f5e6133264f937ce">crypto_options::pid_persist</a></div><div class="ttdeci">struct packet_id_persist * pid_persist</div><div class="ttdoc">Persistent packet ID state for keeping state between successive OpenVPN process startups.</div><div class="ttdef"><b>Definition:</b> <a href="crypto_8h_source.html#l00240">crypto.h:240</a></div></div>
<div class="ttc" id="astructoptions_html_ad1a7fff9ea0912c167096c44896fedfa"><div class="ttname"><a href="structoptions.html#ad1a7fff9ea0912c167096c44896fedfa">options::route_delay</a></div><div class="ttdeci">int route_delay</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00380">options.h:380</a></div></div>
<div class="ttc" id="astructoptions_html_a6c5eef6691660bf4aa7618c2a5485558"><div class="ttname"><a href="structoptions.html#a6c5eef6691660bf4aa7618c2a5485558">options::ifconfig_local</a></div><div class="ttdeci">const char * ifconfig_local</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00267">options.h:267</a></div></div>
<div class="ttc" id="astructconnection__entry_html_acd8706781548bd6e51c6a43b9a457155"><div class="ttname"><a href="structconnection__entry.html#acd8706781548bd6e51c6a43b9a457155">connection_entry::tun_mtu</a></div><div class="ttdeci">int tun_mtu</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00114">options.h:114</a></div></div>
<div class="ttc" id="astructcontext__2_html_a582d5d0db01357d9bb7fa113ecc16c96"><div class="ttname"><a href="structcontext__2.html#a582d5d0db01357d9bb7fa113ecc16c96">context_2::occ_op</a></div><div class="ttdeci">int occ_op</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00316">openvpn.h:316</a></div></div>
<div class="ttc" id="amemdbg_8h_html"><div class="ttname"><a href="memdbg_8h.html">memdbg.h</a></div></div>
<div class="ttc" id="astructoptions_html_af331e61067f9d3fa9d071615d6830720"><div class="ttname"><a href="structoptions.html#af331e61067f9d3fa9d071615d6830720">options::verify_hash</a></div><div class="ttdeci">uint8_t * verify_hash</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00572">options.h:572</a></div></div>
<div class="ttc" id="astructoptions_html_a7309025b69e21f09e0867970b052d1e2"><div class="ttname"><a href="structoptions.html#a7309025b69e21f09e0867970b052d1e2">options::user_script_used</a></div><div class="ttdeci">bool user_script_used</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00329">options.h:329</a></div></div>
<div class="ttc" id="astructcontext__2_html_af7d86fdde3cc1792be2bd85e735a2676"><div class="ttname"><a href="structcontext__2.html#af7d86fdde3cc1792be2bd85e735a2676">context_2::ping_rec_interval</a></div><div class="ttdeci">struct event_timeout ping_rec_interval</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00306">openvpn.h:306</a></div></div>
<div class="ttc" id="apacket__id_8c_html_a5162087628a8856757b82c93cf4a696b"><div class="ttname"><a href="packet__id_8c.html#a5162087628a8856757b82c93cf4a696b">packet_id_free</a></div><div class="ttdeci">void packet_id_free(struct packet_id *p)</div><div class="ttdef"><b>Definition:</b> <a href="packet__id_8c_source.html#l00101">packet_id.c:101</a></div></div>
<div class="ttc" id="astructoptions_html_a96e979feb652ac4f21f59df5cf1ca108"><div class="ttname"><a href="structoptions.html#a96e979feb652ac4f21f59df5cf1ca108">options::ping_rec_timeout_action</a></div><div class="ttdeci">int ping_rec_timeout_action</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00301">options.h:301</a></div></div>
<div class="ttc" id="astructoptions_html_a8d144360526d22d964263e250e8b69ae"><div class="ttname"><a href="structoptions.html#a8d144360526d22d964263e250e8b69ae">options::bind_dev</a></div><div class="ttdeci">char * bind_dev</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00368">options.h:368</a></div></div>
<div class="ttc" id="ainit_8c_html_a6b2bce56f99c5d493e2282b31f950ff0"><div class="ttname"><a href="init_8c.html#a6b2bce56f99c5d493e2282b31f950ff0">do_init_crypto_tls</a></div><div class="ttdeci">static void do_init_crypto_tls(struct context *c, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l02814">init.c:2814</a></div></div>
<div class="ttc" id="astructoptions_html_ab706c7c232f46620eb6f20e3846c21f6"><div class="ttname"><a href="structoptions.html#ab706c7c232f46620eb6f20e3846c21f6">options::mtu_test</a></div><div class="ttdeci">bool mtu_test</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00280">options.h:280</a></div></div>
<div class="ttc" id="astructoptions_html_abbd5e217964dbfcda76a1a6686157eb6"><div class="ttname"><a href="structoptions.html#abbd5e217964dbfcda76a1a6686157eb6">options::management_client_user</a></div><div class="ttdeci">const char * management_client_user</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00403">options.h:403</a></div></div>
<div class="ttc" id="astructmanagement__callback_html"><div class="ttname"><a href="structmanagement__callback.html">management_callback</a></div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00154">manage.h:154</a></div></div>
<div class="ttc" id="astructoptions_html_a7f09235fee401590074265aff177491a"><div class="ttname"><a href="structoptions.html#a7f09235fee401590074265aff177491a">options::ciphername</a></div><div class="ttdeci">const char * ciphername</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00520">options.h:520</a></div></div>
<div class="ttc" id="amtu_8h_html_af353a8e54454b0a1fccc8810d5908fec"><div class="ttname"><a href="mtu_8h.html#af353a8e54454b0a1fccc8810d5908fec">SET_MTU_UPPER_BOUND</a></div><div class="ttdeci">#define SET_MTU_UPPER_BOUND</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8h_source.html#l00221">mtu.h:221</a></div></div>
<div class="ttc" id="astructoptions_html_a6ac631694e763190d479679978e19c08"><div class="ttname"><a href="structoptions.html#a6ac631694e763190d479679978e19c08">options::inactivity_timeout</a></div><div class="ttdeci">int inactivity_timeout</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00291">options.h:291</a></div></div>
<div class="ttc" id="astructcontext__2_html_a7a1136ef8707e675d479855614eadb10"><div class="ttname"><a href="structcontext__2.html#a7a1136ef8707e675d479855614eadb10">context_2::coarse_timer_wakeup</a></div><div class="ttdeci">time_t coarse_timer_wakeup</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00408">openvpn.h:408</a></div></div>
<div class="ttc" id="apacket__id_8c_html_a3f6e28af6874fe3665778dc54a8752cb"><div class="ttname"><a href="packet__id_8c.html#a3f6e28af6874fe3665778dc54a8752cb">packet_id_persist_close</a></div><div class="ttdeci">void packet_id_persist_close(struct packet_id_persist *p)</div><div class="ttdef"><b>Definition:</b> <a href="packet__id_8c_source.html#l00419">packet_id.c:419</a></div></div>
<div class="ttc" id="ainit_8c_html_af0a7adfd1ff37789d61c4066d798060e"><div class="ttname"><a href="init_8c.html#af0a7adfd1ff37789d61c4066d798060e">context_clear_all_except_first_time</a></div><div class="ttdeci">void context_clear_all_except_first_time(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00091">init.c:91</a></div></div>
<div class="ttc" id="aroute_8c_html_aef4915408d31ea4a260b875e960ef3cb"><div class="ttname"><a href="route_8c.html#aef4915408d31ea4a260b875e960ef3cb">setenv_routes</a></div><div class="ttdeci">void setenv_routes(struct env_set *es, const struct route_list *rl)</div><div class="ttdef"><b>Definition:</b> <a href="route_8c_source.html#l01452">route.c:1452</a></div></div>
<div class="ttc" id="aoptions_8h_html_a4e021c14d58bfb45e68b6155e68d40f0"><div class="ttname"><a href="options_8h.html#a4e021c14d58bfb45e68b6155e68d40f0">OPT_P_EXPLICIT_NOTIFY</a></div><div class="ttdeci">#define OPT_P_EXPLICIT_NOTIFY</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00693">options.h:693</a></div></div>
<div class="ttc" id="aoptions_8c_html_ad29b8ce8834ce432aa14dfe842dd7bbd"><div class="ttname"><a href="options_8c.html#ad29b8ce8834ce432aa14dfe842dd7bbd">title_string</a></div><div class="ttdeci">const char title_string[]</div><div class="ttdef"><b>Definition:</b> <a href="options_8c_source.html#l00067">options.c:67</a></div></div>
<div class="ttc" id="ainit_8c_html_a36115f317c9e0a45963d1aa9b2dd9da9"><div class="ttname"><a href="init_8c.html#a36115f317c9e0a45963d1aa9b2dd9da9">ce_management_query_proxy</a></div><div class="ttdeci">static bool ce_management_query_proxy(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00260">init.c:260</a></div></div>
<div class="ttc" id="astructbuffer__list_html"><div class="ttname"><a href="structbuffer__list.html">buffer_list</a></div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l01119">buffer.h:1119</a></div></div>
<div class="ttc" id="astructconnection__entry_html_aecded3865f978a060cb1539fbd394032"><div class="ttname"><a href="structconnection__entry.html#aecded3865f978a060cb1539fbd394032">connection_entry::local_port</a></div><div class="ttdeci">const char * local_port</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00097">options.h:97</a></div></div>
<div class="ttc" id="astructtls__options_html_addb0301d3ccf314df1b25286f6427ce6"><div class="ttname"><a href="structtls__options.html#addb0301d3ccf314df1b25286f6427ce6">tls_options::auth_token_call_auth</a></div><div class="ttdeci">bool auth_token_call_auth</div><div class="ttdoc">always call normal authentication</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00323">ssl_common.h:323</a></div></div>
<div class="ttc" id="aopenvpn_2error_8h_html_a446cccfde267d5f96d18513d217286fe"><div class="ttname"><a href="openvpn_2error_8h.html#a446cccfde267d5f96d18513d217286fe">M_USAGE</a></div><div class="ttdeci">#define M_USAGE</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_2error_8h_source.html#l00108">error.h:108</a></div></div>
<div class="ttc" id="aproxy_8c_html_ae8c759f7897aee01596bafa797058945"><div class="ttname"><a href="proxy_8c.html#ae8c759f7897aee01596bafa797058945">http_proxy_new</a></div><div class="ttdeci">struct http_proxy_info * http_proxy_new(const struct http_proxy_options *o)</div><div class="ttdef"><b>Definition:</b> <a href="proxy_8c_source.html#l00496">proxy.c:496</a></div></div>
<div class="ttc" id="astructcontext__2_html_afe17ff408cef993e5785dbb553851dce"><div class="ttname"><a href="structcontext__2.html#afe17ff408cef993e5785dbb553851dce">context_2::event_set_owned</a></div><div class="ttdeci">bool event_set_owned</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00239">openvpn.h:239</a></div></div>
<div class="ttc" id="astructoptions_html_ad1e91361004780f9f9c8bf2e8d7180f4"><div class="ttname"><a href="structoptions.html#ad1e91361004780f9f9c8bf2e8d7180f4">options::dev_node</a></div><div class="ttdeci">const char * dev_node</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00264">options.h:264</a></div></div>
<div class="ttc" id="ainit_8c_html_a95c0a575a66fd93651241d08fbf7444e"><div class="ttname"><a href="init_8c.html#a95c0a575a66fd93651241d08fbf7444e">do_close_event_set</a></div><div class="ttdeci">static void do_close_event_set(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03739">init.c:3739</a></div></div>
<div class="ttc" id="ainit_8c_html_a8693b9ce4067a8a8eaff5e99c87b872e"><div class="ttname"><a href="init_8c.html#a8693b9ce4067a8a8eaff5e99c87b872e">remove_pid_file</a></div><div class="ttdeci">void remove_pid_file(void)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04732">init.c:4732</a></div></div>
<div class="ttc" id="ainit_8c_html_a58388a630bb35708de3e8bd6ae4b9000"><div class="ttname"><a href="init_8c.html#a58388a630bb35708de3e8bd6ae4b9000">context_init_1</a></div><div class="ttdeci">void context_init_1(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l00694">init.c:694</a></div></div>
<div class="ttc" id="astructoptions_html_a8ccb263f0341f4fd5d62be0b75f755c8"><div class="ttname"><a href="structoptions.html#a8ccb263f0341f4fd5d62be0b75f755c8">options::auth_user_pass_verify_script</a></div><div class="ttdeci">const char * auth_user_pass_verify_script</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00487">options.h:487</a></div></div>
<div class="ttc" id="aoptions_8h_html_ae212b662019ae8c66425245463b7781d"><div class="ttname"><a href="options_8h.html#ae212b662019ae8c66425245463b7781d">OPT_P_PEER_ID</a></div><div class="ttdeci">#define OPT_P_PEER_ID</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00702">options.h:702</a></div></div>
<div class="ttc" id="astructcontext__1_html_afa252fa776c920089066ddb7bdb16b24"><div class="ttname"><a href="structcontext__1.html#afa252fa776c920089066ddb7bdb16b24">context_1::dns_cache</a></div><div class="ttdeci">struct cached_dns_entry * dns_cache</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00163">openvpn.h:163</a></div></div>
<div class="ttc" id="ainit_8c_html_a3709fc7248a2af73c0a60a34594dcee7"><div class="ttname"><a href="init_8c.html#a3709fc7248a2af73c0a60a34594dcee7">do_init_frame_tls</a></div><div class="ttdeci">static void do_init_frame_tls(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03336">init.c:3336</a></div></div>
<div class="ttc" id="aroute_8c_html_aaf3c1abc7823f84b83ec11c5de232e9c"><div class="ttname"><a href="route_8c.html#aaf3c1abc7823f84b83ec11c5de232e9c">init_route_list</a></div><div class="ttdeci">bool init_route_list(struct route_list *rl, const struct route_option_list *opt, const char *remote_endpoint, int default_metric, in_addr_t remote_host, struct env_set *es, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="route_8c_source.html#l00615">route.c:615</a></div></div>
<div class="ttc" id="astructoptions_html_a47f49634431887f4bedb38a827f0bd5c"><div class="ttname"><a href="structoptions.html#a47f49634431887f4bedb38a827f0bd5c">options::ifconfig_pool_persist_refresh_freq</a></div><div class="ttdeci">int ifconfig_pool_persist_refresh_freq</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00447">options.h:447</a></div></div>
<div class="ttc" id="astructoptions_html_a67f4cc4bc80fc43da3ca9a24e5fb72b7"><div class="ttname"><a href="structoptions.html#a67f4cc4bc80fc43da3ca9a24e5fb72b7">options::prng_hash</a></div><div class="ttdeci">const char * prng_hash</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00527">options.h:527</a></div></div>
<div class="ttc" id="amtu_8c_html_a0d975207c7e52a23853613dd18a6eebf"><div class="ttname"><a href="mtu_8c.html#a0d975207c7e52a23853613dd18a6eebf">frame_set_mtu_dynamic</a></div><div class="ttdeci">void frame_set_mtu_dynamic(struct frame *frame, int mtu, unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="mtu_8c_source.html#l00087">mtu.c:87</a></div></div>
<div class="ttc" id="asocks_8c_html_ae7e0b35168a8224034b9a8d86e2a9f5e"><div class="ttname"><a href="socks_8c.html#ae7e0b35168a8224034b9a8d86e2a9f5e">socks_adjust_frame_parameters</a></div><div class="ttdeci">void socks_adjust_frame_parameters(struct frame *frame, int proto)</div><div class="ttdef"><b>Definition:</b> <a href="socks_8c_source.html#l00053">socks.c:53</a></div></div>
<div class="ttc" id="ainit_8h_html_a296e92a38befc01c2716f5b97aeb4b3d"><div class="ttname"><a href="init_8h.html#a296e92a38befc01c2716f5b97aeb4b3d">ISC_ERRORS</a></div><div class="ttdeci">#define ISC_ERRORS</div><div class="ttdef"><b>Definition:</b> <a href="init_8h_source.html#l00117">init.h:117</a></div></div>
<div class="ttc" id="astructoptions_html_a128e966186c103e2d5dc456b90647420"><div class="ttname"><a href="structoptions.html#a128e966186c103e2d5dc456b90647420">options::ifconfig_ipv6_remote</a></div><div class="ttdeci">const char * ifconfig_ipv6_remote</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00271">options.h:271</a></div></div>
<div class="ttc" id="astructoptions_html_a45bb6bb056b0755eed6445cd8fb07156"><div class="ttname"><a href="structoptions.html#a45bb6bb056b0755eed6445cd8fb07156">options::renegotiate_bytes</a></div><div class="ttdeci">int renegotiate_bytes</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00593">options.h:593</a></div></div>
<div class="ttc" id="asocket_8c_html_a7f6b5654e386c141071a9246f68853e9"><div class="ttname"><a href="socket_8c.html#a7f6b5654e386c141071a9246f68853e9">link_socket_close</a></div><div class="ttdeci">void link_socket_close(struct link_socket *sock)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l02385">socket.c:2385</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a4d297c382e0a2017ad37b4f961bec11c"><div class="ttname"><a href="errlevel_8h.html#a4d297c382e0a2017ad37b4f961bec11c">D_CLOSE</a></div><div class="ttdeci">#define D_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00073">errlevel.h:73</a></div></div>
<div class="ttc" id="astructoptions_html_ae774b572dbe4d6eb691db24d6cbd3481"><div class="ttname"><a href="structoptions.html#ae774b572dbe4d6eb691db24d6cbd3481">options::lladdr</a></div><div class="ttdeci">const char * lladdr</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00265">options.h:265</a></div></div>
<div class="ttc" id="astructtls__options_html_a29e88c10288d7ee1207ed626117a4ea4"><div class="ttname"><a href="structtls__options.html#a29e88c10288d7ee1207ed626117a4ea4">tls_options::es</a></div><div class="ttdeci">struct env_set * es</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00332">ssl_common.h:332</a></div></div>
<div class="ttc" id="abuffer_8c_html_a3307f08331b1ce42168bafd2ecf7874a"><div class="ttname"><a href="buffer_8c.html#a3307f08331b1ce42168bafd2ecf7874a">buf_printf</a></div><div class="ttdeci">bool buf_printf(struct buffer *buf, const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00245">buffer.c:245</a></div></div>
<div class="ttc" id="astructkey__schedule_html_aea2d2038fbffa038ea608eaf923bb2db"><div class="ttname"><a href="structkey__schedule.html#aea2d2038fbffa038ea608eaf923bb2db">key_schedule::static_key</a></div><div class="ttdeci">struct key_ctx_bi static_key</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00061">openvpn.h:61</a></div></div>
<div class="ttc" id="astructoptions_html_a30cdddc3ea06d8370b311b1d3c6e7329"><div class="ttname"><a href="structoptions.html#a30cdddc3ea06d8370b311b1d3c6e7329">options::server_bridge_defined</a></div><div class="ttdeci">bool server_bridge_defined</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00435">options.h:435</a></div></div>
<div class="ttc" id="amanage_8h_html_a120badbf4a3d07337d53e6ece2d33b7d"><div class="ttname"><a href="manage_8h.html#a120badbf4a3d07337d53e6ece2d33b7d">management_query_remote_enabled</a></div><div class="ttdeci">static bool management_query_remote_enabled(const struct management *man)</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00462">manage.h:462</a></div></div>
<div class="ttc" id="ainit_8c_html_a4ce16743e82e7bcab17fe41d03b3fd44"><div class="ttname"><a href="init_8c.html#a4ce16743e82e7bcab17fe41d03b3fd44">do_init_timers</a></div><div class="ttdeci">static void do_init_timers(struct context *c, bool deferred)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01406">init.c:1406</a></div></div>
<div class="ttc" id="assl_8c_html_a8ead42ff42559ea4d44fb4cf600a26f1"><div class="ttname"><a href="ssl_8c.html#a8ead42ff42559ea4d44fb4cf600a26f1">init_ssl</a></div><div class="ttdeci">void init_ssl(const struct options *options, struct tls_root_ctx *new_ctx, bool in_chroot)</div><div class="ttdoc">Build master SSL context object that serves for the whole of OpenVPN instantiation.</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8c_source.html#l00607">ssl.c:607</a></div></div>
<div class="ttc" id="astructcontext__2_html_a267d253d04cc5ef2d91efd6ce4a8f28a"><div class="ttname"><a href="structcontext__2.html#a267d253d04cc5ef2d91efd6ce4a8f28a">context_2::do_up_ran</a></div><div class="ttdeci">bool do_up_ran</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00420">openvpn.h:420</a></div></div>
<div class="ttc" id="ainit_8c_html_a27a30601d477a9ec64c7b5abb697b5df"><div class="ttname"><a href="init_8c.html#a27a30601d477a9ec64c7b5abb697b5df">do_option_warnings</a></div><div class="ttdeci">static void do_option_warnings(struct context *c)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03233">init.c:3233</a></div></div>
<div class="ttc" id="arun__command_8c_html_ad171ff25a82c6d1f03d37c1843dc0ad0"><div class="ttname"><a href="run__command_8c.html#ad171ff25a82c6d1f03d37c1843dc0ad0">script_security</a></div><div class="ttdeci">int script_security(void)</div><div class="ttdef"><b>Definition:</b> <a href="run__command_8c_source.html#l00045">run_command.c:45</a></div></div>
<div class="ttc" id="ainit_8c_html_a0efe2bfd4ac02795b81d7aafe116fd25"><div class="ttname"><a href="init_8c.html#a0efe2bfd4ac02795b81d7aafe116fd25">initialization_sequence_completed</a></div><div class="ttdeci">void initialization_sequence_completed(struct context *c, const unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01590">init.c:1590</a></div></div>
<div class="ttc" id="abuffer_8h_html_ac3efdeb76b37368ae2658529cdbdcbda"><div class="ttname"><a href="buffer_8h.html#ac3efdeb76b37368ae2658529cdbdcbda">ALLOC_OBJ_GC</a></div><div class="ttdeci">#define ALLOC_OBJ_GC(dptr, type, gc)</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l01091">buffer.h:1091</a></div></div>
<div class="ttc" id="aconfig-msvc_8h_html_a9a941819355e6f658991890ff66b4b0e"><div class="ttname"><a href="config-msvc_8h.html#a9a941819355e6f658991890ff66b4b0e">uint8_t</a></div><div class="ttdeci">unsigned __int8 uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="config-msvc_8h_source.html#l00164">config-msvc.h:164</a></div></div>
<div class="ttc" id="astructtls__options_html_a65cc3bb31f01ba455cf02d05d9278990"><div class="ttname"><a href="structtls__options.html#a65cc3bb31f01ba455cf02d05d9278990">tls_options::plugins</a></div><div class="ttdeci">const struct plugin_list * plugins</div><div class="ttdef"><b>Definition:</b> <a href="ssl__common_8h_source.html#l00334">ssl_common.h:334</a></div></div>
<div class="ttc" id="assl_8h_html_ababe78be9417be84f1523f5f98b9a0fe"><div class="ttname"><a href="ssl_8h.html#ababe78be9417be84f1523f5f98b9a0fe">TLS_MULTI_REFRESH</a></div><div class="ttdeci">#define TLS_MULTI_REFRESH</div><div class="ttdef"><b>Definition:</b> <a href="ssl_8h_source.html#l00090">ssl.h:90</a></div></div>
<div class="ttc" id="astructoptions_html_af251f46ceb2e74a60d1cbae97a244865"><div class="ttname"><a href="structoptions.html#af251f46ceb2e74a60d1cbae97a244865">options::management_user_pass</a></div><div class="ttdeci">const char * management_user_pass</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00397">options.h:397</a></div></div>
<div class="ttc" id="assl__verify_8h_html_af731ad626c0e9d1650b5f3bd8fb3ef76"><div class="ttname"><a href="ssl__verify_8h.html#af731ad626c0e9d1650b5f3bd8fb3ef76">NS_CERT_CHECK_SERVER</a></div><div class="ttdeci">#define NS_CERT_CHECK_SERVER</div><div class="ttdoc">Do not perform Netscape certificate type verification.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__verify_8h_source.html#l00214">ssl_verify.h:214</a></div></div>
<div class="ttc" id="astructcontext__1_html_a4df958b48a25d1ceec216de0287cc7dd"><div class="ttname"><a href="structcontext__1.html#a4df958b48a25d1ceec216de0287cc7dd">context_1::http_proxy_owned</a></div><div class="ttdeci">bool http_proxy_owned</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00186">openvpn.h:186</a></div></div>
<div class="ttc" id="astructlink__socket__addr_html_a4eb1c90dc35a5fcd2952072cbe8f6c83"><div class="ttname"><a href="structlink__socket__addr.html#a4eb1c90dc35a5fcd2952072cbe8f6c83">link_socket_addr::remote_list</a></div><div class="ttdeci">struct addrinfo * remote_list</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00106">socket.h:106</a></div></div>
<div class="ttc" id="astructoptions_html_a35efdd07abfdcad8904ed80f823be6b4"><div class="ttname"><a href="structoptions.html#a35efdd07abfdcad8904ed80f823be6b4">options::remote_cert_eku</a></div><div class="ttdeci">const char * remote_cert_eku</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00571">options.h:571</a></div></div>
<div class="ttc" id="astructoptions_html_a8f6720d70314b86f89ba09c24bda9c18"><div class="ttname"><a href="structoptions.html#a8f6720d70314b86f89ba09c24bda9c18">options::pull</a></div><div class="ttdeci">bool pull</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00503">options.h:503</a></div></div>
<div class="ttc" id="aroute_8c_html_a7d24ae5eacf30d776d7c7dd91b43428c"><div class="ttname"><a href="route_8c.html#a7d24ae5eacf30d776d7c7dd91b43428c">print_default_gateway</a></div><div class="ttdeci">void print_default_gateway(const int msglevel, const struct route_gateway_info *rgi, const struct route_ipv6_gateway_info *rgi6)</div><div class="ttdef"><b>Definition:</b> <a href="route_8c_source.html#l01336">route.c:1336</a></div></div>
<div class="ttc" id="asocket_8c_html_adbff197bdb9734118cdf9889650477ae"><div class="ttname"><a href="socket_8c.html#adbff197bdb9734118cdf9889650477ae">proto_is_dgram</a></div><div class="ttdeci">bool proto_is_dgram(int proto)</div><div class="ttdef"><b>Definition:</b> <a href="socket_8c_source.html#l03198">socket.c:3198</a></div></div>
<div class="ttc" id="acompat-basename_8c_html_ac29c0b4b98013197963f0fb479dc0360"><div class="ttname"><a href="compat-basename_8c.html#ac29c0b4b98013197963f0fb479dc0360">basename</a></div><div class="ttdeci">char * basename(char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="compat-basename_8c_source.html#l00039">compat-basename.c:39</a></div></div>
<div class="ttc" id="asocket_8h_html_a50ea4ad26d16eec29ff9685126f0a599a2b277c40c006345a264777529561bf93"><div class="ttname"><a href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599a2b277c40c006345a264777529561bf93">PROTO_UDP</a></div><div class="ttdeci">@ PROTO_UDP</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00574">socket.h:574</a></div></div>
<div class="ttc" id="asocket_8h_html_a50ea4ad26d16eec29ff9685126f0a599a44547a13166ee3f0220fb3c4fc60e544"><div class="ttname"><a href="socket_8h.html#a50ea4ad26d16eec29ff9685126f0a599a44547a13166ee3f0220fb3c4fc60e544">PROTO_TCP</a></div><div class="ttdeci">@ PROTO_TCP</div><div class="ttdef"><b>Definition:</b> <a href="socket_8h_source.html#l00575">socket.h:575</a></div></div>
<div class="ttc" id="astructcontext_html_aea116e1362b8f75f5fd13e8c06fc0cf3"><div class="ttname"><a href="structcontext.html#aea116e1362b8f75f5fd13e8c06fc0cf3">context::c1</a></div><div class="ttdeci">struct context_1 c1</div><div class="ttdoc">Level 1 context.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00529">openvpn.h:529</a></div></div>
<div class="ttc" id="agroup__tls__crypt_html_gabc1250a0d15da5d5b50f49f1aec7ef19"><div class="ttname"><a href="group__tls__crypt.html#gabc1250a0d15da5d5b50f49f1aec7ef19">tls_crypt_v2_write_server_key_file</a></div><div class="ttdeci">void tls_crypt_v2_write_server_key_file(const char *filename)</div><div class="ttdoc">Generate a tls-crypt-v2 server key, and write to file.</div><div class="ttdef"><b>Definition:</b> <a href="tls__crypt_8c_source.html#l00636">tls_crypt.c:636</a></div></div>
<div class="ttc" id="assl__verify_8c_html_af3b8a3f413dbfc086e05cc5b09efb998"><div class="ttname"><a href="ssl__verify_8c.html#af3b8a3f413dbfc086e05cc5b09efb998">tls_common_name</a></div><div class="ttdeci">const char * tls_common_name(const struct tls_multi *multi, const bool null)</div><div class="ttdoc">Returns the common name field for the given tunnel.</div><div class="ttdef"><b>Definition:</b> <a href="ssl__verify_8c_source.html#l00129">ssl_verify.c:129</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_a4371249a963e1bdbd3154b399964146f"><div class="ttname"><a href="errlevel_8h.html#a4371249a963e1bdbd3154b399964146f">D_IMPORT_ERRORS</a></div><div class="ttdeci">#define D_IMPORT_ERRORS</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00064">errlevel.h:64</a></div></div>
<div class="ttc" id="aerrlevel_8h_html_aba55050bac6c04df168bb49da677f651"><div class="ttname"><a href="errlevel_8h.html#aba55050bac6c04df168bb49da677f651">D_INIT_MEDIUM</a></div><div class="ttdeci">#define D_INIT_MEDIUM</div><div class="ttdef"><b>Definition:</b> <a href="errlevel_8h_source.html#l00106">errlevel.h:106</a></div></div>
<div class="ttc" id="ainit_8c_html_a8f6bfd35ae93f4eda968d89f76637a98"><div class="ttname"><a href="init_8c.html#a8f6bfd35ae93f4eda968d89f76637a98">close_context</a></div><div class="ttdeci">void close_context(struct context *c, int sig, unsigned int flags)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04669">init.c:4669</a></div></div>
<div class="ttc" id="aopenvpn_8h_html_a690eebaffbe5bdfd2cb1c324bb89538a"><div class="ttname"><a href="openvpn_8h.html#a690eebaffbe5bdfd2cb1c324bb89538a">CM_P2P</a></div><div class="ttdeci">#define CM_P2P</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00498">openvpn.h:498</a></div></div>
<div class="ttc" id="atun_8c_html_a167ef5d50e4284066beb05f5466bd858"><div class="ttname"><a href="tun_8c.html#a167ef5d50e4284066beb05f5466bd858">dev_type_enum</a></div><div class="ttdeci">int dev_type_enum(const char *dev, const char *dev_type)</div><div class="ttdef"><b>Definition:</b> <a href="tun_8c_source.html#l00364">tun.c:364</a></div></div>
<div class="ttc" id="astructmanagement_html_a090962161ff1082218010728e25f2fd5"><div class="ttname"><a href="structmanagement.html#a090962161ff1082218010728e25f2fd5">management::persist</a></div><div class="ttdeci">struct man_persist persist</div><div class="ttdef"><b>Definition:</b> <a href="manage_8h_source.html#l00324">manage.h:324</a></div></div>
<div class="ttc" id="ainit_8c_html_aa7f085114efc1767f2cff733b82508ed"><div class="ttname"><a href="init_8c.html#aa7f085114efc1767f2cff733b82508ed">do_persist_tuntap</a></div><div class="ttdeci">bool do_persist_tuntap(const struct options *options, openvpn_net_ctx_t *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l01184">init.c:1184</a></div></div>
<div class="ttc" id="astructroute__ipv6__option__list_html_a8dcffed95f93c2a93747de1d9e165999"><div class="ttname"><a href="structroute__ipv6__option__list.html#a8dcffed95f93c2a93747de1d9e165999">route_ipv6_option_list::gc</a></div><div class="ttdeci">struct gc_arena * gc</div><div class="ttdef"><b>Definition:</b> <a href="route_8h_source.html#l00109">route.h:109</a></div></div>
<div class="ttc" id="asig_8c_html_a9dce4123b9a7da434cc417d0a1e47294"><div class="ttname"><a href="sig_8c.html#a9dce4123b9a7da434cc417d0a1e47294">signal_description</a></div><div class="ttdeci">const char * signal_description(const int signum, const char *sigtext)</div><div class="ttdef"><b>Definition:</b> <a href="sig_8c_source.html#l00091">sig.c:91</a></div></div>
<div class="ttc" id="aproxy_8c_html_a567500691abe4a2cb2a4d2efcd09310e"><div class="ttname"><a href="proxy_8c.html#a567500691abe4a2cb2a4d2efcd09310e">http_proxy_close</a></div><div class="ttdeci">void http_proxy_close(struct http_proxy_info *hp)</div><div class="ttdef"><b>Definition:</b> <a href="proxy_8c_source.html#l00557">proxy.c:557</a></div></div>
<div class="ttc" id="ainit_8c_html_a81e2893159f1bdba261c39b8b9d4409f"><div class="ttname"><a href="init_8c.html#a81e2893159f1bdba261c39b8b9d4409f">management_callback_status_p2p</a></div><div class="ttdeci">static void management_callback_status_p2p(void *arg, const int version, struct status_output *so)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l03957">init.c:3957</a></div></div>
<div class="ttc" id="aforward_8c_html_a7a409db050be184362b60f3ce7b56b35"><div class="ttname"><a href="forward_8c.html#a7a409db050be184362b60f3ce7b56b35">send_control_channel_string</a></div><div class="ttdeci">bool send_control_channel_string(struct context *c, const char *str, int msglevel)</div><div class="ttdef"><b>Definition:</b> <a href="forward_8c_source.html#l00377">forward.c:377</a></div></div>
<div class="ttc" id="astructoptions_html_a781486d9be15f2560d4f73e5eb822db7"><div class="ttname"><a href="structoptions.html#a781486d9be15f2560d4f73e5eb822db7">options::route_default_gateway</a></div><div class="ttdeci">const char * route_default_gateway</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00376">options.h:376</a></div></div>
<div class="ttc" id="ainit_8c_html_af9f473c94277d38beef77e1b1f165b33"><div class="ttname"><a href="init_8c.html#af9f473c94277d38beef77e1b1f165b33">close_management</a></div><div class="ttdeci">void close_management(void)</div><div class="ttdef"><b>Definition:</b> <a href="init_8c_source.html#l04101">init.c:4101</a></div></div>
<div class="ttc" id="astructcontext__2_html_ad8df4843172d7eaa3a83d407756f4d36"><div class="ttname"><a href="structcontext__2.html#ad8df4843172d7eaa3a83d407756f4d36">context_2::fast_io</a></div><div class="ttdeci">bool fast_io</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00433">openvpn.h:433</a></div></div>
<div class="ttc" id="astructcontext_html_a5e50d91ec749c193a852b3971cbe269f"><div class="ttname"><a href="structcontext.html#a5e50d91ec749c193a852b3971cbe269f">context::net_ctx</a></div><div class="ttdeci">openvpn_net_ctx_t net_ctx</div><div class="ttdoc">Networking API opaque context.</div><div class="ttdef"><b>Definition:</b> <a href="openvpn_8h_source.html#l00514">openvpn.h:514</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
