<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: key_state Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">key_state Struct Reference<div class="ingroups"><a class="el" href="group__control__processor.html">Control_processor</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Security parameter state of one TLS and data channel key session.  
 <a href="structkey__state.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for key_state:</div>
<div class="dyncontent">
<div class="center"><img src="structkey__state__coll__graph.png" border="0" usemap="#key__state_coll__map" alt="Collaboration graph"/></div>
<map name="key__state_coll__map" id="key__state_coll__map">
<area shape="rect" title="Security parameter state of one TLS and data channel key session." alt="" coords="1155,265,1233,292"/>
<area shape="rect" href="structkey__state__ssl.html" title=" " alt="" coords="877,87,979,113"/>
<area shape="rect" href="structbio__ctx.html" title=" " alt="" coords="649,87,713,113"/>
<area shape="rect" href="structendless__buffer.html" title=" " alt="" coords="345,91,451,117"/>
<area shape="rect" href="structbuffer__entry.html" title=" " alt="" coords="135,131,225,157"/>
<area shape="rect" href="structbuffer__list.html" title=" " alt="" coords="496,143,575,169"/>
<area shape="rect" href="structbuffer.html" title="Wrapper structure for dynamically allocated memory." alt="" coords="5,131,60,157"/>
<area shape="rect" href="structreliable__entry.html" title="The structure in which the reliability layer stores a single incoming or outgoing packet." alt="" coords="131,192,229,219"/>
<area shape="rect" href="structlink__socket__actual.html" title=" " alt="" coords="863,265,993,292"/>
<area shape="rect" href="structopenvpn__sockaddr.html" title=" " alt="" coords="616,265,747,292"/>
<area shape="rect" href="structreliable__ack.html" title="The acknowledgment structure in which packet IDs are stored for later acknowledgment." alt="" coords="883,316,973,343"/>
<area shape="rect" href="structsession__id.html" title=" " alt="" coords="886,367,970,393"/>
<area shape="rect" href="structreliable.html" title="The reliability layer storage structure for one VPN tunnel&#39;s control channel in one direction." alt="" coords="773,201,836,228"/>
<area shape="rect" href="structkey__source2.html" title="Container for both halves of random material to be used in key method 2 data channel key generation." alt="" coords="880,417,976,444"/>
<area shape="rect" href="structkey__source.html" title="Container for one half of random material to be used in key method 2 data channel key generation." alt="" coords="637,407,726,433"/>
<area shape="rect" href="structcrypto__options.html" title="Security parameter state for processing data channel packets." alt="" coords="875,480,981,507"/>
<area shape="rect" href="structpacket__id.html" title=" " alt="" coords="642,457,721,484"/>
<area shape="rect" href="structpacket__id__send.html" title=" " alt="" coords="341,407,455,433"/>
<area shape="rect" href="structpacket__id__rec.html" title=" " alt="" coords="347,457,449,484"/>
<area shape="rect" href="structkey__ctx__bi.html" title="Container for two sets of OpenSSL cipher and/or HMAC contexts for both sending and receiving directio..." alt="" coords="639,508,724,535"/>
<area shape="rect" href="structkey__ctx.html" title="Container for one set of cipher and/or HMAC contexts." alt="" coords="364,517,432,544"/>
<area shape="rect" href="structpacket__id__persist.html" title=" " alt="" coords="619,559,743,585"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a42be32cf0cb8d287f43befbbb6715472"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a42be32cf0cb8d287f43befbbb6715472">state</a></td></tr>
<tr class="separator:a42be32cf0cb8d287f43befbbb6715472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0917bb286cc8e2ddfd03676a093f84fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a0917bb286cc8e2ddfd03676a093f84fc">auth_token_state_flags</a></td></tr>
<tr class="memdesc:a0917bb286cc8e2ddfd03676a093f84fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The state of the auth-token sent from the client.  <a href="structkey__state.html#a0917bb286cc8e2ddfd03676a093f84fc">More...</a><br /></td></tr>
<tr class="separator:a0917bb286cc8e2ddfd03676a093f84fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab96385bedbe98845a4b5c64adb4e9f09"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#ab96385bedbe98845a4b5c64adb4e9f09">key_id</a></td></tr>
<tr class="memdesc:ab96385bedbe98845a4b5c64adb4e9f09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key id for this <a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a>, inherited from struct <a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a>.  <a href="structkey__state.html#ab96385bedbe98845a4b5c64adb4e9f09">More...</a><br /></td></tr>
<tr class="separator:ab96385bedbe98845a4b5c64adb4e9f09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fe04c96cfdb018c1e0076355b866b39"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structkey__state__ssl.html">key_state_ssl</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a8fe04c96cfdb018c1e0076355b866b39">ks_ssl</a></td></tr>
<tr class="separator:a8fe04c96cfdb018c1e0076355b866b39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b4fcfc00225857f9d9dbd8cf8b0a213"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a7b4fcfc00225857f9d9dbd8cf8b0a213">established</a></td></tr>
<tr class="separator:a7b4fcfc00225857f9d9dbd8cf8b0a213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ab42fd298323e60f3970178fb127330"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a9ab42fd298323e60f3970178fb127330">must_negotiate</a></td></tr>
<tr class="separator:a9ab42fd298323e60f3970178fb127330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dcda328566d402e1b0413df355398d6"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a4dcda328566d402e1b0413df355398d6">must_die</a></td></tr>
<tr class="separator:a4dcda328566d402e1b0413df355398d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0e663142818e5e45c4fd6b434c8c431"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#af0e663142818e5e45c4fd6b434c8c431">initial_opcode</a></td></tr>
<tr class="separator:af0e663142818e5e45c4fd6b434c8c431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2f4046c0cb3757c8cc20702dc4097ad"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsession__id.html">session_id</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#aa2f4046c0cb3757c8cc20702dc4097ad">session_id_remote</a></td></tr>
<tr class="separator:aa2f4046c0cb3757c8cc20702dc4097ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62d42581c267f57f88b125c70fc98439"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlink__socket__actual.html">link_socket_actual</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a62d42581c267f57f88b125c70fc98439">remote_addr</a></td></tr>
<tr class="separator:a62d42581c267f57f88b125c70fc98439"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2432af1bf9969f63599688a7adf3306d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcrypto__options.html">crypto_options</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a2432af1bf9969f63599688a7adf3306d">crypto_options</a></td></tr>
<tr class="separator:a2432af1bf9969f63599688a7adf3306d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af59a9aa0960261d4ed9d816b5448b732"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structkey__source2.html">key_source2</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#af59a9aa0960261d4ed9d816b5448b732">key_src</a></td></tr>
<tr class="separator:af59a9aa0960261d4ed9d816b5448b732"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a367442f94779a58b94e7d0f3c5d56c20"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structbuffer.html">buffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a367442f94779a58b94e7d0f3c5d56c20">plaintext_read_buf</a></td></tr>
<tr class="separator:a367442f94779a58b94e7d0f3c5d56c20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c5ca3ca552b1cc3718d81587bdeb9c9"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structbuffer.html">buffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a5c5ca3ca552b1cc3718d81587bdeb9c9">plaintext_write_buf</a></td></tr>
<tr class="separator:a5c5ca3ca552b1cc3718d81587bdeb9c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fbf1804a3fd7c2d50bc7582319e2bdb"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structbuffer.html">buffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a2fbf1804a3fd7c2d50bc7582319e2bdb">ack_write_buf</a></td></tr>
<tr class="separator:a2fbf1804a3fd7c2d50bc7582319e2bdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f7af5a94d446e54c369daa1e958f91"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structreliable.html">reliable</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#ad0f7af5a94d446e54c369daa1e958f91">send_reliable</a></td></tr>
<tr class="separator:ad0f7af5a94d446e54c369daa1e958f91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa273f201b4616a39658dcebe4ffaac14"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structreliable.html">reliable</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#aa273f201b4616a39658dcebe4ffaac14">rec_reliable</a></td></tr>
<tr class="separator:aa273f201b4616a39658dcebe4ffaac14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ac0c8a06752a5b8a3a9174e00731332"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structreliable__ack.html">reliable_ack</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a9ac0c8a06752a5b8a3a9174e00731332">rec_ack</a></td></tr>
<tr class="separator:a9ac0c8a06752a5b8a3a9174e00731332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06941b42dfd2fcce8ec6c63884839554"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structbuffer__list.html">buffer_list</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#a06941b42dfd2fcce8ec6c63884839554">paybuf</a></td></tr>
<tr class="separator:a06941b42dfd2fcce8ec6c63884839554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af754aaae84d755b996fd939f0be15d16"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a00dd6fbfb368a41945c8c6b9d6fbf88f">counter_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#af754aaae84d755b996fd939f0be15d16">n_bytes</a></td></tr>
<tr class="separator:af754aaae84d755b996fd939f0be15d16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe288dd340ed182991a423d78de3440a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="common_8h.html#a00dd6fbfb368a41945c8c6b9d6fbf88f">counter_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#afe288dd340ed182991a423d78de3440a">n_packets</a></td></tr>
<tr class="separator:afe288dd340ed182991a423d78de3440a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab84de4d6239e39c6f3721ce2ec9b4868"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="ssl__common_8h.html#a7efefa3a14114fca5c9b3c4606d19c67">ks_auth_state</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#ab84de4d6239e39c6f3721ce2ec9b4868">authenticated</a></td></tr>
<tr class="separator:ab84de4d6239e39c6f3721ce2ec9b4868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8a078848dbcb00d4255b6cae875b9a4"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkey__state.html#ad8a078848dbcb00d4255b6cae875b9a4">auth_deferred_expire</a></td></tr>
<tr class="separator:ad8a078848dbcb00d4255b6cae875b9a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Security parameter state of one TLS and data channel key session. </p>
<p>This structure represents one security parameter session between OpenVPN peers. It includes the control channel TLS state and the data channel crypto state. It also contains the reliability layer structures used for control channel messages.</p>
<p>A new <code><a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a></code> structure is initialized for each hard or soft reset.</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li>This structure should be initialized using the <code><a class="el" href="group__control__processor.html#gaf97679512a386e6c21d2d73f4ae662f6" title="Initialize a key_state structure.">key_state_init()</a></code> function.</li>
<li>This structure should be cleaned up using the <code><a class="el" href="group__control__processor.html#ga1e479e6a3ddb6991825951db9dff9319" title="Cleanup a key_state structure.">key_state_free()</a></code> function. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00166">166</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="a2fbf1804a3fd7c2d50bc7582319e2bdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fbf1804a3fd7c2d50bc7582319e2bdb">&#9670;&nbsp;</a></span>ack_write_buf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structbuffer.html">buffer</a> key_state::ack_write_buf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00194">194</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, and <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>.</p>

</div>
</div>
<a id="ad8a078848dbcb00d4255b6cae875b9a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8a078848dbcb00d4255b6cae875b9a4">&#9670;&nbsp;</a></span>auth_deferred_expire</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t key_state::auth_deferred_expire</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00209">209</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl__verify_8c_source.html#l00950">tls_authentication_status()</a>, <a class="el" href="ssl_8c_source.html#l03800">tls_pre_encrypt()</a>, <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>, and <a class="el" href="ssl_8h_source.html#l00542">tls_test_auth_deferred_interval()</a>.</p>

</div>
</div>
<a id="a0917bb286cc8e2ddfd03676a093f84fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0917bb286cc8e2ddfd03676a093f84fc">&#9670;&nbsp;</a></span>auth_token_state_flags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int key_state::auth_token_state_flags</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The state of the auth-token sent from the client. </p>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00170">170</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00304">auth_token_test_env()</a>, <a class="el" href="auth__token_8c_source.html#l00176">generate_auth_token()</a>, and <a class="el" href="ssl__verify_8c_source.html#l01279">verify_user_pass()</a>.</p>

</div>
</div>
<a id="ab84de4d6239e39c6f3721ce2ec9b4868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab84de4d6239e39c6f3721ce2ec9b4868">&#9670;&nbsp;</a></span>authenticated</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="ssl__common_8h.html#a7efefa3a14114fca5c9b3c4606d19c67">ks_auth_state</a> key_state::authenticated</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00208">208</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l03189">handle_data_channel_packet()</a>, <a class="el" href="ssl_8c_source.html#l02455">key_method_2_read()</a>, <a class="el" href="ssl_8c_source.html#l02335">key_method_2_write()</a>, <a class="el" href="multi_8c_source.html#l02955">multi_process_post()</a>, <a class="el" href="push_8c_source.html#l00731">process_incoming_push_request()</a>, <a class="el" href="ssl__verify_8c_source.html#l00950">tls_authentication_status()</a>, <a class="el" href="ssl__verify_8c_source.html#l00072">tls_deauthenticate()</a>, <a class="el" href="ssl_8c_source.html#l03800">tls_pre_encrypt()</a>, <a class="el" href="ssl_8c_source.html#l01913">tls_session_generate_data_channel_keys()</a>, <a class="el" href="ssl__verify_8c_source.html#l01453">verify_final_auth_checks()</a>, and <a class="el" href="ssl__verify_8c_source.html#l01279">verify_user_pass()</a>.</p>

</div>
</div>
<a id="a2432af1bf9969f63599688a7adf3306d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2432af1bf9969f63599688a7adf3306d">&#9670;&nbsp;</a></span>crypto_options</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcrypto__options.html">crypto_options</a> key_state::crypto_options</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00188">188</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l03189">handle_data_channel_packet()</a>, <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, <a class="el" href="ssl_8c_source.html#l03800">tls_pre_encrypt()</a>, <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>, and <a class="el" href="ssl_8c_source.html#l01913">tls_session_generate_data_channel_keys()</a>.</p>

</div>
</div>
<a id="a7b4fcfc00225857f9d9dbd8cf8b0a213"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b4fcfc00225857f9d9dbd8cf8b0a213">&#9670;&nbsp;</a></span>established</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t key_state::established</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00180">180</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>.</p>

</div>
</div>
<a id="af0e663142818e5e45c4fd6b434c8c431"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0e663142818e5e45c4fd6b434c8c431">&#9670;&nbsp;</a></span>initial_opcode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int key_state::initial_opcode</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00184">184</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, and <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>.</p>

</div>
</div>
<a id="ab96385bedbe98845a4b5c64adb4e9f09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab96385bedbe98845a4b5c64adb4e9f09">&#9670;&nbsp;</a></span>key_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int key_state::key_id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key id for this <a class="el" href="structkey__state.html" title="Security parameter state of one TLS and data channel key session.">key_state</a>, inherited from struct <a class="el" href="structtls__session.html" title="Security parameter state of a single session within a VPN tunnel.">tls_session</a>. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="structtls__session.html#a1255432a61acbfe1b94c15146e9698e0" title="The current active key id, used to keep track of renegotiations.">tls_session::key_id</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00176">176</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l03189">handle_data_channel_packet()</a>, <a class="el" href="ssl_8c_source.html#l02455">key_method_2_read()</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, <a class="el" href="ssl_8c_source.html#l00865">print_key_id()</a>, <a class="el" href="ssl__verify_8c_source.html#l00912">ssl_session_fully_authenticated()</a>, <a class="el" href="ssl_8c_source.html#l03303">tls_pre_decrypt()</a>, <a class="el" href="ssl_8c_source.html#l03800">tls_pre_encrypt()</a>, <a class="el" href="ssl_8c_source.html#l03852">tls_prepend_opcode_v1()</a>, <a class="el" href="ssl_8c_source.html#l03866">tls_prepend_opcode_v2()</a>, and <a class="el" href="ssl_8c_source.html#l01452">write_control_auth()</a>.</p>

</div>
</div>
<a id="af59a9aa0960261d4ed9d816b5448b732"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af59a9aa0960261d4ed9d816b5448b732">&#9670;&nbsp;</a></span>key_src</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structkey__source2.html">key_source2</a>* key_state::key_src</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00190">190</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02455">key_method_2_read()</a>, <a class="el" href="ssl_8c_source.html#l02335">key_method_2_write()</a>, <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, and <a class="el" href="ssl_8c_source.html#l01913">tls_session_generate_data_channel_keys()</a>.</p>

</div>
</div>
<a id="a8fe04c96cfdb018c1e0076355b866b39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fe04c96cfdb018c1e0076355b866b39">&#9670;&nbsp;</a></span>ks_ssl</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structkey__state__ssl.html">key_state_ssl</a> key_state::ks_ssl</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00178">178</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02109">flush_payload_buffer()</a>, <a class="el" href="ssl_8c_source.html#l02455">key_method_2_read()</a>, <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>, and <a class="el" href="ssl_8c_source.html#l03901">tls_send_payload()</a>.</p>

</div>
</div>
<a id="a4dcda328566d402e1b0413df355398d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dcda328566d402e1b0413df355398d6">&#9670;&nbsp;</a></span>must_die</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t key_state::must_die</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00182">182</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02129">key_state_soft_reset()</a>, and <a class="el" href="ssl_8c_source.html#l01232">lame_duck_must_die()</a>.</p>

</div>
</div>
<a id="a9ab42fd298323e60f3970178fb127330"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ab42fd298323e60f3970178fb127330">&#9670;&nbsp;</a></span>must_negotiate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t key_state::must_negotiate</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00181">181</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>.</p>

</div>
</div>
<a id="af754aaae84d755b996fd939f0be15d16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af754aaae84d755b996fd939f0be15d16">&#9670;&nbsp;</a></span>n_bytes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a00dd6fbfb368a41945c8c6b9d6fbf88f">counter_type</a> key_state::n_bytes</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00202">202</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l03189">handle_data_channel_packet()</a>, <a class="el" href="ssl_8c_source.html#l03881">tls_post_encrypt()</a>, and <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>.</p>

</div>
</div>
<a id="afe288dd340ed182991a423d78de3440a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe288dd340ed182991a423d78de3440a">&#9670;&nbsp;</a></span>n_packets</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="common_8h.html#a00dd6fbfb368a41945c8c6b9d6fbf88f">counter_type</a> key_state::n_packets</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00203">203</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l03189">handle_data_channel_packet()</a>, <a class="el" href="ssl_8c_source.html#l03881">tls_post_encrypt()</a>, and <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>.</p>

</div>
</div>
<a id="a06941b42dfd2fcce8ec6c63884839554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06941b42dfd2fcce8ec6c63884839554">&#9670;&nbsp;</a></span>paybuf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structbuffer__list.html">buffer_list</a>* key_state::paybuf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00200">200</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02109">flush_payload_buffer()</a>, <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, and <a class="el" href="ssl_8c_source.html#l03901">tls_send_payload()</a>.</p>

</div>
</div>
<a id="a367442f94779a58b94e7d0f3c5d56c20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a367442f94779a58b94e7d0f3c5d56c20">&#9670;&nbsp;</a></span>plaintext_read_buf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structbuffer.html">buffer</a> key_state::plaintext_read_buf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00192">192</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>, <a class="el" href="ssl_8c_source.html#l03940">tls_rec_payload()</a>, and <a class="el" href="ssl_8h_source.html#l00553">tls_test_payload_len()</a>.</p>

</div>
</div>
<a id="a5c5ca3ca552b1cc3718d81587bdeb9c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c5ca3ca552b1cc3718d81587bdeb9c9">&#9670;&nbsp;</a></span>plaintext_write_buf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structbuffer.html">buffer</a> key_state::plaintext_write_buf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00193">193</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, and <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>.</p>

</div>
</div>
<a id="a9ac0c8a06752a5b8a3a9174e00731332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ac0c8a06752a5b8a3a9174e00731332">&#9670;&nbsp;</a></span>rec_ack</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structreliable__ack.html">reliable_ack</a>* key_state::rec_ack</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00198">198</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, <a class="el" href="ssl_8c_source.html#l03303">tls_pre_decrypt()</a>, <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>, and <a class="el" href="ssl_8c_source.html#l01452">write_control_auth()</a>.</p>

</div>
</div>
<a id="aa273f201b4616a39658dcebe4ffaac14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa273f201b4616a39658dcebe4ffaac14">&#9670;&nbsp;</a></span>rec_reliable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structreliable.html">reliable</a>* key_state::rec_reliable</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00197">197</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, <a class="el" href="ssl_8c_source.html#l03303">tls_pre_decrypt()</a>, and <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>.</p>

</div>
</div>
<a id="a62d42581c267f57f88b125c70fc98439"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62d42581c267f57f88b125c70fc98439">&#9670;&nbsp;</a></span>remote_addr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlink__socket__actual.html">link_socket_actual</a> key_state::remote_addr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00186">186</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l03189">handle_data_channel_packet()</a>, <a class="el" href="ssl_8c_source.html#l02129">key_state_soft_reset()</a>, <a class="el" href="ssl_8c_source.html#l03021">tls_multi_process()</a>, <a class="el" href="ssl_8c_source.html#l03303">tls_pre_decrypt()</a>, <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>, <a class="el" href="ssl_8c_source.html#l03969">tls_update_remote_addr()</a>, and <a class="el" href="ssl_8c_source.html#l01452">write_control_auth()</a>.</p>

</div>
</div>
<a id="ad0f7af5a94d446e54c369daa1e958f91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0f7af5a94d446e54c369daa1e958f91">&#9670;&nbsp;</a></span>send_reliable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structreliable.html">reliable</a>* key_state::send_reliable</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00196">196</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, <a class="el" href="ssl_8c_source.html#l03303">tls_pre_decrypt()</a>, and <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>.</p>

</div>
</div>
<a id="aa2f4046c0cb3757c8cc20702dc4097ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2f4046c0cb3757c8cc20702dc4097ad">&#9670;&nbsp;</a></span>session_id_remote</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsession__id.html">session_id</a> key_state::session_id_remote</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00185">185</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l02129">key_state_soft_reset()</a>, <a class="el" href="ssl_8c_source.html#l00865">print_key_id()</a>, <a class="el" href="ssl_8c_source.html#l03021">tls_multi_process()</a>, <a class="el" href="ssl_8c_source.html#l03303">tls_pre_decrypt()</a>, <a class="el" href="ssl_8c_source.html#l01913">tls_session_generate_data_channel_keys()</a>, and <a class="el" href="ssl_8c_source.html#l01452">write_control_auth()</a>.</p>

</div>
</div>
<a id="a42be32cf0cb8d287f43befbbb6715472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42be32cf0cb8d287f43befbbb6715472">&#9670;&nbsp;</a></span>state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int key_state::state</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ssl__common_8h_source.html#l00168">168</a> of file <a class="el" href="ssl__common_8h_source.html">ssl_common.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="ssl_8c_source.html#l00996">key_state_free()</a>, <a class="el" href="ssl_8c_source.html#l00916">key_state_init()</a>, <a class="el" href="ssl_8c_source.html#l01232">lame_duck_must_die()</a>, <a class="el" href="ssl_8c_source.html#l00865">print_key_id()</a>, <a class="el" href="ssl_8c_source.html#l03021">tls_multi_process()</a>, <a class="el" href="ssl_8c_source.html#l03303">tls_pre_decrypt()</a>, <a class="el" href="ssl_8c_source.html#l03800">tls_pre_encrypt()</a>, <a class="el" href="ssl_8c_source.html#l02649">tls_process()</a>, <a class="el" href="ssl_8c_source.html#l03940">tls_rec_payload()</a>, <a class="el" href="ssl_8c_source.html#l03901">tls_send_payload()</a>, and <a class="el" href="ssl_8h_source.html#l00553">tls_test_payload_len()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>src/openvpn/<a class="el" href="ssl__common_8h_source.html">ssl_common.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
