<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: tests/unit_tests/openvpn/test_auth_token.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_59425e443f801f1f2fd8bbe4959a3ccf.html">tests</a></li><li class="navelem"><a class="el" href="dir_5f8b75fb530eeb20ca2b934e61c4d56d.html">unit_tests</a></li><li class="navelem"><a class="el" href="dir_a6377c3b803d25eb7f91ec1ca818b921.html">openvpn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">test_auth_token.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="syshead_8h_source.html">syshead.h</a>&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdarg.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;setjmp.h&gt;</code><br />
<code>#include &lt;cmocka.h&gt;</code><br />
<code>#include &quot;<a class="el" href="auth__token_8c_source.html">auth_token.c</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mock__msg_8h_source.html">mock_msg.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for test_auth_token.c:</div>
<div class="dyncontent">
<div class="center"><img src="test__auth__token_8c__incl.png" border="0" usemap="#tests_2unit__tests_2openvpn_2test__auth__token_8c" alt=""/></div>
<map name="tests_2unit__tests_2openvpn_2test__auth__token_8c" id="tests_2unit__tests_2openvpn_2test__auth__token_8c">
<area shape="rect" title=" " alt="" coords="843,5,1009,47"/>
<area shape="rect" href="syshead_8h.html" title=" " alt="" coords="813,244,895,271"/>
<area shape="rect" title=" " alt="" coords="579,95,641,121"/>
<area shape="rect" title=" " alt="" coords="665,95,733,121"/>
<area shape="rect" title=" " alt="" coords="758,95,822,121"/>
<area shape="rect" title=" " alt="" coords="846,95,915,121"/>
<area shape="rect" title=" " alt="" coords="940,95,1005,121"/>
<area shape="rect" title=" " alt="" coords="1030,95,1102,121"/>
<area shape="rect" title=" " alt="" coords="1127,95,1205,121"/>
<area shape="rect" href="auth__token_8c.html" title=" " alt="" coords="1229,95,1327,121"/>
<area shape="rect" href="mock__msg_8h.html" title=" " alt="" coords="1351,95,1448,121"/>
<area shape="rect" href="compat_8h.html" title=" " alt="" coords="1177,319,1253,345"/>
<area shape="rect" title=" " alt="" coords="1403,841,1478,868"/>
<area shape="rect" title=" " alt="" coords="224,319,308,345"/>
<area shape="rect" title=" " alt="" coords="333,319,421,345"/>
<area shape="rect" title=" " alt="" coords="445,319,524,345"/>
<area shape="rect" title=" " alt="" coords="548,319,635,345"/>
<area shape="rect" title=" " alt="" coords="659,319,742,345"/>
<area shape="rect" title=" " alt="" coords="766,319,843,345"/>
<area shape="rect" title=" " alt="" coords="867,319,942,345"/>
<area shape="rect" title=" " alt="" coords="966,319,1043,345"/>
<area shape="rect" title=" " alt="" coords="1067,319,1153,345"/>
<area shape="rect" href="base64_8h.html" title=" " alt="" coords="23,169,98,196"/>
<area shape="rect" href="buffer_8h.html" title=" " alt="" coords="1875,692,1940,719"/>
<area shape="rect" href="crypto_8h.html" title=" " alt="" coords="1449,393,1518,420"/>
<area shape="rect" href="openvpn_8h.html" title=" " alt="" coords="2178,169,2261,196"/>
<area shape="rect" href="ssl_8h.html" title=" " alt="" coords="1494,244,1545,271"/>
<area shape="rect" href="ssl__common_8h.html" title=" " alt="" coords="1633,319,1739,345"/>
<area shape="rect" href="integer_8h.html" title=" " alt="" coords="2601,692,2673,719"/>
<area shape="rect" href="auth__token_8h.html" title=" " alt="" coords="1316,169,1413,196"/>
<area shape="rect" href="push_8h.html" title=" " alt="" coords="1438,169,1499,196"/>
<area shape="rect" href="ssl__verify_8h.html" title=" " alt="" coords="1153,169,1241,196"/>
<area shape="rect" title=" " alt="" coords="1671,169,1749,196"/>
<area shape="rect" href="openvpn_2basic_8h.html" title=" " alt="" coords="1639,841,1703,868"/>
<area shape="rect" href="openvpn_2error_8h.html" title=" " alt="" coords="2182,767,2241,793"/>
<area shape="rect" href="crypto__backend_8h.html" title=" " alt="" coords="1563,617,1689,644"/>
<area shape="rect" href="packet__id_8h.html" title=" " alt="" coords="1601,468,1691,495"/>
<area shape="rect" href="mtu_8h.html" title=" " alt="" coords="1815,617,1869,644"/>
<area shape="rect" href="options_8h.html" title=" " alt="" coords="1803,393,1878,420"/>
<area shape="rect" href="route_8h.html" title=" " alt="" coords="2308,468,2371,495"/>
<area shape="rect" href="tun_8h.html" title=" " alt="" coords="2251,543,2302,569"/>
<area shape="rect" href="socket_8h.html" title=" " alt="" coords="1918,468,1990,495"/>
<area shape="rect" href="proxy_8h.html" title=" " alt="" coords="1969,543,2033,569"/>
<area shape="rect" href="socks_8h.html" title=" " alt="" coords="2159,543,2227,569"/>
<area shape="rect" href="comp_8h.html" title=" " alt="" coords="2065,468,2131,495"/>
<area shape="rect" href="interval_8h.html" title=" " alt="" coords="2502,692,2577,719"/>
<area shape="rect" href="status_8h.html" title=" " alt="" coords="2625,319,2694,345"/>
<area shape="rect" href="fragment_8h.html" title=" " alt="" coords="2327,543,2411,569"/>
<area shape="rect" href="shaper_8h.html" title=" " alt="" coords="2499,617,2571,644"/>
<area shape="rect" href="sig_8h.html" title=" " alt="" coords="2598,244,2649,271"/>
</map>
</div>
</div>
<p><a href="test__auth__token_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtest__context.html">test_context</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afeaacd608704c9ef6ddfa1bea7a280e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#afeaacd608704c9ef6ddfa1bea7a280e8">send_push_reply_auth_token</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi)</td></tr>
<tr class="memdesc:afeaacd608704c9ef6ddfa1bea7a280e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends a push reply message only containin the auth-token to update the auth-token on the client.  <a href="test__auth__token_8c.html#afeaacd608704c9ef6ddfa1bea7a280e8">More...</a><br /></td></tr>
<tr class="separator:afeaacd608704c9ef6ddfa1bea7a280e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27b82950b6bc7211a3a2f6201a2ca693"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a27b82950b6bc7211a3a2f6201a2ca693">auth_set_client_reason</a> (struct <a class="el" href="structtls__multi.html">tls_multi</a> *multi, const char *reason)</td></tr>
<tr class="memdesc:a27b82950b6bc7211a3a2f6201a2ca693"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the reason why authentication of a client failed.  <a href="test__auth__token_8c.html#a27b82950b6bc7211a3a2f6201a2ca693">More...</a><br /></td></tr>
<tr class="separator:a27b82950b6bc7211a3a2f6201a2ca693"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3743688c369a6a63ebea4512080e9fe"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#ab3743688c369a6a63ebea4512080e9fe">setup</a> (void **state)</td></tr>
<tr class="separator:ab3743688c369a6a63ebea4512080e9fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a199383cdaf56acd2611400b9bb125142"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a199383cdaf56acd2611400b9bb125142">teardown</a> (void **state)</td></tr>
<tr class="separator:a199383cdaf56acd2611400b9bb125142"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4654d043abc3cb5b18a3e18ff936b21"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#ac4654d043abc3cb5b18a3e18ff936b21">auth_token_basic_test</a> (void **state)</td></tr>
<tr class="separator:ac4654d043abc3cb5b18a3e18ff936b21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fdcdb0163e0c2a160595dda5ec7325d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a9fdcdb0163e0c2a160595dda5ec7325d">auth_token_fail_invalid_key</a> (void **state)</td></tr>
<tr class="separator:a9fdcdb0163e0c2a160595dda5ec7325d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ff87fe510600e72ab334d5aceb35f40"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a5ff87fe510600e72ab334d5aceb35f40">auth_token_test_timeout</a> (void **state)</td></tr>
<tr class="separator:a5ff87fe510600e72ab334d5aceb35f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae616f767aee2c16f6600ffac3a74b890"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#ae616f767aee2c16f6600ffac3a74b890">zerohmac</a> (char *token)</td></tr>
<tr class="separator:ae616f767aee2c16f6600ffac3a74b890"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b62b29e15b011d7095e51ab0ca6dc01"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a2b62b29e15b011d7095e51ab0ca6dc01">auth_token_test_known_keys</a> (void **state)</td></tr>
<tr class="separator:a2b62b29e15b011d7095e51ab0ca6dc01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a872620e2e324ded9c1bc8af1c253faf9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a872620e2e324ded9c1bc8af1c253faf9">setenv_str</a> (struct <a class="el" href="structenv__set.html">env_set</a> *es, const char *name, const char *value)</td></tr>
<tr class="separator:a872620e2e324ded9c1bc8af1c253faf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a796b76b5cdfc43c8de2b9b9b297c770c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a796b76b5cdfc43c8de2b9b9b297c770c">auth_token_test_empty_user</a> (void **state)</td></tr>
<tr class="separator:a796b76b5cdfc43c8de2b9b9b297c770c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a181d71ce54a53b5ad690c1b6e13828de"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a181d71ce54a53b5ad690c1b6e13828de">auth_token_test_env</a> (void **state)</td></tr>
<tr class="separator:a181d71ce54a53b5ad690c1b6e13828de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d33aa76540e69d21f6bbea59dca40b0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a6d33aa76540e69d21f6bbea59dca40b0">auth_token_test_random_keys</a> (void **state)</td></tr>
<tr class="separator:a6d33aa76540e69d21f6bbea59dca40b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ff47d852ca8a0bb0d9054d3a4726f92"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a4ff47d852ca8a0bb0d9054d3a4726f92">auth_token_test_key_load</a> (void **state)</td></tr>
<tr class="separator:a4ff47d852ca8a0bb0d9054d3a4726f92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="separator:a840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a57e22c9029ecdec0d0c0de126e4b93c4"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a57e22c9029ecdec0d0c0de126e4b93c4">now0key0</a> = &quot;SESS_ID_AT_0123456789abcdefAAAAAAAAAAAAAAAAAAAAAE5JsQJOVfo8jnI3RL3tBaR5NkE4yPfcylFUHmHSc5Bu&quot;</td></tr>
<tr class="separator:a57e22c9029ecdec0d0c0de126e4b93c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a436c55d3d750c9b200812fba7c8d416a"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a436c55d3d750c9b200812fba7c8d416a">zeroinline</a></td></tr>
<tr class="separator:a436c55d3d750c9b200812fba7c8d416a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad294aef52de5b2cebeb02da23caaf07e"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#ad294aef52de5b2cebeb02da23caaf07e">allx01inline</a></td></tr>
<tr class="separator:ad294aef52de5b2cebeb02da23caaf07e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae432d6f189f2dbe832e95e423920eb3"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#aae432d6f189f2dbe832e95e423920eb3">random_key</a></td></tr>
<tr class="separator:aae432d6f189f2dbe832e95e423920eb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51b5365eed4782ac0aef3e47b9ccff2a"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#a51b5365eed4782ac0aef3e47b9ccff2a">random_token</a> = &quot;SESS_ID_AT_ThhRItzOKNKrh3dfAAAAAFwzHpwAAAAAXDMenDdrq0RoH3dkA1f7O3wO+7kZcx2DusVZrRmFlWQM9HOb&quot;</td></tr>
<tr class="separator:a51b5365eed4782ac0aef3e47b9ccff2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac42761e3cbe74f696e57b6a593a27089"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test__auth__token_8c.html#ac42761e3cbe74f696e57b6a593a27089">lastsesion_statevalue</a></td></tr>
<tr class="separator:ac42761e3cbe74f696e57b6a593a27089"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a27b82950b6bc7211a3a2f6201a2ca693"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27b82950b6bc7211a3a2f6201a2ca693">&#9670;&nbsp;</a></span>auth_set_client_reason()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void auth_set_client_reason </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>client_reason</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the reason why authentication of a client failed. </p>
<p>This be will send to the client when the AUTH_FAILED message is sent An example would be "SESSION: Token expired" </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">multi</td><td>The multi tls struct </td></tr>
    <tr><td class="paramname">client_reason</td><td>The string to send to the client as part of AUTH_FAILED </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00058">58</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00560">tls_multi::client_reason</a>, and <a class="el" href="buffer_8c_source.html#l00665">string_alloc()</a>.</p>

</div>
</div>
<a id="ac4654d043abc3cb5b18a3e18ff936b21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4654d043abc3cb5b18a3e18ff936b21">&#9670;&nbsp;</a></span>auth_token_basic_test()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void auth_token_basic_test </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00133">133</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00567">tls_multi::auth_token</a>, <a class="el" href="ssl__common_8h_source.html#l00575">AUTH_TOKEN_HMAC_OK</a>, <a class="el" href="auth__token_8c_source.html#l00176">generate_auth_token()</a>, <a class="el" href="test__auth__token_8c_source.html#l00045">test_context::multi</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="test__auth__token_8c_source.html#l00048">test_context::session</a>, <a class="el" href="test__auth__token_8c_source.html#l00047">test_context::up</a>, and <a class="el" href="auth__token_8c_source.html#l00302">verify_auth_token()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00377">main()</a>.</p>

</div>
</div>
<a id="a9fdcdb0163e0c2a160595dda5ec7325d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fdcdb0163e0c2a160595dda5ec7325d">&#9670;&nbsp;</a></span>auth_token_fail_invalid_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void auth_token_fail_invalid_key </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00144">144</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00567">tls_multi::auth_token</a>, <a class="el" href="ssl__common_8h_source.html#l00575">AUTH_TOKEN_HMAC_OK</a>, <a class="el" href="ssl__common_8h_source.html#l00326">tls_options::auth_token_key</a>, <a class="el" href="crypto_8c_source.html#l00891">free_key_ctx()</a>, <a class="el" href="auth__token_8c_source.html#l00176">generate_auth_token()</a>, <a class="el" href="crypto_8c_source.html#l00823">init_key_ctx()</a>, <a class="el" href="test__auth__token_8c_source.html#l00046">test_context::kt</a>, <a class="el" href="test__auth__token_8c_source.html#l00045">test_context::multi</a>, <a class="el" href="ssl__common_8h_source.html#l00516">tls_multi::opt</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="test__auth__token_8c_source.html#l00048">test_context::session</a>, <a class="el" href="test__auth__token_8c_source.html#l00047">test_context::up</a>, and <a class="el" href="auth__token_8c_source.html#l00302">verify_auth_token()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00377">main()</a>.</p>

</div>
</div>
<a id="a796b76b5cdfc43c8de2b9b9b297c770c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a796b76b5cdfc43c8de2b9b9b297c770c">&#9670;&nbsp;</a></span>auth_token_test_empty_user()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void auth_token_test_empty_user </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00272">272</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00567">tls_multi::auth_token</a>, <a class="el" href="ssl__common_8h_source.html#l00577">AUTH_TOKEN_EXPIRED</a>, <a class="el" href="ssl__common_8h_source.html#l00575">AUTH_TOKEN_HMAC_OK</a>, <a class="el" href="ssl__common_8h_source.html#l00579">AUTH_TOKEN_VALID_EMPTYUSER</a>, <a class="el" href="openvpn_2basic_8h_source.html#l00033">CLEAR</a>, <a class="el" href="auth__token_8c_source.html#l00176">generate_auth_token()</a>, <a class="el" href="test__auth__token_8c_source.html#l00045">test_context::multi</a>, <a class="el" href="otime_8c_source.html#l00036">now</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="test__auth__token_8c_source.html#l00048">test_context::session</a>, <a class="el" href="test__auth__token_8c_source.html#l00047">test_context::up</a>, <a class="el" href="misc_8h_source.html#l00078">user_pass::username</a>, <a class="el" href="auth__token_8c_source.html#l00302">verify_auth_token()</a>, and <a class="el" href="test__auth__token_8c_source.html#l00233">zerohmac()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00377">main()</a>.</p>

</div>
</div>
<a id="a181d71ce54a53b5ad690c1b6e13828de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a181d71ce54a53b5ad690c1b6e13828de">&#9670;&nbsp;</a></span>auth_token_test_env()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void auth_token_test_env </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00304">304</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="auth__token_8c_source.html#l00052">add_session_token_env()</a>, <a class="el" href="ssl__common_8h_source.html#l00567">tls_multi::auth_token</a>, <a class="el" href="ssl__common_8h_source.html#l00577">AUTH_TOKEN_EXPIRED</a>, <a class="el" href="ssl__common_8h_source.html#l00575">AUTH_TOKEN_HMAC_OK</a>, <a class="el" href="ssl__common_8h_source.html#l00170">key_state::auth_token_state_flags</a>, <a class="el" href="ssl__common_8h_source.html#l00579">AUTH_TOKEN_VALID_EMPTYUSER</a>, <a class="el" href="ssl__common_8h_source.html#l00442">tls_session::key</a>, <a class="el" href="ssl__common_8h_source.html#l00381">KS_PRIMARY</a>, <a class="el" href="test__auth__token_8c_source.html#l00261">lastsesion_statevalue</a>, <a class="el" href="test__auth__token_8c_source.html#l00045">test_context::multi</a>, <a class="el" href="test__auth__token_8c_source.html#l00063">now0key0</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="test__auth__token_8c_source.html#l00048">test_context::session</a>, <a class="el" href="ssl__common_8h_source.html#l00597">tls_multi::session</a>, <a class="el" href="ssl__common_8h_source.html#l00462">TM_ACTIVE</a>, and <a class="el" href="test__auth__token_8c_source.html#l00047">test_context::up</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00377">main()</a>.</p>

</div>
</div>
<a id="a4ff47d852ca8a0bb0d9054d3a4726f92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ff47d852ca8a0bb0d9054d3a4726f92">&#9670;&nbsp;</a></span>auth_token_test_key_load()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void auth_token_test_key_load </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00362">362</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="test__auth__token_8c_source.html#l00071">allx01inline</a>, <a class="el" href="auth__token_8c_source.html#l00139">auth_token_init_secret()</a>, <a class="el" href="ssl__common_8h_source.html#l00326">tls_options::auth_token_key</a>, <a class="el" href="crypto_8c_source.html#l00891">free_key_ctx()</a>, <a class="el" href="test__auth__token_8c_source.html#l00045">test_context::multi</a>, <a class="el" href="test__auth__token_8c_source.html#l00063">now0key0</a>, <a class="el" href="ssl__common_8h_source.html#l00516">tls_multi::opt</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="test__auth__token_8c_source.html#l00048">test_context::session</a>, <a class="el" href="test__auth__token_8c_source.html#l00047">test_context::up</a>, <a class="el" href="auth__token_8c_source.html#l00302">verify_auth_token()</a>, and <a class="el" href="test__auth__token_8c_source.html#l00065">zeroinline</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00377">main()</a>.</p>

</div>
</div>
<a id="a2b62b29e15b011d7095e51ab0ca6dc01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b62b29e15b011d7095e51ab0ca6dc01">&#9670;&nbsp;</a></span>auth_token_test_known_keys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void auth_token_test_known_keys </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00241">241</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00567">tls_multi::auth_token</a>, <a class="el" href="ssl__common_8h_source.html#l00575">AUTH_TOKEN_HMAC_OK</a>, <a class="el" href="auth__token_8c_source.html#l00176">generate_auth_token()</a>, <a class="el" href="test__auth__token_8c_source.html#l00045">test_context::multi</a>, <a class="el" href="otime_8c_source.html#l00036">now</a>, <a class="el" href="test__auth__token_8c_source.html#l00063">now0key0</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="test__auth__token_8c_source.html#l00048">test_context::session</a>, <a class="el" href="test__auth__token_8c_source.html#l00047">test_context::up</a>, <a class="el" href="auth__token_8c_source.html#l00302">verify_auth_token()</a>, and <a class="el" href="test__auth__token_8c_source.html#l00233">zerohmac()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00377">main()</a>.</p>

</div>
</div>
<a id="a6d33aa76540e69d21f6bbea59dca40b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d33aa76540e69d21f6bbea59dca40b0">&#9670;&nbsp;</a></span>auth_token_test_random_keys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void auth_token_test_random_keys </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00338">338</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00567">tls_multi::auth_token</a>, <a class="el" href="auth__token_8c_source.html#l00139">auth_token_init_secret()</a>, <a class="el" href="ssl__common_8h_source.html#l00326">tls_options::auth_token_key</a>, <a class="el" href="crypto_8c_source.html#l00891">free_key_ctx()</a>, <a class="el" href="auth__token_8c_source.html#l00176">generate_auth_token()</a>, <a class="el" href="test__auth__token_8c_source.html#l00045">test_context::multi</a>, <a class="el" href="otime_8c_source.html#l00036">now</a>, <a class="el" href="ssl__common_8h_source.html#l00516">tls_multi::opt</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="test__auth__token_8c_source.html#l00077">random_key</a>, <a class="el" href="test__auth__token_8c_source.html#l00085">random_token</a>, <a class="el" href="test__auth__token_8c_source.html#l00048">test_context::session</a>, <a class="el" href="test__auth__token_8c_source.html#l00047">test_context::up</a>, <a class="el" href="auth__token_8c_source.html#l00302">verify_auth_token()</a>, and <a class="el" href="test__auth__token_8c_source.html#l00233">zerohmac()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00377">main()</a>.</p>

</div>
</div>
<a id="a5ff87fe510600e72ab334d5aceb35f40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ff87fe510600e72ab334d5aceb35f40">&#9670;&nbsp;</a></span>auth_token_test_timeout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void auth_token_test_timeout </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00171">171</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00567">tls_multi::auth_token</a>, <a class="el" href="ssl__common_8h_source.html#l00577">AUTH_TOKEN_EXPIRED</a>, <a class="el" href="ssl__common_8h_source.html#l00575">AUTH_TOKEN_HMAC_OK</a>, <a class="el" href="ssl__common_8h_source.html#l00571">tls_multi::auth_token_initial</a>, <a class="el" href="ssl__common_8h_source.html#l00324">tls_options::auth_token_lifetime</a>, <a class="el" href="auth__token_8c_source.html#l00176">generate_auth_token()</a>, <a class="el" href="test__auth__token_8c_source.html#l00045">test_context::multi</a>, <a class="el" href="otime_8c_source.html#l00036">now</a>, <a class="el" href="ssl__common_8h_source.html#l00407">tls_session::opt</a>, <a class="el" href="ssl__common_8h_source.html#l00516">tls_multi::opt</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="ssl__common_8h_source.html#l00275">tls_options::renegotiate_seconds</a>, <a class="el" href="test__auth__token_8c_source.html#l00048">test_context::session</a>, <a class="el" href="test__auth__token_8c_source.html#l00047">test_context::up</a>, and <a class="el" href="auth__token_8c_source.html#l00302">verify_auth_token()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00377">main()</a>.</p>

</div>
</div>
<a id="a840291bc02cba5474a4cb46a9b9566fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840291bc02cba5474a4cb46a9b9566fe">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00377">377</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="test__auth__token_8c_source.html#l00133">auth_token_basic_test()</a>, <a class="el" href="test__auth__token_8c_source.html#l00144">auth_token_fail_invalid_key()</a>, <a class="el" href="test__auth__token_8c_source.html#l00272">auth_token_test_empty_user()</a>, <a class="el" href="test__auth__token_8c_source.html#l00304">auth_token_test_env()</a>, <a class="el" href="test__auth__token_8c_source.html#l00362">auth_token_test_key_load()</a>, <a class="el" href="test__auth__token_8c_source.html#l00241">auth_token_test_known_keys()</a>, <a class="el" href="test__auth__token_8c_source.html#l00338">auth_token_test_random_keys()</a>, <a class="el" href="test__auth__token_8c_source.html#l00171">auth_token_test_timeout()</a>, <a class="el" href="test__auth__token_8c_source.html#l00089">setup()</a>, and <a class="el" href="test__auth__token_8c_source.html#l00119">teardown()</a>.</p>

</div>
</div>
<a id="afeaacd608704c9ef6ddfa1bea7a280e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeaacd608704c9ef6ddfa1bea7a280e8">&#9670;&nbsp;</a></span>send_push_reply_auth_token()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void send_push_reply_auth_token </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structtls__multi.html">tls_multi</a> *&#160;</td>
          <td class="paramname"><em>multi</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends a push reply message only containin the auth-token to update the auth-token on the client. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">multi</td><td>- The <a class="el" href="structtls__multi.html" title="Security parameter state for a single VPN tunnel.">tls_multi</a> structure belonging to the instance to push to </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00053">53</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00090">alloc_buf_gc()</a>, <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="buffer_8h_source.html#l00129">BSTR</a>, <a class="el" href="buffer_8c_source.html#l00245">buf_printf()</a>, <a class="el" href="errlevel_8h_source.html#l00083">D_PUSH</a>, <a class="el" href="pushlist_8h_source.html#l00031">push_entry::enable</a>, <a class="el" href="buffer_8h_source.html#l01032">gc_free()</a>, <a class="el" href="buffer_8h_source.html#l01024">gc_new()</a>, <a class="el" href="pushlist_8h_source.html#l00036">push_list::head</a>, <a class="el" href="pushlist_8h_source.html#l00032">push_entry::option</a>, <a class="el" href="push_8c_source.html#l00394">prepare_auth_token_push_reply()</a>, <a class="el" href="common_8h_source.html#l00084">PUSH_BUNDLE_SIZE</a>, <a class="el" href="push_8c_source.html#l00043">push_reply_cmd</a>, and <a class="el" href="forward_8c_source.html#l00358">send_control_channel_string_dowork()</a>.</p>

</div>
</div>
<a id="a872620e2e324ded9c1bc8af1c253faf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a872620e2e324ded9c1bc8af1c253faf9">&#9670;&nbsp;</a></span>setenv_str()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setenv_str </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structenv__set.html">env_set</a> *&#160;</td>
          <td class="paramname"><em>es</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00263">263</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8h_source.html#l00927">CC_NAME</a>, <a class="el" href="buffer_8h_source.html#l00899">CC_PRINT</a>, <a class="el" href="test__auth__token_8c_source.html#l00261">lastsesion_statevalue</a>, <a class="el" href="env__set_8c_source.html#l00337">setenv_str_ex()</a>, and <a class="el" href="options_8h_source.html#l00669">streq</a>.</p>

</div>
</div>
<a id="ab3743688c369a6a63ebea4512080e9fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3743688c369a6a63ebea4512080e9fe">&#9670;&nbsp;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int setup </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00089">89</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00320">tls_options::auth_token_generate</a>, <a class="el" href="ssl__common_8h_source.html#l00326">tls_options::auth_token_key</a>, <a class="el" href="auth__token_8c_source.html#l00032">auth_token_kt()</a>, <a class="el" href="ssl__common_8h_source.html#l00324">tls_options::auth_token_lifetime</a>, <a class="el" href="crypto_8h_source.html#l00144">key_type::digest</a>, <a class="el" href="crypto_8c_source.html#l00823">init_key_ctx()</a>, <a class="el" href="test__auth__token_8c_source.html#l00046">test_context::kt</a>, <a class="el" href="test__auth__token_8c_source.html#l00045">test_context::multi</a>, <a class="el" href="otime_8c_source.html#l00036">now</a>, <a class="el" href="ssl__common_8h_source.html#l00407">tls_session::opt</a>, <a class="el" href="ssl__common_8h_source.html#l00516">tls_multi::opt</a>, <a class="el" href="misc_8h_source.html#l00079">user_pass::password</a>, <a class="el" href="ssl__common_8h_source.html#l00275">tls_options::renegotiate_seconds</a>, <a class="el" href="test__auth__token_8c_source.html#l00048">test_context::session</a>, <a class="el" href="ssl__common_8h_source.html#l00597">tls_multi::session</a>, <a class="el" href="ssl__common_8h_source.html#l00462">TM_ACTIVE</a>, <a class="el" href="test__auth__token_8c_source.html#l00047">test_context::up</a>, and <a class="el" href="misc_8h_source.html#l00078">user_pass::username</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00377">main()</a>.</p>

</div>
</div>
<a id="a199383cdaf56acd2611400b9bb125142"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a199383cdaf56acd2611400b9bb125142">&#9670;&nbsp;</a></span>teardown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int teardown </td>
          <td>(</td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00119">119</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="ssl__common_8h_source.html#l00326">tls_options::auth_token_key</a>, <a class="el" href="crypto_8c_source.html#l00891">free_key_ctx()</a>, <a class="el" href="test__auth__token_8c_source.html#l00045">test_context::multi</a>, <a class="el" href="ssl__common_8h_source.html#l00407">tls_session::opt</a>, <a class="el" href="ssl__common_8h_source.html#l00516">tls_multi::opt</a>, <a class="el" href="test__auth__token_8c_source.html#l00048">test_context::session</a>, and <a class="el" href="auth__token_8c_source.html#l00395">wipe_auth_token()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00377">main()</a>.</p>

</div>
</div>
<a id="ae616f767aee2c16f6600ffac3a74b890"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae616f767aee2c16f6600ffac3a74b890">&#9670;&nbsp;</a></span>zerohmac()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zerohmac </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>token</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00233">233</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">References <a class="el" href="auth__token_8c_source.html#l00023">AUTH_TOKEN_SESSION_ID_LEN</a>, and <a class="el" href="auth__token_8h_source.html#l00115">SESSION_ID_PREFIX</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00272">auth_token_test_empty_user()</a>, <a class="el" href="test__auth__token_8c_source.html#l00241">auth_token_test_known_keys()</a>, and <a class="el" href="test__auth__token_8c_source.html#l00338">auth_token_test_random_keys()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad294aef52de5b2cebeb02da23caaf07e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad294aef52de5b2cebeb02da23caaf07e">&#9670;&nbsp;</a></span>allx01inline</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* allx01inline</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= <span class="stringliteral">&quot;-----BEGIN OpenVPN auth-token server key-----\n&quot;</span></div>
<div class="line">                                  <span class="stringliteral">&quot;AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEB\n&quot;</span></div>
<div class="line">                                  <span class="stringliteral">&quot;AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEB\n&quot;</span></div>
<div class="line">                                  <span class="stringliteral">&quot;AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE=\n&quot;</span></div>
<div class="line">                                  <span class="stringliteral">&quot;-----END OpenVPN auth-token server key-----&quot;</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00071">71</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00362">auth_token_test_key_load()</a>.</p>

</div>
</div>
<a id="ac42761e3cbe74f696e57b6a593a27089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac42761e3cbe74f696e57b6a593a27089">&#9670;&nbsp;</a></span>lastsesion_statevalue</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* lastsesion_statevalue</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00261">261</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00304">auth_token_test_env()</a>, and <a class="el" href="test__auth__token_8c_source.html#l00263">setenv_str()</a>.</p>

</div>
</div>
<a id="a57e22c9029ecdec0d0c0de126e4b93c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57e22c9029ecdec0d0c0de126e4b93c4">&#9670;&nbsp;</a></span>now0key0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* now0key0 = &quot;SESS_ID_AT_0123456789abcdefAAAAAAAAAAAAAAAAAAAAAE5JsQJOVfo8jnI3RL3tBaR5NkE4yPfcylFUHmHSc5Bu&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00063">63</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00304">auth_token_test_env()</a>, <a class="el" href="test__auth__token_8c_source.html#l00362">auth_token_test_key_load()</a>, and <a class="el" href="test__auth__token_8c_source.html#l00241">auth_token_test_known_keys()</a>.</p>

</div>
</div>
<a id="aae432d6f189f2dbe832e95e423920eb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae432d6f189f2dbe832e95e423920eb3">&#9670;&nbsp;</a></span>random_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* random_key</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= <span class="stringliteral">&quot;-----BEGIN OpenVPN auth-token server key-----\n&quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;+mmmf7IQ5cymtMVjKYTWk8IOcYanRlpQmV9Tb3EjkHYxueBVDg3yqRgzeBlVGzNLD//rAPiOVhau\n&quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;3NDBjNOQB8951bfs7Cc2mYfay92Bh2gRJ5XEM/DMfzCWN+7uU6NWoTTHr4FuojnIQtjtqVAj/JS9\n&quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;w+dTSp/vYHl+c7uHd19uVRu/qLqV85+rm4tUGIjO7FfYuwyPqwmhuIsi3hs9QkSimh888FmBpoKY\n&quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;/tbKVTJZmSERKti9KEwtV2eVAR0znN5KW7lCB3mHVAhN7bUpcoDjfCzYIFARxwswTFu9gFkwqUMY\n&quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;I1KUOgIsVNs4llACioeXplYekWETR+YkJwDc/A==\n&quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;-----END OpenVPN auth-token server key-----&quot;</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00077">77</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00338">auth_token_test_random_keys()</a>.</p>

</div>
</div>
<a id="a51b5365eed4782ac0aef3e47b9ccff2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51b5365eed4782ac0aef3e47b9ccff2a">&#9670;&nbsp;</a></span>random_token</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* random_token = &quot;SESS_ID_AT_ThhRItzOKNKrh3dfAAAAAFwzHpwAAAAAXDMenDdrq0RoH3dkA1f7O3wO+7kZcx2DusVZrRmFlWQM9HOb&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00085">85</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00338">auth_token_test_random_keys()</a>.</p>

</div>
</div>
<a id="a436c55d3d750c9b200812fba7c8d416a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a436c55d3d750c9b200812fba7c8d416a">&#9670;&nbsp;</a></span>zeroinline</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* zeroinline</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= <span class="stringliteral">&quot;-----BEGIN OpenVPN auth-token server key-----\n&quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n&quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n&quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=\n&quot;</span></div>
<div class="line">                                <span class="stringliteral">&quot;-----END OpenVPN auth-token server key-----&quot;</span></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="test__auth__token_8c_source.html#l00065">65</a> of file <a class="el" href="test__auth__token_8c_source.html">test_auth_token.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__auth__token_8c_source.html#l00362">auth_token_test_key_load()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
