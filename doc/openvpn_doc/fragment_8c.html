<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: src/openvpn/fragment.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_92f13d409beef24f5ba1b81abfed1f1c.html">openvpn</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fragment.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="syshead_8h_source.html">syshead.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto_8h_source.html">crypto.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="misc_8h_source.html">misc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fragment_8h_source.html">fragment.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="integer_8h_source.html">integer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="memdbg_8h_source.html">memdbg.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for fragment.c:</div>
<div class="dyncontent">
<div class="center"><img src="fragment_8c__incl.png" border="0" usemap="#src_2openvpn_2fragment_8c" alt=""/></div>
<map name="src_2openvpn_2fragment_8c" id="src_2openvpn_2fragment_8c">
<area shape="rect" title=" " alt="" coords="1879,5,2037,32"/>
<area shape="rect" href="syshead_8h.html" title=" " alt="" coords="579,80,662,107"/>
<area shape="rect" href="crypto_8h.html" title=" " alt="" coords="2223,229,2293,256"/>
<area shape="rect" href="integer_8h.html" title=" " alt="" coords="1294,453,1366,480"/>
<area shape="rect" href="misc_8h.html" title=" " alt="" coords="1906,229,1967,256"/>
<area shape="rect" href="fragment_8h.html" title=" " alt="" coords="1757,80,1841,107"/>
<area shape="rect" href="memdbg_8h.html" title=" " alt="" coords="2222,80,2305,107"/>
<area shape="rect" href="compat_8h.html" title=" " alt="" coords="635,155,711,181"/>
<area shape="rect" title=" " alt="" coords="951,603,1026,629"/>
<area shape="rect" title=" " alt="" coords="787,155,871,181"/>
<area shape="rect" title=" " alt="" coords="895,155,983,181"/>
<area shape="rect" title=" " alt="" coords="1008,155,1087,181"/>
<area shape="rect" title=" " alt="" coords="5,155,92,181"/>
<area shape="rect" title=" " alt="" coords="117,155,199,181"/>
<area shape="rect" title=" " alt="" coords="223,155,301,181"/>
<area shape="rect" title=" " alt="" coords="325,155,399,181"/>
<area shape="rect" title=" " alt="" coords="423,155,501,181"/>
<area shape="rect" title=" " alt="" coords="525,155,610,181"/>
<area shape="rect" href="crypto__backend_8h.html" title=" " alt="" coords="2354,379,2479,405"/>
<area shape="rect" href="openvpn_2basic_8h.html" title=" " alt="" coords="1898,603,1962,629"/>
<area shape="rect" href="buffer_8h.html" title=" " alt="" coords="1991,453,2056,480"/>
<area shape="rect" href="packet__id_8h.html" title=" " alt="" coords="1597,304,1687,331"/>
<area shape="rect" href="mtu_8h.html" title=" " alt="" coords="2173,304,2228,331"/>
<area shape="rect" href="crypto__openssl_8h.html" title=" " alt="" coords="2349,453,2471,480"/>
<area shape="rect" title=" " alt="" coords="2485,528,2588,555"/>
<area shape="rect" title=" " alt="" coords="2089,528,2203,555"/>
<area shape="rect" title=" " alt="" coords="2227,528,2334,555"/>
<area shape="rect" title=" " alt="" coords="2359,528,2461,555"/>
<area shape="rect" href="openvpn_2error_8h.html" title=" " alt="" coords="1397,528,1455,555"/>
<area shape="rect" title=" " alt="" coords="1441,603,1504,629"/>
<area shape="rect" title=" " alt="" coords="1529,603,1598,629"/>
<area shape="rect" href="errlevel_8h.html" title=" " alt="" coords="1342,603,1417,629"/>
<area shape="rect" href="circ__list_8h.html" title=" " alt="" coords="1608,379,1687,405"/>
<area shape="rect" href="otime_8h.html" title=" " alt="" coords="1416,379,1481,405"/>
<area shape="rect" href="common_8h.html" title=" " alt="" coords="1395,453,1478,480"/>
<area shape="rect" href="argv_8h.html" title=" " alt="" coords="2019,379,2076,405"/>
<area shape="rect" href="env__set_8h.html" title=" " alt="" coords="1897,304,1976,331"/>
<area shape="rect" href="platform_8h.html" title=" " alt="" coords="1813,379,1893,405"/>
<area shape="rect" href="interval_8h.html" title=" " alt="" coords="1762,229,1837,256"/>
<area shape="rect" href="shaper_8h.html" title=" " alt="" coords="1690,155,1762,181"/>
</map>
</div>
</div>
<p><a href="fragment_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a8982fb3523c9e7f32c4b46844a5bc82a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fragment_8c.html#a8982fb3523c9e7f32c4b46844a5bc82a">FRAG_ERR</a>(s)&#160;&#160;&#160;{ errmsg = s; goto error; }</td></tr>
<tr class="separator:a8982fb3523c9e7f32c4b46844a5bc82a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aebc43c7f7168a139c251e069e2f92a4a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fragment_8c.html#aebc43c7f7168a139c251e069e2f92a4a">fragment_list_buf_init</a> (struct <a class="el" href="structfragment__list.html">fragment_list</a> *list, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="separator:aebc43c7f7168a139c251e069e2f92a4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf012cea31d025f2d36a63ecc5660d3b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fragment_8c.html#adf012cea31d025f2d36a63ecc5660d3b">fragment_list_buf_free</a> (struct <a class="el" href="structfragment__list.html">fragment_list</a> *list)</td></tr>
<tr class="separator:adf012cea31d025f2d36a63ecc5660d3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b5bb9c8ee62a69b110ae2a2cd6874f"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structfragment.html">fragment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fragment_8c.html#a31b5bb9c8ee62a69b110ae2a2cd6874f">fragment_list_get_buf</a> (struct <a class="el" href="structfragment__list.html">fragment_list</a> *list, int seq_id)</td></tr>
<tr class="separator:a31b5bb9c8ee62a69b110ae2a2cd6874f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0be982cb04c4e5c3344d8f91323f4d8c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structfragment__master.html">fragment_master</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga0be982cb04c4e5c3344d8f91323f4d8c">fragment_init</a> (struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:ga0be982cb04c4e5c3344d8f91323f4d8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and initialize a <code><a class="el" href="structfragment__master.html" title="Fragmentation and reassembly state for one VPN tunnel instance.">fragment_master</a></code> structure.  <a href="group__fragmentation.html#ga0be982cb04c4e5c3344d8f91323f4d8c">More...</a><br /></td></tr>
<tr class="separator:ga0be982cb04c4e5c3344d8f91323f4d8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae6f7daf38cb2c0edaa6dbdfeabddb826"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gae6f7daf38cb2c0edaa6dbdfeabddb826">fragment_free</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f)</td></tr>
<tr class="memdesc:gae6f7daf38cb2c0edaa6dbdfeabddb826"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a <code><a class="el" href="structfragment__master.html" title="Fragmentation and reassembly state for one VPN tunnel instance.">fragment_master</a></code> structure and its internal packet buffers.  <a href="group__fragmentation.html#gae6f7daf38cb2c0edaa6dbdfeabddb826">More...</a><br /></td></tr>
<tr class="separator:gae6f7daf38cb2c0edaa6dbdfeabddb826"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga78eb641be3402b8db31607baba604e62"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga78eb641be3402b8db31607baba604e62">fragment_frame_init</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:ga78eb641be3402b8db31607baba604e62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate internal packet buffers for a <code><a class="el" href="structfragment__master.html" title="Fragmentation and reassembly state for one VPN tunnel instance.">fragment_master</a></code> structure.  <a href="group__fragmentation.html#ga78eb641be3402b8db31607baba604e62">More...</a><br /></td></tr>
<tr class="separator:ga78eb641be3402b8db31607baba604e62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa1048bcf1d77edd2762193d3c26e5a63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gaa1048bcf1d77edd2762193d3c26e5a63">fragment_incoming</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f, struct <a class="el" href="structbuffer.html">buffer</a> *buf, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:gaa1048bcf1d77edd2762193d3c26e5a63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process an incoming packet, which may or may not be fragmented.  <a href="group__fragmentation.html#gaa1048bcf1d77edd2762193d3c26e5a63">More...</a><br /></td></tr>
<tr class="separator:gaa1048bcf1d77edd2762193d3c26e5a63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82048c3490cb387d47a248a1daf018ec"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fragment_8c.html#a82048c3490cb387d47a248a1daf018ec">fragment_prepend_flags</a> (struct <a class="el" href="structbuffer.html">buffer</a> *buf, int type, int seq_id, int frag_id, int frag_size)</td></tr>
<tr class="separator:a82048c3490cb387d47a248a1daf018ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc34646dab8292168a39801bad17d9dc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fragment_8c.html#abc34646dab8292168a39801bad17d9dc">optimal_fragment_size</a> (int len, int max_frag_size)</td></tr>
<tr class="separator:abc34646dab8292168a39801bad17d9dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8d431d13746c625db07ffbef8fdb4b63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#ga8d431d13746c625db07ffbef8fdb4b63">fragment_outgoing</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f, struct <a class="el" href="structbuffer.html">buffer</a> *buf, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:ga8d431d13746c625db07ffbef8fdb4b63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process an outgoing packet, which may or may not need to be fragmented.  <a href="group__fragmentation.html#ga8d431d13746c625db07ffbef8fdb4b63">More...</a><br /></td></tr>
<tr class="separator:ga8d431d13746c625db07ffbef8fdb4b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafee718405669b72a316b31225da38485"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gafee718405669b72a316b31225da38485">fragment_ready_to_send</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f, struct <a class="el" href="structbuffer.html">buffer</a> *buf, const struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="memdesc:gafee718405669b72a316b31225da38485"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether outgoing fragments are ready to be send, and if so make one available.  <a href="group__fragmentation.html#gafee718405669b72a316b31225da38485">More...</a><br /></td></tr>
<tr class="separator:gafee718405669b72a316b31225da38485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a651ed1dd497d003178ee7430b7284b7f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fragment_8c.html#a651ed1dd497d003178ee7430b7284b7f">fragment_ttl_reap</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f)</td></tr>
<tr class="separator:a651ed1dd497d003178ee7430b7284b7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacf00a549c0d55a864584b128cd1d1927"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fragmentation.html#gacf00a549c0d55a864584b128cd1d1927">fragment_wakeup</a> (struct <a class="el" href="structfragment__master.html">fragment_master</a> *f, struct <a class="el" href="structframe.html">frame</a> *<a class="el" href="structframe.html">frame</a>)</td></tr>
<tr class="separator:gacf00a549c0d55a864584b128cd1d1927"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a8982fb3523c9e7f32c4b46844a5bc82a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8982fb3523c9e7f32c4b46844a5bc82a">&#9670;&nbsp;</a></span>FRAG_ERR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FRAG_ERR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">s</td><td>)</td>
          <td>&#160;&#160;&#160;{ errmsg = s; goto error; }</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fragment_8c_source.html#l00040">40</a> of file <a class="el" href="fragment_8c_source.html">fragment.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="adf012cea31d025f2d36a63ecc5660d3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf012cea31d025f2d36a63ecc5660d3b">&#9670;&nbsp;</a></span>fragment_list_buf_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fragment_list_buf_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfragment__list.html">fragment_list</a> *&#160;</td>
          <td class="paramname"><em>list</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fragment_8c_source.html#l00053">53</a> of file <a class="el" href="fragment_8c_source.html">fragment.c</a>.</p>

<p class="reference">References <a class="el" href="fragment_8h_source.html#l00086">fragment::buf</a>, <a class="el" href="fragment_8h_source.html#l00114">fragment_list::fragments</a>, <a class="el" href="buffer_8c_source.html#l00185">free_buf()</a>, and <a class="el" href="fragment_8h_source.html#l00049">N_FRAG_BUF</a>.</p>

<p class="reference">Referenced by <a class="el" href="fragment_8c_source.html#l00118">fragment_free()</a>.</p>

</div>
</div>
<a id="aebc43c7f7168a139c251e069e2f92a4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebc43c7f7168a139c251e069e2f92a4a">&#9670;&nbsp;</a></span>fragment_list_buf_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fragment_list_buf_init </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfragment__list.html">fragment_list</a> *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structframe.html">frame</a> *&#160;</td>
          <td class="paramname"><em>frame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fragment_8c_source.html#l00043">43</a> of file <a class="el" href="fragment_8c_source.html">fragment.c</a>.</p>

<p class="reference">References <a class="el" href="buffer_8c_source.html#l00064">alloc_buf()</a>, <a class="el" href="fragment_8h_source.html#l00086">fragment::buf</a>, <a class="el" href="mtu_8h_source.html#l00194">BUF_SIZE</a>, <a class="el" href="fragment_8h_source.html#l00114">fragment_list::fragments</a>, and <a class="el" href="fragment_8h_source.html#l00049">N_FRAG_BUF</a>.</p>

<p class="reference">Referenced by <a class="el" href="fragment_8c_source.html#l00127">fragment_frame_init()</a>.</p>

</div>
</div>
<a id="a31b5bb9c8ee62a69b110ae2a2cd6874f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31b5bb9c8ee62a69b110ae2a2cd6874f">&#9670;&nbsp;</a></span>fragment_list_get_buf()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structfragment.html">fragment</a>* fragment_list_get_buf </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfragment__list.html">fragment_list</a> *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seq_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fragment_8c_source.html#l00067">67</a> of file <a class="el" href="fragment_8c_source.html">fragment.c</a>.</p>

<p class="reference">References <a class="el" href="fragment_8h_source.html#l00066">fragment::defined</a>, <a class="el" href="fragment_8h_source.html#l00114">fragment_list::fragments</a>, <a class="el" href="fragment_8h_source.html#l00099">fragment_list::index</a>, <a class="el" href="integer_8h_source.html#l00116">modulo_add()</a>, <a class="el" href="integer_8h_source.html#l00101">modulo_subtract()</a>, <a class="el" href="fragment_8h_source.html#l00049">N_FRAG_BUF</a>, <a class="el" href="fragment_8h_source.html#l00142">N_SEQ_ID</a>, and <a class="el" href="fragment_8h_source.html#l00096">fragment_list::seq_id</a>.</p>

<p class="reference">Referenced by <a class="el" href="fragment_8c_source.html#l00141">fragment_incoming()</a>.</p>

</div>
</div>
<a id="a82048c3490cb387d47a248a1daf018ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82048c3490cb387d47a248a1daf018ec">&#9670;&nbsp;</a></span>fragment_prepend_flags()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fragment_prepend_flags </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbuffer.html">buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seq_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>frag_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>frag_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fragment_8c_source.html#l00266">266</a> of file <a class="el" href="fragment_8c_source.html">fragment.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00218">ASSERT</a>, <a class="el" href="fragment_8h_source.html#l00086">fragment::buf</a>, <a class="el" href="buffer_8h_source.html#l00685">buf_write_prepend()</a>, <a class="el" href="errlevel_8h_source.html#l00122">D_FRAG_DEBUG</a>, <a class="el" href="openvpn_2error_8h_source.html#l00171">dmsg</a>, <a class="el" href="fragment_8h_source.html#l00225">FRAG_ID_MASK</a>, <a class="el" href="fragment_8h_source.html#l00227">FRAG_ID_SHIFT</a>, <a class="el" href="fragment_8h_source.html#l00221">FRAG_SEQ_ID_MASK</a>, <a class="el" href="fragment_8h_source.html#l00223">FRAG_SEQ_ID_SHIFT</a>, <a class="el" href="fragment_8h_source.html#l00239">FRAG_SIZE_MASK</a>, <a class="el" href="fragment_8h_source.html#l00243">FRAG_SIZE_ROUND_SHIFT</a>, <a class="el" href="fragment_8h_source.html#l00241">FRAG_SIZE_SHIFT</a>, <a class="el" href="fragment_8h_source.html#l00204">FRAG_TYPE_MASK</a>, <a class="el" href="fragment_8h_source.html#l00206">FRAG_TYPE_SHIFT</a>, <a class="el" href="fragment_8h_source.html#l00208">FRAG_WHOLE</a>, <a class="el" href="fragment_8h_source.html#l00210">FRAG_YES_NOTLAST</a>, <a class="el" href="common_8h_source.html#l00060">fragment_header_format</a>, <a class="el" href="fragment_8h_source.html#l00194">hton_fragment_header_type</a>, and <a class="el" href="buffer_8h_source.html#l00066">buffer::len</a>.</p>

<p class="reference">Referenced by <a class="el" href="fragment_8c_source.html#l00326">fragment_outgoing()</a>, and <a class="el" href="fragment_8c_source.html#l00381">fragment_ready_to_send()</a>.</p>

</div>
</div>
<a id="a651ed1dd497d003178ee7430b7284b7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a651ed1dd497d003178ee7430b7284b7f">&#9670;&nbsp;</a></span>fragment_ttl_reap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void fragment_ttl_reap </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structfragment__master.html">fragment_master</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fragment_8c_source.html#l00418">418</a> of file <a class="el" href="fragment_8c_source.html">fragment.c</a>.</p>

<p class="reference">References <a class="el" href="errlevel_8h_source.html#l00069">D_FRAG_ERRORS</a>, <a class="el" href="fragment_8h_source.html#l00066">fragment::defined</a>, <a class="el" href="http-client_8py_source.html#l00006">http-client::f</a>, <a class="el" href="fragment_8h_source.html#l00054">FRAG_TTL_SEC</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="fragment_8h_source.html#l00049">N_FRAG_BUF</a>, <a class="el" href="otime_8c_source.html#l00036">now</a>, and <a class="el" href="fragment_8h_source.html#l00084">fragment::timestamp</a>.</p>

<p class="reference">Referenced by <a class="el" href="fragment_8c_source.html#l00434">fragment_wakeup()</a>.</p>

</div>
</div>
<a id="abc34646dab8292168a39801bad17d9dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc34646dab8292168a39801bad17d9dc">&#9670;&nbsp;</a></span>optimal_fragment_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int optimal_fragment_size </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_frag_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="fragment_8c_source.html#l00307">307</a> of file <a class="el" href="fragment_8c_source.html">fragment.c</a>.</p>

<p class="reference">References <a class="el" href="fragment_8h_source.html#l00244">FRAG_SIZE_ROUND_MASK</a>, <a class="el" href="fragment_8h_source.html#l00069">fragment::max_frag_size</a>, and <a class="el" href="integer_8h_source.html#l00057">min_int()</a>.</p>

<p class="reference">Referenced by <a class="el" href="fragment_8c_source.html#l00326">fragment_outgoing()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
