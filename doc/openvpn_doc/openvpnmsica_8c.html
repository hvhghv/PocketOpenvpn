<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: src/openvpnmsica/openvpnmsica.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cdee22a92790c26b7500dfcf39dd7ef8.html">openvpnmsica</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">openvpnmsica.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;winsock2.h&gt;</code><br />
<code>#include &quot;<a class="el" href="openvpnmsica_8h_source.html">openvpnmsica.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="msica__arg_8h_source.html">msica_arg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="msiex_8h_source.html">msiex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tapctl_2basic_8h_source.html">../tapctl/basic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tapctl_2error_8h_source.html">../tapctl/error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tap_8h_source.html">../tapctl/tap.h</a>&quot;</code><br />
<code>#include &lt;windows.h&gt;</code><br />
<code>#include &lt;iphlpapi.h&gt;</code><br />
<code>#include &lt;malloc.h&gt;</code><br />
<code>#include &lt;memory.h&gt;</code><br />
<code>#include &lt;msiquery.h&gt;</code><br />
<code>#include &lt;shellapi.h&gt;</code><br />
<code>#include &lt;shlwapi.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;tchar.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for openvpnmsica.c:</div>
<div class="dyncontent">
<div class="center"><img src="openvpnmsica_8c__incl.png" border="0" usemap="#src_2openvpnmsica_2openvpnmsica_8c" alt=""/></div>
<map name="src_2openvpnmsica_2openvpnmsica_8c" id="src_2openvpnmsica_2openvpnmsica_8c">
<area shape="rect" title=" " alt="" coords="643,5,869,32"/>
<area shape="rect" title=" " alt="" coords="5,80,93,107"/>
<area shape="rect" href="openvpnmsica_8h.html" title=" " alt="" coords="168,80,285,107"/>
<area shape="rect" title=" " alt="" coords="293,155,377,181"/>
<area shape="rect" href="tapctl_2basic_8h.html" title=" " alt="" coords="401,155,513,181"/>
<area shape="rect" href="msica__arg_8h.html" title=" " alt="" coords="575,80,668,107"/>
<area shape="rect" title=" " alt="" coords="607,155,670,181"/>
<area shape="rect" href="msiex_8h.html" title=" " alt="" coords="309,80,377,107"/>
<area shape="rect" href="tapctl_2error_8h.html" title=" " alt="" coords="793,80,900,107"/>
<area shape="rect" title=" " alt="" coords="713,155,788,181"/>
<area shape="rect" title=" " alt="" coords="905,155,969,181"/>
<area shape="rect" href="tap_8h.html" title=" " alt="" coords="401,80,500,107"/>
<area shape="rect" title=" " alt="" coords="975,80,1052,107"/>
<area shape="rect" title=" " alt="" coords="1077,80,1147,107"/>
<area shape="rect" title=" " alt="" coords="1171,80,1250,107"/>
<area shape="rect" title=" " alt="" coords="1275,80,1360,107"/>
<area shape="rect" title=" " alt="" coords="1384,80,1461,107"/>
<area shape="rect" title=" " alt="" coords="1485,80,1563,107"/>
<area shape="rect" title=" " alt="" coords="210,155,265,181"/>
<area shape="rect" title=" " alt="" coords="812,155,881,181"/>
</map>
</div>
</div>
<p><a href="openvpnmsica_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a66f2c44d1e0e422115de5ec1ac301c6f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#a66f2c44d1e0e422115de5ec1ac301c6f">MSICA_ADAPTER_TICK_SIZE</a>&#160;&#160;&#160;(16*1024) /** Amount of tick <a class="el" href="options_8c.html#a9085ab47d2925598bcb6fe2e0b0f2622">space</a> to reserve for one TAP/TUN adapter creation/deletition. */</td></tr>
<tr class="memdesc:a66f2c44d1e0e422115de5ec1ac301c6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local constants.  <a href="openvpnmsica_8c.html#a66f2c44d1e0e422115de5ec1ac301c6f">More...</a><br /></td></tr>
<tr class="separator:a66f2c44d1e0e422115de5ec1ac301c6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a971e4ef818e36fb3f83efce1d6634443"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#a971e4ef818e36fb3f83efce1d6634443">FILE_NEED_REBOOT</a>&#160;&#160;&#160;L&quot;.ovpn_need_reboot&quot;</td></tr>
<tr class="separator:a971e4ef818e36fb3f83efce1d6634443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7124873adc7ccb217b699b047063bf98"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#a7124873adc7ccb217b699b047063bf98">debug_popup</a>(f)</td></tr>
<tr class="separator:a7124873adc7ccb217b699b047063bf98"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afc3852993d3dcd7f0bdd224837aa73c1"><td class="memItemLeft" align="right" valign="top">static UINT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#afc3852993d3dcd7f0bdd224837aa73c1">setup_sequence</a> (<a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE hInstall, <a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR szProperty, <a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *seq)</td></tr>
<tr class="memdesc:afc3852993d3dcd7f0bdd224837aa73c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Joins an argument sequence and sets it to the MSI property.  <a href="openvpnmsica_8c.html#afc3852993d3dcd7f0bdd224837aa73c1">More...</a><br /></td></tr>
<tr class="separator:afc3852993d3dcd7f0bdd224837aa73c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf02471728554606048ea3cf742af28"><td class="memItemLeft" align="right" valign="top">static UINT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#a6cf02471728554606048ea3cf742af28">set_openvpnserv_state</a> (<a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE hInstall)</td></tr>
<tr class="memdesc:a6cf02471728554606048ea3cf742af28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detects if the OpenVPNService service is in use (running or paused) and sets OPENVPNSERVICE to the service process PID, or its path if it is set to auto-start, but not running.  <a href="openvpnmsica_8c.html#a6cf02471728554606048ea3cf742af28">More...</a><br /></td></tr>
<tr class="separator:a6cf02471728554606048ea3cf742af28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d3674b03d19a115cb5f28d2aa0bffb6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#a2d3674b03d19a115cb5f28d2aa0bffb6">find_adapters</a> (<a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE hInstall, <a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR szzHardwareIDs, <a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR szAdaptersPropertyName, <a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR szActiveAdaptersPropertyName)</td></tr>
<tr class="separator:a2d3674b03d19a115cb5f28d2aa0bffb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55aaec61acfbeae4ef2da1727b0194f3"><td class="memItemLeft" align="right" valign="top">UINT __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#a55aaec61acfbeae4ef2da1727b0194f3">FindSystemInfo</a> (<a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE hInstall)</td></tr>
<tr class="memdesc:a55aaec61acfbeae4ef2da1727b0194f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines Windows information:  <a href="openvpnmsica_8c.html#a55aaec61acfbeae4ef2da1727b0194f3">More...</a><br /></td></tr>
<tr class="separator:a55aaec61acfbeae4ef2da1727b0194f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a960ac51b22867a1f34f20e51265aacea"><td class="memItemLeft" align="right" valign="top">UINT __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#a960ac51b22867a1f34f20e51265aacea">CloseOpenVPNGUI</a> (<a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE hInstall)</td></tr>
<tr class="memdesc:a960ac51b22867a1f34f20e51265aacea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find OpenVPN GUI window and send it a WM_CLOSE message.  <a href="openvpnmsica_8c.html#a960ac51b22867a1f34f20e51265aacea">More...</a><br /></td></tr>
<tr class="separator:a960ac51b22867a1f34f20e51265aacea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaea463ec153c101ecd8fc1dd71276408"><td class="memItemLeft" align="right" valign="top">UINT __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#aaea463ec153c101ecd8fc1dd71276408">StartOpenVPNGUI</a> (<a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE hInstall)</td></tr>
<tr class="memdesc:aaea463ec153c101ecd8fc1dd71276408"><td class="mdescLeft">&#160;</td><td class="mdescRight">Launches OpenVPN GUI.  <a href="openvpnmsica_8c.html#aaea463ec153c101ecd8fc1dd71276408">More...</a><br /></td></tr>
<tr class="separator:aaea463ec153c101ecd8fc1dd71276408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5908c00713d42ea62dda90049609b98"><td class="memItemLeft" align="right" valign="top">static DWORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#ab5908c00713d42ea62dda90049609b98">schedule_adapter_create</a> (<a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *seq, <a class="el" href="tapctl_2basic_8h.html#a9741e627e14220d0e9a803d9fa222a69">_Inout_opt_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *seqRollback, <a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR szDisplayName, <a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR szHardwareId, <a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> int *iTicks)</td></tr>
<tr class="memdesc:ab5908c00713d42ea62dda90049609b98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedules adapter creation.  <a href="openvpnmsica_8c.html#ab5908c00713d42ea62dda90049609b98">More...</a><br /></td></tr>
<tr class="separator:ab5908c00713d42ea62dda90049609b98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57f93181adcbb8cab7dbeb9b9dbe5d44"><td class="memItemLeft" align="right" valign="top">static DWORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#a57f93181adcbb8cab7dbeb9b9dbe5d44">schedule_adapter_delete</a> (<a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *seq, <a class="el" href="tapctl_2basic_8h.html#a9741e627e14220d0e9a803d9fa222a69">_Inout_opt_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *seqCommit, <a class="el" href="tapctl_2basic_8h.html#a9741e627e14220d0e9a803d9fa222a69">_Inout_opt_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *seqRollback, <a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR szDisplayName, <a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR szzHardwareIDs, <a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> int *iTicks)</td></tr>
<tr class="memdesc:a57f93181adcbb8cab7dbeb9b9dbe5d44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedules adapter deletion.  <a href="openvpnmsica_8c.html#a57f93181adcbb8cab7dbeb9b9dbe5d44">More...</a><br /></td></tr>
<tr class="separator:a57f93181adcbb8cab7dbeb9b9dbe5d44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae811bd9b162ef40be26bc6fa52a98716"><td class="memItemLeft" align="right" valign="top">UINT __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#ae811bd9b162ef40be26bc6fa52a98716">EvaluateTUNTAPAdapters</a> (<a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE hInstall)</td></tr>
<tr class="memdesc:ae811bd9b162ef40be26bc6fa52a98716"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the TUNTAPAdapter table of the MSI package database and prepare a list of TAP adapters to install/remove.  <a href="openvpnmsica_8c.html#ae811bd9b162ef40be26bc6fa52a98716">More...</a><br /></td></tr>
<tr class="separator:ae811bd9b162ef40be26bc6fa52a98716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2afaabfc152252c302a814e1cd3b936"><td class="memItemLeft" align="right" valign="top">static BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#ac2afaabfc152252c302a814e1cd3b936">parse_guid</a> (<a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCWSTR szArg, <a class="el" href="tapctl_2basic_8h.html#a9c50bd6a6ca6e0be76a0f3a79379b90e">_Out_</a> GUID *guid)</td></tr>
<tr class="memdesc:ac2afaabfc152252c302a814e1cd3b936"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses string encoded GUID.  <a href="openvpnmsica_8c.html#ac2afaabfc152252c302a814e1cd3b936">More...</a><br /></td></tr>
<tr class="separator:ac2afaabfc152252c302a814e1cd3b936"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac838ec75ab58fd22b9617751864bbb85"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#ac838ec75ab58fd22b9617751864bbb85">CreateRebootFile</a> (<a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCWSTR szTmpDir)</td></tr>
<tr class="memdesc:ac838ec75ab58fd22b9617751864bbb85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create empty file in user's temp directory.  <a href="openvpnmsica_8c.html#ac838ec75ab58fd22b9617751864bbb85">More...</a><br /></td></tr>
<tr class="separator:ac838ec75ab58fd22b9617751864bbb85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a579590585a88c200a837d8babd6dae80"><td class="memItemLeft" align="right" valign="top">UINT __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#a579590585a88c200a837d8babd6dae80">ProcessDeferredAction</a> (<a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE hInstall)</td></tr>
<tr class="memdesc:a579590585a88c200a837d8babd6dae80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform scheduled deferred action.  <a href="openvpnmsica_8c.html#a579590585a88c200a837d8babd6dae80">More...</a><br /></td></tr>
<tr class="separator:a579590585a88c200a837d8babd6dae80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a052168435b703927f07789c10568e420"><td class="memItemLeft" align="right" valign="top">UINT __stdcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="openvpnmsica_8c.html#a052168435b703927f07789c10568e420">CheckAndScheduleReboot</a> (<a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE hInstall)</td></tr>
<tr class="memdesc:a052168435b703927f07789c10568e420"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedule reboot after installation if reboot indication file is found in user's temp directory.  <a href="openvpnmsica_8c.html#a052168435b703927f07789c10568e420">More...</a><br /></td></tr>
<tr class="separator:a052168435b703927f07789c10568e420"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7124873adc7ccb217b699b047063bf98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7124873adc7ccb217b699b047063bf98">&#9670;&nbsp;</a></span>debug_popup</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define debug_popup</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">f</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00135">135</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

</div>
</div>
<a id="a971e4ef818e36fb3f83efce1d6634443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a971e4ef818e36fb3f83efce1d6634443">&#9670;&nbsp;</a></span>FILE_NEED_REBOOT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FILE_NEED_REBOOT&#160;&#160;&#160;L&quot;.ovpn_need_reboot&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00062">62</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

</div>
</div>
<a id="a66f2c44d1e0e422115de5ec1ac301c6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66f2c44d1e0e422115de5ec1ac301c6f">&#9670;&nbsp;</a></span>MSICA_ADAPTER_TICK_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSICA_ADAPTER_TICK_SIZE&#160;&#160;&#160;(16*1024) /** Amount of tick <a class="el" href="options_8c.html#a9085ab47d2925598bcb6fe2e0b0f2622">space</a> to reserve for one TAP/TUN adapter creation/deletition. */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Local constants. </p>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00060">60</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a052168435b703927f07789c10568e420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a052168435b703927f07789c10568e420">&#9670;&nbsp;</a></span>CheckAndScheduleReboot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT __stdcall CheckAndScheduleReboot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE&#160;</td>
          <td class="paramname"><em>hInstall</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Schedule reboot after installation if reboot indication file is found in user's temp directory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hInstall</td><td>Handle to the installation provided to the DLL custom action</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; An error code otherwise See: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l01260">1260</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="openvpnmsica_8c_source.html#l00135">debug_popup</a>, <a class="el" href="openvpnmsica_8c_source.html#l00062">FILE_NEED_REBOOT</a>, <a class="el" href="openvpn_2error_8h_source.html#l00093">M_WARN</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="openvpnmsica_8h_source.html#l00054">OPENVPNMSICA_SAVE_MSI_SESSION</a>.</p>

</div>
</div>
<a id="a960ac51b22867a1f34f20e51265aacea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a960ac51b22867a1f34f20e51265aacea">&#9670;&nbsp;</a></span>CloseOpenVPNGUI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT __stdcall CloseOpenVPNGUI </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE&#160;</td>
          <td class="paramname"><em>hInstall</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find OpenVPN GUI window and send it a WM_CLOSE message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hInstall</td><td>Handle to the installation provided to the DLL custom action</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; An error code otherwise See: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00435">435</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="openvpnmsica_8c_source.html#l00135">debug_popup</a>.</p>

</div>
</div>
<a id="ac838ec75ab58fd22b9617751864bbb85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac838ec75ab58fd22b9617751864bbb85">&#9670;&nbsp;</a></span>CreateRebootFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void CreateRebootFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCWSTR&#160;</td>
          <td class="paramname"><em>szTmpDir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create empty file in user's temp directory. </p>
<p>The existence of this file is checked in the end of installation by ScheduleReboot immediate custom action which schedules reboot.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">szTmpDir</td><td>path to user's temp dirctory </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l01041">1041</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="openvpnmsica_8c_source.html#l00062">FILE_NEED_REBOOT</a>, <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00093">M_WARN</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="tapctl_2basic_8h_source.html#l00029">PRIsLPTSTR</a>.</p>

<p class="reference">Referenced by <a class="el" href="openvpnmsica_8c_source.html#l01060">ProcessDeferredAction()</a>.</p>

</div>
</div>
<a id="ae811bd9b162ef40be26bc6fa52a98716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae811bd9b162ef40be26bc6fa52a98716">&#9670;&nbsp;</a></span>EvaluateTUNTAPAdapters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT __stdcall EvaluateTUNTAPAdapters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE&#160;</td>
          <td class="paramname"><em>hInstall</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate the TUNTAPAdapter table of the MSI package database and prepare a list of TAP adapters to install/remove. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hInstall</td><td>Handle to the installation provided to the DLL custom action</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; An error code otherwise See: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00731">731</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="openvpnmsica_8c_source.html#l00135">debug_popup</a>, <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="msiex_8c_source.html#l00214">msi_format_field()</a>, <a class="el" href="msiex_8c_source.html#l00098">msi_get_record_string()</a>, <a class="el" href="msica__arg_8c_source.html#l00078">msica_arg_seq_add_tail()</a>, <a class="el" href="msica__arg_8c_source.html#l00044">msica_arg_seq_free()</a>, <a class="el" href="msica__arg_8c_source.html#l00036">msica_arg_seq_init()</a>, <a class="el" href="openvpnmsica_8h_source.html#l00054">OPENVPNMSICA_SAVE_MSI_SESSION</a>, <a class="el" href="tapctl_2basic_8h_source.html#l00029">PRIsLPTSTR</a>, <a class="el" href="openvpnmsica_8c_source.html#l00564">schedule_adapter_create()</a>, <a class="el" href="openvpnmsica_8c_source.html#l00664">schedule_adapter_delete()</a>, and <a class="el" href="openvpnmsica_8c_source.html#l00076">setup_sequence()</a>.</p>

</div>
</div>
<a id="a2d3674b03d19a115cb5f28d2aa0bffb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d3674b03d19a115cb5f28d2aa0bffb6">&#9670;&nbsp;</a></span>find_adapters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void find_adapters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE&#160;</td>
          <td class="paramname"><em>hInstall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szzHardwareIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szAdaptersPropertyName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szActiveAdaptersPropertyName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00253">253</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="tap_8h_source.html#l00138">tap_adapter_node::guid</a>, <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="tap_8h_source.html#l00142">tap_adapter_node::pNext</a>, <a class="el" href="tap_8h_source.html#l00139">tap_adapter_node::szzHardwareIDs</a>, <a class="el" href="tap_8c_source.html#l01356">tap_free_adapter_list()</a>, and <a class="el" href="tap_8c_source.html#l01147">tap_list_adapters()</a>.</p>

<p class="reference">Referenced by <a class="el" href="openvpnmsica_8c_source.html#l00402">FindSystemInfo()</a>.</p>

</div>
</div>
<a id="a55aaec61acfbeae4ef2da1727b0194f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55aaec61acfbeae4ef2da1727b0194f3">&#9670;&nbsp;</a></span>FindSystemInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT __stdcall FindSystemInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE&#160;</td>
          <td class="paramname"><em>hInstall</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines Windows information: </p>
<ul>
<li>Sets <code>OPENVPNSERVICE</code> MSI property to PID of OpenVPN Service if running, or its EXE path if configured for auto-start.</li>
<li>Finds existing TAP-Windows6 adapters and set TAPWINDOWS6ADAPTERS and ACTIVETAPWINDOWS6ADAPTERS properties with semicolon delimited list of all installed adapter GUIDs and active adapter GUIDs respectively.</li>
<li>Finds existing Wintun adapters and set WINTUNADAPTERS and ACTIVEWINTUNADAPTERS properties with semicolon delimited list of all installed adapter GUIDs and active adapter GUIDs respectively.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hInstall</td><td>Handle to the installation provided to the DLL custom action</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; An error code otherwise See: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00402">402</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="openvpnmsica_8c_source.html#l00135">debug_popup</a>, <a class="el" href="openvpnmsica_8c_source.html#l00253">find_adapters()</a>, <a class="el" href="openvpnmsica_8h_source.html#l00054">OPENVPNMSICA_SAVE_MSI_SESSION</a>, <a class="el" href="openvpnmsica_8c_source.html#l00150">set_openvpnserv_state()</a>, and <a class="el" href="config-msvc-version_8h_source.html#l00012">TAP_WIN_COMPONENT_ID</a>.</p>

</div>
</div>
<a id="ac2afaabfc152252c302a814e1cd3b936"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2afaabfc152252c302a814e1cd3b936">&#9670;&nbsp;</a></span>parse_guid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static BOOL parse_guid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCWSTR&#160;</td>
          <td class="paramname"><em>szArg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a9c50bd6a6ca6e0be76a0f3a79379b90e">_Out_</a> GUID *&#160;</td>
          <td class="paramname"><em>guid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parses string encoded GUID. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">szArg</td><td>Zero terminated string where the GUID string starts</td></tr>
    <tr><td class="paramname">guid</td><td>Pointer to GUID that receives parsed value</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE on success; FALSE otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l01019">1019</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="tapctl_2basic_8h_source.html#l00039">_L</a>, <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="tapctl_2basic_8h_source.html#l00035">PRIGUID_PARAM_REF</a>, and <a class="el" href="tapctl_2basic_8h_source.html#l00032">PRIXGUID</a>.</p>

<p class="reference">Referenced by <a class="el" href="openvpnmsica_8c_source.html#l01060">ProcessDeferredAction()</a>.</p>

</div>
</div>
<a id="a579590585a88c200a837d8babd6dae80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a579590585a88c200a837d8babd6dae80">&#9670;&nbsp;</a></span>ProcessDeferredAction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT __stdcall ProcessDeferredAction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE&#160;</td>
          <td class="paramname"><em>hInstall</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform scheduled deferred action. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hInstall</td><td>Handle to the installation provided to the DLL custom action</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; An error code otherwise See: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l01060">1060</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="openvpnmsica_8c_source.html#l01041">CreateRebootFile()</a>, <a class="el" href="openvpnmsica_8c_source.html#l00135">debug_popup</a>, <a class="el" href="tap_8h_source.html#l00138">tap_adapter_node::guid</a>, <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="msiex_8c_source.html#l00040">msi_get_string()</a>, <a class="el" href="openvpnmsica_8c_source.html#l00060">MSICA_ADAPTER_TICK_SIZE</a>, <a class="el" href="openvpnmsica_8h_source.html#l00054">OPENVPNMSICA_SAVE_MSI_SESSION</a>, <a class="el" href="openvpnmsica_8c_source.html#l01019">parse_guid()</a>, <a class="el" href="tap_8h_source.html#l00142">tap_adapter_node::pNext</a>, <a class="el" href="tap_8h_source.html#l00140">tap_adapter_node::szName</a>, <a class="el" href="tap_8c_source.html#l00725">tap_create_adapter()</a>, <a class="el" href="tap_8c_source.html#l01007">tap_delete_adapter()</a>, <a class="el" href="tap_8c_source.html#l01017">tap_enable_adapter()</a>, <a class="el" href="tap_8c_source.html#l01356">tap_free_adapter_list()</a>, <a class="el" href="tap_8c_source.html#l01147">tap_list_adapters()</a>, and <a class="el" href="tap_8c_source.html#l01065">tap_set_adapter_name()</a>.</p>

</div>
</div>
<a id="ab5908c00713d42ea62dda90049609b98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5908c00713d42ea62dda90049609b98">&#9670;&nbsp;</a></span>schedule_adapter_create()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static DWORD schedule_adapter_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a9741e627e14220d0e9a803d9fa222a69">_Inout_opt_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *&#160;</td>
          <td class="paramname"><em>seqRollback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szDisplayName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szHardwareId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> int *&#160;</td>
          <td class="paramname"><em>iTicks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Schedules adapter creation. </p>
<p>When the rollback is enabled, the adapter deletition is scheduled on rollback.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seq</td><td>The argument sequence to pass to InstallTUNTAPAdapters custom action</td></tr>
    <tr><td class="paramname">seqRollback</td><td>The argument sequence to pass to InstallTUNTAPAdaptersRollback custom action. NULL when rollback is disabled.</td></tr>
    <tr><td class="paramname">szDisplayName</td><td>Adapter display name</td></tr>
    <tr><td class="paramname">szHardwareId</td><td>Adapter hardware ID</td></tr>
    <tr><td class="paramname">iTicks</td><td>Pointer to an integer that represents amount of work (on progress indicator) the InstallTUNTAPAdapters will take. This function increments it by MSICA_ADAPTER_TICK_SIZE for each adapter to create.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; An error code otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00564">564</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="openvpnmsica_8c_source.html#l00060">MSICA_ADAPTER_TICK_SIZE</a>, <a class="el" href="msica__arg_8c_source.html#l00057">msica_arg_seq_add_head()</a>, <a class="el" href="msica__arg_8c_source.html#l00078">msica_arg_seq_add_tail()</a>, <a class="el" href="tap_8h_source.html#l00142">tap_adapter_node::pNext</a>, <a class="el" href="tapctl_2basic_8h_source.html#l00029">PRIsLPTSTR</a>, <a class="el" href="tap_8c_source.html#l01356">tap_free_adapter_list()</a>, and <a class="el" href="tap_8c_source.html#l01147">tap_list_adapters()</a>.</p>

<p class="reference">Referenced by <a class="el" href="openvpnmsica_8c_source.html#l00731">EvaluateTUNTAPAdapters()</a>.</p>

</div>
</div>
<a id="a57f93181adcbb8cab7dbeb9b9dbe5d44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57f93181adcbb8cab7dbeb9b9dbe5d44">&#9670;&nbsp;</a></span>schedule_adapter_delete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static DWORD schedule_adapter_delete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *&#160;</td>
          <td class="paramname"><em>seq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a9741e627e14220d0e9a803d9fa222a69">_Inout_opt_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *&#160;</td>
          <td class="paramname"><em>seqCommit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a9741e627e14220d0e9a803d9fa222a69">_Inout_opt_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *&#160;</td>
          <td class="paramname"><em>seqRollback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szDisplayName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szzHardwareIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> int *&#160;</td>
          <td class="paramname"><em>iTicks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Schedules adapter deletion. </p>
<p>When the rollback is enabled, the adapter deletition is scheduled as: disable in UninstallTUNTAPAdapters, enable on rollback, delete on commit.</p>
<p>When rollback is disabled, the adapter deletition is scheduled as delete in UninstallTUNTAPAdapters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seq</td><td>The argument sequence to pass to UninstallTUNTAPAdapters custom action</td></tr>
    <tr><td class="paramname">seqCommit</td><td>The argument sequence to pass to UninstallTUNTAPAdaptersCommit custom action. NULL when rollback is disabled.</td></tr>
    <tr><td class="paramname">seqRollback</td><td>The argument sequence to pass to UninstallTUNTAPAdaptersRollback custom action. NULL when rollback is disabled.</td></tr>
    <tr><td class="paramname">szDisplayName</td><td>Adapter display name</td></tr>
    <tr><td class="paramname">szzHardwareIDs</td><td>String of strings with acceptable adapter hardware IDs</td></tr>
    <tr><td class="paramname">iTicks</td><td>Pointer to an integer that represents amount of work (on progress indicator) the UninstallTUNTAPAdapters will take. This function increments it by MSICA_ADAPTER_TICK_SIZE for each adapter to delete.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; An error code otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00664">664</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="openvpnmsica_8c_source.html#l00060">MSICA_ADAPTER_TICK_SIZE</a>, <a class="el" href="msica__arg_8c_source.html#l00057">msica_arg_seq_add_head()</a>, <a class="el" href="msica__arg_8c_source.html#l00078">msica_arg_seq_add_tail()</a>, <a class="el" href="tap_8h_source.html#l00142">tap_adapter_node::pNext</a>, <a class="el" href="tapctl_2basic_8h_source.html#l00033">PRIGUID_PARAM</a>, <a class="el" href="tapctl_2basic_8h_source.html#l00032">PRIXGUID</a>, <a class="el" href="tap_8h_source.html#l00139">tap_adapter_node::szzHardwareIDs</a>, <a class="el" href="tap_8c_source.html#l01356">tap_free_adapter_list()</a>, and <a class="el" href="tap_8c_source.html#l01147">tap_list_adapters()</a>.</p>

<p class="reference">Referenced by <a class="el" href="openvpnmsica_8c_source.html#l00731">EvaluateTUNTAPAdapters()</a>.</p>

</div>
</div>
<a id="a6cf02471728554606048ea3cf742af28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cf02471728554606048ea3cf742af28">&#9670;&nbsp;</a></span>set_openvpnserv_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static UINT set_openvpnserv_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE&#160;</td>
          <td class="paramname"><em>hInstall</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Detects if the OpenVPNService service is in use (running or paused) and sets OPENVPNSERVICE to the service process PID, or its path if it is set to auto-start, but not running. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hInstall</td><td>Handle to the installation provided to the DLL custom action</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; An error code otherwise See: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00150">150</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, and <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>.</p>

<p class="reference">Referenced by <a class="el" href="openvpnmsica_8c_source.html#l00402">FindSystemInfo()</a>.</p>

</div>
</div>
<a id="afc3852993d3dcd7f0bdd224837aa73c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc3852993d3dcd7f0bdd224837aa73c1">&#9670;&nbsp;</a></span>setup_sequence()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static UINT setup_sequence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE&#160;</td>
          <td class="paramname"><em>hInstall</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a445adb5c0468d0aeaaaeb006ac4bbf7f">_In_z_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szProperty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> struct <a class="el" href="structmsica__arg__seq.html">msica_arg_seq</a> *&#160;</td>
          <td class="paramname"><em>seq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Joins an argument sequence and sets it to the MSI property. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hInstall</td><td>Handle to the installation provided to the DLL custom action</td></tr>
    <tr><td class="paramname">szProperty</td><td>MSI property name to set to the joined argument sequence.</td></tr>
    <tr><td class="paramname">seq</td><td>The argument sequence.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; An error code otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00076">76</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="msica__arg_8c_source.html#l00096">msica_arg_seq_join()</a>, and <a class="el" href="tapctl_2basic_8h_source.html#l00029">PRIsLPTSTR</a>.</p>

<p class="reference">Referenced by <a class="el" href="openvpnmsica_8c_source.html#l00731">EvaluateTUNTAPAdapters()</a>.</p>

</div>
</div>
<a id="aaea463ec153c101ecd8fc1dd71276408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaea463ec153c101ecd8fc1dd71276408">&#9670;&nbsp;</a></span>StartOpenVPNGUI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINT __stdcall StartOpenVPNGUI </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> MSIHANDLE&#160;</td>
          <td class="paramname"><em>hInstall</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Launches OpenVPN GUI. </p>
<p>It's path is obtained by expanding the <code>[#bin.openvpn_gui.exe]</code> therefore, its Id field in File table must be "bin.openvpn_gui.exe".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hInstall</td><td>Handle to the installation provided to the DLL custom action</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; An error code otherwise See: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/aa368072.aspx</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="openvpnmsica_8c_source.html#l00458">458</a> of file <a class="el" href="openvpnmsica_8c_source.html">openvpnmsica.c</a>.</p>

<p class="reference">References <a class="el" href="openvpnmsica_8c_source.html#l00135">debug_popup</a>, <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, and <a class="el" href="openvpnmsica_8h_source.html#l00054">OPENVPNMSICA_SAVE_MSI_SESSION</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
