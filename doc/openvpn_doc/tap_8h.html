<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenVPN: src/tapctl/tap.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenVPN
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1a0590686102dbc481222512e60904eb.html">tapctl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tap.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;windows.h&gt;</code><br />
<code>#include &quot;<a class="el" href="tapctl_2basic_8h_source.html">basic.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for tap.h:</div>
<div class="dyncontent">
<div class="center"><img src="tap_8h__incl.png" border="0" usemap="#src_2tapctl_2tap_8h" alt=""/></div>
<map name="src_2tapctl_2tap_8h" id="src_2tapctl_2tap_8h">
<area shape="rect" title=" " alt="" coords="42,5,151,32"/>
<area shape="rect" title=" " alt="" coords="5,80,89,107"/>
<area shape="rect" href="tapctl_2basic_8h.html" title=" " alt="" coords="114,80,178,107"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="tap_8h__dep__incl.png" border="0" usemap="#src_2tapctl_2tap_8hdep" alt=""/></div>
<map name="src_2tapctl_2tap_8hdep" id="src_2tapctl_2tap_8hdep">
<area shape="rect" title=" " alt="" coords="354,5,463,32"/>
<area shape="rect" href="msica__arg_8c.html" title=" " alt="" coords="5,80,172,121"/>
<area shape="rect" href="openvpnmsica_8c.html" title=" " alt="" coords="197,87,423,114"/>
<area shape="rect" href="main_8c.html" title=" " alt="" coords="448,87,567,114"/>
<area shape="rect" href="tap_8c.html" title=" " alt="" coords="591,87,701,114"/>
</map>
</div>
</div>
<p><a href="tap_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtap__adapter__node.html">tap_adapter_node</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Network adapter list node.  <a href="structtap__adapter__node.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88e5be4edaa74c65bd22afdae7aa0da0"><td class="memItemLeft" align="right" valign="top">DWORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tap_8h.html#a88e5be4edaa74c65bd22afdae7aa0da0">tap_create_adapter</a> (<a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> HWND hwndParent, <a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> LPCTSTR szDeviceDescription, <a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> LPCTSTR szHwId, <a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> LPBOOL pbRebootRequired, <a class="el" href="tapctl_2basic_8h.html#a9c50bd6a6ca6e0be76a0f3a79379b90e">_Out_</a> LPGUID pguidAdapter)</td></tr>
<tr class="memdesc:a88e5be4edaa74c65bd22afdae7aa0da0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a TUN/TAP adapter.  <a href="tap_8h.html#a88e5be4edaa74c65bd22afdae7aa0da0">More...</a><br /></td></tr>
<tr class="separator:a88e5be4edaa74c65bd22afdae7aa0da0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4a8e51bfc84cfdf15584716794c2ed3"><td class="memItemLeft" align="right" valign="top">DWORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tap_8h.html#ac4a8e51bfc84cfdf15584716794c2ed3">tap_delete_adapter</a> (<a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> HWND hwndParent, <a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> LPCGUID pguidAdapter, <a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> LPBOOL pbRebootRequired)</td></tr>
<tr class="memdesc:ac4a8e51bfc84cfdf15584716794c2ed3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes an adapter.  <a href="tap_8h.html#ac4a8e51bfc84cfdf15584716794c2ed3">More...</a><br /></td></tr>
<tr class="separator:ac4a8e51bfc84cfdf15584716794c2ed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af15c29578ef178f8e37c7330a9e794f8"><td class="memItemLeft" align="right" valign="top">DWORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tap_8h.html#af15c29578ef178f8e37c7330a9e794f8">tap_enable_adapter</a> (<a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> HWND hwndParent, <a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> LPCGUID pguidAdapter, <a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> BOOL bEnable, <a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> LPBOOL pbRebootRequired)</td></tr>
<tr class="memdesc:af15c29578ef178f8e37c7330a9e794f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables or disables an adapter.  <a href="tap_8h.html#af15c29578ef178f8e37c7330a9e794f8">More...</a><br /></td></tr>
<tr class="separator:af15c29578ef178f8e37c7330a9e794f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa383e394cbb13d6858187a6fec9afe4a"><td class="memItemLeft" align="right" valign="top">DWORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tap_8h.html#aa383e394cbb13d6858187a6fec9afe4a">tap_set_adapter_name</a> (<a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> LPCGUID pguidAdapter, <a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> LPCTSTR szName, <a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> BOOL bSilent)</td></tr>
<tr class="memdesc:aa383e394cbb13d6858187a6fec9afe4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets adapter name.  <a href="tap_8h.html#aa383e394cbb13d6858187a6fec9afe4a">More...</a><br /></td></tr>
<tr class="separator:aa383e394cbb13d6858187a6fec9afe4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a409366d04a30b7d6784e182c43eaff03"><td class="memItemLeft" align="right" valign="top">DWORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tap_8h.html#a409366d04a30b7d6784e182c43eaff03">tap_list_adapters</a> (<a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> HWND hwndParent, <a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> LPCTSTR szzHwIDs, <a class="el" href="tapctl_2basic_8h.html#a9c50bd6a6ca6e0be76a0f3a79379b90e">_Out_</a> struct <a class="el" href="structtap__adapter__node.html">tap_adapter_node</a> **ppAdapterList)</td></tr>
<tr class="memdesc:a409366d04a30b7d6784e182c43eaff03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a list of existing network adapters.  <a href="tap_8h.html#a409366d04a30b7d6784e182c43eaff03">More...</a><br /></td></tr>
<tr class="separator:a409366d04a30b7d6784e182c43eaff03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5d3110b02b5c8f0ac397fe0be810c3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tap_8h.html#ae5d3110b02b5c8f0ac397fe0be810c3a">tap_free_adapter_list</a> (<a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> struct <a class="el" href="structtap__adapter__node.html">tap_adapter_node</a> *pAdapterList)</td></tr>
<tr class="memdesc:ae5d3110b02b5c8f0ac397fe0be810c3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees a list of network adapters.  <a href="tap_8h.html#ae5d3110b02b5c8f0ac397fe0be810c3a">More...</a><br /></td></tr>
<tr class="separator:ae5d3110b02b5c8f0ac397fe0be810c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a88e5be4edaa74c65bd22afdae7aa0da0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88e5be4edaa74c65bd22afdae7aa0da0">&#9670;&nbsp;</a></span>tap_create_adapter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DWORD tap_create_adapter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> HWND&#160;</td>
          <td class="paramname"><em>hwndParent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szDeviceDescription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szHwId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> LPBOOL&#160;</td>
          <td class="paramname"><em>pbRebootRequired</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a9c50bd6a6ca6e0be76a0f3a79379b90e">_Out_</a> LPGUID&#160;</td>
          <td class="paramname"><em>pguidAdapter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a TUN/TAP adapter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hwndParent</td><td>A handle to the top-level window to use for any user adapter that is related to non-device-specific actions (such as a select-device dialog box that uses the global class driver list). This handle is optional and can be NULL. If a specific top-level window is not required, set hwndParent to NULL.</td></tr>
    <tr><td class="paramname">szDeviceDescription</td><td>A pointer to a NULL-terminated string that supplies the text description of the device. This pointer is optional and can be NULL.</td></tr>
    <tr><td class="paramname">szHwId</td><td>A pointer to a NULL-terminated string that supplies the hardware id of the device (e.g. "root\\tap0901", "Wintun").</td></tr>
    <tr><td class="paramname">pbRebootRequired</td><td>A pointer to a BOOL flag. If the device requires a system restart, this flag is set to TRUE. Otherwise, the flag is left unmodified. This allows the flag to be globally initialized to FALSE and reused for multiple adapter manipulations.</td></tr>
    <tr><td class="paramname">pguidAdapter</td><td>A pointer to GUID that receives network adapter ID.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; Win32 error code otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="tap_8c_source.html#l00725">725</a> of file <a class="el" href="tap_8c_source.html">tap.c</a>.</p>

<p class="reference">References <a class="el" href="tap_8c_source.html#l00183">check_reboot()</a>, <a class="el" href="tap_8c_source.html#l00065">find_function()</a>, <a class="el" href="tap_8c_source.html#l00558">get_net_adapter_guid()</a>, <a class="el" href="tap_8c_source.html#l00046">GUID_DEVCLASS_NET</a>, <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, and <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00138">_tmain()</a>, and <a class="el" href="openvpnmsica_8c_source.html#l01060">ProcessDeferredAction()</a>.</p>

</div>
</div>
<a id="ac4a8e51bfc84cfdf15584716794c2ed3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4a8e51bfc84cfdf15584716794c2ed3">&#9670;&nbsp;</a></span>tap_delete_adapter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DWORD tap_delete_adapter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> HWND&#160;</td>
          <td class="paramname"><em>hwndParent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> LPCGUID&#160;</td>
          <td class="paramname"><em>pguidAdapter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> LPBOOL&#160;</td>
          <td class="paramname"><em>pbRebootRequired</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes an adapter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hwndParent</td><td>A handle to the top-level window to use for any user adapter that is related to non-device-specific actions (such as a select-device dialog box that uses the global class driver list). This handle is optional and can be NULL. If a specific top-level window is not required, set hwndParent to NULL.</td></tr>
    <tr><td class="paramname">pguidAdapter</td><td>A pointer to GUID that contains network adapter ID.</td></tr>
    <tr><td class="paramname">pbRebootRequired</td><td>A pointer to a BOOL flag. If the device requires a system restart, this flag is set to TRUE. Otherwise, the flag is left unmodified. This allows the flag to be globally initialized to FALSE and reused for multiple adapter manipulations.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; Win32 error code otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="tap_8c_source.html#l01007">1007</a> of file <a class="el" href="tap_8c_source.html">tap.c</a>.</p>

<p class="reference">References <a class="el" href="tap_8c_source.html#l00230">delete_device()</a>, and <a class="el" href="tap_8c_source.html#l00918">execute_on_first_adapter()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00138">_tmain()</a>, and <a class="el" href="openvpnmsica_8c_source.html#l01060">ProcessDeferredAction()</a>.</p>

</div>
</div>
<a id="af15c29578ef178f8e37c7330a9e794f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af15c29578ef178f8e37c7330a9e794f8">&#9670;&nbsp;</a></span>tap_enable_adapter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DWORD tap_enable_adapter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> HWND&#160;</td>
          <td class="paramname"><em>hwndParent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> LPCGUID&#160;</td>
          <td class="paramname"><em>pguidAdapter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> BOOL&#160;</td>
          <td class="paramname"><em>bEnable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> LPBOOL&#160;</td>
          <td class="paramname"><em>pbRebootRequired</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables or disables an adapter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hwndParent</td><td>A handle to the top-level window to use for any user adapter that is related to non-device-specific actions (such as a select-device dialog box that uses the global class driver list). This handle is optional and can be NULL. If a specific top-level window is not required, set hwndParent to NULL.</td></tr>
    <tr><td class="paramname">pguidAdapter</td><td>A pointer to GUID that contains network adapter ID.</td></tr>
    <tr><td class="paramname">bEnable</td><td>TRUE to enable; FALSE to disable</td></tr>
    <tr><td class="paramname">pbRebootRequired</td><td>A pointer to a BOOL flag. If the device requires a system restart, this flag is set to TRUE. Otherwise, the flag is left unmodified. This allows the flag to be globally initialized to FALSE and reused for multiple adapter manipulations.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; Win32 error code otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="tap_8c_source.html#l01017">1017</a> of file <a class="el" href="tap_8c_source.html">tap.c</a>.</p>

<p class="reference">References <a class="el" href="tap_8c_source.html#l00384">disable_device()</a>, <a class="el" href="tap_8c_source.html#l00358">enable_device()</a>, and <a class="el" href="tap_8c_source.html#l00918">execute_on_first_adapter()</a>.</p>

<p class="reference">Referenced by <a class="el" href="openvpnmsica_8c_source.html#l01060">ProcessDeferredAction()</a>.</p>

</div>
</div>
<a id="ae5d3110b02b5c8f0ac397fe0be810c3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5d3110b02b5c8f0ac397fe0be810c3a">&#9670;&nbsp;</a></span>tap_free_adapter_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tap_free_adapter_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> struct <a class="el" href="structtap__adapter__node.html">tap_adapter_node</a> *&#160;</td>
          <td class="paramname"><em>pAdapterList</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees a list of network adapters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pAdapterList</td><td>A pointer to the first adapter in the list to free. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="tap_8c_source.html#l01356">1356</a> of file <a class="el" href="tap_8c_source.html">tap.c</a>.</p>

<p class="reference">References <a class="el" href="tap_8h_source.html#l00142">tap_adapter_node::pNext</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00138">_tmain()</a>, <a class="el" href="openvpnmsica_8c_source.html#l00253">find_adapters()</a>, <a class="el" href="openvpnmsica_8c_source.html#l01060">ProcessDeferredAction()</a>, <a class="el" href="openvpnmsica_8c_source.html#l00564">schedule_adapter_create()</a>, and <a class="el" href="openvpnmsica_8c_source.html#l00664">schedule_adapter_delete()</a>.</p>

</div>
</div>
<a id="a409366d04a30b7d6784e182c43eaff03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a409366d04a30b7d6784e182c43eaff03">&#9670;&nbsp;</a></span>tap_list_adapters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DWORD tap_list_adapters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> HWND&#160;</td>
          <td class="paramname"><em>hwndParent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szzHwIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#a9c50bd6a6ca6e0be76a0f3a79379b90e">_Out_</a> struct <a class="el" href="structtap__adapter__node.html">tap_adapter_node</a> **&#160;</td>
          <td class="paramname"><em>ppAdapterList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a list of existing network adapters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hwndParent</td><td>A handle to the top-level window to use for any user adapter that is related to non-device-specific actions (such as a select-device dialog box that uses the global class driver list). This handle is optional and can be NULL. If a specific top-level window is not required, set hwndParent to NULL.</td></tr>
    <tr><td class="paramname">szzHwIDs</td><td>A string of strings that supplies the list of hardware IDs of the device. This pointer is optional and can be NULL. When NULL, all network adapters found are added to the list.</td></tr>
    <tr><td class="paramname">ppAdapterList</td><td>A pointer to the list to receive pointer to the first adapter in the list. After the list is no longer required, free it using <a class="el" href="tap_8h.html#ae5d3110b02b5c8f0ac397fe0be810c3a" title="Frees a list of network adapters.">tap_free_adapter_list()</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; Win32 error code otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="tap_8c_source.html#l01147">1147</a> of file <a class="el" href="tap_8c_source.html">tap.c</a>.</p>

<p class="reference">References <a class="el" href="tap_8c_source.html#l00130">_tcszistr()</a>, <a class="el" href="tap_8c_source.html#l00109">_tcszlen()</a>, <a class="el" href="tap_8c_source.html#l00049">ADAPTER_REGKEY_PATH_MAX</a>, <a class="el" href="tap_8c_source.html#l00647">get_device_reg_property()</a>, <a class="el" href="tap_8c_source.html#l00558">get_net_adapter_guid()</a>, <a class="el" href="tap_8c_source.html#l00408">get_reg_string()</a>, <a class="el" href="tap_8h_source.html#l00138">tap_adapter_node::guid</a>, <a class="el" href="tap_8c_source.html#l00046">GUID_DEVCLASS_NET</a>, <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00091">M_FATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00093">M_WARN</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="tap_8h_source.html#l00142">tap_adapter_node::pNext</a>, <a class="el" href="tapctl_2basic_8h_source.html#l00030">PRIsLPOLESTR</a>, <a class="el" href="tapctl_2basic_8h_source.html#l00029">PRIsLPTSTR</a>, <a class="el" href="tap_8c_source.html#l00048">szAdapterRegKeyPathTemplate</a>, <a class="el" href="tap_8h_source.html#l00140">tap_adapter_node::szName</a>, and <a class="el" href="tap_8h_source.html#l00139">tap_adapter_node::szzHardwareIDs</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00138">_tmain()</a>, <a class="el" href="openvpnmsica_8c_source.html#l00253">find_adapters()</a>, <a class="el" href="openvpnmsica_8c_source.html#l01060">ProcessDeferredAction()</a>, <a class="el" href="openvpnmsica_8c_source.html#l00564">schedule_adapter_create()</a>, and <a class="el" href="openvpnmsica_8c_source.html#l00664">schedule_adapter_delete()</a>.</p>

</div>
</div>
<a id="aa383e394cbb13d6858187a6fec9afe4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa383e394cbb13d6858187a6fec9afe4a">&#9670;&nbsp;</a></span>tap_set_adapter_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DWORD tap_set_adapter_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> LPCGUID&#160;</td>
          <td class="paramname"><em>pguidAdapter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> LPCTSTR&#160;</td>
          <td class="paramname"><em>szName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tapctl_2basic_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> BOOL&#160;</td>
          <td class="paramname"><em>bSilent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets adapter name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pguidAdapter</td><td>A pointer to GUID that contains network adapter ID.</td></tr>
    <tr><td class="paramname">szName</td><td>New adapter name - must be unique</td></tr>
    <tr><td class="paramname">bSilent</td><td>If true, MSI installer won't display message box and only print error to log.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>ERROR_SUCCESS on success; Win32 error code otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="tap_8c_source.html#l01065">1065</a> of file <a class="el" href="tap_8c_source.html">tap.c</a>.</p>

<p class="reference">References <a class="el" href="tap_8c_source.html#l00049">ADAPTER_REGKEY_PATH_MAX</a>, <a class="el" href="tap_8c_source.html#l01028">ExecCommand()</a>, <a class="el" href="tap_8c_source.html#l00408">get_reg_string()</a>, <a class="el" href="tap_8c_source.html#l00046">GUID_DEVCLASS_NET</a>, <a class="el" href="openvpn_2error_8h_source.html#l00096">M_ERRNO</a>, <a class="el" href="openvpn_2error_8h_source.html#l00092">M_NONFATAL</a>, <a class="el" href="openvpn_2error_8h_source.html#l00093">M_WARN</a>, <a class="el" href="openvpn_2error_8h_source.html#l00170">msg</a>, <a class="el" href="tapctl_2basic_8h_source.html#l00029">PRIsLPTSTR</a>, <a class="el" href="tap_8c_source.html#l00048">szAdapterRegKeyPathTemplate</a>, and <a class="el" href="tap_8h_source.html#l00140">tap_adapter_node::szName</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8c_source.html#l00138">_tmain()</a>, and <a class="el" href="openvpnmsica_8c_source.html#l01060">ProcessDeferredAction()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
